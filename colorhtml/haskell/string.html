<div class="highlight"><pre><span class="c1">--unwrap Maybe</span>
<span class="nf">open</span><span class="ow">::</span><span class="kt">Maybe</span> <span class="n">a</span><span class="ow">-&gt;</span><span class="n">a</span>
<span class="nf">open</span> <span class="kt">Nothing</span> <span class="ow">=</span> <span class="ne">error</span> <span class="s">&quot;error&quot;</span>
<span class="nf">open</span> <span class="p">(</span><span class="kt">Just</span> <span class="n">a</span><span class="p">)</span> <span class="ow">=</span> <span class="n">a</span>

<span class="c1">-- find the index of Char</span>
<span class="nf">findChar</span><span class="ow">::</span><span class="kt">Char</span><span class="ow">-&gt;</span><span class="kt">String</span><span class="ow">-&gt;</span><span class="kt">Int</span>
<span class="nf">findChar</span> <span class="kr">_</span> <span class="kt">[]</span> <span class="ow">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="nf">findChar</span> <span class="n">a</span> <span class="p">(</span><span class="n">x</span><span class="kt">:</span><span class="n">xs</span><span class="p">)</span> <span class="ow">=</span> <span class="kr">if</span> <span class="n">a</span> <span class="o">/=</span> <span class="n">x</span> <span class="kr">then</span> <span class="p">((</span><span class="n">findChar</span> <span class="n">a</span> <span class="n">xs</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="kr">else</span> <span class="mi">0</span>

<span class="c1">-- substring from l to r</span>
<span class="nf">range</span><span class="ow">::</span><span class="kt">Int</span><span class="ow">-&gt;</span><span class="kt">Int</span><span class="ow">-&gt;</span><span class="kt">String</span><span class="ow">-&gt;</span><span class="kt">String</span>
<span class="nf">range</span> <span class="n">l</span> <span class="n">r</span> <span class="n">str</span> <span class="ow">=</span> <span class="kr">if</span> <span class="n">l</span> <span class="o">&gt;=</span> <span class="n">length</span> <span class="n">str</span> <span class="o">||</span> <span class="n">r</span> <span class="o">&gt;=</span> <span class="n">length</span> <span class="n">str</span> <span class="kr">then</span> <span class="kt">[]</span> <span class="kr">else</span> <span class="p">(</span><span class="kr">if</span> <span class="n">l</span> <span class="o">&lt;=</span> <span class="n">r</span> <span class="kr">then</span> <span class="n">str</span> <span class="o">!!</span> <span class="n">l</span> <span class="kt">:[]</span> <span class="o">++</span> <span class="n">range</span> <span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="n">r</span> <span class="n">str</span> <span class="kr">else</span> <span class="kt">[]</span><span class="p">)</span>
</pre></div>
