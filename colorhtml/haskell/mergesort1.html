<div class="highlight"><pre><span class="nf">mergeSort</span><span class="ow">::</span><span class="p">[</span><span class="kt">Int</span><span class="p">]</span><span class="ow">-&gt;</span><span class="p">[</span><span class="kt">Int</span><span class="p">]</span>
<span class="nf">mergeSort</span> <span class="kt">[]</span> <span class="ow">=</span> <span class="kt">[]</span>
<span class="nf">mergeSort</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="ow">=</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span>
<span class="nf">mergeSort</span> <span class="n">l</span> <span class="ow">=</span> <span class="n">merge</span><span class="p">(</span><span class="n">mergeSort</span> <span class="n">left</span><span class="p">)</span> <span class="p">(</span><span class="n">mergeSort</span> <span class="n">right</span><span class="p">)</span> 
                <span class="kr">where</span>
                    <span class="n">half</span> <span class="ow">=</span> <span class="p">(</span><span class="n">length</span> <span class="n">l</span><span class="p">)</span> <span class="p">`</span><span class="n">div</span><span class="p">`</span> <span class="mi">2</span>
                    <span class="n">left</span> <span class="ow">=</span> <span class="n">take</span> <span class="n">half</span> <span class="n">l</span>
                    <span class="n">right</span> <span class="ow">=</span> <span class="n">drop</span> <span class="n">half</span> <span class="n">l</span>  

                    <span class="n">merge</span><span class="ow">::</span><span class="p">[</span><span class="kt">Int</span><span class="p">]</span><span class="ow">-&gt;</span><span class="p">[</span><span class="kt">Int</span><span class="p">]</span><span class="ow">-&gt;</span><span class="p">[</span><span class="kt">Int</span><span class="p">]</span>
                    <span class="n">merge</span> <span class="kt">[]</span> <span class="n">r</span> <span class="ow">=</span> <span class="n">r</span>
                    <span class="n">merge</span> <span class="n">l</span> <span class="kt">[]</span> <span class="ow">=</span> <span class="n">l</span>
                    <span class="n">merge</span> <span class="p">(</span><span class="n">x</span><span class="kt">:</span><span class="n">xs</span><span class="p">)</span> <span class="p">(</span><span class="n">y</span><span class="kt">:</span><span class="n">ys</span><span class="p">)</span>  <span class="ow">=</span> <span class="kr">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span>
                                            <span class="kr">then</span> 
                                               <span class="n">x</span><span class="kt">:</span><span class="n">merge</span> <span class="n">xs</span> <span class="p">(</span><span class="n">y</span><span class="kt">:</span><span class="n">ys</span><span class="p">)</span> 
                                            <span class="kr">else</span>
                                               <span class="n">y</span><span class="kt">:</span><span class="n">merge</span> <span class="p">(</span><span class="n">x</span><span class="kt">:</span><span class="n">xs</span><span class="p">)</span> <span class="n">ys</span>
</pre></div>
