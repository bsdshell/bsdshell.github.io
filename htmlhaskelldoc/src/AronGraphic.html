<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">AronGraphic</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unless</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">when</span><span class="hs-special">)</span><span>
</span><a name="line-4"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Graphics.Rendering.OpenGL</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">GL</span><span>
</span><a name="line-5"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Graphics.Rendering.OpenGL.GLU.Matrix</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">GM</span><span>
</span><a name="line-6"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Graphics.UI.GLFW</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">FW</span><span>
</span><a name="line-7"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">System.Exit</span><span>
</span><a name="line-8"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">System.IO</span><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad</span><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">System.Random</span><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Set</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span class="hs-special">)</span><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Maybe</span><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.IORef</span><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.Real</span><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Set</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">S</span><span>
</span><a name="line-16"></a><span class="hs-comment">--import Linear.V3</span><span>
</span><a name="line-17"></a><span class="hs-comment">--import Linear.V3(cross) </span><span>
</span><a name="line-18"></a><span class="hs-comment">--import Linear.Vector</span><span>
</span><a name="line-19"></a><span class="hs-comment">--import Linear.Matrix</span><span>
</span><a name="line-20"></a><span class="hs-comment">--import Linear.Projection as P</span><span>
</span><a name="line-21"></a><span class="hs-comment">--import Linear.Metric(norm, signorm)</span><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span> </span><a href="AronModule.html"><span class="hs-identifier">AronModule</span></a><span>
</span><a name="line-24"></a><span>
</span><a name="line-25"></a><span class="hs-identifier">lightDiffuse</span><span> </span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Color4</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-26"></a><a name="lightDiffuse"><a href="AronGraphic.html#lightDiffuse"><span class="hs-identifier">lightDiffuse</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Color4</span><span> </span><span class="hs-number">0.6</span><span> </span><span class="hs-number">1.0</span><span> </span><span class="hs-number">0.5</span><span> </span><span class="hs-number">0.6</span><span>
</span><a name="line-27"></a><span>
</span><a name="line-28"></a><span class="hs-identifier">lightAmbient</span><span> </span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Color4</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-29"></a><a name="lightAmbient"><a href="AronGraphic.html#lightAmbient"><span class="hs-identifier">lightAmbient</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Color4</span><span> </span><span class="hs-number">0.0</span><span> </span><span class="hs-number">0.0</span><span> </span><span class="hs-number">1.0</span><span> </span><span class="hs-number">1.0</span><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span class="hs-identifier">lightPosition</span><span> </span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex4</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-32"></a><a name="lightPosition"><a href="AronGraphic.html#lightPosition"><span class="hs-identifier">lightPosition</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex4</span><span> </span><span class="hs-number">1.0</span><span> </span><span class="hs-number">1.0</span><span> </span><span class="hs-number">1.2</span><span> </span><span class="hs-number">0.0</span><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span class="hs-identifier">lightSpecular</span><span> </span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Color4</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-35"></a><a name="lightSpecular"><a href="AronGraphic.html#lightSpecular"><span class="hs-identifier">lightSpecular</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Color4</span><span> </span><span class="hs-number">1.0</span><span> </span><span class="hs-number">0.7</span><span> </span><span class="hs-number">1.0</span><span> </span><span class="hs-number">0.8</span><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span class="hs-keyword">data</span><span> </span><a name="SegEndPt"><a href="AronGraphic.html#SegEndPt"><span class="hs-identifier">SegEndPt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="No"><a href="AronGraphic.html#No"><span class="hs-identifier">No</span></a></a><span>      </span><span class="hs-comment">-- no pt, just a segment </span><span>
</span><a name="line-38"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a name="End"><a href="AronGraphic.html#End"><span class="hs-identifier">End</span></a></a><span>   </span><span class="hs-comment">-- end pt </span><span>
</span><a name="line-39"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a name="Beg"><a href="AronGraphic.html#Beg"><span class="hs-identifier">Beg</span></a></a><span>   </span><span class="hs-comment">-- begin pt </span><span>
</span><a name="line-40"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a name="Both"><a href="AronGraphic.html#Both"><span class="hs-identifier">Both</span></a></a><span>  </span><span class="hs-comment">-- begin and end pts </span><span>
</span><a name="line-41"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a name="Cen"><a href="AronGraphic.html#Cen"><span class="hs-identifier">Cen</span></a></a><span>   </span><span class="hs-comment">-- center pt </span><span>
</span><a name="line-42"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a name="All"><a href="AronGraphic.html#All"><span class="hs-identifier">All</span></a></a><span>   </span><span class="hs-comment">-- all pts: begin, end and ceneter </span><span>
</span><a name="line-43"></a><span>
</span><a name="line-44"></a><span class="hs-comment">--   /\</span><span>
</span><a name="line-45"></a><span class="hs-comment">--   | ccw</span><span>
</span><a name="line-46"></a><span class="hs-comment">--    --&gt; </span><span>
</span><a name="line-47"></a><span class="hs-comment">--   | cw</span><span>
</span><a name="line-48"></a><span class="hs-comment">--   V </span><span>
</span><a name="line-49"></a><span class="hs-comment">-- | counter clockwise | clock wise</span><span>
</span><a name="line-50"></a><span class="hs-keyword">data</span><span> </span><a name="NormalDir"><a href="AronGraphic.html#NormalDir"><span class="hs-identifier">NormalDir</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="NCCW"><a href="AronGraphic.html#NCCW"><span class="hs-identifier">NCCW</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="NCW"><a href="AronGraphic.html#NCW"><span class="hs-identifier">NCW</span></a></a><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">)</span><span>
</span><a name="line-51"></a><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span class="hs-comment">{-|
    === Compute the distance between two points

    \( v = (x, y, z) \)

    \( \| v \| = \sqrt{ x^2 + y^2 + z^2} = \sqrt{ v \cdot v} \)
    
    &gt;let v1 = Vertex3 1 2 3
    &gt;let v2 = Vertex3 2 3 4 
    &gt;dist v1 v2
-}</span><span>
</span><a name="line-64"></a><span class="hs-identifier">dist</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-65"></a><a name="dist"><a href="AronGraphic.html#dist"><span class="hs-identifier">dist</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679077974"><a href="#local-6989586621679077974"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679077975"><a href="#local-6989586621679077975"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679077976"><a href="#local-6989586621679077976"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679077977"><a href="#local-6989586621679077977"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679077978"><a href="#local-6989586621679077978"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679077979"><a href="#local-6989586621679077979"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sqrt</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679077977"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679077974"><span class="hs-identifier hs-var">x0</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">**</span><span class="hs-number">2</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679077978"><span class="hs-identifier hs-var">y1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679077975"><span class="hs-identifier hs-var">y0</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">**</span><span class="hs-number">2</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679077979"><span class="hs-identifier hs-var">z1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679077976"><span class="hs-identifier hs-var">z0</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">**</span><span class="hs-number">2</span><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span>
</span><a name="line-68"></a><span class="hs-comment">{-|
    === Compute the norm-squared

    \( v = (x, y, z)\)

    \( |v|^2 = x^2 + y^2 + z^2 \)
    
    &gt;let v1 = Vertex3 1 2 3
    &gt;let v2 = Vertex3 2 3 4 
    &gt;sqdist v1 v2
-}</span><span>
</span><a name="line-79"></a><span class="hs-identifier">sqdist</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-80"></a><a name="sqdist"><a href="AronGraphic.html#sqdist"><span class="hs-identifier">sqdist</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679077980"><a href="#local-6989586621679077980"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679077981"><a href="#local-6989586621679077981"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679077982"><a href="#local-6989586621679077982"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679077983"><a href="#local-6989586621679077983"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679077984"><a href="#local-6989586621679077984"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679077985"><a href="#local-6989586621679077985"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679077983"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679077980"><span class="hs-identifier hs-var">x0</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">**</span><span class="hs-number">2</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679077984"><span class="hs-identifier hs-var">y1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679077981"><span class="hs-identifier hs-var">y0</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">**</span><span class="hs-number">2</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679077985"><span class="hs-identifier hs-var">z1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679077982"><span class="hs-identifier hs-var">z0</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">**</span><span class="hs-number">2</span><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span class="hs-comment">-- | dot product for Vector3</span><span>
</span><a name="line-83"></a><span class="hs-identifier">dot3ve</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679077973"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-identifier hs-type">Vector3</span><span> </span><a href="#local-6989586621679077973"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><a href="#local-6989586621679077973"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679077973"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-84"></a><a name="dot3ve"><a href="AronGraphic.html#dot3ve"><span class="hs-identifier">dot3ve</span></a></a><span> </span><a name="local-6989586621679077986"><a href="#local-6989586621679077986"><span class="hs-identifier">v1</span></a></a><span> </span><a name="local-6989586621679077987"><a href="#local-6989586621679077987"><span class="hs-identifier">v2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#dot3vx"><span class="hs-identifier hs-var">dot3vx</span></a><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#v2x"><span class="hs-identifier hs-var">v2x</span></a><span> </span><a href="#local-6989586621679077986"><span class="hs-identifier hs-var">v1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#v2x"><span class="hs-identifier hs-var">v2x</span></a><span> </span><a href="#local-6989586621679077987"><span class="hs-identifier hs-var">v2</span></a><span class="hs-special">)</span><span>
</span><a name="line-85"></a><span>
</span><a name="line-86"></a><span class="hs-comment">-- | dot product for Vertex3 </span><span>
</span><a name="line-87"></a><span class="hs-identifier">dot3vx</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679077972"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679077972"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679077972"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679077972"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-88"></a><a name="dot3vx"><a href="AronGraphic.html#dot3vx"><span class="hs-identifier">dot3vx</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679077988"><a href="#local-6989586621679077988"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679077989"><a href="#local-6989586621679077989"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679077990"><a href="#local-6989586621679077990"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679077991"><a href="#local-6989586621679077991"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679077992"><a href="#local-6989586621679077992"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679077993"><a href="#local-6989586621679077993"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679077988"><span class="hs-identifier hs-var">x0</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679077991"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679077989"><span class="hs-identifier hs-var">y0</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679077992"><span class="hs-identifier hs-var">y1</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679077990"><span class="hs-identifier hs-var">z0</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679077993"><span class="hs-identifier hs-var">z1</span></a><span>
</span><a name="line-89"></a><span>
</span><a name="line-90"></a><span class="hs-special">(</span><span class="hs-operator">+:</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679077971"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679077971"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><a href="#local-6989586621679077971"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679077971"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-91"></a><span class="hs-special">(</span><a name="%2B%3A"><a href="AronGraphic.html#%2B%3A"><span class="hs-operator">+:</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679077994"><a href="#local-6989586621679077994"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679077995"><a href="#local-6989586621679077995"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679077996"><a href="#local-6989586621679077996"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679077997"><a href="#local-6989586621679077997"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679077998"><a href="#local-6989586621679077998"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679077999"><a href="#local-6989586621679077999"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679077994"><span class="hs-identifier hs-var">x0</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679077997"><span class="hs-identifier hs-var">x1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679077995"><span class="hs-identifier hs-var">y0</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679077998"><span class="hs-identifier hs-var">y1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679077996"><span class="hs-identifier hs-var">z0</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679077999"><span class="hs-identifier hs-var">z1</span></a><span class="hs-special">)</span><span>
</span><a name="line-92"></a><span>
</span><a name="line-93"></a><span class="hs-special">(</span><span class="hs-operator">-:</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679077970"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679077970"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679077970"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><a href="#local-6989586621679077970"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-94"></a><span class="hs-special">(</span><a name="-%3A"><a href="AronGraphic.html#-%3A"><span class="hs-operator">-:</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679078000"><a href="#local-6989586621679078000"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679078001"><a href="#local-6989586621679078001"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679078002"><a href="#local-6989586621679078002"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679078003"><a href="#local-6989586621679078003"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679078004"><a href="#local-6989586621679078004"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679078005"><a href="#local-6989586621679078005"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vector3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078000"><span class="hs-identifier hs-var">x0</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679078003"><span class="hs-identifier hs-var">x1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078001"><span class="hs-identifier hs-var">y0</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679078004"><span class="hs-identifier hs-var">y1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078002"><span class="hs-identifier hs-var">z0</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679078005"><span class="hs-identifier hs-var">z1</span></a><span class="hs-special">)</span><span>
</span><a name="line-95"></a><span>
</span><a name="line-96"></a><span class="hs-special">(</span><span class="hs-operator">&#8869;</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-97"></a><span class="hs-special">(</span><a name="%22A5"><a href="AronGraphic.html#%22A5"><span class="hs-operator">&#8869;</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679078006"><a href="#local-6989586621679078006"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679078007"><a href="#local-6989586621679078007"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679078008"><a href="#local-6989586621679078008"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vector3</span><span> </span><a href="#local-6989586621679078007"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679078006"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679078008"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a><span class="hs-identifier">perpcw</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679077969"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-identifier hs-type">Vector3</span><span> </span><a href="#local-6989586621679077969"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Vector3</span><span> </span><a href="#local-6989586621679077969"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-100"></a><a name="perpcw"><a href="AronGraphic.html#perpcw"><span class="hs-identifier">perpcw</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679078009"><a href="#local-6989586621679078009"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679078010"><a href="#local-6989586621679078010"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679078011"><a href="#local-6989586621679078011"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vector3</span><span> </span><a href="#local-6989586621679078010"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679078009"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679078011"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-101"></a><span>
</span><a name="line-102"></a><span class="hs-identifier">perpccw</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679077968"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-identifier hs-type">Vector3</span><span> </span><a href="#local-6989586621679077968"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Vector3</span><span> </span><a href="#local-6989586621679077968"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-103"></a><a name="perpccw"><a href="AronGraphic.html#perpccw"><span class="hs-identifier">perpccw</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679078012"><a href="#local-6989586621679078012"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679078013"><a href="#local-6989586621679078013"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679078014"><a href="#local-6989586621679078014"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vector3</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679078013"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679078012"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679078014"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-104"></a><span>
</span><a name="line-105"></a><span class="hs-special">(</span><span class="hs-operator">*:</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679077967"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><a href="#local-6989586621679077967"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><a href="#local-6989586621679077967"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><a href="#local-6989586621679077967"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-106"></a><span class="hs-special">(</span><a name="%2A%3A"><a href="AronGraphic.html#%2A%3A"><span class="hs-operator">*:</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679078015"><a href="#local-6989586621679078015"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679078016"><a href="#local-6989586621679078016"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679078017"><a href="#local-6989586621679078017"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679078018"><a href="#local-6989586621679078018"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vector3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078015"><span class="hs-identifier hs-var">k</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679078016"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078015"><span class="hs-identifier hs-var">k</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679078017"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078015"><span class="hs-identifier hs-var">k</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679078018"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span>
</span><a name="line-107"></a><span>
</span><a name="line-108"></a><span class="hs-special">(</span><span class="hs-operator">**:</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-109"></a><span class="hs-special">(</span><a name="%2A%2A%3A"><a href="AronGraphic.html#%2A%2A%3A"><span class="hs-operator">**:</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679078019"><a href="#local-6989586621679078019"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679078020"><a href="#local-6989586621679078020"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679078021"><a href="#local-6989586621679078021"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679078022"><a href="#local-6989586621679078022"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078019"><span class="hs-identifier hs-var">t</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679078020"><span class="hs-identifier hs-var">x0</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078019"><span class="hs-identifier hs-var">t</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679078021"><span class="hs-identifier hs-var">y0</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078019"><span class="hs-identifier hs-var">t</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679078022"><span class="hs-identifier hs-var">z0</span></a><span class="hs-special">)</span><span>
</span><a name="line-110"></a><span>
</span><a name="line-111"></a><span class="hs-special">(</span><span class="hs-operator">*&gt;:</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-112"></a><span class="hs-special">(</span><a name="%2A%3E%3A"><a href="AronGraphic.html#%2A%3E%3A"><span class="hs-operator">*&gt;:</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679078023"><a href="#local-6989586621679078023"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679078024"><a href="#local-6989586621679078024"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679078025"><a href="#local-6989586621679078025"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679078026"><a href="#local-6989586621679078026"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078023"><span class="hs-identifier hs-var">k</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679078024"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078023"><span class="hs-identifier hs-var">k</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679078025"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078023"><span class="hs-identifier hs-var">k</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679078026"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span>
</span><a name="line-113"></a><span>
</span><a name="line-114"></a><span class="hs-special">(</span><span class="hs-operator">&gt;&gt;:</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-115"></a><span class="hs-special">(</span><a name="%3E%3E%3A"><a href="AronGraphic.html#%3E%3E%3A"><span class="hs-operator">&gt;&gt;:</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679078027"><a href="#local-6989586621679078027"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679078028"><a href="#local-6989586621679078028"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679078029"><a href="#local-6989586621679078029"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679078030"><a href="#local-6989586621679078030"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vector3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078027"><span class="hs-identifier hs-var">k</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679078028"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078027"><span class="hs-identifier hs-var">k</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679078029"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078027"><span class="hs-identifier hs-var">k</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679078030"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span>
</span><a name="line-116"></a><span>
</span><a name="line-117"></a><span class="hs-special">(</span><span class="hs-operator">.&gt;</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-118"></a><span class="hs-special">(</span><a name=".%3E"><a href="AronGraphic.html#.%3E"><span class="hs-operator">.&gt;</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">3</span><span>
</span><a name="line-119"></a><span>
</span><a name="line-120"></a><span class="hs-comment">-- | dot product  odot</span><span>
</span><a name="line-121"></a><span class="hs-special">(</span><span class="hs-operator">&#8857;</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-122"></a><span class="hs-special">(</span><a name="%2299"><a href="AronGraphic.html#%2299"><span class="hs-operator">&#8857;</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679078031"><a href="#local-6989586621679078031"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679078032"><a href="#local-6989586621679078032"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679078033"><a href="#local-6989586621679078033"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679078034"><a href="#local-6989586621679078034"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679078035"><a href="#local-6989586621679078035"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679078036"><a href="#local-6989586621679078036"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078031"><span class="hs-identifier hs-var">x0</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679078034"><span class="hs-identifier hs-var">x1</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078032"><span class="hs-identifier hs-var">y0</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679078035"><span class="hs-identifier hs-var">y1</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078033"><span class="hs-identifier hs-var">z0</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679078036"><span class="hs-identifier hs-var">z1</span></a><span class="hs-special">)</span><span>
</span><a name="line-123"></a><span>
</span><a name="line-124"></a><span class="hs-special">(</span><span class="hs-operator">&#8712;</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679077966"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679077966"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><a href="#local-6989586621679077966"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679077966"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-125"></a><span class="hs-special">(</span><a name="%2208"><a href="AronGraphic.html#%2208"><span class="hs-operator">&#8712;</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679078037"><a href="#local-6989586621679078037"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621679078038"><a href="#local-6989586621679078038"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679078039"><a href="#local-6989586621679078039"><span class="hs-identifier">c</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679078037"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><a href="#local-6989586621679078038"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679078037"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621679078039"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-126"></a><span>
</span><a name="line-127"></a><span class="hs-special">(</span><span class="hs-operator">&#8728;</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679077965"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><a href="#local-6989586621679077965"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><a href="#local-6989586621679077965"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><a href="#local-6989586621679077965"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-128"></a><span class="hs-special">(</span><a name="%2218"><a href="AronGraphic.html#%2218"><span class="hs-operator">&#8728;</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679078040"><a href="#local-6989586621679078040"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679078041"><a href="#local-6989586621679078041"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679078042"><a href="#local-6989586621679078042"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679078043"><a href="#local-6989586621679078043"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vector3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078040"><span class="hs-identifier hs-var">k</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679078041"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078040"><span class="hs-identifier hs-var">k</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679078042"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078040"><span class="hs-identifier hs-var">k</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679078043"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span>
</span><a name="line-129"></a><span>
</span><a name="line-130"></a><span class="hs-special">(</span><span class="hs-operator">&#8721;</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-131"></a><span class="hs-special">(</span><a name="%2211"><a href="AronGraphic.html#%2211"><span class="hs-operator">&#8721;</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">4</span><span>
</span><a name="line-132"></a><span class="hs-special">(</span><span class="hs-operator">&#8718;</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-133"></a><span class="hs-special">(</span><a name="%220E"><a href="AronGraphic.html#%220E"><span class="hs-operator">&#8718;</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679078044"><a href="#local-6989586621679078044"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679078045"><a href="#local-6989586621679078045"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679078046"><a href="#local-6989586621679078046"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679078047"><a href="#local-6989586621679078047"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vector3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078044"><span class="hs-identifier hs-var">k</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679078047"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078044"><span class="hs-identifier hs-var">k</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679078046"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078044"><span class="hs-identifier hs-var">k</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679078047"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span>
</span><a name="line-134"></a><span>
</span><a name="line-135"></a><span class="hs-identifier">v2x</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679077964"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-identifier hs-type">Vector3</span><span> </span><a href="#local-6989586621679077964"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679077964"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-136"></a><a name="v2x"><a href="AronGraphic.html#v2x"><span class="hs-identifier">v2x</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679078048"><a href="#local-6989586621679078048"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679078049"><a href="#local-6989586621679078049"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679078050"><a href="#local-6989586621679078050"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a href="#local-6989586621679078048"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679078049"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679078050"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-137"></a><span>
</span><a name="line-138"></a><span class="hs-identifier">x2v</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679077963"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679077963"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><a href="#local-6989586621679077963"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-139"></a><a name="x2v"><a href="AronGraphic.html#x2v"><span class="hs-identifier">x2v</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679078051"><a href="#local-6989586621679078051"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679078052"><a href="#local-6989586621679078052"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679078053"><a href="#local-6989586621679078053"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vector3</span><span> </span><a href="#local-6989586621679078051"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679078052"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679078053"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-140"></a><span>
</span><a name="line-141"></a><span class="hs-comment">-- Tue Jan  1 17:57:32 2019 </span><span>
</span><a name="line-142"></a><span class="hs-comment">-- remove it</span><span>
</span><a name="line-143"></a><span class="hs-comment">--smulv::GLfloat -&gt; Vector3 GLfloat -&gt;Vector3 GLfloat </span><span>
</span><a name="line-144"></a><span class="hs-comment">--smulv k (Vector3 x y z) = Vector3 (k*x) (k*y) (k*z)</span><span>
</span><a name="line-145"></a><span>
</span><a name="line-146"></a><span class="hs-comment">-- | Shorten realToFrac </span><span>
</span><a name="line-147"></a><span class="hs-identifier">rf</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Real</span><span> </span><a href="#local-6989586621679077961"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679077962"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679077961"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679077962"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-148"></a><a name="rf"><a href="AronGraphic.html#rf"><span class="hs-identifier">rf</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">realToFrac</span><span>
</span><a name="line-149"></a><span>
</span><a name="line-150"></a><span class="hs-comment">-- | -------------------------------------------------------------------------------- </span><span>
</span><a name="line-151"></a><span class="hs-comment">-- | Fri Dec  7 14:35:38 2018 </span><span>
</span><a name="line-152"></a><span class="hs-comment">-- | three colors: data Color3 a = Color3 !a !a !a</span><span>
</span><a name="line-153"></a><a name="red"><a href="AronGraphic.html#red"><span class="hs-identifier">red</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Color3</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span>
</span><a name="line-154"></a><a name="green"><a href="AronGraphic.html#green"><span class="hs-identifier">green</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Color3</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span>
</span><a name="line-155"></a><a name="blue"><a href="AronGraphic.html#blue"><span class="hs-identifier">blue</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Color3</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span>
</span><a name="line-156"></a><span>
</span><a name="line-157"></a><span>
</span><a name="line-158"></a><span class="hs-comment">-- Fri Dec 28 21:51:37 2018 </span><span>
</span><a name="line-159"></a><span class="hs-comment">-- TODO: remove it</span><span>
</span><a name="line-160"></a><span class="hs-comment">--dot3'::Vector3 GLfloat -&gt; Vector3 GLfloat -&gt; GLfloat</span><span>
</span><a name="line-161"></a><span class="hs-comment">--dot3' (Vector3 x0 y0 z0) (Vector3 x1 y1 z1) = x0*x1 + y0*y1 + z0*z1</span><span>
</span><a name="line-162"></a><span>
</span><a name="line-163"></a><span class="hs-comment">-- | form a skew symmetric matrix from Vertex3</span><span>
</span><a name="line-164"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-165"></a><span class="hs-comment">-- | cross product of a x b = [a] b where [a] is skew symmetric matrix from vector a</span><span>
</span><a name="line-166"></a><span class="hs-comment">-- |  colIndex x rowIndex = [c][r]</span><span>
</span><a name="line-167"></a><span class="hs-comment">-- |     i  j   k         k    i </span><span>
</span><a name="line-168"></a><span class="hs-comment">-- |  i -1  -k  j           j </span><span>
</span><a name="line-169"></a><span class="hs-comment">-- |  j  k  -1  -i     </span><span>
</span><a name="line-170"></a><span class="hs-comment">-- |  k -j  i   -1</span><span>
</span><a name="line-171"></a><span class="hs-identifier">skew</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679077960"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679077960"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679077960"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-172"></a><a name="skew"><a href="AronGraphic.html#skew"><span class="hs-identifier">skew</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679078054"><a href="#local-6989586621679078054"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679078055"><a href="#local-6989586621679078055"><span class="hs-identifier">a2</span></a></a><span> </span><a name="local-6989586621679078056"><a href="#local-6989586621679078056"><span class="hs-identifier">a3</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span>
</span><a name="line-173"></a><span>                            </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span>     </span><span class="hs-glyph">-</span><a href="#local-6989586621679078056"><span class="hs-identifier hs-var">a3</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679078055"><span class="hs-identifier hs-var">a2</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-174"></a><span>                            </span><span class="hs-special">[</span><a href="#local-6989586621679078056"><span class="hs-identifier hs-var">a3</span></a><span class="hs-special">,</span><span>    </span><span class="hs-number">0</span><span class="hs-special">,</span><span>  </span><span class="hs-glyph">-</span><a href="#local-6989586621679078054"><span class="hs-identifier hs-var">a1</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-175"></a><span>                            </span><span class="hs-special">[</span><span class="hs-glyph">-</span><a href="#local-6989586621679078055"><span class="hs-identifier hs-var">a2</span></a><span class="hs-special">,</span><span>   </span><a href="#local-6989586621679078054"><span class="hs-identifier hs-var">a1</span></a><span class="hs-special">,</span><span>   </span><span class="hs-number">0</span><span class="hs-special">]</span><span>
</span><a name="line-176"></a><span>                          </span><span class="hs-special">]</span><span>
</span><a name="line-177"></a><span>
</span><a name="line-178"></a><span class="hs-identifier">skew'</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679077959"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-identifier hs-type">Vector3</span><span> </span><a href="#local-6989586621679077959"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679077959"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-179"></a><a name="skew%27"><a href="AronGraphic.html#skew%27"><span class="hs-identifier">skew'</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679078057"><a href="#local-6989586621679078057"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679078058"><a href="#local-6989586621679078058"><span class="hs-identifier">a2</span></a></a><span> </span><a name="local-6989586621679078059"><a href="#local-6989586621679078059"><span class="hs-identifier">a3</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span>
</span><a name="line-180"></a><span>                            </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span>     </span><span class="hs-glyph">-</span><a href="#local-6989586621679078059"><span class="hs-identifier hs-var">a3</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679078058"><span class="hs-identifier hs-var">a2</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-181"></a><span>                            </span><span class="hs-special">[</span><a href="#local-6989586621679078059"><span class="hs-identifier hs-var">a3</span></a><span class="hs-special">,</span><span>    </span><span class="hs-number">0</span><span class="hs-special">,</span><span>  </span><span class="hs-glyph">-</span><a href="#local-6989586621679078057"><span class="hs-identifier hs-var">a1</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-182"></a><span>                            </span><span class="hs-special">[</span><span class="hs-glyph">-</span><a href="#local-6989586621679078058"><span class="hs-identifier hs-var">a2</span></a><span class="hs-special">,</span><span>   </span><a href="#local-6989586621679078057"><span class="hs-identifier hs-var">a1</span></a><span class="hs-special">,</span><span>   </span><span class="hs-number">0</span><span class="hs-special">]</span><span>
</span><a name="line-183"></a><span>                           </span><span class="hs-special">]</span><span>
</span><a name="line-184"></a><span>
</span><a name="line-185"></a><span>
</span><a name="line-186"></a><span class="hs-comment">{-|
  === Cross product of two vectors.
  * The directin is determinated by the the Right Hadle Rule                        
-}</span><span>
</span><a name="line-190"></a><span class="hs-special">(</span><span class="hs-operator">&#8855;</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-191"></a><span class="hs-special">(</span><a name="%2297"><a href="AronGraphic.html#%2297"><span class="hs-operator">&#8855;</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679078060"><a href="#local-6989586621679078060"><span class="hs-identifier">v0</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679078061"><a href="#local-6989586621679078061"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679078062"><a href="#local-6989586621679078062"><span class="hs-identifier">a2</span></a></a><span> </span><a name="local-6989586621679078063"><a href="#local-6989586621679078063"><span class="hs-identifier">a3</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679078064"><a href="#local-6989586621679078064"><span class="hs-identifier">v1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679078065"><a href="#local-6989586621679078065"><span class="hs-identifier">b1</span></a></a><span> </span><a name="local-6989586621679078066"><a href="#local-6989586621679078066"><span class="hs-identifier">b2</span></a></a><span> </span><a name="local-6989586621679078067"><a href="#local-6989586621679078067"><span class="hs-identifier">b3</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vector3</span><span> </span><a href="#local-6989586621679078072"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679078073"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679078074"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-192"></a><span>                    </span><span class="hs-keyword">where</span><span>
</span><a name="line-193"></a><span>                        </span><a name="local-6989586621679078068"><a href="#local-6989586621679078068"><span class="hs-identifier">vs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679078065"><span class="hs-identifier hs-var">b1</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679078066"><span class="hs-identifier hs-var">b2</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679078067"><span class="hs-identifier hs-var">b3</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-194"></a><span>                        </span><span class="hs-comment">-- form a skew matrix from v0</span><span>
</span><a name="line-195"></a><span>                        </span><a name="local-6989586621679078069"><a href="#local-6989586621679078069"><span class="hs-identifier">sm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#skew%27"><span class="hs-identifier hs-var">skew'</span></a><span> </span><a href="#local-6989586621679078060"><span class="hs-identifier hs-var">v0</span></a><span>
</span><a name="line-196"></a><span>                        </span><span class="hs-comment">-- cross product: v0 X v1</span><span>
</span><a name="line-197"></a><span>                        </span><a name="local-6989586621679078070"><a href="#local-6989586621679078070"><span class="hs-identifier">vc</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#multiMat"><span class="hs-identifier hs-var">multiMat</span></a><span> </span><a href="#local-6989586621679078069"><span class="hs-identifier hs-var">sm</span></a><span> </span><a href="#local-6989586621679078068"><span class="hs-identifier hs-var">vs</span></a><span>
</span><a name="line-198"></a><span>                        </span><a name="local-6989586621679078071"><a href="#local-6989586621679078071"><span class="hs-identifier">vp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vector3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">head</span><span class="hs-special">)</span><span>
</span><a name="line-199"></a><span>
</span><a name="line-200"></a><span>                        </span><span class="hs-comment">-- vc = [[x], [y], [z]]</span><span>
</span><a name="line-201"></a><span>                        </span><a name="local-6989586621679078072"><a href="#local-6989586621679078072"><span class="hs-identifier">x</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">head</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679078070"><span class="hs-identifier hs-var">vc</span></a><span>
</span><a name="line-202"></a><span>                        </span><a name="local-6989586621679078073"><a href="#local-6989586621679078073"><span class="hs-identifier">y</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">head</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">tail</span><span> </span><a href="#local-6989586621679078070"><span class="hs-identifier hs-var">vc</span></a><span>
</span><a name="line-203"></a><span>                        </span><a name="local-6989586621679078074"><a href="#local-6989586621679078074"><span class="hs-identifier">z</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">last</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">last</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679078070"><span class="hs-identifier hs-var">vc</span></a><span>
</span><a name="line-204"></a><span>
</span><a name="line-205"></a><span>
</span><a name="line-206"></a><span class="hs-comment">-- | check whether four points are coplanar</span><span>
</span><a name="line-207"></a><span class="hs-comment">-- </span><span>
</span><a name="line-208"></a><span class="hs-comment">-- | /Users/cat/myfile/bitbucket/math/coplanar.pdf</span><span>
</span><a name="line-209"></a><span class="hs-comment">-- </span><span>
</span><a name="line-210"></a><span class="hs-identifier">isCoplanar</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-211"></a><a name="isCoplanar"><a href="AronGraphic.html#isCoplanar"><span class="hs-identifier">isCoplanar</span></a></a><span> </span><a name="local-6989586621679078075"><a href="#local-6989586621679078075"><span class="hs-identifier">p0</span></a></a><span> </span><a name="local-6989586621679078076"><a href="#local-6989586621679078076"><span class="hs-identifier">p1</span></a></a><span> </span><a name="local-6989586621679078077"><a href="#local-6989586621679078077"><span class="hs-identifier">q0</span></a></a><span> </span><a name="local-6989586621679078078"><a href="#local-6989586621679078078"><span class="hs-identifier">q1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679078079"><span class="hs-identifier hs-var">nis0</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679078080"><span class="hs-identifier hs-var">nis1</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679078087"><span class="hs-identifier hs-var">norm</span></a><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#cross"><span class="hs-identifier hs-var">cross</span></a><span> </span><a href="#local-6989586621679078085"><span class="hs-identifier hs-var">v01</span></a><span> </span><a href="#local-6989586621679078086"><span class="hs-identifier hs-var">v12</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0.0</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-212"></a><span>                </span><span class="hs-keyword">where</span><span>
</span><a name="line-213"></a><span>                    </span><a name="local-6989586621679078079"><a href="#local-6989586621679078079"><span class="hs-identifier">nis0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#isColinear"><span class="hs-identifier hs-var">isColinear</span></a><span> </span><a href="#local-6989586621679078075"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679078077"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679078078"><span class="hs-identifier hs-var">q1</span></a><span>
</span><a name="line-214"></a><span>                    </span><a name="local-6989586621679078080"><a href="#local-6989586621679078080"><span class="hs-identifier">nis1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#isColinear"><span class="hs-identifier hs-var">isColinear</span></a><span> </span><a href="#local-6989586621679078076"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679078077"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679078078"><span class="hs-identifier hs-var">q1</span></a><span>
</span><a name="line-215"></a><span>                    </span><a name="local-6989586621679078081"><a href="#local-6989586621679078081"><span class="hs-identifier">v0</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679078077"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679078075"><span class="hs-identifier hs-var">p0</span></a><span> </span><span class="hs-comment">-- p0 -&gt; q0</span><span>
</span><a name="line-216"></a><span>                    </span><a name="local-6989586621679078082"><a href="#local-6989586621679078082"><span class="hs-identifier">v1</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679078078"><span class="hs-identifier hs-var">q1</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679078075"><span class="hs-identifier hs-var">p0</span></a><span> </span><span class="hs-comment">-- p0 -&gt; q1</span><span>
</span><a name="line-217"></a><span>                    </span><a name="local-6989586621679078083"><a href="#local-6989586621679078083"><span class="hs-identifier">v2</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679078077"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679078076"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-comment">-- p1 -&gt; q0</span><span>
</span><a name="line-218"></a><span>                    </span><a name="local-6989586621679078084"><a href="#local-6989586621679078084"><span class="hs-identifier">v3</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679078078"><span class="hs-identifier hs-var">q1</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679078076"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-comment">-- p1 -&gt; q1</span><span>
</span><a name="line-219"></a><span>                    </span><a name="local-6989586621679078085"><a href="#local-6989586621679078085"><span class="hs-identifier">v01</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#cross"><span class="hs-identifier hs-var">cross</span></a><span> </span><a href="#local-6989586621679078081"><span class="hs-identifier hs-var">v0</span></a><span> </span><a href="#local-6989586621679078082"><span class="hs-identifier hs-var">v1</span></a><span> </span><span class="hs-comment">-- v0 X v1</span><span>
</span><a name="line-220"></a><span>                    </span><a name="local-6989586621679078086"><a href="#local-6989586621679078086"><span class="hs-identifier">v12</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#cross"><span class="hs-identifier hs-var">cross</span></a><span> </span><a href="#local-6989586621679078083"><span class="hs-identifier hs-var">v2</span></a><span> </span><a href="#local-6989586621679078084"><span class="hs-identifier hs-var">v3</span></a><span> </span><span class="hs-comment">-- v2 X v3</span><span>
</span><a name="line-221"></a><span>                    </span><a name="local-6989586621679078087"><a href="#local-6989586621679078087"><span class="hs-identifier">norm</span></a></a><span> </span><a name="local-6989586621679078088"><a href="#local-6989586621679078088"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sqrt</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#dot3ve"><span class="hs-identifier hs-var">dot3ve</span></a><span> </span><a href="#local-6989586621679078088"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679078088"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-222"></a><span>
</span><a name="line-223"></a><span class="hs-identifier">cross</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-224"></a><a name="cross"><a href="AronGraphic.html#cross"><span class="hs-identifier">cross</span></a></a><span> </span><a name="local-6989586621679078089"><a href="#local-6989586621679078089"><span class="hs-identifier">u</span></a></a><span> </span><a name="local-6989586621679078090"><a href="#local-6989586621679078090"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679078089"><span class="hs-identifier hs-var">u</span></a><span> </span><a href="AronGraphic.html#%2297"><span class="hs-operator hs-var">&#8855;</span></a><span> </span><a href="#local-6989586621679078090"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-225"></a><span>
</span><a name="line-226"></a><span class="hs-comment">-- | compute the normal of three points</span><span>
</span><a name="line-227"></a><span class="hs-identifier">normal3</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span>
</span><a name="line-228"></a><a name="normal3"><a href="AronGraphic.html#normal3"><span class="hs-identifier">normal3</span></a></a><span> </span><a name="local-6989586621679078091"><a href="#local-6989586621679078091"><span class="hs-identifier">p0</span></a></a><span> </span><a name="local-6989586621679078092"><a href="#local-6989586621679078092"><span class="hs-identifier">q0</span></a></a><span> </span><a name="local-6989586621679078093"><a href="#local-6989586621679078093"><span class="hs-identifier">q1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679078094"><span class="hs-identifier hs-var">isc</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679078097"><span class="hs-identifier hs-var">nr</span></a><span class="hs-special">)</span><span>
</span><a name="line-229"></a><span>                </span><span class="hs-keyword">where</span><span>
</span><a name="line-230"></a><span>                    </span><a name="local-6989586621679078094"><a href="#local-6989586621679078094"><span class="hs-identifier">isc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#isColinear"><span class="hs-identifier hs-var">isColinear</span></a><span> </span><a href="#local-6989586621679078091"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679078092"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679078093"><span class="hs-identifier hs-var">q1</span></a><span>
</span><a name="line-231"></a><span>                    </span><a name="local-6989586621679078095"><a href="#local-6989586621679078095"><span class="hs-identifier">v0</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679078092"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679078091"><span class="hs-identifier hs-var">p0</span></a><span>
</span><a name="line-232"></a><span>                    </span><a name="local-6989586621679078096"><a href="#local-6989586621679078096"><span class="hs-identifier">v1</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679078093"><span class="hs-identifier hs-var">q1</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679078091"><span class="hs-identifier hs-var">p0</span></a><span>
</span><a name="line-233"></a><span>                    </span><a name="local-6989586621679078097"><a href="#local-6989586621679078097"><span class="hs-identifier">nr</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679078095"><span class="hs-identifier hs-var">v0</span></a><span> </span><a href="AronGraphic.html#%2297"><span class="hs-operator hs-var">&#8855;</span></a><span> </span><a href="#local-6989586621679078096"><span class="hs-identifier hs-var">v1</span></a><span>
</span><a name="line-234"></a><span>
</span><a name="line-235"></a><span class="hs-comment">-- | compute the normal of plane with two given vectors</span><span>
</span><a name="line-236"></a><span class="hs-identifier">normal3'</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-237"></a><a name="normal3%27"><a href="AronGraphic.html#normal3%27"><span class="hs-identifier">normal3'</span></a></a><span> </span><a name="local-6989586621679078098"><a href="#local-6989586621679078098"><span class="hs-identifier">v0</span></a></a><span> </span><a name="local-6989586621679078099"><a href="#local-6989586621679078099"><span class="hs-identifier">v1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679078098"><span class="hs-identifier hs-var">v0</span></a><span> </span><a href="AronGraphic.html#%2297"><span class="hs-operator hs-var">&#8855;</span></a><span> </span><a href="#local-6989586621679078099"><span class="hs-identifier hs-var">v1</span></a><span>
</span><a name="line-238"></a><span>
</span><a name="line-239"></a><span>
</span><a name="line-240"></a><span>
</span><a name="line-241"></a><span>
</span><a name="line-242"></a><span class="hs-comment">-- | (Vertex3 a) operator: (-) (+)</span><span>
</span><a name="line-243"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679076038"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-identifier hs-type">Num</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679076038"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-244"></a><span>    </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679076039"><a href="#local-6989586621679076039"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679076040"><a href="#local-6989586621679076040"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679076041"><a href="#local-6989586621679076041"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679076042"><a href="#local-6989586621679076042"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679076043"><a href="#local-6989586621679076043"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679076044"><a href="#local-6989586621679076044"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679076039"><span class="hs-identifier hs-var">x0</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679076042"><span class="hs-identifier hs-var">x1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679076040"><span class="hs-identifier hs-var">y0</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679076043"><span class="hs-identifier hs-var">y1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679076041"><span class="hs-identifier hs-var">z0</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679076044"><span class="hs-identifier hs-var">z1</span></a><span class="hs-special">)</span><span>
</span><a name="line-245"></a><span>    </span><span class="hs-special">(</span><a name="local-8214565720323784853"><span class="hs-operator">+</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679076045"><a href="#local-6989586621679076045"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679076046"><a href="#local-6989586621679076046"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679076047"><a href="#local-6989586621679076047"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679076048"><a href="#local-6989586621679076048"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679076049"><a href="#local-6989586621679076049"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679076050"><a href="#local-6989586621679076050"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679076045"><span class="hs-identifier hs-var">x0</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679076048"><span class="hs-identifier hs-var">x1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679076046"><span class="hs-identifier hs-var">y0</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679076049"><span class="hs-identifier hs-var">y1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679076047"><span class="hs-identifier hs-var">z0</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679076050"><span class="hs-identifier hs-var">z1</span></a><span class="hs-special">)</span><span>
</span><a name="line-246"></a><span>    </span><a name="local-3458764513820541097"><span class="hs-identifier">negate</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679076051"><a href="#local-6989586621679076051"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679076052"><a href="#local-6989586621679076052"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679076053"><a href="#local-6989586621679076053"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679076051"><span class="hs-identifier hs-var">x0</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679076052"><span class="hs-identifier hs-var">y0</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679076053"><span class="hs-identifier hs-var">z0</span></a><span class="hs-special">)</span><span>
</span><a name="line-247"></a><span>    </span><a name="local-8214565720323784854"><span class="hs-identifier">abs</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679076054"><a href="#local-6989586621679076054"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679076055"><a href="#local-6989586621679076055"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679076056"><a href="#local-6989586621679076056"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">abs</span><span> </span><a href="#local-6989586621679076054"><span class="hs-identifier hs-var">x0</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">abs</span><span> </span><a href="#local-6989586621679076055"><span class="hs-identifier hs-var">y0</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">abs</span><span> </span><a href="#local-6989586621679076056"><span class="hs-identifier hs-var">z0</span></a><span class="hs-special">)</span><span>
</span><a name="line-248"></a><span>    </span><a name="local-8214565720323784855"><span class="hs-identifier">signum</span></a><span> </span><span class="hs-identifier">_</span><span>                                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">undefined</span><span>
</span><a name="line-249"></a><span>    </span><span class="hs-special">(</span><a name="local-8214565720323784852"><span class="hs-operator">*</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>                                   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">undefined</span><span>
</span><a name="line-250"></a><span>    </span><a name="local-3458764513820541088"><span class="hs-identifier">fromInteger</span></a><span> </span><span class="hs-identifier">_</span><span>                             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">undefined</span><span>
</span><a name="line-251"></a><span>
</span><a name="line-252"></a><span class="hs-comment">-- | (Vector3 a) operator: (-) (+)</span><span>
</span><a name="line-253"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679074536"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-identifier hs-type">Num</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector3</span><span> </span><a href="#local-6989586621679074536"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-254"></a><span>    </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679076020"><a href="#local-6989586621679076020"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679076021"><a href="#local-6989586621679076021"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679076022"><a href="#local-6989586621679076022"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679076023"><a href="#local-6989586621679076023"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679076024"><a href="#local-6989586621679076024"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679076025"><a href="#local-6989586621679076025"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vector3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679076020"><span class="hs-identifier hs-var">x0</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679076023"><span class="hs-identifier hs-var">x1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679076021"><span class="hs-identifier hs-var">y0</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679076024"><span class="hs-identifier hs-var">y1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679076022"><span class="hs-identifier hs-var">z0</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679076025"><span class="hs-identifier hs-var">z1</span></a><span class="hs-special">)</span><span>
</span><a name="line-255"></a><span>    </span><span class="hs-special">(</span><a name="local-8214565720323784853"><span class="hs-operator">+</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679076026"><a href="#local-6989586621679076026"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679076027"><a href="#local-6989586621679076027"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679076028"><a href="#local-6989586621679076028"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679076029"><a href="#local-6989586621679076029"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679076030"><a href="#local-6989586621679076030"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679076031"><a href="#local-6989586621679076031"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vector3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679076026"><span class="hs-identifier hs-var">x0</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679076029"><span class="hs-identifier hs-var">x1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679076027"><span class="hs-identifier hs-var">y0</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679076030"><span class="hs-identifier hs-var">y1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679076028"><span class="hs-identifier hs-var">z0</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679076031"><span class="hs-identifier hs-var">z1</span></a><span class="hs-special">)</span><span>
</span><a name="line-256"></a><span>    </span><a name="local-3458764513820541097"><span class="hs-identifier">negate</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679076032"><a href="#local-6989586621679076032"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679076033"><a href="#local-6989586621679076033"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679076034"><a href="#local-6989586621679076034"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vector3</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679076032"><span class="hs-identifier hs-var">x0</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679076033"><span class="hs-identifier hs-var">y0</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679076034"><span class="hs-identifier hs-var">z0</span></a><span class="hs-special">)</span><span>
</span><a name="line-257"></a><span>    </span><a name="local-8214565720323784854"><span class="hs-identifier">abs</span></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679076035"><a href="#local-6989586621679076035"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679076036"><a href="#local-6989586621679076036"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679076037"><a href="#local-6989586621679076037"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vector3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">abs</span><span> </span><a href="#local-6989586621679076035"><span class="hs-identifier hs-var">x0</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">abs</span><span> </span><a href="#local-6989586621679076036"><span class="hs-identifier hs-var">y0</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">abs</span><span> </span><a href="#local-6989586621679076037"><span class="hs-identifier hs-var">z0</span></a><span class="hs-special">)</span><span>
</span><a name="line-258"></a><span>    </span><a name="local-8214565720323784855"><span class="hs-identifier">signum</span></a><span> </span><span class="hs-identifier">_</span><span>                                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">undefined</span><span>
</span><a name="line-259"></a><span>    </span><span class="hs-special">(</span><a name="local-8214565720323784852"><span class="hs-operator">*</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>                                   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">undefined</span><span>
</span><a name="line-260"></a><span>    </span><a name="local-3458764513820541088"><span class="hs-identifier">fromInteger</span></a><span> </span><span class="hs-identifier">_</span><span>                             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">undefined</span><span>
</span><a name="line-261"></a><span>
</span><a name="line-262"></a><span class="hs-comment">-- | Vector: p0 -&gt; p1 = p1 - p0</span><span>
</span><a name="line-263"></a><span class="hs-identifier">vec</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-264"></a><a name="vec"><a href="AronGraphic.html#vec"><span class="hs-identifier">vec</span></a></a><span> </span><a name="local-6989586621679078100"><a href="#local-6989586621679078100"><span class="hs-identifier">p0</span></a></a><span> </span><a name="local-6989586621679078101"><a href="#local-6989586621679078101"><span class="hs-identifier">p1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679078101"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679078100"><span class="hs-identifier hs-var">p0</span></a><span>
</span><a name="line-265"></a><span>
</span><a name="line-266"></a><span class="hs-comment">-- | Given a point and vector,</span><span>
</span><a name="line-267"></a><span class="hs-comment">-- </span><span>
</span><a name="line-268"></a><span class="hs-comment">-- | draw a line passes the point and alone the vector</span><span>
</span><a name="line-269"></a><span class="hs-comment">--</span><span>
</span><a name="line-270"></a><span class="hs-comment">-- | r(t) = p0 + t(p1 - p0)</span><span>
</span><a name="line-271"></a><span class="hs-comment">--</span><span>
</span><a name="line-272"></a><span class="hs-identifier">ray</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-273"></a><a name="ray"><a href="AronGraphic.html#ray"><span class="hs-identifier">ray</span></a></a><span> </span><a name="local-6989586621679078102"><a href="#local-6989586621679078102"><span class="hs-identifier">p0</span></a></a><span> </span><a name="local-6989586621679078103"><a href="#local-6989586621679078103"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679078104"><a href="#local-6989586621679078104"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679078102"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="AronGraphic.html#%2B%3A"><span class="hs-operator hs-var">+:</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078103"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="AronGraphic.html#%2A%3A"><span class="hs-operator hs-var">*:</span></a><span> </span><a href="#local-6989586621679078104"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-274"></a><span>
</span><a name="line-275"></a><span class="hs-comment">-- | Given s, t, p0 and p1 </span><span>
</span><a name="line-276"></a><span class="hs-comment">--   1. c&#8320; = center p&#8320; p&#8321; </span><span>
</span><a name="line-277"></a><span class="hs-comment">--   2. p1' = p0 + s(&#8869; p0 p1), p2' = p0 + t(&#8869; p0 p1)</span><span>
</span><a name="line-278"></a><span class="hs-comment">--   3. draw line from p1' to p2'</span><span>
</span><a name="line-279"></a><span class="hs-identifier">perpenLine</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span>
</span><a name="line-280"></a><a name="perpenLine"><a href="AronGraphic.html#perpenLine"><span class="hs-identifier">perpenLine</span></a></a><span> </span><a name="local-6989586621679078105"><a href="#local-6989586621679078105"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679078106"><a href="#local-6989586621679078106"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679078107"><a href="#local-6989586621679078107"><span class="hs-identifier">p0</span></a></a><span> </span><a name="local-6989586621679078108"><a href="#local-6989586621679078108"><span class="hs-identifier">p1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679078110"><span class="hs-identifier hs-var">c0</span></a><span> </span><a href="AronGraphic.html#%2B%3A"><span class="hs-operator hs-var">+:</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078105"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="AronGraphic.html#%2A%3A"><span class="hs-operator hs-var">*:</span></a><span> </span><a href="#local-6989586621679078109"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679078110"><span class="hs-identifier hs-var">c0</span></a><span> </span><a href="AronGraphic.html#%2B%3A"><span class="hs-operator hs-var">+:</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078106"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="AronGraphic.html#%2A%3A"><span class="hs-operator hs-var">*:</span></a><span> </span><a href="#local-6989586621679078109"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-281"></a><span>           </span><span class="hs-keyword">where</span><span>
</span><a name="line-282"></a><span>             </span><a name="local-6989586621679078109"><a href="#local-6989586621679078109"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#perpcw"><span class="hs-identifier hs-var">perpcw</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#vec"><span class="hs-identifier hs-var">vec</span></a><span> </span><a href="#local-6989586621679078107"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679078108"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-comment">-- p&#8320; &#8594; p&#8321;</span><span>
</span><a name="line-283"></a><span>             </span><a name="local-6989586621679078110"><a href="#local-6989586621679078110"><span class="hs-identifier">c0</span></a></a><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#cen"><span class="hs-identifier hs-var">cen</span></a><span> </span><a href="#local-6989586621679078107"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679078108"><span class="hs-identifier hs-var">p1</span></a><span>
</span><a name="line-284"></a><span>
</span><a name="line-285"></a><span class="hs-identifier">curvePt</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span>
</span><a name="line-286"></a><a name="curvePt"><a href="AronGraphic.html#curvePt"><span class="hs-identifier">curvePt</span></a></a><span> </span><a name="local-6989586621679078111"><a href="#local-6989586621679078111"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679078112"><a href="#local-6989586621679078112"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679078113"><a href="#local-6989586621679078113"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a href="#local-6989586621679078117"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078111"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679078117"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679078117"><a href="#local-6989586621679078117"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679078114"><a href="#local-6989586621679078114"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">100</span><span class="hs-special">;</span><span> </span><a name="local-6989586621679078115"><a href="#local-6989586621679078115"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078113"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679078112"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">/</span><a href="#local-6989586621679078114"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">;</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679078116"><a href="#local-6989586621679078116"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679078112"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679078116"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679078115"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><a href="#local-6989586621679078114"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-287"></a><span>
</span><a name="line-288"></a><span class="hs-comment">-- | Given a function f, interval (a, b), </span><span>
</span><a name="line-289"></a><span class="hs-comment">--   draw the curve from a to b</span><span>
</span><a name="line-290"></a><span class="hs-identifier">drawCurve</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-291"></a><a name="drawCurve"><a href="AronGraphic.html#drawCurve"><span class="hs-identifier">drawCurve</span></a></a><span> </span><a name="local-6989586621679078118"><a href="#local-6989586621679078118"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679078119"><a href="#local-6989586621679078119"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679078120"><a href="#local-6989586621679078120"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679078121"><a href="#local-6989586621679078121"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">renderPrimitive</span><span> </span><span class="hs-identifier hs-var">LineStrip</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mapM_</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679078153"><a href="#local-6989586621679078153"><span class="hs-identifier">vx</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-292"></a><span>                                            </span><span class="hs-identifier hs-var">color</span><span> </span><a href="#local-6989586621679078121"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-293"></a><span>                                            </span><span class="hs-identifier hs-var">vertex</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679078153"><span class="hs-identifier hs-var">vx</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#curvePt"><span class="hs-identifier hs-var">curvePt</span></a><span> </span><a href="#local-6989586621679078118"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078119"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679078120"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-294"></a><span>
</span><a name="line-295"></a><span class="hs-comment">{-|
  Draw a line that is tangent at pt (c, f(c)) where x in [x0, x1] 

  &lt;http://localhost/image/tangleline.png tangentLine&gt;

  1. Given a function f, and x0 on x-Axis

  2. Derive a tangent line at (c, f(c)) with slop = f'(c)

  3. Interpolate (x0, f(x0)) and (x1, f(x1))  

-}</span><span>
</span><a name="line-307"></a><span class="hs-identifier">tangentLine</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679077958"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-special">(</span><a href="#local-6989586621679077958"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679077958"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><a href="#local-6989586621679077958"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679077958"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679077958"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679077958"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-308"></a><a name="tangentLine"><a href="AronGraphic.html#tangentLine"><span class="hs-identifier">tangentLine</span></a></a><span> </span><a name="local-6989586621679079998"><a href="#local-6989586621679079998"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679079999"><a href="#local-6989586621679079999"><span class="hs-identifier">x0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080000"><a href="#local-6989586621679080000"><span class="hs-identifier">x1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679080001"><a href="#local-6989586621679080001"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#interpolate%27"><span class="hs-identifier hs-var">interpolate'</span></a><span> </span><span class="hs-number">1</span><span> </span><a href="#local-6989586621679080004"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679080005"><span class="hs-identifier hs-var">p1</span></a><span>
</span><a name="line-309"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-310"></a><span>            </span><a name="local-6989586621679080002"><a href="#local-6989586621679080002"><span class="hs-identifier">y0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#tangent"><span class="hs-identifier hs-var">tangent</span></a><span> </span><a href="#local-6989586621679079998"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679079999"><span class="hs-identifier hs-var">x0</span></a><span> </span><a href="#local-6989586621679080001"><span class="hs-identifier hs-var">c</span></a><span>  </span><span class="hs-comment">-- y = slop(x - c) + (f x0) </span><span>
</span><a name="line-311"></a><span>            </span><a name="local-6989586621679080003"><a href="#local-6989586621679080003"><span class="hs-identifier">y1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#tangent"><span class="hs-identifier hs-var">tangent</span></a><span> </span><a href="#local-6989586621679079998"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679080000"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="#local-6989586621679080001"><span class="hs-identifier hs-var">c</span></a><span>  </span><span class="hs-comment">-- y = slop(x - c) + (f x1) </span><span>
</span><a name="line-312"></a><span>            </span><a name="local-6989586621679080004"><a href="#local-6989586621679080004"><span class="hs-identifier">p0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a href="#local-6989586621679079999"><span class="hs-identifier hs-var">x0</span></a><span> </span><a href="#local-6989586621679080002"><span class="hs-identifier hs-var">y0</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-313"></a><span>            </span><a name="local-6989586621679080005"><a href="#local-6989586621679080005"><span class="hs-identifier">p1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a href="#local-6989586621679080000"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="#local-6989586621679080003"><span class="hs-identifier hs-var">y1</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-314"></a><span>
</span><a name="line-315"></a><span class="hs-identifier">interpolate'</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679077957"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679077957"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679077957"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679077957"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-316"></a><a name="interpolate%27"><a href="AronGraphic.html#interpolate%27"><span class="hs-identifier">interpolate'</span></a></a><span> </span><a name="local-6989586621679080006"><a href="#local-6989586621679080006"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679080007"><a href="#local-6989586621679080007"><span class="hs-identifier">p0</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679080008"><a href="#local-6989586621679080008"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679080009"><a href="#local-6989586621679080009"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679080010"><a href="#local-6989586621679080010"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679080011"><a href="#local-6989586621679080011"><span class="hs-identifier">p1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679080012"><a href="#local-6989586621679080012"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679080013"><a href="#local-6989586621679080013"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679080014"><a href="#local-6989586621679080014"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080017"><a href="#local-6989586621679080017"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679080018"><a href="#local-6989586621679080018"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080016"><span class="hs-identifier hs-var">d</span></a><span class="hs-operator hs-var">*</span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679080017"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679080007"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="AronGraphic.html#%2B%3A"><span class="hs-operator hs-var">+:</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080018"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="AronGraphic.html#%2A%3A"><span class="hs-operator hs-var">*:</span></a><span> </span><a href="#local-6989586621679080015"><span class="hs-identifier hs-var">ve</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><a href="#local-6989586621679080006"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span>
</span><a name="line-317"></a><span>                    </span><span class="hs-keyword">where</span><span>
</span><a name="line-318"></a><span>                        </span><a name="local-6989586621679080015"><a href="#local-6989586621679080015"><span class="hs-identifier">ve</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080011"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679080007"><span class="hs-identifier hs-var">p0</span></a><span> </span><span class="hs-comment">-- vector: p0 -&gt; p1</span><span>
</span><a name="line-319"></a><span>                        </span><a name="local-6989586621679080016"><a href="#local-6989586621679080016"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span class="hs-operator hs-var">/</span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621679080006"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-320"></a><span>
</span><a name="line-321"></a><span class="hs-comment">-- | Given a function f, interval (a, b), </span><span>
</span><a name="line-322"></a><span class="hs-comment">--   draw a tangent line at (x0, f(x0)) from a to b</span><span>
</span><a name="line-323"></a><span class="hs-comment">--   f::x -&gt; y </span><span>
</span><a name="line-324"></a><span class="hs-comment">--   (a, b) is interval</span><span>
</span><a name="line-325"></a><span class="hs-comment">--  differentiate at (x0, f x0) </span><span>
</span><a name="line-326"></a><span class="hs-comment">-- </span><span>
</span><a name="line-327"></a><span class="hs-identifier">drawTangentLine</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-328"></a><a name="drawTangentLine"><a href="AronGraphic.html#drawTangentLine"><span class="hs-identifier">drawTangentLine</span></a></a><span> </span><a name="local-6989586621679080019"><a href="#local-6989586621679080019"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679080020"><a href="#local-6989586621679080020"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080021"><a href="#local-6989586621679080021"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679080022"><a href="#local-6989586621679080022"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679080023"><a href="#local-6989586621679080023"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">renderPrimitive</span><span> </span><span class="hs-identifier hs-var">LineStrip</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mapM_</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080025"><a href="#local-6989586621679080025"><span class="hs-identifier">vx</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-329"></a><span>                                            </span><span class="hs-identifier hs-var">color</span><span> </span><a href="#local-6989586621679080023"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-330"></a><span>                                            </span><span class="hs-identifier hs-var">vertex</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679080025"><span class="hs-identifier hs-var">vx</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679080024"><span class="hs-identifier hs-var">pts</span></a><span>
</span><a name="line-331"></a><span>                    </span><span class="hs-keyword">where</span><span>
</span><a name="line-332"></a><span>                        </span><a name="local-6989586621679080024"><a href="#local-6989586621679080024"><span class="hs-identifier">pts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#tangentLine"><span class="hs-identifier hs-var">tangentLine</span></a><span> </span><a href="#local-6989586621679080019"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080020"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080021"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080022"><span class="hs-identifier hs-var">x0</span></a><span>
</span><a name="line-333"></a><span>
</span><a name="line-334"></a><span class="hs-comment">-- | NormalDir is either counter clockwise or clockwise for normal</span><span>
</span><a name="line-335"></a><span class="hs-comment">-- | (x0, x1) is interval for the normal</span><span>
</span><a name="line-336"></a><span class="hs-comment">-- | f is  any function </span><span>
</span><a name="line-337"></a><span class="hs-comment">-- | x=c is the tangent point at (c, f c)</span><span>
</span><a name="line-338"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-339"></a><span class="hs-identifier">normalLine</span><span class="hs-glyph">::</span><a href="AronGraphic.html#NormalDir"><span class="hs-identifier hs-type">NormalDir</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span>
</span><a name="line-340"></a><a name="normalLine"><a href="AronGraphic.html#normalLine"><span class="hs-identifier">normalLine</span></a></a><span> </span><a name="local-6989586621679080026"><a href="#local-6989586621679080026"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679080027"><a href="#local-6989586621679080027"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679080028"><a href="#local-6989586621679080028"><span class="hs-identifier">x0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080029"><a href="#local-6989586621679080029"><span class="hs-identifier">x1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679080030"><a href="#local-6989586621679080030"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#interpolate%27"><span class="hs-identifier hs-var">interpolate'</span></a><span> </span><span class="hs-number">1</span><span> </span><a href="#local-6989586621679080033"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679080037"><span class="hs-identifier hs-var">p1'</span></a><span>
</span><a name="line-341"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-342"></a><span>            </span><a name="local-6989586621679080031"><a href="#local-6989586621679080031"><span class="hs-identifier">y0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#tangent"><span class="hs-identifier hs-var">tangent</span></a><span> </span><a href="#local-6989586621679080027"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679080028"><span class="hs-identifier hs-var">x0</span></a><span> </span><a href="#local-6989586621679080030"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-343"></a><span>            </span><a name="local-6989586621679080032"><a href="#local-6989586621679080032"><span class="hs-identifier">y1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#tangent"><span class="hs-identifier hs-var">tangent</span></a><span> </span><a href="#local-6989586621679080027"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679080029"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="#local-6989586621679080030"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-344"></a><span>            </span><a name="local-6989586621679080033"><a href="#local-6989586621679080033"><span class="hs-identifier">p0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a href="#local-6989586621679080028"><span class="hs-identifier hs-var">x0</span></a><span> </span><a href="#local-6989586621679080031"><span class="hs-identifier hs-var">y0</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-345"></a><span>            </span><a name="local-6989586621679080034"><a href="#local-6989586621679080034"><span class="hs-identifier">p1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a href="#local-6989586621679080029"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="#local-6989586621679080032"><span class="hs-identifier hs-var">y1</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-346"></a><span>            </span><a name="local-6989586621679080035"><a href="#local-6989586621679080035"><span class="hs-identifier">ve</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080034"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679080033"><span class="hs-identifier hs-var">p0</span></a><span>  </span><span class="hs-comment">-- p0 -&gt; p1</span><span>
</span><a name="line-347"></a><span>            </span><a name="local-6989586621679080036"><a href="#local-6989586621679080036"><span class="hs-identifier">nr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679080026"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="AronGraphic.html#NCW"><span class="hs-identifier hs-var">NCW</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="AronGraphic.html#perpccw"><span class="hs-identifier hs-var">perpccw</span></a><span> </span><a href="#local-6989586621679080035"><span class="hs-identifier hs-var">ve</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="AronGraphic.html#perpcw"><span class="hs-identifier hs-var">perpcw</span></a><span> </span><a href="#local-6989586621679080035"><span class="hs-identifier hs-var">ve</span></a><span>
</span><a name="line-348"></a><span>            </span><a name="local-6989586621679080037"><a href="#local-6989586621679080037"><span class="hs-identifier">p1'</span></a></a><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080033"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="AronGraphic.html#%2B%3A"><span class="hs-operator hs-var">+:</span></a><span> </span><a href="#local-6989586621679080036"><span class="hs-identifier hs-var">nr</span></a><span>
</span><a name="line-349"></a><span>
</span><a name="line-350"></a><span class="hs-identifier">drawNormalLine</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-351"></a><a name="drawNormalLine"><a href="AronGraphic.html#drawNormalLine"><span class="hs-identifier">drawNormalLine</span></a></a><span> </span><a name="local-6989586621679080038"><a href="#local-6989586621679080038"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679080039"><a href="#local-6989586621679080039"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080040"><a href="#local-6989586621679080040"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679080041"><a href="#local-6989586621679080041"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679080042"><a href="#local-6989586621679080042"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">renderPrimitive</span><span> </span><span class="hs-identifier hs-var">LineStrip</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mapM_</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080044"><a href="#local-6989586621679080044"><span class="hs-identifier">vx</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-352"></a><span>                                            </span><span class="hs-identifier hs-var">color</span><span> </span><a href="#local-6989586621679080042"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-353"></a><span>                                            </span><span class="hs-identifier hs-var">vertex</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679080044"><span class="hs-identifier hs-var">vx</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679080043"><span class="hs-identifier hs-var">pts</span></a><span>
</span><a name="line-354"></a><span>                    </span><span class="hs-keyword">where</span><span>
</span><a name="line-355"></a><span>                        </span><a name="local-6989586621679080043"><a href="#local-6989586621679080043"><span class="hs-identifier">pts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#normalLine"><span class="hs-identifier hs-var">normalLine</span></a><span> </span><a href="AronGraphic.html#NCCW"><span class="hs-identifier hs-var">NCCW</span></a><span> </span><a href="#local-6989586621679080038"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080039"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080040"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080041"><span class="hs-identifier hs-var">x0</span></a><span>
</span><a name="line-356"></a><span>
</span><a name="line-357"></a><span class="hs-comment">-- | compute the center of two vertices/vertex</span><span>
</span><a name="line-358"></a><span class="hs-identifier">cen</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-359"></a><a name="cen"><a href="AronGraphic.html#cen"><span class="hs-identifier">cen</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679080045"><a href="#local-6989586621679080045"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679080046"><a href="#local-6989586621679080046"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679080047"><a href="#local-6989586621679080047"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679080048"><a href="#local-6989586621679080048"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679080049"><a href="#local-6989586621679080049"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679080050"><a href="#local-6989586621679080050"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679080045"><span class="hs-identifier hs-var">x0</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679080048"><span class="hs-identifier hs-var">x1</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">/</span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679080046"><span class="hs-identifier hs-var">y0</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679080049"><span class="hs-identifier hs-var">y1</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">/</span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679080047"><span class="hs-identifier hs-var">z0</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679080050"><span class="hs-identifier hs-var">z1</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">/</span><span class="hs-number">2</span><span class="hs-special">)</span><span>
</span><a name="line-360"></a><span>
</span><a name="line-361"></a><span class="hs-comment">-- | check two vectors whether they are perpendicular</span><span>
</span><a name="line-362"></a><span class="hs-identifier">isPerpen</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-363"></a><a name="isPerpen"><a href="AronGraphic.html#isPerpen"><span class="hs-identifier">isPerpen</span></a></a><span> </span><a name="local-6989586621679080051"><a href="#local-6989586621679080051"><span class="hs-identifier">v1</span></a></a><span> </span><a name="local-6989586621679080052"><a href="#local-6989586621679080052"><span class="hs-identifier">v2</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="#local-6989586621679080051"><span class="hs-identifier hs-var">v1</span></a><span> </span><a href="AronGraphic.html#%2299"><span class="hs-operator hs-var">&#8857;</span></a><span> </span><a href="#local-6989586621679080052"><span class="hs-identifier hs-var">v2</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-364"></a><span>
</span><a name="line-365"></a><span class="hs-comment">{-| 
    === Check whether three pts are colinear
    __NOTE__

    * If two points or three points are overlapped, then they are still colinear 

    @
    f(t) = p0 + t(p1 - p0)
    f(s) = p0 + s(p2 - p0)
    f(t) = f(s) =&gt;
    t(p1 - p0) = s(p2 - p0)
    t v1 = s v2, let A = [v1 v2]
    det A =? 0 
    det A = 0 =&gt; p0 p1 p2 are colinear
    @
-}</span><span>
</span><a name="line-381"></a><span class="hs-identifier">isColinear</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-382"></a><a name="isColinear"><a href="AronGraphic.html#isColinear"><span class="hs-identifier">isColinear</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679080053"><a href="#local-6989586621679080053"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679080054"><a href="#local-6989586621679080054"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679080055"><a href="#local-6989586621679080055"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679080056"><a href="#local-6989586621679080056"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679080057"><a href="#local-6989586621679080057"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679080058"><a href="#local-6989586621679080058"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679080059"><a href="#local-6989586621679080059"><span class="hs-identifier">x2</span></a></a><span> </span><a name="local-6989586621679080060"><a href="#local-6989586621679080060"><span class="hs-identifier">y2</span></a></a><span> </span><a name="local-6989586621679080061"><a href="#local-6989586621679080061"><span class="hs-identifier">z2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080062"><span class="hs-identifier hs-var">det</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-383"></a><span>                </span><span class="hs-keyword">where</span><span>
</span><a name="line-384"></a><span>                    </span><span class="hs-comment">-- v01 = Vertex3 (x1 - x0) (y1 - y0) (z1 - z0) </span><span>
</span><a name="line-385"></a><span>                    </span><span class="hs-comment">-- v02 = Vertex3 (x2 - x0) (y2 - y0) (z2 - z0) </span><span>
</span><a name="line-386"></a><span>                    </span><a name="local-6989586621679080062"><a href="#local-6989586621679080062"><span class="hs-identifier">det</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080056"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679080053"><span class="hs-identifier hs-var">x0</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><span class="hs-special">(</span><a href="#local-6989586621679080060"><span class="hs-identifier hs-var">y2</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679080054"><span class="hs-identifier hs-var">y0</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080059"><span class="hs-identifier hs-var">x2</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679080053"><span class="hs-identifier hs-var">x0</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><span class="hs-special">(</span><a href="#local-6989586621679080057"><span class="hs-identifier hs-var">y1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679080054"><span class="hs-identifier hs-var">y0</span></a><span class="hs-special">)</span><span>
</span><a name="line-387"></a><span>
</span><a name="line-388"></a><span class="hs-comment">{-| 
    === Check whether a given point is inside the segment

    * Assume three pts are different pts

    * Given p0, q0 q1, check whether p0 is inside the segment of q0 q1

    * __If__ they are colinear 
    * __then__ check the distance \( \overline{p_0 q_0} \)  \( \overline{p_0 q_1} \) and \( \overline q_0 q_1 \)
-}</span><span>
</span><a name="line-398"></a><span class="hs-identifier">isInSegment</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-399"></a><a name="isInSegment"><a href="AronGraphic.html#isInSegment"><span class="hs-identifier">isInSegment</span></a></a><span> </span><a name="local-6989586621679080063"><a href="#local-6989586621679080063"><span class="hs-identifier">p0</span></a></a><span> </span><a name="local-6989586621679080064"><a href="#local-6989586621679080064"><span class="hs-identifier">q0</span></a></a><span> </span><a name="local-6989586621679080065"><a href="#local-6989586621679080065"><span class="hs-identifier">q1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679080066"><span class="hs-identifier hs-var">is</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679080068"><span class="hs-identifier hs-var">d1</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-6989586621679080067"><span class="hs-identifier hs-var">ds</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679080069"><span class="hs-identifier hs-var">d2</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-6989586621679080067"><span class="hs-identifier hs-var">ds</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-400"></a><span>                </span><span class="hs-keyword">where</span><span>
</span><a name="line-401"></a><span>                    </span><a name="local-6989586621679080066"><a href="#local-6989586621679080066"><span class="hs-identifier">is</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#isColinear"><span class="hs-identifier hs-var">isColinear</span></a><span> </span><a href="#local-6989586621679080063"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679080064"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679080065"><span class="hs-identifier hs-var">q1</span></a><span> </span><span class="hs-comment">-- has to be colinear</span><span>
</span><a name="line-402"></a><span>                    </span><a name="local-6989586621679080067"><a href="#local-6989586621679080067"><span class="hs-identifier">ds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#dist"><span class="hs-identifier hs-var">dist</span></a><span> </span><a href="#local-6989586621679080064"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679080065"><span class="hs-identifier hs-var">q1</span></a><span>
</span><a name="line-403"></a><span>                    </span><a name="local-6989586621679080068"><a href="#local-6989586621679080068"><span class="hs-identifier">d1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#dist"><span class="hs-identifier hs-var">dist</span></a><span> </span><a href="#local-6989586621679080063"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679080064"><span class="hs-identifier hs-var">q0</span></a><span>
</span><a name="line-404"></a><span>                    </span><a name="local-6989586621679080069"><a href="#local-6989586621679080069"><span class="hs-identifier">d2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#dist"><span class="hs-identifier hs-var">dist</span></a><span> </span><a href="#local-6989586621679080063"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679080065"><span class="hs-identifier hs-var">q1</span></a><span>
</span><a name="line-405"></a><span>
</span><a name="line-406"></a><span class="hs-comment">-- | draw primitive such lines, points, lineloop etc</span><span>
</span><a name="line-407"></a><span class="hs-identifier">drawPrimitive</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">PrimitiveMode</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-408"></a><a name="drawPrimitive"><a href="AronGraphic.html#drawPrimitive"><span class="hs-identifier">drawPrimitive</span></a></a><span> </span><a name="local-6989586621679080070"><a href="#local-6989586621679080070"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679080071"><a href="#local-6989586621679080071"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679080072"><a href="#local-6989586621679080072"><span class="hs-identifier">list</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-409"></a><span>    </span><span class="hs-identifier hs-var">renderPrimitive</span><span> </span><a href="#local-6989586621679080070"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mapM_</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679080073"><a href="#local-6989586621679080073"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080074"><a href="#local-6989586621679080074"><span class="hs-identifier">y</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080075"><a href="#local-6989586621679080075"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-410"></a><span>        </span><span class="hs-identifier hs-var">color</span><span> </span><a href="#local-6989586621679080071"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-411"></a><span>        </span><span class="hs-identifier hs-var">vertex</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a href="#local-6989586621679080073"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679080074"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679080075"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080072"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-412"></a><span>
</span><a name="line-413"></a><span class="hs-identifier">drawPrimitive'</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">PrimitiveMode</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-414"></a><a name="drawPrimitive%27"><a href="AronGraphic.html#drawPrimitive%27"><span class="hs-identifier">drawPrimitive'</span></a></a><span> </span><a name="local-6989586621679080076"><a href="#local-6989586621679080076"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679080077"><a href="#local-6989586621679080077"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679080078"><a href="#local-6989586621679080078"><span class="hs-identifier">list</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-415"></a><span>    </span><span class="hs-identifier hs-var">renderPrimitive</span><span> </span><a href="#local-6989586621679080076"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mapM_</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080079"><a href="#local-6989586621679080079"><span class="hs-identifier">v3</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-416"></a><span>        </span><span class="hs-identifier hs-var">color</span><span> </span><a href="#local-6989586621679080077"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-417"></a><span>        </span><span class="hs-identifier hs-var">vertex</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679080079"><span class="hs-identifier hs-var">v3</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080078"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-418"></a><span>
</span><a name="line-419"></a><span class="hs-identifier">drawLines</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-420"></a><a name="drawLines"><a href="AronGraphic.html#drawLines"><span class="hs-identifier">drawLines</span></a></a><span> </span><a name="local-6989586621679080080"><a href="#local-6989586621679080080"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679080081"><a href="#local-6989586621679080081"><span class="hs-identifier">list</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-421"></a><span>    </span><span class="hs-identifier hs-var">renderPrimitive</span><span> </span><span class="hs-identifier hs-var">Lines</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mapM_</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080082"><a href="#local-6989586621679080082"><span class="hs-identifier">v3</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-422"></a><span>        </span><span class="hs-identifier hs-var">color</span><span> </span><a href="#local-6989586621679080080"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-423"></a><span>        </span><span class="hs-identifier hs-var">vertex</span><span> </span><a href="#local-6989586621679080082"><span class="hs-identifier hs-var">v3</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080081"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-424"></a><span>    </span><span class="hs-identifier hs-var">mapM_</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679080083"><a href="#local-6989586621679080083"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080084"><a href="#local-6989586621679080084"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mod</span><span> </span><a href="#local-6989586621679080083"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="AronGraphic.html#drawCircleColor%27"><span class="hs-identifier hs-var">drawCircleColor'</span></a><span> </span><a href="AronGraphic.html#red"><span class="hs-identifier hs-var">red</span></a><span> </span><span class="hs-number">0.01</span><span> </span><a href="#local-6989586621679080084"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679080081"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-425"></a><span>    </span><span class="hs-identifier hs-var">mapM_</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679080085"><a href="#local-6989586621679080085"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080086"><a href="#local-6989586621679080086"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mod</span><span> </span><a href="#local-6989586621679080085"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="AronGraphic.html#drawCircleColor%27"><span class="hs-identifier hs-var">drawCircleColor'</span></a><span> </span><a href="AronGraphic.html#green"><span class="hs-identifier hs-var">green</span></a><span> </span><span class="hs-number">0.015</span><span> </span><a href="#local-6989586621679080086"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679080081"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-426"></a><span>
</span><a name="line-427"></a><span class="hs-identifier">drawSegmentWithEndPt</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-428"></a><a name="drawSegmentWithEndPt"><a href="AronGraphic.html#drawSegmentWithEndPt"><span class="hs-identifier">drawSegmentWithEndPt</span></a></a><span> </span><a name="local-6989586621679080087"><a href="#local-6989586621679080087"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679080088"><a href="#local-6989586621679080088"><span class="hs-identifier">list</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-429"></a><span>    </span><span class="hs-identifier hs-var">renderPrimitive</span><span> </span><span class="hs-identifier hs-var">Lines</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mapM_</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080089"><a href="#local-6989586621679080089"><span class="hs-identifier">v3</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-430"></a><span>        </span><span class="hs-identifier hs-var">color</span><span> </span><a href="#local-6989586621679080087"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-431"></a><span>        </span><span class="hs-identifier hs-var">vertex</span><span> </span><a href="#local-6989586621679080089"><span class="hs-identifier hs-var">v3</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080088"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-432"></a><span>    </span><span class="hs-identifier hs-var">mapM_</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679080090"><a href="#local-6989586621679080090"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080091"><a href="#local-6989586621679080091"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mod</span><span> </span><a href="#local-6989586621679080090"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="AronGraphic.html#drawCircleColor%27"><span class="hs-identifier hs-var">drawCircleColor'</span></a><span> </span><a href="AronGraphic.html#red"><span class="hs-identifier hs-var">red</span></a><span> </span><span class="hs-number">0.01</span><span> </span><a href="#local-6989586621679080091"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679080088"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-433"></a><span>    </span><span class="hs-identifier hs-var">mapM_</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679080092"><a href="#local-6989586621679080092"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080093"><a href="#local-6989586621679080093"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mod</span><span> </span><a href="#local-6989586621679080092"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="AronGraphic.html#drawCircleColor%27"><span class="hs-identifier hs-var">drawCircleColor'</span></a><span> </span><a href="AronGraphic.html#green"><span class="hs-identifier hs-var">green</span></a><span> </span><span class="hs-number">0.015</span><span> </span><a href="#local-6989586621679080093"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679080088"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-434"></a><span>
</span><a name="line-435"></a><span class="hs-identifier">drawSegmentNoEndPt</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-436"></a><a name="drawSegmentNoEndPt"><a href="AronGraphic.html#drawSegmentNoEndPt"><span class="hs-identifier">drawSegmentNoEndPt</span></a></a><span> </span><a name="local-6989586621679080094"><a href="#local-6989586621679080094"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679080095"><a href="#local-6989586621679080095"><span class="hs-identifier">list</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-437"></a><span>    </span><span class="hs-identifier hs-var">renderPrimitive</span><span> </span><span class="hs-identifier hs-var">Lines</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mapM_</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080096"><a href="#local-6989586621679080096"><span class="hs-identifier">v3</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-438"></a><span>        </span><span class="hs-identifier hs-var">color</span><span> </span><a href="#local-6989586621679080094"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-439"></a><span>        </span><span class="hs-identifier hs-var">vertex</span><span> </span><a href="#local-6989586621679080096"><span class="hs-identifier hs-var">v3</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080095"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-440"></a><span>
</span><a name="line-441"></a><span class="hs-comment">-- | Draw a set of segments </span><span>
</span><a name="line-442"></a><span class="hs-comment">-- | Segment contains two end points, one is begin point, other is end point</span><span>
</span><a name="line-443"></a><span class="hs-comment">--   [p0, p1] = p0 -&gt; p1 </span><span>
</span><a name="line-444"></a><span class="hs-comment">-- </span><span>
</span><a name="line-445"></a><span class="hs-identifier">drawSegments</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-446"></a><a name="drawSegments"><a href="AronGraphic.html#drawSegments"><span class="hs-identifier">drawSegments</span></a></a><span> </span><a name="local-6989586621679080097"><a href="#local-6989586621679080097"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679080098"><a href="#local-6989586621679080098"><span class="hs-identifier">list</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-447"></a><span>    </span><span class="hs-identifier hs-var">renderPrimitive</span><span> </span><span class="hs-identifier hs-var">Lines</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mapM_</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080099"><a href="#local-6989586621679080099"><span class="hs-identifier">v3</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-448"></a><span>        </span><span class="hs-identifier hs-var">color</span><span> </span><a href="#local-6989586621679080097"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-449"></a><span>        </span><span class="hs-identifier hs-var">vertex</span><span> </span><a href="#local-6989586621679080099"><span class="hs-identifier hs-var">v3</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080098"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-450"></a><span>    </span><span class="hs-identifier hs-var">mapM_</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679080100"><a href="#local-6989586621679080100"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080101"><a href="#local-6989586621679080101"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mod</span><span> </span><a href="#local-6989586621679080100"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="AronGraphic.html#drawCircleColor%27"><span class="hs-identifier hs-var">drawCircleColor'</span></a><span> </span><a href="AronGraphic.html#red"><span class="hs-identifier hs-var">red</span></a><span> </span><span class="hs-number">0.01</span><span> </span><a href="#local-6989586621679080101"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679080098"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-451"></a><span>    </span><span class="hs-identifier hs-var">mapM_</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679080102"><a href="#local-6989586621679080102"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080103"><a href="#local-6989586621679080103"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mod</span><span> </span><a href="#local-6989586621679080102"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="AronGraphic.html#drawCircleColor%27"><span class="hs-identifier hs-var">drawCircleColor'</span></a><span> </span><a href="AronGraphic.html#green"><span class="hs-identifier hs-var">green</span></a><span> </span><span class="hs-number">0.015</span><span> </span><a href="#local-6989586621679080103"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679080098"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-452"></a><span>
</span><a name="line-453"></a><span class="hs-comment">-- | Draw one segment from p0 to p1</span><span>
</span><a name="line-454"></a><span class="hs-comment">-- | drawSegment color (p0, p1)</span><span>
</span><a name="line-455"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-456"></a><span class="hs-identifier">drawSegment</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-457"></a><a name="drawSegment"><a href="AronGraphic.html#drawSegment"><span class="hs-identifier">drawSegment</span></a></a><span> </span><a name="local-6989586621679080104"><a href="#local-6989586621679080104"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679080105"><a href="#local-6989586621679080105"><span class="hs-identifier">p0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080106"><a href="#local-6989586621679080106"><span class="hs-identifier">p1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-458"></a><span>    </span><span class="hs-identifier hs-var">renderPrimitive</span><span> </span><span class="hs-identifier hs-var">Lines</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mapM_</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080108"><a href="#local-6989586621679080108"><span class="hs-identifier">v3</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-459"></a><span>        </span><span class="hs-identifier hs-var">color</span><span> </span><a href="#local-6989586621679080104"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-460"></a><span>        </span><span class="hs-identifier hs-var">vertex</span><span> </span><a href="#local-6989586621679080108"><span class="hs-identifier hs-var">v3</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080107"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-461"></a><span>    </span><span class="hs-identifier hs-var">mapM_</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679080109"><a href="#local-6989586621679080109"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080110"><a href="#local-6989586621679080110"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mod</span><span> </span><a href="#local-6989586621679080109"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="AronGraphic.html#drawCircleColor%27"><span class="hs-identifier hs-var">drawCircleColor'</span></a><span> </span><a href="AronGraphic.html#red"><span class="hs-identifier hs-var">red</span></a><span> </span><span class="hs-number">0.01</span><span> </span><a href="#local-6989586621679080110"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679080107"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-462"></a><span>    </span><span class="hs-identifier hs-var">mapM_</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679080111"><a href="#local-6989586621679080111"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080112"><a href="#local-6989586621679080112"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mod</span><span> </span><a href="#local-6989586621679080111"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="AronGraphic.html#drawCircleColor%27"><span class="hs-identifier hs-var">drawCircleColor'</span></a><span> </span><a href="AronGraphic.html#green"><span class="hs-identifier hs-var">green</span></a><span> </span><span class="hs-number">0.015</span><span> </span><a href="#local-6989586621679080112"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679080107"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-463"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-464"></a><span>            </span><a name="local-6989586621679080107"><a href="#local-6989586621679080107"><span class="hs-identifier">list</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679080105"><span class="hs-identifier hs-var">p0</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080106"><span class="hs-identifier hs-var">p1</span></a><span class="hs-special">]</span><span>
</span><a name="line-465"></a><span>
</span><a name="line-466"></a><span class="hs-comment">-- | definition: </span><span>
</span><a name="line-467"></a><span class="hs-comment">--   Segment contains two end points, one is begin point, other is end point</span><span>
</span><a name="line-468"></a><span class="hs-comment">--   [p0, p1] = p0 -&gt; p1 </span><span>
</span><a name="line-469"></a><span class="hs-comment">-- </span><span>
</span><a name="line-470"></a><span class="hs-comment">--data SegEndPt = No      -- no pt, just a segment </span><span>
</span><a name="line-471"></a><span class="hs-comment">--                | End   -- end pt </span><span>
</span><a name="line-472"></a><span class="hs-comment">--                | Beg   -- begin pt </span><span>
</span><a name="line-473"></a><span class="hs-comment">--                | Both  -- begin and end pts </span><span>
</span><a name="line-474"></a><span class="hs-comment">--                | Cen   -- center pt </span><span>
</span><a name="line-475"></a><span class="hs-comment">--                | All   -- all pts: begin, end and ceneter </span><span>
</span><a name="line-476"></a><span class="hs-identifier">drawSegment'</span><span class="hs-glyph">::</span><a href="AronGraphic.html#SegEndPt"><span class="hs-identifier hs-type">SegEndPt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-477"></a><a name="drawSegment%27"><a href="AronGraphic.html#drawSegment%27"><span class="hs-identifier">drawSegment'</span></a></a><span> </span><a name="local-6989586621679080113"><a href="#local-6989586621679080113"><span class="hs-identifier">endpt</span></a></a><span> </span><a name="local-6989586621679080114"><a href="#local-6989586621679080114"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679080115"><a href="#local-6989586621679080115"><span class="hs-identifier">list</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-478"></a><span>    </span><span class="hs-identifier hs-var">renderPrimitive</span><span> </span><span class="hs-identifier hs-var">Lines</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mapM_</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080116"><a href="#local-6989586621679080116"><span class="hs-identifier">v3</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-479"></a><span>        </span><span class="hs-identifier hs-var">color</span><span> </span><a href="#local-6989586621679080114"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-480"></a><span>        </span><span class="hs-identifier hs-var">vertex</span><span> </span><a href="#local-6989586621679080116"><span class="hs-identifier hs-var">v3</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080115"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-481"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679080117"><a href="#local-6989586621679080117"><span class="hs-identifier">bList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapM_</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679080123"><a href="#local-6989586621679080123"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080124"><a href="#local-6989586621679080124"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mod</span><span> </span><a href="#local-6989586621679080123"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="AronGraphic.html#drawCircleColor%27"><span class="hs-identifier hs-var">drawCircleColor'</span></a><span> </span><a href="AronGraphic.html#red"><span class="hs-identifier hs-var">red</span></a><span> </span><span class="hs-number">0.01</span><span> </span><a href="#local-6989586621679080124"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679080115"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-482"></a><span>        </span><a name="local-6989586621679080118"><a href="#local-6989586621679080118"><span class="hs-identifier">eList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapM_</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679080125"><a href="#local-6989586621679080125"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080126"><a href="#local-6989586621679080126"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mod</span><span> </span><a href="#local-6989586621679080125"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="AronGraphic.html#drawCircleColor%27"><span class="hs-identifier hs-var">drawCircleColor'</span></a><span> </span><a href="AronGraphic.html#green"><span class="hs-identifier hs-var">green</span></a><span> </span><span class="hs-number">0.015</span><span> </span><a href="#local-6989586621679080126"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679080115"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-483"></a><span>        </span><a name="local-6989586621679080119"><a href="#local-6989586621679080119"><span class="hs-identifier">ols</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#odds"><span class="hs-identifier hs-var">odds</span></a><span>  </span><a href="#local-6989586621679080115"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-484"></a><span>        </span><a name="local-6989586621679080120"><a href="#local-6989586621679080120"><span class="hs-identifier">els</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#evens"><span class="hs-identifier hs-var">evens</span></a><span> </span><a href="#local-6989586621679080115"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-485"></a><span>        </span><a name="local-6989586621679080121"><a href="#local-6989586621679080121"><span class="hs-identifier">cls</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">zipWith</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080127"><a href="#local-6989586621679080127"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679080128"><a href="#local-6989586621679080128"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span class="hs-special">(</span><span class="hs-operator hs-var">/</span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pure</span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="#local-6989586621679080127"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="#local-6989586621679080128"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080119"><span class="hs-identifier hs-var">ols</span></a><span> </span><a href="#local-6989586621679080120"><span class="hs-identifier hs-var">els</span></a><span>
</span><a name="line-486"></a><span>        </span><a name="local-6989586621679080122"><a href="#local-6989586621679080122"><span class="hs-identifier">cList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapM_</span><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#drawCircleColor%27"><span class="hs-identifier hs-var">drawCircleColor'</span></a><span> </span><a href="AronGraphic.html#blue"><span class="hs-identifier hs-var">blue</span></a><span> </span><span class="hs-number">0.012</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080121"><span class="hs-identifier hs-var">cls</span></a><span>
</span><a name="line-487"></a><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679080113"><span class="hs-identifier hs-var">endpt</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-488"></a><span>            </span><a href="AronGraphic.html#Beg"><span class="hs-identifier hs-var">Beg</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679080117"><span class="hs-identifier hs-var">bList</span></a><span> </span><span class="hs-comment">-- begin pt</span><span>
</span><a name="line-489"></a><span>            </span><a href="AronGraphic.html#End"><span class="hs-identifier hs-var">End</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679080118"><span class="hs-identifier hs-var">eList</span></a><span> </span><span class="hs-comment">-- end pt</span><span>
</span><a name="line-490"></a><span>            </span><a href="AronGraphic.html#Cen"><span class="hs-identifier hs-var">Cen</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679080122"><span class="hs-identifier hs-var">cList</span></a><span> </span><span class="hs-comment">-- center pt </span><span>
</span><a name="line-491"></a><span>            </span><a href="AronGraphic.html#Both"><span class="hs-identifier hs-var">Both</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-492"></a><span>                </span><a href="#local-6989586621679080117"><span class="hs-identifier hs-var">bList</span></a><span>
</span><a name="line-493"></a><span>                </span><a href="#local-6989586621679080118"><span class="hs-identifier hs-var">eList</span></a><span>
</span><a name="line-494"></a><span>            </span><a href="AronGraphic.html#All"><span class="hs-identifier hs-var">All</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-495"></a><span>                </span><a href="#local-6989586621679080117"><span class="hs-identifier hs-var">bList</span></a><span>
</span><a name="line-496"></a><span>                </span><a href="#local-6989586621679080118"><span class="hs-identifier hs-var">eList</span></a><span>
</span><a name="line-497"></a><span>                </span><a href="#local-6989586621679080122"><span class="hs-identifier hs-var">cList</span></a><span>
</span><a name="line-498"></a><span>            </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-499"></a><span>
</span><a name="line-500"></a><span class="hs-comment">-- | Draw intersection pt from two segments</span><span>
</span><a name="line-501"></a><span class="hs-comment">-- | Two segments need not have an intersection.</span><span>
</span><a name="line-502"></a><span class="hs-comment">-- </span><span>
</span><a name="line-503"></a><span class="hs-identifier">drawSegmentArg</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-504"></a><span>                </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-505"></a><span>                </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-506"></a><span>                </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-507"></a><a name="drawSegmentArg"><a href="AronGraphic.html#drawSegmentArg"><span class="hs-identifier">drawSegmentArg</span></a></a><span> </span><a name="local-6989586621679080129"><a href="#local-6989586621679080129"><span class="hs-identifier">p0</span></a></a><span> </span><a name="local-6989586621679080130"><a href="#local-6989586621679080130"><span class="hs-identifier">p1</span></a></a><span> </span><a name="local-6989586621679080131"><a href="#local-6989586621679080131"><span class="hs-identifier">q0</span></a></a><span> </span><a name="local-6989586621679080132"><a href="#local-6989586621679080132"><span class="hs-identifier">q1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-508"></a><span>            </span><a href="AronGraphic.html#drawLines"><span class="hs-identifier hs-var">drawLines</span></a><span> </span><a href="AronGraphic.html#green"><span class="hs-identifier hs-var">green</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679080129"><span class="hs-identifier hs-var">p0</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080137"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">]</span><span>
</span><a name="line-509"></a><span>            </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679080135"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="AronGraphic.html#%2208"><span class="hs-operator hs-var">&#8712;</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span> </span><span class="hs-number">1</span><span class="hs-special">]</span><span>
</span><a name="line-510"></a><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679080135"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-511"></a><span>                </span><span class="hs-keyword">then</span><span> </span><a href="AronGraphic.html#drawLines"><span class="hs-identifier hs-var">drawLines</span></a><span> </span><a href="AronGraphic.html#blue"><span class="hs-identifier hs-var">blue</span></a><span>  </span><span class="hs-special">[</span><a href="#local-6989586621679080130"><span class="hs-identifier hs-var">p1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080137"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- (p0 --&gt; p1) --&gt; ps</span><span>
</span><a name="line-512"></a><span>                </span><span class="hs-keyword">else</span><span> </span><a href="AronGraphic.html#drawLines"><span class="hs-identifier hs-var">drawLines</span></a><span> </span><a href="AronGraphic.html#green"><span class="hs-identifier hs-var">green</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679080129"><span class="hs-identifier hs-var">p0</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080137"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ps &lt;-- (p0 --&gt; p1 </span><span>
</span><a name="line-513"></a><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-514"></a><span>            </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679080136"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679080136"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-515"></a><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679080136"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-516"></a><span>                </span><span class="hs-keyword">then</span><span> </span><a href="AronGraphic.html#drawLines"><span class="hs-identifier hs-var">drawLines</span></a><span> </span><a href="AronGraphic.html#green"><span class="hs-identifier hs-var">green</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679080132"><span class="hs-identifier hs-var">q1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080138"><span class="hs-identifier hs-var">qt</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- (q0 --&gt; q1) --&gt; qt </span><span>
</span><a name="line-517"></a><span>                </span><span class="hs-keyword">else</span><span> </span><a href="AronGraphic.html#drawLines"><span class="hs-identifier hs-var">drawLines</span></a><span> </span><a href="AronGraphic.html#blue"><span class="hs-identifier hs-var">blue</span></a><span>  </span><span class="hs-special">[</span><a href="#local-6989586621679080131"><span class="hs-identifier hs-var">q0</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080138"><span class="hs-identifier hs-var">qt</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- qt &lt;-- (q0 --&gt; q1) </span><span>
</span><a name="line-518"></a><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-519"></a><span>            </span><span class="hs-keyword">where</span><span>
</span><a name="line-520"></a><span>                </span><a name="local-6989586621679080133"><a href="#local-6989586621679080133"><span class="hs-identifier">tup</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromJust</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#intersectLine"><span class="hs-identifier hs-var">intersectLine</span></a><span>  </span><a href="#local-6989586621679080129"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679080130"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679080131"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679080132"><span class="hs-identifier hs-var">q1</span></a><span>
</span><a name="line-521"></a><span>                </span><a name="local-6989586621679080134"><a href="#local-6989586621679080134"><span class="hs-identifier">vx</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621679080133"><span class="hs-identifier hs-var">tup</span></a><span>
</span><a name="line-522"></a><span>                </span><a name="local-6989586621679080135"><a href="#local-6989586621679080135"><span class="hs-identifier">s</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">head</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679080133"><span class="hs-identifier hs-var">tup</span></a><span>
</span><a name="line-523"></a><span>                </span><a name="local-6989586621679080136"><a href="#local-6989586621679080136"><span class="hs-identifier">t</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">last</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">last</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679080133"><span class="hs-identifier hs-var">tup</span></a><span>
</span><a name="line-524"></a><span>                </span><a name="local-6989586621679080137"><a href="#local-6989586621679080137"><span class="hs-identifier">ps</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080129"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="AronGraphic.html#%2B%3A"><span class="hs-operator hs-var">+:</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080135"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="AronGraphic.html#%2A%3A"><span class="hs-operator hs-var">*:</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080130"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679080129"><span class="hs-identifier hs-var">p0</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-525"></a><span>                </span><a name="local-6989586621679080138"><a href="#local-6989586621679080138"><span class="hs-identifier">qt</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080131"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="AronGraphic.html#%2B%3A"><span class="hs-operator hs-var">+:</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080136"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="AronGraphic.html#%2A%3A"><span class="hs-operator hs-var">*:</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080132"><span class="hs-identifier hs-var">q1</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679080131"><span class="hs-identifier hs-var">q0</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-526"></a><span>
</span><a name="line-527"></a><span class="hs-comment">{-|
  === draw sphere center at c with radius r
  * &#946; is in x-y plane, it rotates around z-Axis. &#981; is x-z plane, it rotates aroound y-Axis              
  * \( r*\cos(&#981;) \) is the radius of circle cut through x-y plane
  
-}</span><span>
</span><a name="line-533"></a><span class="hs-identifier">drawSpherePt</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span>
</span><a name="line-534"></a><a name="drawSpherePt"><a href="AronGraphic.html#drawSpherePt"><span class="hs-identifier">drawSpherePt</span></a></a><span> </span><a name="local-6989586621679080139"><a href="#local-6989586621679080139"><span class="hs-identifier">c</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679080140"><a href="#local-6989586621679080140"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679080141"><a href="#local-6989586621679080141"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679080142"><a href="#local-6989586621679080142"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679080143"><a href="#local-6989586621679080143"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080152"><span class="hs-identifier hs-var">pp</span></a><span>
</span><a name="line-535"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-536"></a><span>            </span><a name="local-6989586621679080144"><a href="#local-6989586621679080144"><span class="hs-identifier">fx</span></a></a><span> </span><a name="local-6989586621679080153"><a href="#local-6989586621679080153"><span class="hs-identifier">&#981;</span></a></a><span> </span><a name="local-6989586621679080154"><a href="#local-6989586621679080154"><span class="hs-identifier">&#946;</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080143"><span class="hs-identifier hs-var">r</span></a><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">cos</span><span class="hs-special">(</span><a href="#local-6989586621679080153"><span class="hs-identifier hs-var">&#981;</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">cos</span><span class="hs-special">(</span><a href="#local-6989586621679080154"><span class="hs-identifier hs-var">&#946;</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679080140"><span class="hs-identifier hs-var">x0</span></a><span>
</span><a name="line-537"></a><span>            </span><a name="local-6989586621679080145"><a href="#local-6989586621679080145"><span class="hs-identifier">fy</span></a></a><span> </span><a name="local-6989586621679080155"><a href="#local-6989586621679080155"><span class="hs-identifier">&#981;</span></a></a><span> </span><a name="local-6989586621679080156"><a href="#local-6989586621679080156"><span class="hs-identifier">&#946;</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080143"><span class="hs-identifier hs-var">r</span></a><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">cos</span><span class="hs-special">(</span><a href="#local-6989586621679080155"><span class="hs-identifier hs-var">&#981;</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">sin</span><span class="hs-special">(</span><a href="#local-6989586621679080156"><span class="hs-identifier hs-var">&#946;</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679080141"><span class="hs-identifier hs-var">y0</span></a><span>
</span><a name="line-538"></a><span>            </span><a name="local-6989586621679080146"><a href="#local-6989586621679080146"><span class="hs-identifier">fz</span></a></a><span> </span><a name="local-6989586621679080157"><a href="#local-6989586621679080157"><span class="hs-identifier">&#981;</span></a></a><span> </span><a name="local-6989586621679080158"><a href="#local-6989586621679080158"><span class="hs-identifier">&#946;</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080143"><span class="hs-identifier hs-var">r</span></a><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">sin</span><span class="hs-special">(</span><a href="#local-6989586621679080157"><span class="hs-identifier hs-var">&#981;</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679080142"><span class="hs-identifier hs-var">z0</span></a><span>
</span><a name="line-539"></a><span>            </span><a name="local-6989586621679080147"><a href="#local-6989586621679080147"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">50</span><span>
</span><a name="line-540"></a><span>            </span><a name="local-6989586621679080148"><a href="#local-6989586621679080148"><span class="hs-identifier">&#960;</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pi</span><span>
</span><a name="line-541"></a><span>            </span><a name="local-6989586621679080149"><a href="#local-6989586621679080149"><span class="hs-identifier">&#948;</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">2</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679080148"><span class="hs-identifier hs-var">&#960;</span></a><span class="hs-operator hs-var">/</span><a href="#local-6989586621679080147"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-542"></a><span>            </span><a name="local-6989586621679080150"><a href="#local-6989586621679080150"><span class="hs-identifier">ll</span></a></a><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080159"><a href="#local-6989586621679080159"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679080159"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679080149"><span class="hs-identifier hs-var">&#948;</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><a href="#local-6989586621679080147"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span>
</span><a name="line-543"></a><span>            </span><a name="local-6989586621679080151"><a href="#local-6989586621679080151"><span class="hs-identifier">ls</span></a></a><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080160"><a href="#local-6989586621679080160"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679080160"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679080149"><span class="hs-identifier hs-var">&#948;</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><a href="#local-6989586621679080147"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span>
</span><a name="line-544"></a><span>            </span><a name="local-6989586621679080152"><a href="#local-6989586621679080152"><span class="hs-identifier">pp</span></a></a><span class="hs-glyph">=</span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080144"><span class="hs-identifier hs-var">fx</span></a><span> </span><a href="#local-6989586621679080162"><span class="hs-identifier hs-var">&#981;</span></a><span> </span><a href="#local-6989586621679080163"><span class="hs-identifier hs-var">&#946;</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080145"><span class="hs-identifier hs-var">fy</span></a><span> </span><a href="#local-6989586621679080162"><span class="hs-identifier hs-var">&#981;</span></a><span> </span><a href="#local-6989586621679080163"><span class="hs-identifier hs-var">&#946;</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080146"><span class="hs-identifier hs-var">fz</span></a><span> </span><a href="#local-6989586621679080162"><span class="hs-identifier hs-var">&#981;</span></a><span> </span><a href="#local-6989586621679080163"><span class="hs-identifier hs-var">&#946;</span></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679080162"><a href="#local-6989586621679080162"><span class="hs-identifier">&#981;</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679080161"><a href="#local-6989586621679080161"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080148"><span class="hs-identifier hs-var">&#960;</span></a><span class="hs-operator hs-var">/</span><span class="hs-number">10</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679080161"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><span class="hs-number">10</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679080163"><a href="#local-6989586621679080163"><span class="hs-identifier">&#946;</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679080151"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">]</span><span>
</span><a name="line-545"></a><span>
</span><a name="line-546"></a><span>
</span><a name="line-547"></a><span>
</span><a name="line-548"></a><span class="hs-comment">-- | draw plane with three points</span><span>
</span><a name="line-549"></a><span class="hs-comment">-- | no check whether they are co-linear</span><span>
</span><a name="line-550"></a><span class="hs-comment">-- </span><span>
</span><a name="line-551"></a><span class="hs-identifier">drawPlane</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-552"></a><span>           </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-553"></a><span>           </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-554"></a><span>           </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-555"></a><a name="drawPlane"><a href="AronGraphic.html#drawPlane"><span class="hs-identifier">drawPlane</span></a></a><span> </span><a name="local-6989586621679080164"><a href="#local-6989586621679080164"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679080165"><a href="#local-6989586621679080165"><span class="hs-identifier">q0</span></a></a><span> </span><a name="local-6989586621679080166"><a href="#local-6989586621679080166"><span class="hs-identifier">q1</span></a></a><span> </span><a name="local-6989586621679080167"><a href="#local-6989586621679080167"><span class="hs-identifier">q2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-556"></a><span>  </span><span class="hs-identifier hs-var">renderPrimitive</span><span> </span><span class="hs-identifier hs-var">Lines</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mapM_</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080168"><a href="#local-6989586621679080168"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-557"></a><span>                                    </span><span class="hs-identifier hs-var">color</span><span> </span><a href="#local-6989586621679080164"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-558"></a><span>                                    </span><span class="hs-identifier hs-var">vertex</span><span> </span><a href="#local-6989586621679080168"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679080165"><span class="hs-identifier hs-var">q0</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080166"><span class="hs-identifier hs-var">q1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080165"><span class="hs-identifier hs-var">q0</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080167"><span class="hs-identifier hs-var">q2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080166"><span class="hs-identifier hs-var">q1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080167"><span class="hs-identifier hs-var">q2</span></a><span class="hs-special">]</span><span>
</span><a name="line-559"></a><span>
</span><a name="line-560"></a><span class="hs-comment">-- | set of pts for circle</span><span>
</span><a name="line-561"></a><span class="hs-comment">--circle::(GLfloat, GLfloat, GLfloat) -&gt; Double -&gt; [(GLfloat, GLfloat, GLfloat)]</span><span>
</span><a name="line-562"></a><span class="hs-comment">--circle (x0, y0, z0) r =[ let alpha = (pi2*n)/num in ((rf r)*_sin(alpha) + x0, (rf r)*_cos(alpha) + y0, 0 + z0) | n &lt;- [1..num]]</span><span>
</span><a name="line-563"></a><span class="hs-comment">--        where</span><span>
</span><a name="line-564"></a><span class="hs-comment">--            num = 40 </span><span>
</span><a name="line-565"></a><span class="hs-comment">--            pi2 = 2*pi::Float </span><span>
</span><a name="line-566"></a><span>
</span><a name="line-567"></a><span class="hs-comment">-- | draw xy-plane circle</span><span>
</span><a name="line-568"></a><span class="hs-comment">-- | divide 2*pi to num and iterate from 1 to num</span><span>
</span><a name="line-569"></a><span class="hs-comment">-- | </span><span>
</span><a name="line-570"></a><span class="hs-identifier">circle'</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span>
</span><a name="line-571"></a><a name="circle%27"><a href="AronGraphic.html#circle%27"><span class="hs-identifier">circle'</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679080169"><a href="#local-6989586621679080169"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679080170"><a href="#local-6989586621679080170"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679080171"><a href="#local-6989586621679080171"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679080172"><a href="#local-6989586621679080172"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span class="hs-special">[</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679080176"><a href="#local-6989586621679080176"><span class="hs-identifier">alpha</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080174"><span class="hs-identifier hs-var">pi2</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679080175"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">/</span><a href="#local-6989586621679080173"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="AronGraphic.html#rf"><span class="hs-identifier hs-var">rf</span></a><span> </span><a href="#local-6989586621679080172"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">sin</span><span class="hs-special">(</span><a href="#local-6989586621679080176"><span class="hs-identifier hs-var">alpha</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679080169"><span class="hs-identifier hs-var">x0</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="AronGraphic.html#rf"><span class="hs-identifier hs-var">rf</span></a><span> </span><a href="#local-6989586621679080172"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">cos</span><span class="hs-special">(</span><a href="#local-6989586621679080176"><span class="hs-identifier hs-var">alpha</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679080170"><span class="hs-identifier hs-var">y0</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679080171"><span class="hs-identifier hs-var">z0</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679080175"><a href="#local-6989586621679080175"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><a href="#local-6989586621679080173"><span class="hs-identifier hs-var">num</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-572"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-573"></a><span>            </span><a name="local-6989586621679080173"><a href="#local-6989586621679080173"><span class="hs-identifier">num</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">40</span><span>
</span><a name="line-574"></a><span>            </span><a name="local-6989586621679080174"><a href="#local-6989586621679080174"><span class="hs-identifier">pi2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">2</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">pi</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Float</span><span>
</span><a name="line-575"></a><span>
</span><a name="line-576"></a><span class="hs-comment">-- | draw dot, small circle</span><span>
</span><a name="line-577"></a><span class="hs-identifier">drawDot</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-578"></a><a name="drawDot"><a href="AronGraphic.html#drawDot"><span class="hs-identifier">drawDot</span></a></a><span> </span><a name="local-6989586621679080177"><a href="#local-6989586621679080177"><span class="hs-identifier">cen</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#drawPrimitive%27"><span class="hs-identifier hs-var">drawPrimitive'</span></a><span> </span><span class="hs-identifier hs-var">LineLoop</span><span> </span><a href="#local-6989586621679080179"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#circle%27"><span class="hs-identifier hs-var">circle'</span></a><span> </span><a href="#local-6989586621679080177"><span class="hs-identifier hs-var">cen</span></a><span> </span><a href="#local-6989586621679080178"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-579"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-580"></a><span>            </span><a name="local-6989586621679080178"><a href="#local-6989586621679080178"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0.01</span><span>
</span><a name="line-581"></a><span>            </span><a name="local-6989586621679080179"><a href="#local-6989586621679080179"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#red"><span class="hs-identifier hs-var">red</span></a><span>
</span><a name="line-582"></a><span>
</span><a name="line-583"></a><span class="hs-comment">-- | Given an Vector3 x y z or Vertex3 x y z                  </span><span>
</span><a name="line-584"></a><span class="hs-comment">-- | Convert Cartesian Coordinates to Polar Coordinates       </span><span>
</span><a name="line-585"></a><span class="hs-comment">-- | beta  x-y plane,                                         </span><span>
</span><a name="line-586"></a><span class="hs-comment">-- | alpha x-z plane                                          </span><span>
</span><a name="line-587"></a><span class="hs-comment">-- |                                                          </span><span>
</span><a name="line-588"></a><span class="hs-comment">-- |             y  z                                         </span><span>
</span><a name="line-589"></a><span class="hs-comment">-- |             | /                                          </span><span>
</span><a name="line-590"></a><span class="hs-comment">-- |          ---|/--- x                                      </span><span>
</span><a name="line-591"></a><span class="hs-comment">-- |             /                                            </span><span>
</span><a name="line-592"></a><span class="hs-comment">--                                                            </span><span>
</span><a name="line-593"></a><span class="hs-identifier">cartToPolar</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span>
</span><a name="line-594"></a><a name="cartToPolar"><a href="AronGraphic.html#cartToPolar"><span class="hs-identifier">cartToPolar</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679080180"><a href="#local-6989586621679080180"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679080181"><a href="#local-6989586621679080181"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679080182"><a href="#local-6989586621679080182"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">atan</span><span class="hs-special">(</span><a href="#local-6989586621679080181"><span class="hs-identifier hs-var">y</span></a><span class="hs-operator hs-var">/</span><a href="#local-6989586621679080180"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">asin</span><span class="hs-special">(</span><a href="#local-6989586621679080182"><span class="hs-identifier hs-var">z</span></a><span class="hs-operator hs-var">/</span><a href="#local-6989586621679080184"><span class="hs-identifier hs-var">rxz</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-595"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-596"></a><span>            </span><a name="local-6989586621679080183"><a href="#local-6989586621679080183"><span class="hs-identifier">rxy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sqrt</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#dot3ve"><span class="hs-identifier hs-var">dot3ve</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a href="#local-6989586621679080180"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679080181"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-number">0.0</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a href="#local-6989586621679080180"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679080181"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-number">0.0</span><span class="hs-special">)</span><span>
</span><a name="line-597"></a><span>            </span><a name="local-6989586621679080184"><a href="#local-6989586621679080184"><span class="hs-identifier">rxz</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sqrt</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#dot3ve"><span class="hs-identifier hs-var">dot3ve</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a href="#local-6989586621679080180"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-number">0.0</span><span> </span><a href="#local-6989586621679080182"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a href="#local-6989586621679080180"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-number">0.0</span><span> </span><a href="#local-6989586621679080182"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span>
</span><a name="line-598"></a><span>            </span><span class="hs-comment">-- | at  = if y &lt; 0 &amp;&amp; x &lt; 0 then pi + atan(y/x) else atan(y/x)</span><span>
</span><a name="line-599"></a><span>
</span><a name="line-600"></a><span class="hs-comment">-- | right hand coordinates system in OpenGL</span><span>
</span><a name="line-601"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-602"></a><span class="hs-comment">-- | x-z plane</span><span>
</span><a name="line-603"></a><a name="roty"><a href="AronGraphic.html#roty"><span class="hs-identifier">roty</span></a></a><span> </span><a name="local-6989586621679080185"><a href="#local-6989586621679080185"><span class="hs-identifier">&#945;</span></a></a><span> </span><span class="hs-glyph">=</span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-var">cos</span><span> </span><a href="#local-6989586621679080185"><span class="hs-identifier hs-var">&#945;</span></a><span class="hs-special">,</span><span>          </span><span class="hs-number">0.0</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier hs-var">sin</span><span> </span><a href="#local-6989586621679080185"><span class="hs-identifier hs-var">&#945;</span></a><span class="hs-special">]</span><span>
</span><a name="line-604"></a><span>        </span><span class="hs-special">,</span><span class="hs-special">[</span><span> </span><span class="hs-number">0.0</span><span> </span><span class="hs-special">,</span><span>          </span><span class="hs-number">1.0</span><span class="hs-special">,</span><span>  </span><span class="hs-number">0.0</span><span>  </span><span class="hs-special">]</span><span>
</span><a name="line-605"></a><span>        </span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-identifier hs-var">negate</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">sin</span><span> </span><a href="#local-6989586621679080185"><span class="hs-identifier hs-var">&#945;</span></a><span class="hs-special">,</span><span> </span><span class="hs-number">0.0</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier hs-var">cos</span><span> </span><a href="#local-6989586621679080185"><span class="hs-identifier hs-var">&#945;</span></a><span class="hs-special">]</span><span>
</span><a name="line-606"></a><span>         </span><span class="hs-special">]</span><span>
</span><a name="line-607"></a><span>
</span><a name="line-608"></a><span class="hs-comment">-- | x-y plane</span><span>
</span><a name="line-609"></a><a name="rotz"><a href="AronGraphic.html#rotz"><span class="hs-identifier">rotz</span></a></a><span> </span><a name="local-6989586621679080186"><a href="#local-6989586621679080186"><span class="hs-identifier">&#981;</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">cos</span><span> </span><a href="#local-6989586621679080186"><span class="hs-identifier hs-var">&#981;</span></a><span class="hs-special">,</span><span>          </span><span class="hs-identifier hs-var">negate</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">sin</span><span> </span><a href="#local-6989586621679080186"><span class="hs-identifier hs-var">&#981;</span></a><span class="hs-special">,</span><span> </span><span class="hs-number">0.0</span><span class="hs-special">]</span><span>
</span><a name="line-610"></a><span>         </span><span class="hs-special">,</span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">sin</span><span> </span><a href="#local-6989586621679080186"><span class="hs-identifier hs-var">&#981;</span></a><span class="hs-special">,</span><span>          </span><span class="hs-identifier hs-var">cos</span><span> </span><a href="#local-6989586621679080186"><span class="hs-identifier hs-var">&#981;</span></a><span class="hs-special">,</span><span> </span><span class="hs-number">0.0</span><span class="hs-special">]</span><span>
</span><a name="line-611"></a><span>          </span><span class="hs-special">,</span><span class="hs-special">[</span><span> </span><span class="hs-number">0.0</span><span> </span><span class="hs-special">,</span><span>            </span><span class="hs-number">0.0</span><span class="hs-special">,</span><span> </span><span class="hs-number">1.0</span><span class="hs-special">]</span><span>
</span><a name="line-612"></a><span>          </span><span class="hs-special">]</span><span>
</span><a name="line-613"></a><span>
</span><a name="line-614"></a><span class="hs-comment">-- | Given an radius r, center Vertex3 vx, and Vector ve</span><span>
</span><a name="line-615"></a><span class="hs-comment">--   Draw circle(r, vx) which is perpendicular to ve</span><span>
</span><a name="line-616"></a><span class="hs-comment">-- |  </span><span>
</span><a name="line-617"></a><span class="hs-identifier">drawCircleVec</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-618"></a><a name="drawCircleVec"><a href="AronGraphic.html#drawCircleVec"><span class="hs-identifier">drawCircleVec</span></a></a><span> </span><a name="local-6989586621679080187"><a href="#local-6989586621679080187"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679080188"><a href="#local-6989586621679080188"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679080189"><a href="#local-6989586621679080189"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-619"></a><span>  </span><span class="hs-identifier hs-var">mapM_</span><span> </span><a href="AronGraphic.html#drawDot"><span class="hs-identifier hs-var">drawDot</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#matVx"><span class="hs-identifier hs-var">matVx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080194"><span class="hs-identifier hs-var">ls'</span></a><span>
</span><a name="line-620"></a><span>  </span><a href="AronGraphic.html#drawLines"><span class="hs-identifier hs-var">drawLines</span></a><span> </span><a href="AronGraphic.html#blue"><span class="hs-identifier hs-var">blue</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679080188"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080188"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="AronGraphic.html#%2B%3A"><span class="hs-operator hs-var">+:</span></a><span> </span><a href="#local-6989586621679080189"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">]</span><span>
</span><a name="line-621"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-622"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679080190"><a href="#local-6989586621679080190"><span class="hs-identifier">&#981;</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080191"><a href="#local-6989586621679080191"><span class="hs-identifier">&#945;</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#cartToPolar"><span class="hs-identifier hs-var">cartToPolar</span></a><span> </span><a href="#local-6989586621679080189"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-623"></a><span>    </span><a name="local-6989586621679080192"><a href="#local-6989586621679080192"><span class="hs-identifier">circ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-number">0.0</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679080187"><span class="hs-identifier hs-var">r</span></a><span class="hs-operator hs-var">*</span><span class="hs-special">(</span><span class="hs-identifier hs-var">cos</span><span> </span><a href="#local-6989586621679080205"><span class="hs-identifier hs-var">&#946;</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679080187"><span class="hs-identifier hs-var">r</span></a><span class="hs-operator hs-var">*</span><span class="hs-special">(</span><span class="hs-identifier hs-var">sin</span><span> </span><a href="#local-6989586621679080205"><span class="hs-identifier hs-var">&#946;</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679080205"><a href="#local-6989586621679080205"><span class="hs-identifier">&#946;</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679080203"><a href="#local-6989586621679080203"><span class="hs-identifier">&#960;</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">3.1415</span><span class="hs-special">;</span><span> </span><a name="local-6989586621679080204"><a href="#local-6989586621679080204"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">2</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679080203"><span class="hs-identifier hs-var">&#960;</span></a><span class="hs-operator hs-var">/</span><span class="hs-number">100</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679080204"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-number">100</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-624"></a><span>    </span><span class="hs-comment">-- | circ = [[[0.5], [0.5], [0.0]]]</span><span>
</span><a name="line-625"></a><span>    </span><a name="local-6989586621679080193"><a href="#local-6989586621679080193"><span class="hs-identifier">ls</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><a href="AronModule.html#multiMat"><span class="hs-identifier hs-var">multiMat</span></a><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#rotz"><span class="hs-identifier hs-var">rotz</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679080190"><span class="hs-identifier hs-var">&#981;</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080192"><span class="hs-identifier hs-var">circ</span></a><span> </span><span class="hs-comment">-- rotate x-y plane</span><span>
</span><a name="line-626"></a><span>    </span><a name="local-6989586621679080194"><a href="#local-6989586621679080194"><span class="hs-identifier">ls'</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><a href="AronModule.html#multiMat"><span class="hs-identifier hs-var">multiMat</span></a><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#roty"><span class="hs-identifier hs-var">roty</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679080191"><span class="hs-identifier hs-var">&#945;</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080193"><span class="hs-identifier hs-var">ls</span></a><span>   </span><span class="hs-comment">-- rotate x-z plane</span><span>
</span><a name="line-627"></a><span>    </span><span class="hs-comment">-- |  v'   = multiMat (rotz $ &#981;) (veMat v)</span><span>
</span><a name="line-628"></a><span>    </span><span class="hs-comment">-- |  v''  = multiMat (roty $ &#945;) v'</span><span>
</span><a name="line-629"></a><span>    </span><span class="hs-comment">-- | matVx [[x], [y], [z]] = Vertex3 x y z</span><span>
</span><a name="line-630"></a><span>    </span><span class="hs-comment">-- | veMat (Vector3 x y z) = [[x], [y], [z]]</span><span>
</span><a name="line-631"></a><span>    </span><span class="hs-comment">-- | ls   = map(multiMat (rotz $ 0.0)) circ   </span><span>
</span><a name="line-632"></a><span>    </span><a name="local-6989586621679080195"><a href="#local-6989586621679080195"><span class="hs-identifier">ls1</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><a href="AronModule.html#multiMat"><span class="hs-identifier hs-var">multiMat</span></a><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#rotz"><span class="hs-identifier hs-var">rotz</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">pi</span><span class="hs-operator hs-var">/</span><span class="hs-number">4</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080192"><span class="hs-identifier hs-var">circ</span></a><span>
</span><a name="line-633"></a><span>    </span><a name="local-6989586621679080196"><a href="#local-6989586621679080196"><span class="hs-identifier">ls2</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><a href="AronModule.html#multiMat"><span class="hs-identifier hs-var">multiMat</span></a><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#rotz"><span class="hs-identifier hs-var">rotz</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-number">2</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">pi</span><span class="hs-operator hs-var">/</span><span class="hs-number">4</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080192"><span class="hs-identifier hs-var">circ</span></a><span>
</span><a name="line-634"></a><span>    </span><a name="local-6989586621679080197"><a href="#local-6989586621679080197"><span class="hs-identifier">ls3</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><a href="AronModule.html#multiMat"><span class="hs-identifier hs-var">multiMat</span></a><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#rotz"><span class="hs-identifier hs-var">rotz</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-number">3</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">pi</span><span class="hs-operator hs-var">/</span><span class="hs-number">4</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080192"><span class="hs-identifier hs-var">circ</span></a><span>
</span><a name="line-635"></a><span>    </span><a name="local-6989586621679080198"><a href="#local-6989586621679080198"><span class="hs-identifier">ls4</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><a href="AronModule.html#multiMat"><span class="hs-identifier hs-var">multiMat</span></a><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#rotz"><span class="hs-identifier hs-var">rotz</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-number">4</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">pi</span><span class="hs-operator hs-var">/</span><span class="hs-number">4</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080192"><span class="hs-identifier hs-var">circ</span></a><span>
</span><a name="line-636"></a><span>    </span><a name="local-6989586621679080199"><a href="#local-6989586621679080199"><span class="hs-identifier">ls5</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><a href="AronModule.html#multiMat"><span class="hs-identifier hs-var">multiMat</span></a><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#rotz"><span class="hs-identifier hs-var">rotz</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-number">5</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">pi</span><span class="hs-operator hs-var">/</span><span class="hs-number">4</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080192"><span class="hs-identifier hs-var">circ</span></a><span>
</span><a name="line-637"></a><span>    </span><a name="local-6989586621679080200"><a href="#local-6989586621679080200"><span class="hs-identifier">ls6</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><a href="AronModule.html#multiMat"><span class="hs-identifier hs-var">multiMat</span></a><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#rotz"><span class="hs-identifier hs-var">rotz</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-number">6</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">pi</span><span class="hs-operator hs-var">/</span><span class="hs-number">4</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080192"><span class="hs-identifier hs-var">circ</span></a><span>
</span><a name="line-638"></a><span>    </span><a name="local-6989586621679080201"><a href="#local-6989586621679080201"><span class="hs-identifier">ls7</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><a href="AronModule.html#multiMat"><span class="hs-identifier hs-var">multiMat</span></a><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#rotz"><span class="hs-identifier hs-var">rotz</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-number">7</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">pi</span><span class="hs-operator hs-var">/</span><span class="hs-number">4</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080192"><span class="hs-identifier hs-var">circ</span></a><span>
</span><a name="line-639"></a><span>    </span><a name="local-6989586621679080202"><a href="#local-6989586621679080202"><span class="hs-identifier">ls8</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><a href="AronModule.html#multiMat"><span class="hs-identifier hs-var">multiMat</span></a><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#rotz"><span class="hs-identifier hs-var">rotz</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-number">8</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">pi</span><span class="hs-operator hs-var">/</span><span class="hs-number">4</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080192"><span class="hs-identifier hs-var">circ</span></a><span>
</span><a name="line-640"></a><span>
</span><a name="line-641"></a><span class="hs-comment">-- | matrix to Vertex</span><span>
</span><a name="line-642"></a><a name="matVx"><a href="AronGraphic.html#matVx"><span class="hs-identifier">matVx</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a name="local-6989586621679080206"><a href="#local-6989586621679080206"><span class="hs-identifier">x</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679080207"><a href="#local-6989586621679080207"><span class="hs-identifier">y</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679080208"><a href="#local-6989586621679080208"><span class="hs-identifier">z</span></a></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a href="#local-6989586621679080206"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679080207"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679080208"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-643"></a><span class="hs-comment">-- | matrix to Vector</span><span>
</span><a name="line-644"></a><a name="matVe"><a href="AronGraphic.html#matVe"><span class="hs-identifier">matVe</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a name="local-6989586621679080209"><a href="#local-6989586621679080209"><span class="hs-identifier">x</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679080210"><a href="#local-6989586621679080210"><span class="hs-identifier">y</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679080211"><a href="#local-6989586621679080211"><span class="hs-identifier">z</span></a></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vector3</span><span> </span><a href="#local-6989586621679080209"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679080210"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679080211"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-645"></a><span class="hs-comment">-- | Vector to matrix</span><span>
</span><a name="line-646"></a><a name="veMat"><a href="AronGraphic.html#veMat"><span class="hs-identifier">veMat</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679080212"><a href="#local-6989586621679080212"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679080213"><a href="#local-6989586621679080213"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679080214"><a href="#local-6989586621679080214"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679080212"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679080213"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679080214"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-647"></a><span>
</span><a name="line-648"></a><span>
</span><a name="line-649"></a><span class="hs-comment">-- | draw circle with center and radius</span><span>
</span><a name="line-650"></a><span class="hs-comment">-- | ceneter radius</span><span>
</span><a name="line-651"></a><span class="hs-comment">--drawCircle::(GLfloat, GLfloat, GLfloat) -&gt; Double -&gt; IO()</span><span>
</span><a name="line-652"></a><span class="hs-comment">--drawCircle cen r = drawPrimitive LineLoop red $ circle cen r </span><span>
</span><a name="line-653"></a><span>
</span><a name="line-654"></a><span class="hs-identifier">drawCircle'</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-655"></a><a name="drawCircle%27"><a href="AronGraphic.html#drawCircle%27"><span class="hs-identifier">drawCircle'</span></a></a><span> </span><a name="local-6989586621679080215"><a href="#local-6989586621679080215"><span class="hs-identifier">cen</span></a></a><span> </span><a name="local-6989586621679080216"><a href="#local-6989586621679080216"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#drawPrimitive%27"><span class="hs-identifier hs-var">drawPrimitive'</span></a><span> </span><span class="hs-identifier hs-var">LineLoop</span><span> </span><a href="AronGraphic.html#red"><span class="hs-identifier hs-var">red</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#circle%27"><span class="hs-identifier hs-var">circle'</span></a><span> </span><a href="#local-6989586621679080215"><span class="hs-identifier hs-var">cen</span></a><span> </span><a href="#local-6989586621679080216"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-656"></a><span>
</span><a name="line-657"></a><span class="hs-identifier">drawCircleColor</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-658"></a><a name="drawCircleColor"><a href="AronGraphic.html#drawCircleColor"><span class="hs-identifier">drawCircleColor</span></a></a><span> </span><a name="local-6989586621679080217"><a href="#local-6989586621679080217"><span class="hs-identifier">cen</span></a></a><span> </span><a name="local-6989586621679080218"><a href="#local-6989586621679080218"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679080219"><a href="#local-6989586621679080219"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#drawPrimitive%27"><span class="hs-identifier hs-var">drawPrimitive'</span></a><span> </span><span class="hs-identifier hs-var">LineLoop</span><span> </span><a href="#local-6989586621679080218"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#circle%27"><span class="hs-identifier hs-var">circle'</span></a><span> </span><a href="#local-6989586621679080217"><span class="hs-identifier hs-var">cen</span></a><span> </span><a href="#local-6989586621679080219"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-659"></a><span>
</span><a name="line-660"></a><span class="hs-identifier">drawCircleColor'</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-661"></a><a name="drawCircleColor%27"><a href="AronGraphic.html#drawCircleColor%27"><span class="hs-identifier">drawCircleColor'</span></a></a><span> </span><a name="local-6989586621679080220"><a href="#local-6989586621679080220"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679080221"><a href="#local-6989586621679080221"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679080222"><a href="#local-6989586621679080222"><span class="hs-identifier">cen</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#drawPrimitive%27"><span class="hs-identifier hs-var">drawPrimitive'</span></a><span> </span><span class="hs-identifier hs-var">LineLoop</span><span> </span><a href="#local-6989586621679080220"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#circle%27"><span class="hs-identifier hs-var">circle'</span></a><span> </span><a href="#local-6989586621679080222"><span class="hs-identifier hs-var">cen</span></a><span> </span><a href="#local-6989586621679080221"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-662"></a><span>
</span><a name="line-663"></a><span class="hs-comment">-- | Conic Parameter Equation</span><span>
</span><a name="line-664"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-665"></a><span class="hs-comment">-- |  gx http://localhost/html/indexThebeautyofTorus.html</span><span>
</span><a name="line-666"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-667"></a><span class="hs-identifier">conic</span><span class="hs-glyph">::</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-668"></a><a name="conic"><a href="AronGraphic.html#conic"><span class="hs-identifier">conic</span></a></a><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679080232"><a href="#local-6989586621679080232"><span class="hs-identifier">r'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080226"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679080229"><span class="hs-identifier hs-var">rd</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679080230"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080228"><span class="hs-identifier hs-var">d'</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679080230"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080232"><span class="hs-identifier hs-var">r'</span></a><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">sin</span><span class="hs-special">(</span><a href="#local-6989586621679080227"><span class="hs-identifier hs-var">del</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679080231"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080232"><span class="hs-identifier hs-var">r'</span></a><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">cos</span><span class="hs-special">(</span><a href="#local-6989586621679080227"><span class="hs-identifier hs-var">del</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679080231"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679080230"><a href="#local-6989586621679080230"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><a href="#local-6989586621679080224"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679080231"><a href="#local-6989586621679080231"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><a href="#local-6989586621679080223"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-669"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-670"></a><span>            </span><a name="local-6989586621679080223"><a href="#local-6989586621679080223"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">40</span><span>
</span><a name="line-671"></a><span>            </span><a name="local-6989586621679080224"><a href="#local-6989586621679080224"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">20</span><span>
</span><a name="line-672"></a><span>            </span><a name="local-6989586621679080225"><a href="#local-6989586621679080225"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0.1</span><span>
</span><a name="line-673"></a><span>            </span><a name="local-6989586621679080226"><a href="#local-6989586621679080226"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0.05</span><span>
</span><a name="line-674"></a><span>            </span><a name="local-6989586621679080227"><a href="#local-6989586621679080227"><span class="hs-identifier">del</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">2</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">pi</span><span class="hs-operator hs-var">/</span><a href="#local-6989586621679080223"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-675"></a><span>            </span><a name="local-6989586621679080228"><a href="#local-6989586621679080228"><span class="hs-identifier">d'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080225"><span class="hs-identifier hs-var">h</span></a><span class="hs-operator hs-var">/</span><a href="#local-6989586621679080224"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-676"></a><span>            </span><a name="local-6989586621679080229"><a href="#local-6989586621679080229"><span class="hs-identifier">rd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080226"><span class="hs-identifier hs-var">r</span></a><span class="hs-operator hs-var">/</span><a href="#local-6989586621679080224"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-677"></a><span>
</span><a name="line-678"></a><span>
</span><a name="line-679"></a><span>
</span><a name="line-680"></a><span class="hs-comment">-- | determinant of two dimension matrix</span><span>
</span><a name="line-681"></a><span class="hs-identifier">det2</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679076136"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679076136"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679076136"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-682"></a><a name="det2"><a href="AronGraphic.html#det2"><span class="hs-identifier">det2</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a name="local-6989586621679080233"><a href="#local-6989586621679080233"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080234"><a href="#local-6989586621679080234"><span class="hs-identifier">b</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679080235"><a href="#local-6989586621679080235"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080236"><a href="#local-6989586621679080236"><span class="hs-identifier">d</span></a></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080233"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679080236"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679080234"><span class="hs-identifier hs-var">b</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679080235"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-683"></a><span>
</span><a name="line-684"></a><span>
</span><a name="line-685"></a><span class="hs-comment">--- | Sat Dec 22 20:59:28 2018                                        </span><span>
</span><a name="line-686"></a><span class="hs-comment">--- |                                                                 </span><span>
</span><a name="line-687"></a><span class="hs-comment">--- | find the inverse of matrix in Rational number                   </span><span>
</span><a name="line-688"></a><span class="hs-comment">--- | it is not much difference from the Integer code                 </span><span>
</span><a name="line-689"></a><span class="hs-comment">--- | change division from (div n m) =&gt; (n / m)                       </span><span>
</span><a name="line-690"></a><span class="hs-comment">--- |                                                                 </span><span>
</span><a name="line-691"></a><span class="hs-identifier">inverseR</span><span class="hs-glyph">::</span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Rational</span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Rational</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-692"></a><a name="inverseR"><a href="AronGraphic.html#inverseR"><span class="hs-identifier">inverseR</span></a></a><span> </span><a name="local-6989586621679080237"><a href="#local-6989586621679080237"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679080241"><span class="hs-identifier hs-var">diag</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679080256"><span class="hs-identifier hs-var">mb'</span></a><span>
</span><a name="line-693"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-694"></a><span>            </span><a name="local-6989586621679080238"><a href="#local-6989586621679080238"><span class="hs-identifier">id</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#ident%27"><span class="hs-identifier hs-var">ident'</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679080237"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-695"></a><span>            </span><span class="hs-comment">-- argumented matrix [m] ++ [id]                         </span><span>
</span><a name="line-696"></a><span>            </span><a name="local-6989586621679080239"><a href="#local-6989586621679080239"><span class="hs-identifier">argm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">zipWith</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080257"><a href="#local-6989586621679080257"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679080258"><a href="#local-6989586621679080258"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679080257"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679080258"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080237"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679080238"><span class="hs-identifier hs-var">id</span></a><span>
</span><a name="line-697"></a><span>            </span><span class="hs-comment">-- argm =                                                </span><span>
</span><a name="line-698"></a><span>            </span><span class="hs-comment">-- [[1 2 3 1 0 0]]                                       </span><span>
</span><a name="line-699"></a><span>            </span><span class="hs-comment">-- [[4 5 6 0 1 0]]                                       </span><span>
</span><a name="line-700"></a><span>            </span><span class="hs-comment">-- [[7 8 9 0 0 1]]                                       </span><span>
</span><a name="line-701"></a><span>            </span><a name="local-6989586621679080240"><a href="#local-6989586621679080240"><span class="hs-identifier">mt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#upperTri%27"><span class="hs-identifier hs-var">upperTri'</span></a><span> </span><a href="#local-6989586621679080239"><span class="hs-identifier hs-var">argm</span></a><span>
</span><a name="line-702"></a><span>            </span><span class="hs-comment">-- mt =                                                  </span><span>
</span><a name="line-703"></a><span>            </span><span class="hs-comment">-- [[1, 2, 3 x x x]]                                     </span><span>
</span><a name="line-704"></a><span>            </span><span class="hs-comment">-- [[   2, 2 x x x]]                                     </span><span>
</span><a name="line-705"></a><span>            </span><span class="hs-comment">-- [[      1 x x x]]                                     </span><span>
</span><a name="line-706"></a><span>            </span><span class="hs-comment">--                                                       </span><span>
</span><a name="line-707"></a><span>            </span><span class="hs-comment">-- If diag[onal] == 0 then it is single matrix           </span><span>
</span><a name="line-708"></a><span>            </span><a name="local-6989586621679080241"><a href="#local-6989586621679080241"><span class="hs-identifier">diag</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl</span><span class="hs-special">(</span><span class="hs-operator hs-var">*</span><span class="hs-special">)</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679080259"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679080259"><a href="#local-6989586621679080259"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679080240"><span class="hs-identifier hs-var">mt</span></a><span class="hs-special">]</span><span>
</span><a name="line-709"></a><span>            </span><a name="local-6989586621679080242"><a href="#local-6989586621679080242"><span class="hs-identifier">ar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">zipWith</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080260"><a href="#local-6989586621679080260"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679080261"><a href="#local-6989586621679080261"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">replicate</span><span> </span><a href="#local-6989586621679080260"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679080261"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679080240"><span class="hs-identifier hs-var">mt</span></a><span>
</span><a name="line-710"></a><span>            </span><span class="hs-comment">-- ar =                                                  </span><span>
</span><a name="line-711"></a><span>            </span><span class="hs-comment">-- [[1 2 3 x x x]                                        </span><span>
</span><a name="line-712"></a><span>            </span><span class="hs-comment">--  [0 2 2 x x x]                                        </span><span>
</span><a name="line-713"></a><span>            </span><span class="hs-comment">--  [0 0 1 x x x]]                                       </span><span>
</span><a name="line-714"></a><span>            </span><a name="local-6989586621679080243"><a href="#local-6989586621679080243"><span class="hs-identifier">pm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080262"><a href="#local-6989586621679080262"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="AronModule.html#partList"><span class="hs-identifier hs-var">partList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679080242"><span class="hs-identifier hs-var">ar</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080262"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080242"><span class="hs-identifier hs-var">ar</span></a><span>
</span><a name="line-715"></a><span>            </span><span class="hs-comment">-- pm =                                                  </span><span>
</span><a name="line-716"></a><span>            </span><span class="hs-comment">-- [[[1 2 3] [x x x]]                                    </span><span>
</span><a name="line-717"></a><span>            </span><span class="hs-comment">--  [[0 1 2] [x x x]]                                    </span><span>
</span><a name="line-718"></a><span>            </span><span class="hs-comment">--  [[0 0 1] [x x x]]]                                   </span><span>
</span><a name="line-719"></a><span>            </span><a name="local-6989586621679080244"><a href="#local-6989586621679080244"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080263"><a href="#local-6989586621679080263"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679080263"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080243"><span class="hs-identifier hs-var">pm</span></a><span>
</span><a name="line-720"></a><span>            </span><a name="local-6989586621679080245"><a href="#local-6989586621679080245"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080264"><a href="#local-6989586621679080264"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">last</span><span> </span><a href="#local-6989586621679080264"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080243"><span class="hs-identifier hs-var">pm</span></a><span>
</span><a name="line-721"></a><span>            </span><span class="hs-comment">-- m1 =                                                  </span><span>
</span><a name="line-722"></a><span>            </span><span class="hs-comment">-- [[1 2 3]                                              </span><span>
</span><a name="line-723"></a><span>            </span><span class="hs-comment">--  [0 1 2]                                              </span><span>
</span><a name="line-724"></a><span>            </span><span class="hs-comment">--  [0 0 1]]                                             </span><span>
</span><a name="line-725"></a><span>            </span><span class="hs-comment">-- m2 =                                                  </span><span>
</span><a name="line-726"></a><span>            </span><span class="hs-comment">-- [[x x x]                                              </span><span>
</span><a name="line-727"></a><span>            </span><span class="hs-comment">--  [x x x]                                              </span><span>
</span><a name="line-728"></a><span>            </span><span class="hs-comment">--  [x x x]]                                             </span><span>
</span><a name="line-729"></a><span>            </span><a name="local-6989586621679080246"><a href="#local-6989586621679080246"><span class="hs-identifier">m11</span></a></a><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080265"><a href="#local-6989586621679080265"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679080265"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080244"><span class="hs-identifier hs-var">m1</span></a><span>
</span><a name="line-730"></a><span>            </span><span class="hs-comment">-- m11 =                                                 </span><span>
</span><a name="line-731"></a><span>            </span><span class="hs-comment">-- [[3 2 1]                                              </span><span>
</span><a name="line-732"></a><span>            </span><span class="hs-comment">--  [2 1 0]                                              </span><span>
</span><a name="line-733"></a><span>            </span><span class="hs-comment">--  [1 0 0]]                                             </span><span>
</span><a name="line-734"></a><span>            </span><span class="hs-comment">-- [[1 0 0]                                              </span><span>
</span><a name="line-735"></a><span>            </span><span class="hs-comment">--  [2 1 0]                                              </span><span>
</span><a name="line-736"></a><span>            </span><span class="hs-comment">--  [3 2 1]]                                             </span><span>
</span><a name="line-737"></a><span>            </span><a name="local-6989586621679080247"><a href="#local-6989586621679080247"><span class="hs-identifier">m22</span></a></a><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080266"><a href="#local-6989586621679080266"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679080266"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080245"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-738"></a><span>            </span><span class="hs-comment">-- m22 =                                                 </span><span>
</span><a name="line-739"></a><span>            </span><span class="hs-comment">-- [[x x x]                                              </span><span>
</span><a name="line-740"></a><span>            </span><span class="hs-comment">--  [x x x]                                              </span><span>
</span><a name="line-741"></a><span>            </span><span class="hs-comment">--  [x x x]]                                             </span><span>
</span><a name="line-742"></a><span>
</span><a name="line-743"></a><span>            </span><a name="local-6989586621679080248"><a href="#local-6989586621679080248"><span class="hs-identifier">m3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">zipWith</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080267"><a href="#local-6989586621679080267"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679080268"><a href="#local-6989586621679080268"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679080267"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679080268"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080246"><span class="hs-identifier hs-var">m11</span></a><span> </span><a href="#local-6989586621679080247"><span class="hs-identifier hs-var">m22</span></a><span>
</span><a name="line-744"></a><span>            </span><a name="local-6989586621679080249"><a href="#local-6989586621679080249"><span class="hs-identifier">m4</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#upperTri%27"><span class="hs-identifier hs-var">upperTri'</span></a><span> </span><a href="#local-6989586621679080248"><span class="hs-identifier hs-var">m3</span></a><span>
</span><a name="line-745"></a><span>            </span><span class="hs-comment">--m4'= map(\r -&gt; map(\x -&gt; divI x   $ toInteger (head r))</span><span>
</span><a name="line-746"></a><span>            </span><span class="hs-comment">-- Fri Dec 14 16:04:32 2018                              </span><span>
</span><a name="line-747"></a><span>            </span><span class="hs-comment">-- remove the division here                              </span><span>
</span><a name="line-748"></a><span>            </span><a name="local-6989586621679080250"><a href="#local-6989586621679080250"><span class="hs-identifier">m4'</span></a></a><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080269"><a href="#local-6989586621679080269"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080270"><a href="#local-6989586621679080270"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679080270"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679080269"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080269"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080249"><span class="hs-identifier hs-var">m4</span></a><span>
</span><a name="line-749"></a><span>            </span><span class="hs-comment">-- Not full inverse matrix here                          </span><span>
</span><a name="line-750"></a><span>            </span><a name="local-6989586621679080251"><a href="#local-6989586621679080251"><span class="hs-identifier">mm'</span></a></a><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">zipWith</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080271"><a href="#local-6989586621679080271"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679080272"><a href="#local-6989586621679080272"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">replicate</span><span> </span><a href="#local-6989586621679080271"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679080272"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679080250"><span class="hs-identifier hs-var">m4'</span></a><span>
</span><a name="line-751"></a><span>            </span><a name="local-6989586621679080252"><a href="#local-6989586621679080252"><span class="hs-identifier">mm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080273"><a href="#local-6989586621679080273"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="AronModule.html#partList"><span class="hs-identifier hs-var">partList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679080251"><span class="hs-identifier hs-var">mm'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080273"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080251"><span class="hs-identifier hs-var">mm'</span></a><span>
</span><a name="line-752"></a><span>            </span><a name="local-6989586621679080253"><a href="#local-6989586621679080253"><span class="hs-identifier">m1'</span></a></a><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080274"><a href="#local-6989586621679080274"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679080274"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080252"><span class="hs-identifier hs-var">mm</span></a><span>
</span><a name="line-753"></a><span>            </span><a name="local-6989586621679080254"><a href="#local-6989586621679080254"><span class="hs-identifier">m2'</span></a></a><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080275"><a href="#local-6989586621679080275"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">last</span><span> </span><a href="#local-6989586621679080275"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080252"><span class="hs-identifier hs-var">mm</span></a><span>
</span><a name="line-754"></a><span>            </span><a name="local-6989586621679080255"><a href="#local-6989586621679080255"><span class="hs-identifier">ma'</span></a></a><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080276"><a href="#local-6989586621679080276"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679080276"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679080253"><span class="hs-identifier hs-var">m1'</span></a><span>
</span><a name="line-755"></a><span>            </span><a name="local-6989586621679080256"><a href="#local-6989586621679080256"><span class="hs-identifier">mb'</span></a></a><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080277"><a href="#local-6989586621679080277"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679080277"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679080254"><span class="hs-identifier hs-var">m2'</span></a><span>
</span><a name="line-756"></a><span>
</span><a name="line-757"></a><span>
</span><a name="line-758"></a><span>
</span><a name="line-759"></a><span>
</span><a name="line-760"></a><span>
</span><a name="line-761"></a><span>
</span><a name="line-762"></a><span>
</span><a name="line-763"></a><span class="hs-comment">{-|
  === Inverse of two dimension matrix
  &lt;http://localhost/pdf/inverse_matrix2.pdf Inverse_matrix_determinant&gt;

    \[
        \begin{equation}
        \begin{aligned}
        A &amp;= \begin{bmatrix}
            a &amp; b \\
            c &amp; d \\
            \end{bmatrix} \\
        A^{ -1} &amp;= \frac{1}{ \det A }  
                \begin{bmatrix}
                 d &amp; -b \\
                 -c &amp; a \\
                 \end{bmatrix}
        \end{aligned}
        \end{equation}
    \]
    * inverse should be used in general.

    * Or 'isInver' should be used for large matrix because 'isInver' is implemented 
      in __QR Decomposition__

    @
    isInver::(Fractional a, Ord a)=&gt; [[a]] -&gt; Bool 
    isInver m = if len (filter(&lt; 0.0001) cx) &gt; 0 then False else True
    @
    
    * Following function is implemented in Gaussian Elimination

    * There is some Integer overflow issue, it only works for small matrix, e.g. 10 by 10

    @ 
    isInvertible::[[Integer]]-&gt;Bool
    @
-}</span><span>
</span><a name="line-800"></a><span class="hs-identifier">inv2</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679076135"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679076135"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679076135"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-801"></a><a name="inv2"><a href="AronGraphic.html#inv2"><span class="hs-identifier">inv2</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a name="local-6989586621679080278"><a href="#local-6989586621679080278"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080279"><a href="#local-6989586621679080279"><span class="hs-identifier">b</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679080280"><a href="#local-6989586621679080280"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080281"><a href="#local-6989586621679080281"><span class="hs-identifier">d</span></a></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span class="hs-operator hs-var">/</span><a href="AronGraphic.html#det2"><span class="hs-identifier hs-var">det2</span></a><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679080278"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080279"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679080280"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080281"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080282"><span class="hs-operator hs-var">*:</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679080281"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679080279"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679080280"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080278"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-802"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-803"></a><span>        </span><span class="hs-comment">-- scalar multiply 2x2 matrix</span><span>
</span><a name="line-804"></a><span>        </span><span class="hs-special">(</span><span class="hs-operator">*:</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679080284"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><a href="#local-6989586621679080284"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679080284"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679080284"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-805"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679080282"><a href="#local-6989586621679080282"><span class="hs-operator">*:</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679080285"><a href="#local-6989586621679080285"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679080286"><a href="#local-6989586621679080286"><span class="hs-identifier">cx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679080285"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080286"><span class="hs-identifier hs-var">cx</span></a><span>
</span><a name="line-806"></a><span>        </span><a name="local-6989586621679080283"><a href="#local-6989586621679080283"><span class="hs-identifier">dt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#det2"><span class="hs-identifier hs-var">det2</span></a><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679080278"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080279"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679080280"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080281"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-807"></a><span>
</span><a name="line-808"></a><span class="hs-keyword">data</span><span> </span><a name="SegColinear"><a href="AronGraphic.html#SegColinear"><span class="hs-identifier">SegColinear</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Colinear3"><a href="AronGraphic.html#Colinear3"><span class="hs-identifier">Colinear3</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Colinear4"><a href="AronGraphic.html#Colinear4"><span class="hs-identifier">Colinear4</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="None"><a href="AronGraphic.html#None"><span class="hs-identifier">None</span></a></a><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-809"></a><span class="hs-comment">{-| 
    === If four points are colinear then return 'Colinear4'
    === If only three points are colinear then return 'Colinear3'
    === Else return 'None'

    The function uses 'isColinear'
-}</span><span>
</span><a name="line-816"></a><span class="hs-identifier">twoSegColinear</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="AronGraphic.html#SegColinear"><span class="hs-identifier hs-type">SegColinear</span></a><span>
</span><a name="line-817"></a><a name="twoSegColinear"><a href="AronGraphic.html#twoSegColinear"><span class="hs-identifier">twoSegColinear</span></a></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621679080287"><a href="#local-6989586621679080287"><span class="hs-identifier">p0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080288"><a href="#local-6989586621679080288"><span class="hs-identifier">p1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679080289"><a href="#local-6989586621679080289"><span class="hs-identifier">q0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080290"><a href="#local-6989586621679080290"><span class="hs-identifier">q1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080291"><span class="hs-identifier hs-var">is0</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679080292"><span class="hs-identifier hs-var">is1</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="AronGraphic.html#Colinear4"><span class="hs-identifier hs-var">Colinear4</span></a><span> </span><span class="hs-keyword">else</span><span>
</span><a name="line-818"></a><span>                                            </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080291"><span class="hs-identifier hs-var">is0</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679080292"><span class="hs-identifier hs-var">is1</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080293"><span class="hs-identifier hs-var">is0'</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679080294"><span class="hs-identifier hs-var">is1'</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="AronGraphic.html#Colinear3"><span class="hs-identifier hs-var">Colinear3</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="AronGraphic.html#None"><span class="hs-identifier hs-var">None</span></a><span>
</span><a name="line-819"></a><span>           </span><span class="hs-keyword">where</span><span>
</span><a name="line-820"></a><span>                </span><a name="local-6989586621679080291"><a href="#local-6989586621679080291"><span class="hs-identifier">is0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#isColinear"><span class="hs-identifier hs-var">isColinear</span></a><span> </span><a href="#local-6989586621679080287"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679080289"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679080290"><span class="hs-identifier hs-var">q1</span></a><span>
</span><a name="line-821"></a><span>                </span><a name="local-6989586621679080292"><a href="#local-6989586621679080292"><span class="hs-identifier">is1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#isColinear"><span class="hs-identifier hs-var">isColinear</span></a><span> </span><a href="#local-6989586621679080288"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679080289"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679080290"><span class="hs-identifier hs-var">q1</span></a><span>
</span><a name="line-822"></a><span>                </span><a name="local-6989586621679080293"><a href="#local-6989586621679080293"><span class="hs-identifier">is0'</span></a></a><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#isColinear"><span class="hs-identifier hs-var">isColinear</span></a><span> </span><a href="#local-6989586621679080289"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679080287"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679080288"><span class="hs-identifier hs-var">p1</span></a><span>
</span><a name="line-823"></a><span>                </span><a name="local-6989586621679080294"><a href="#local-6989586621679080294"><span class="hs-identifier">is1'</span></a></a><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#isColinear"><span class="hs-identifier hs-var">isColinear</span></a><span> </span><a href="#local-6989586621679080290"><span class="hs-identifier hs-var">q1</span></a><span> </span><a href="#local-6989586621679080287"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679080288"><span class="hs-identifier hs-var">p1</span></a><span>
</span><a name="line-824"></a><span>
</span><a name="line-825"></a><span>
</span><a name="line-826"></a><span class="hs-comment">{-| 
    === Find the intersection of two lines, intersect two lines 
    ==== Assume that two endpoints of each segment are not overlapped.(segment has non-zero length)
    __NOTE__ This function is ONLY for two dimensions

    ===== If four points are colinear: return Nothing, see 'twoSegColinear' 

    &gt;let p0 = Vertex3 0 0 0 
    &gt;let p1 = Vertex3 1 0 0 
    &gt;let q0 = Vertex3 1 0 0 
    &gt;let q1 = Vertex3 2 0 0 
    &gt;intersectLine p0 p1 q0 q1 
    &gt;Nothing

    * two dimensions determinant is used here

    * The Intersection of two line is __NOT__ necessary in their segments 
    * If two lines are parallel, then return Nothing  
    * Else return the intersection and \( s, t \)
    
    Given four pts: \(p_0, p_1\) and \(q_0, q_1\)
    \[
        \begin{aligned}
        v_0 &amp;= p_1 - p_0 \\  
        v_1 &amp;= q_1 - q_0 \\
        A &amp;= \begin{bmatrix}
             v_0 &amp; v_1
             \end{bmatrix} \\
        \det A &amp;= 0  \quad \text{they are linearly dependent }
        \end{aligned} 
    \]

    @
    data Seg a = Seg a a
    fun::Seg GLflat -&gt; Seg GLfloat -&gt; Maybe(Vertex3 GLfloat, [[GLfloat]])
    fun (Seg (Vertex3 x0 y0 z0) (Vertex3 x1 y1 z1)) = Nothing
    @

    &lt;http://localhost/pdf/intersectionLine.pdf intersect_line&gt;

    @
    intersectLine p0 p1 q0 q1 
    (Just ((Vertex3 2.0 2.0 0), [[2.0],[2.0]]))= intersectLine 
                                                (Vertex3 0 0 0) 
                                                (Vertex3 1 1 0) 
                                                (Vertex3 2 0 0) 
                                                (Vertex3 2 1 0)
    @
-}</span><span>
</span><a name="line-875"></a><span class="hs-identifier">intersectLine</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-876"></a><span>               </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-877"></a><span>               </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-878"></a><span>               </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-879"></a><span>               </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-880"></a><a name="intersectLine"><a href="AronGraphic.html#intersectLine"><span class="hs-identifier">intersectLine</span></a></a><span> </span><a name="local-6989586621679080295"><a href="#local-6989586621679080295"><span class="hs-identifier">p0</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679080296"><a href="#local-6989586621679080296"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679080297"><a href="#local-6989586621679080297"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679080298"><a href="#local-6989586621679080298"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-881"></a><span>              </span><a name="local-6989586621679080299"><a href="#local-6989586621679080299"><span class="hs-identifier">p1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679080300"><a href="#local-6989586621679080300"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679080301"><a href="#local-6989586621679080301"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679080302"><a href="#local-6989586621679080302"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-882"></a><span>              </span><a name="local-6989586621679080303"><a href="#local-6989586621679080303"><span class="hs-identifier">q0</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679080304"><a href="#local-6989586621679080304"><span class="hs-identifier">a0</span></a></a><span> </span><a name="local-6989586621679080305"><a href="#local-6989586621679080305"><span class="hs-identifier">b0</span></a></a><span> </span><a name="local-6989586621679080306"><a href="#local-6989586621679080306"><span class="hs-identifier">c0</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-883"></a><span>              </span><a name="local-6989586621679080307"><a href="#local-6989586621679080307"><span class="hs-identifier">q1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679080308"><a href="#local-6989586621679080308"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679080309"><a href="#local-6989586621679080309"><span class="hs-identifier">b1</span></a></a><span> </span><a name="local-6989586621679080310"><a href="#local-6989586621679080310"><span class="hs-identifier">c1</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-884"></a><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679080314"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679080311"><span class="hs-identifier hs-var">c4</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="AronGraphic.html#Colinear4"><span class="hs-identifier hs-var">Colinear4</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080322"><span class="hs-identifier hs-var">pt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080320"><span class="hs-identifier hs-var">st</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-885"></a><span>              </span><span class="hs-keyword">where</span><span>
</span><a name="line-886"></a><span class="hs-comment">--                is0 = isColinear p0 q0 q1</span><span>
</span><a name="line-887"></a><span class="hs-comment">--                is1 = isColinear p1 q0 q1</span><span>
</span><a name="line-888"></a><span class="hs-comment">--</span><span>
</span><a name="line-889"></a><span>                </span><span class="hs-comment">-- if c4 == Colinear4 then four pts are colinear</span><span>
</span><a name="line-890"></a><span>                </span><a name="local-6989586621679080311"><a href="#local-6989586621679080311"><span class="hs-identifier">c4</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#twoSegColinear"><span class="hs-identifier hs-var">twoSegColinear</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080295"><span class="hs-identifier hs-var">p0</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080299"><span class="hs-identifier hs-var">p1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080303"><span class="hs-identifier hs-var">q0</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080307"><span class="hs-identifier hs-var">q1</span></a><span class="hs-special">)</span><span>
</span><a name="line-891"></a><span>                </span><a name="local-6989586621679080312"><a href="#local-6989586621679080312"><span class="hs-identifier">w1</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080325"><span class="hs-identifier hs-var">v2a</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679080299"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679080295"><span class="hs-identifier hs-var">p0</span></a><span>  </span><span class="hs-comment">-- [[1, 2]]</span><span>
</span><a name="line-892"></a><span>                </span><a name="local-6989586621679080313"><a href="#local-6989586621679080313"><span class="hs-identifier">w2</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080325"><span class="hs-identifier hs-var">v2a</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679080307"><span class="hs-identifier hs-var">q1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679080303"><span class="hs-identifier hs-var">q0</span></a><span>  </span><span class="hs-comment">-- [[4, 5]]</span><span>
</span><a name="line-893"></a><span>                </span><span class="hs-comment">-- if d == 0 then two lines are parallel</span><span>
</span><a name="line-894"></a><span>                </span><a name="local-6989586621679080314"><a href="#local-6989586621679080314"><span class="hs-identifier">d</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#det2"><span class="hs-identifier hs-var">det2</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679080312"><span class="hs-identifier hs-var">w1</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679080313"><span class="hs-identifier hs-var">w2</span></a><span> </span><span class="hs-comment">-- det2 [[1, 2], [4, 5]]</span><span>
</span><a name="line-895"></a><span>                </span><a name="local-6989586621679080315"><a href="#local-6989586621679080315"><span class="hs-identifier">v01</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080299"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679080295"><span class="hs-identifier hs-var">p0</span></a><span> </span><span class="hs-comment">-- p&#8321; - p&#8320;  f(t) = p&#8320; + s(p&#8321; - p&#8320;)</span><span>
</span><a name="line-896"></a><span>                </span><a name="local-6989586621679080316"><a href="#local-6989586621679080316"><span class="hs-identifier">u01</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080307"><span class="hs-identifier hs-var">q1</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679080303"><span class="hs-identifier hs-var">q0</span></a><span> </span><span class="hs-comment">-- q&#8321; - q&#8320;  f(s) = q&#8320; + t(q&#8321; - q&#8320;)</span><span>
</span><a name="line-897"></a><span>                </span><a name="local-6989586621679080317"><a href="#local-6989586621679080317"><span class="hs-identifier">ma</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679080323"><span class="hs-identifier hs-var">ne</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080300"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679080296"><span class="hs-identifier hs-var">x0</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080308"><span class="hs-identifier hs-var">a1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679080304"><span class="hs-identifier hs-var">a0</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>  </span><span class="hs-comment">-- [s]</span><span>
</span><a name="line-898"></a><span>                      </span><span class="hs-special">[</span><a href="#local-6989586621679080323"><span class="hs-identifier hs-var">ne</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080301"><span class="hs-identifier hs-var">y1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679080297"><span class="hs-identifier hs-var">y0</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080309"><span class="hs-identifier hs-var">b1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679080305"><span class="hs-identifier hs-var">b0</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- [t]</span><span>
</span><a name="line-899"></a><span>                </span><a name="local-6989586621679080318"><a href="#local-6989586621679080318"><span class="hs-identifier">ivm</span></a></a><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#inv2"><span class="hs-identifier hs-var">inv2</span></a><span> </span><a href="#local-6989586621679080317"><span class="hs-identifier hs-var">ma</span></a><span>
</span><a name="line-900"></a><span>                </span><a name="local-6989586621679080319"><a href="#local-6989586621679080319"><span class="hs-identifier">v</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679080296"><span class="hs-identifier hs-var">x0</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679080304"><span class="hs-identifier hs-var">a0</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- p&#8320; - q&#8320;</span><span>
</span><a name="line-901"></a><span>                      </span><span class="hs-special">[</span><a href="#local-6989586621679080297"><span class="hs-identifier hs-var">y0</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679080305"><span class="hs-identifier hs-var">b0</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-902"></a><span>                </span><span class="hs-comment">-- solve s and t</span><span>
</span><a name="line-903"></a><span>                </span><span class="hs-comment">-- [s]</span><span>
</span><a name="line-904"></a><span>                </span><span class="hs-comment">-- [t]</span><span>
</span><a name="line-905"></a><span>                </span><a name="local-6989586621679080320"><a href="#local-6989586621679080320"><span class="hs-identifier">st</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#multiMat"><span class="hs-identifier hs-var">multiMat</span></a><span> </span><a href="#local-6989586621679080318"><span class="hs-identifier hs-var">ivm</span></a><span> </span><a href="#local-6989586621679080319"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-906"></a><span>                </span><span class="hs-comment">-- |  st = ivm *. v</span><span>
</span><a name="line-907"></a><span>                </span><a name="local-6989586621679080321"><a href="#local-6989586621679080321"><span class="hs-identifier">s</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">head</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080320"><span class="hs-identifier hs-var">st</span></a><span> </span><span class="hs-comment">-- st = [[s],[t]]</span><span>
</span><a name="line-908"></a><span>                </span><a name="local-6989586621679080322"><a href="#local-6989586621679080322"><span class="hs-identifier">pt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080295"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="AronGraphic.html#%2B%3A"><span class="hs-operator hs-var">+:</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080321"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="AronGraphic.html#%2A%3A"><span class="hs-operator hs-var">*:</span></a><span> </span><a href="#local-6989586621679080315"><span class="hs-identifier hs-var">v01</span></a><span class="hs-special">)</span><span>
</span><a name="line-909"></a><span>                </span><a name="local-6989586621679080323"><a href="#local-6989586621679080323"><span class="hs-identifier">ne</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">negate</span><span>
</span><a name="line-910"></a><span>                </span><span class="hs-special">(</span><a name="local-6989586621679080324"><a href="#local-6989586621679080324"><span class="hs-operator">*.</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a name="local-6989586621679080326"><a href="#local-6989586621679080326"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080327"><a href="#local-6989586621679080327"><span class="hs-identifier">b</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679080328"><a href="#local-6989586621679080328"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080329"><a href="#local-6989586621679080329"><span class="hs-identifier">d</span></a></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a name="local-6989586621679080330"><a href="#local-6989586621679080330"><span class="hs-identifier">x</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679080331"><a href="#local-6989586621679080331"><span class="hs-identifier">y</span></a></a><span class="hs-special">]</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679080326"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679080330"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679080327"><span class="hs-identifier hs-var">b</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679080331"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679080328"><span class="hs-identifier hs-var">c</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679080330"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679080329"><span class="hs-identifier hs-var">d</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679080331"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-911"></a><span>
</span><a name="line-912"></a><span>                </span><a name="local-6989586621679080325"><a href="#local-6989586621679080325"><span class="hs-identifier">v2a</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679080332"><a href="#local-6989586621679080332"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679080333"><a href="#local-6989586621679080333"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679080334"><a href="#local-6989586621679080334"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679080332"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080333"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-913"></a><span>
</span><a name="line-914"></a><span class="hs-comment">-- | Four Vertex3 in a list</span><span>
</span><a name="line-915"></a><span class="hs-comment">-- </span><span>
</span><a name="line-916"></a><span class="hs-identifier">intersectLine'</span><span class="hs-glyph">::</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-917"></a><span>               </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-918"></a><a name="intersectLine%27"><a href="AronGraphic.html#intersectLine%27"><span class="hs-identifier">intersectLine'</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621679080335"><a href="#local-6989586621679080335"><span class="hs-identifier">p0</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679080336"><a href="#local-6989586621679080336"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679080337"><a href="#local-6989586621679080337"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679080338"><a href="#local-6989586621679080338"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-919"></a><span>               </span><span class="hs-special">,</span><a name="local-6989586621679080339"><a href="#local-6989586621679080339"><span class="hs-identifier">p1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679080340"><a href="#local-6989586621679080340"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679080341"><a href="#local-6989586621679080341"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679080342"><a href="#local-6989586621679080342"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-920"></a><span>               </span><span class="hs-special">,</span><a name="local-6989586621679080343"><a href="#local-6989586621679080343"><span class="hs-identifier">q0</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679080344"><a href="#local-6989586621679080344"><span class="hs-identifier">a0</span></a></a><span> </span><a name="local-6989586621679080345"><a href="#local-6989586621679080345"><span class="hs-identifier">b0</span></a></a><span> </span><a name="local-6989586621679080346"><a href="#local-6989586621679080346"><span class="hs-identifier">c0</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-921"></a><span>               </span><span class="hs-special">,</span><a name="local-6989586621679080347"><a href="#local-6989586621679080347"><span class="hs-identifier">q1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679080348"><a href="#local-6989586621679080348"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679080349"><a href="#local-6989586621679080349"><span class="hs-identifier">b1</span></a></a><span> </span><a name="local-6989586621679080350"><a href="#local-6989586621679080350"><span class="hs-identifier">c1</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-922"></a><span>               </span><span class="hs-special">]</span><span>
</span><a name="line-923"></a><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679080351"><span class="hs-identifier hs-var">is0</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679080352"><span class="hs-identifier hs-var">is1</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080360"><span class="hs-identifier hs-var">pt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080358"><span class="hs-identifier hs-var">st</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-924"></a><span>              </span><span class="hs-keyword">where</span><span>
</span><a name="line-925"></a><span>                </span><a name="local-6989586621679080351"><a href="#local-6989586621679080351"><span class="hs-identifier">is0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#isColinear"><span class="hs-identifier hs-var">isColinear</span></a><span> </span><a href="#local-6989586621679080335"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679080343"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679080347"><span class="hs-identifier hs-var">q1</span></a><span>
</span><a name="line-926"></a><span>                </span><a name="local-6989586621679080352"><a href="#local-6989586621679080352"><span class="hs-identifier">is1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#isColinear"><span class="hs-identifier hs-var">isColinear</span></a><span> </span><a href="#local-6989586621679080339"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679080343"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679080347"><span class="hs-identifier hs-var">q1</span></a><span>
</span><a name="line-927"></a><span>                </span><a name="local-6989586621679080353"><a href="#local-6989586621679080353"><span class="hs-identifier">v01</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080339"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679080335"><span class="hs-identifier hs-var">p0</span></a><span> </span><span class="hs-comment">-- p&#8321; - p&#8320;  f(t) = p&#8320; + s(p&#8321; - p&#8320;)</span><span>
</span><a name="line-928"></a><span>                </span><a name="local-6989586621679080354"><a href="#local-6989586621679080354"><span class="hs-identifier">u01</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080347"><span class="hs-identifier hs-var">q1</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679080343"><span class="hs-identifier hs-var">q0</span></a><span> </span><span class="hs-comment">-- q&#8321; - q&#8320;  f(s) = q&#8320; + t(q&#8321; - q&#8320;)</span><span>
</span><a name="line-929"></a><span>                </span><a name="local-6989586621679080355"><a href="#local-6989586621679080355"><span class="hs-identifier">ma</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679080361"><span class="hs-identifier hs-var">ne</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080340"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679080336"><span class="hs-identifier hs-var">x0</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080348"><span class="hs-identifier hs-var">a1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679080344"><span class="hs-identifier hs-var">a0</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>  </span><span class="hs-comment">-- [s]</span><span>
</span><a name="line-930"></a><span>                      </span><span class="hs-special">[</span><a href="#local-6989586621679080361"><span class="hs-identifier hs-var">ne</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080341"><span class="hs-identifier hs-var">y1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679080337"><span class="hs-identifier hs-var">y0</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080349"><span class="hs-identifier hs-var">b1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679080345"><span class="hs-identifier hs-var">b0</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- [t]</span><span>
</span><a name="line-931"></a><span>                </span><a name="local-6989586621679080356"><a href="#local-6989586621679080356"><span class="hs-identifier">ivm</span></a></a><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#inv2"><span class="hs-identifier hs-var">inv2</span></a><span> </span><a href="#local-6989586621679080355"><span class="hs-identifier hs-var">ma</span></a><span>
</span><a name="line-932"></a><span>                </span><a name="local-6989586621679080357"><a href="#local-6989586621679080357"><span class="hs-identifier">v</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679080336"><span class="hs-identifier hs-var">x0</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679080344"><span class="hs-identifier hs-var">a0</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- p&#8320; - q&#8320;</span><span>
</span><a name="line-933"></a><span>                      </span><span class="hs-special">[</span><a href="#local-6989586621679080337"><span class="hs-identifier hs-var">y0</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679080345"><span class="hs-identifier hs-var">b0</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-934"></a><span>                </span><span class="hs-comment">-- solve s and t</span><span>
</span><a name="line-935"></a><span>                </span><span class="hs-comment">-- [s]</span><span>
</span><a name="line-936"></a><span>                </span><span class="hs-comment">-- [t]</span><span>
</span><a name="line-937"></a><span>                </span><a name="local-6989586621679080358"><a href="#local-6989586621679080358"><span class="hs-identifier">st</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#multiMat"><span class="hs-identifier hs-var">multiMat</span></a><span> </span><a href="#local-6989586621679080356"><span class="hs-identifier hs-var">ivm</span></a><span> </span><a href="#local-6989586621679080357"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-938"></a><span>                </span><span class="hs-comment">-- |  st = ivm *. v</span><span>
</span><a name="line-939"></a><span>                </span><a name="local-6989586621679080359"><a href="#local-6989586621679080359"><span class="hs-identifier">s</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">head</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080358"><span class="hs-identifier hs-var">st</span></a><span> </span><span class="hs-comment">-- st = [[s],[t]]</span><span>
</span><a name="line-940"></a><span>                </span><a name="local-6989586621679080360"><a href="#local-6989586621679080360"><span class="hs-identifier">pt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080335"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="AronGraphic.html#%2B%3A"><span class="hs-operator hs-var">+:</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080359"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="AronGraphic.html#%2A%3A"><span class="hs-operator hs-var">*:</span></a><span> </span><a href="#local-6989586621679080353"><span class="hs-identifier hs-var">v01</span></a><span class="hs-special">)</span><span>
</span><a name="line-941"></a><span>                </span><a name="local-6989586621679080361"><a href="#local-6989586621679080361"><span class="hs-identifier">ne</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">negate</span><span>
</span><a name="line-942"></a><span>                </span><span class="hs-special">(</span><a name="local-6989586621679080362"><a href="#local-6989586621679080362"><span class="hs-operator">*.</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a name="local-6989586621679080363"><a href="#local-6989586621679080363"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080364"><a href="#local-6989586621679080364"><span class="hs-identifier">b</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679080365"><a href="#local-6989586621679080365"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080366"><a href="#local-6989586621679080366"><span class="hs-identifier">d</span></a></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a name="local-6989586621679080367"><a href="#local-6989586621679080367"><span class="hs-identifier">x</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679080368"><a href="#local-6989586621679080368"><span class="hs-identifier">y</span></a></a><span class="hs-special">]</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679080363"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679080367"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679080364"><span class="hs-identifier hs-var">b</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679080368"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679080365"><span class="hs-identifier hs-var">c</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679080367"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679080366"><span class="hs-identifier hs-var">d</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679080368"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-943"></a><span>
</span><a name="line-944"></a><span class="hs-comment">-- | TODO: fix, the code only handles two dimension.</span><span>
</span><a name="line-945"></a><span class="hs-comment">-- | Given a point: p0, line: q0 q1</span><span>
</span><a name="line-946"></a><span class="hs-comment">-- | Compute the distance from p0 to line: q0 q1</span><span>
</span><a name="line-947"></a><span class="hs-comment">-- | </span><span>
</span><a name="line-948"></a><span class="hs-identifier">pointToLine</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-949"></a><span>             </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-950"></a><span>             </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-951"></a><span>             </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-952"></a><a name="pointToLine"><a href="AronGraphic.html#pointToLine"><span class="hs-identifier">pointToLine</span></a></a><span> </span><a name="local-6989586621679080369"><a href="#local-6989586621679080369"><span class="hs-identifier">p0</span></a></a><span> </span><a name="local-6989586621679080370"><a href="#local-6989586621679080370"><span class="hs-identifier">q0</span></a></a><span> </span><a name="local-6989586621679080371"><a href="#local-6989586621679080371"><span class="hs-identifier">q1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679080372"><span class="hs-identifier hs-var">is</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-number">0.0</span><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679080377"><span class="hs-identifier hs-var">di</span></a><span>
</span><a name="line-953"></a><span>            </span><span class="hs-keyword">where</span><span>
</span><a name="line-954"></a><span>                </span><a name="local-6989586621679080372"><a href="#local-6989586621679080372"><span class="hs-identifier">is</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#isColinear"><span class="hs-identifier hs-var">isColinear</span></a><span> </span><a href="#local-6989586621679080369"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679080370"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679080371"><span class="hs-identifier hs-var">q1</span></a><span> </span><span class="hs-comment">-- if three pts are colinear, return zero</span><span>
</span><a name="line-955"></a><span>                </span><a name="local-6989586621679080373"><a href="#local-6989586621679080373"><span class="hs-identifier">nr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#perpcw"><span class="hs-identifier hs-var">perpcw</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080371"><span class="hs-identifier hs-var">q1</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679080370"><span class="hs-identifier hs-var">q0</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- normal of q0 -&gt; q1</span><span>
</span><a name="line-956"></a><span>                </span><a name="local-6989586621679080374"><a href="#local-6989586621679080374"><span class="hs-identifier">p1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080369"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="AronGraphic.html#%2B%3A"><span class="hs-operator hs-var">+:</span></a><span> </span><a href="#local-6989586621679080373"><span class="hs-identifier hs-var">nr</span></a><span> </span><span class="hs-comment">-- p0 +: t*normal where t = 1</span><span>
</span><a name="line-957"></a><span>                </span><a name="local-6989586621679080375"><a href="#local-6989586621679080375"><span class="hs-identifier">vx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fromJust</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#intersectLine"><span class="hs-identifier hs-var">intersectLine</span></a><span> </span><a href="#local-6989586621679080369"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679080374"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679080370"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679080371"><span class="hs-identifier hs-var">q1</span></a><span>  </span><span class="hs-comment">-- compute the insection of two lines</span><span>
</span><a name="line-958"></a><span>
</span><a name="line-959"></a><span>                </span><span class="hs-comment">-- square root can not be represented in Rational number in general, </span><span>
</span><a name="line-960"></a><span>                </span><span class="hs-comment">-- Convert: Vertex3 Rational =&gt; Vertex3 GLfloat</span><span>
</span><a name="line-961"></a><span>                </span><a name="local-6989586621679080376"><a href="#local-6989586621679080376"><span class="hs-identifier">vx'</span></a></a><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">realToFrac</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080375"><span class="hs-identifier hs-var">vx</span></a><span>
</span><a name="line-962"></a><span>                </span><a name="local-6989586621679080377"><a href="#local-6989586621679080377"><span class="hs-identifier">di</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#dist"><span class="hs-identifier hs-var">dist</span></a><span> </span><a href="#local-6989586621679080369"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679080376"><span class="hs-identifier hs-var">vx'</span></a><span>
</span><a name="line-963"></a><span>
</span><a name="line-964"></a><span>
</span><a name="line-965"></a><span class="hs-comment">{-| 
    === Find the intersection of two segments, 
    ==== Assume that two endpoints of each segment are not overlapped.(segment has non-zero length)
    __NOTE__ This function is ONLY for two dimensions

    __NOTE__ endpoins of different segments may be coincide  

    &gt; intersectSeg (p0, p1) (q0, q1)
    &gt; Nothing
    &gt; 
    &gt; intersectSeg (p0, p1) (q0, q1)
    &gt; Vertex3 x y z 

    The function is based on 'intersectLine' 

    TODO: add test cases
-}</span><span>
</span><a name="line-982"></a><span class="hs-identifier">intersectSeg</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span>
</span><a name="line-983"></a><a name="intersectSeg"><a href="AronGraphic.html#intersectSeg"><span class="hs-identifier">intersectSeg</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679080378"><a href="#local-6989586621679080378"><span class="hs-identifier">p0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080379"><a href="#local-6989586621679080379"><span class="hs-identifier">p1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679080380"><a href="#local-6989586621679080380"><span class="hs-identifier">q0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080381"><a href="#local-6989586621679080381"><span class="hs-identifier">q1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679080382"><span class="hs-identifier hs-var">is</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-984"></a><span>                                      </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679080383"><a href="#local-6989586621679080383"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080384"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="AronGraphic.html#%2208"><span class="hs-operator hs-var">&#8712;</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">0.0</span><span class="hs-special">,</span><span> </span><span class="hs-number">1.0</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080385"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="AronGraphic.html#%2208"><span class="hs-operator hs-var">&#8712;</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">0.0</span><span class="hs-special">,</span><span> </span><span class="hs-number">1.0</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621679080383"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-985"></a><span>                                        </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679080384"><a href="#local-6989586621679080384"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">head</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679080383"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-986"></a><span>                                              </span><a name="local-6989586621679080385"><a href="#local-6989586621679080385"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">last</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">last</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679080383"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-987"></a><span>                                      </span><span class="hs-identifier">_</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-988"></a><span>               </span><span class="hs-keyword">where</span><span>
</span><a name="line-989"></a><span>                </span><a name="local-6989586621679080382"><a href="#local-6989586621679080382"><span class="hs-identifier">is</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#intersectLine"><span class="hs-identifier hs-var">intersectLine</span></a><span> </span><a href="#local-6989586621679080378"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679080379"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679080380"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679080381"><span class="hs-identifier hs-var">q1</span></a><span>
</span><a name="line-990"></a><span>
</span><a name="line-991"></a><span class="hs-identifier">intersectSegNoEndPt</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span>
</span><a name="line-992"></a><a name="intersectSegNoEndPt"><a href="AronGraphic.html#intersectSegNoEndPt"><span class="hs-identifier">intersectSegNoEndPt</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679080386"><a href="#local-6989586621679080386"><span class="hs-identifier">p0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080387"><a href="#local-6989586621679080387"><span class="hs-identifier">p1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679080388"><a href="#local-6989586621679080388"><span class="hs-identifier">q0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080389"><a href="#local-6989586621679080389"><span class="hs-identifier">q1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679080390"><span class="hs-identifier hs-var">is</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-993"></a><span>                                      </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679080391"><a href="#local-6989586621679080391"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679080392"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0.0</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679080392"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">1.0</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679080393"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0.0</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679080393"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">1.0</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080392"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="AronGraphic.html#%2208"><span class="hs-operator hs-var">&#8712;</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">0.0</span><span class="hs-special">,</span><span> </span><span class="hs-number">1.0</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080393"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="AronGraphic.html#%2208"><span class="hs-operator hs-var">&#8712;</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">0.0</span><span class="hs-special">,</span><span> </span><span class="hs-number">1.0</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621679080391"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-994"></a><span>                                        </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679080392"><a href="#local-6989586621679080392"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">head</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679080391"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-995"></a><span>                                              </span><a name="local-6989586621679080393"><a href="#local-6989586621679080393"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">last</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">last</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679080391"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-996"></a><span>                                      </span><span class="hs-identifier">_</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-997"></a><span>               </span><span class="hs-keyword">where</span><span>
</span><a name="line-998"></a><span>                </span><a name="local-6989586621679080390"><a href="#local-6989586621679080390"><span class="hs-identifier">is</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#intersectLine"><span class="hs-identifier hs-var">intersectLine</span></a><span> </span><a href="#local-6989586621679080386"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679080387"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679080388"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679080389"><span class="hs-identifier hs-var">q1</span></a><span>
</span><a name="line-999"></a><span>
</span><a name="line-1000"></a><span class="hs-identifier">isIntersectedSeg</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1001"></a><a name="isIntersectedSeg"><a href="AronGraphic.html#isIntersectedSeg"><span class="hs-identifier">isIntersectedSeg</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679080394"><a href="#local-6989586621679080394"><span class="hs-identifier">p0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080395"><a href="#local-6989586621679080395"><span class="hs-identifier">p1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679080396"><a href="#local-6989586621679080396"><span class="hs-identifier">q0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080397"><a href="#local-6989586621679080397"><span class="hs-identifier">q1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679080398"><span class="hs-identifier hs-var">is</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1002"></a><span>                                      </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679080399"><a href="#local-6989586621679080399"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080400"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="AronGraphic.html#%2208"><span class="hs-operator hs-var">&#8712;</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">0.0</span><span class="hs-special">,</span><span> </span><span class="hs-number">1.0</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080401"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="AronGraphic.html#%2208"><span class="hs-operator hs-var">&#8712;</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">0.0</span><span class="hs-special">,</span><span> </span><span class="hs-number">1.0</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1003"></a><span>                                        </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679080400"><a href="#local-6989586621679080400"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">head</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679080399"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1004"></a><span>                                              </span><a name="local-6989586621679080401"><a href="#local-6989586621679080401"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">last</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">last</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679080399"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1005"></a><span>                                      </span><span class="hs-identifier">_</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1006"></a><span>               </span><span class="hs-keyword">where</span><span>
</span><a name="line-1007"></a><span>                </span><a name="local-6989586621679080398"><a href="#local-6989586621679080398"><span class="hs-identifier">is</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#intersectLine"><span class="hs-identifier hs-var">intersectLine</span></a><span> </span><a href="#local-6989586621679080394"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679080395"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679080396"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679080397"><span class="hs-identifier hs-var">q1</span></a><span>
</span><a name="line-1008"></a><span>
</span><a name="line-1009"></a><span class="hs-identifier">intersectLineR</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1010"></a><span>                </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1011"></a><span>                </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1012"></a><span>                </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1013"></a><span>                </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">Rational</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Rational</span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1014"></a><a name="intersectLineR"><a href="AronGraphic.html#intersectLineR"><span class="hs-identifier">intersectLineR</span></a></a><span> </span><a name="local-6989586621679080402"><a href="#local-6989586621679080402"><span class="hs-identifier">p0</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679080403"><a href="#local-6989586621679080403"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679080404"><a href="#local-6989586621679080404"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679080405"><a href="#local-6989586621679080405"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1015"></a><span>               </span><a name="local-6989586621679080406"><a href="#local-6989586621679080406"><span class="hs-identifier">p1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679080407"><a href="#local-6989586621679080407"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679080408"><a href="#local-6989586621679080408"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679080409"><a href="#local-6989586621679080409"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1016"></a><span>               </span><a name="local-6989586621679080410"><a href="#local-6989586621679080410"><span class="hs-identifier">q0</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679080411"><a href="#local-6989586621679080411"><span class="hs-identifier">a0</span></a></a><span> </span><a name="local-6989586621679080412"><a href="#local-6989586621679080412"><span class="hs-identifier">b0</span></a></a><span> </span><a name="local-6989586621679080413"><a href="#local-6989586621679080413"><span class="hs-identifier">c0</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1017"></a><span>               </span><a name="local-6989586621679080414"><a href="#local-6989586621679080414"><span class="hs-identifier">q1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679080415"><a href="#local-6989586621679080415"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679080416"><a href="#local-6989586621679080416"><span class="hs-identifier">b1</span></a></a><span> </span><a name="local-6989586621679080417"><a href="#local-6989586621679080417"><span class="hs-identifier">c1</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1018"></a><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679080418"><span class="hs-identifier hs-var">is0</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679080419"><span class="hs-identifier hs-var">is1</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080430"><span class="hs-identifier hs-var">pt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080427"><span class="hs-identifier hs-var">st</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1019"></a><span>               </span><span class="hs-keyword">where</span><span>
</span><a name="line-1020"></a><span>                </span><a name="local-6989586621679080418"><a href="#local-6989586621679080418"><span class="hs-identifier">is0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#isColinear"><span class="hs-identifier hs-var">isColinear</span></a><span> </span><a href="#local-6989586621679080402"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679080410"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679080414"><span class="hs-identifier hs-var">q1</span></a><span>
</span><a name="line-1021"></a><span>                </span><a name="local-6989586621679080419"><a href="#local-6989586621679080419"><span class="hs-identifier">is1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#isColinear"><span class="hs-identifier hs-var">isColinear</span></a><span> </span><a href="#local-6989586621679080406"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679080410"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679080414"><span class="hs-identifier hs-var">q1</span></a><span>
</span><a name="line-1022"></a><span>                </span><a name="local-6989586621679080420"><a href="#local-6989586621679080420"><span class="hs-identifier">v01</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toRational</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679080406"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679080402"><span class="hs-identifier hs-var">p0</span></a><span> </span><span class="hs-comment">-- p&#8321; - p&#8320;  f(t) = p&#8320; + s(p&#8321; - p&#8320;)</span><span>
</span><a name="line-1023"></a><span>                </span><a name="local-6989586621679080421"><a href="#local-6989586621679080421"><span class="hs-identifier">u01</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080414"><span class="hs-identifier hs-var">q1</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679080410"><span class="hs-identifier hs-var">q0</span></a><span> </span><span class="hs-comment">-- q&#8321; - q&#8320;  f(s) = q&#8320; + t(q&#8321; - q&#8320;)</span><span>
</span><a name="line-1024"></a><span>                </span><a name="local-6989586621679080422"><a href="#local-6989586621679080422"><span class="hs-identifier">ma</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679080431"><span class="hs-identifier hs-var">ne</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080407"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679080403"><span class="hs-identifier hs-var">x0</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080415"><span class="hs-identifier hs-var">a1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679080411"><span class="hs-identifier hs-var">a0</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>  </span><span class="hs-comment">-- [s]</span><span>
</span><a name="line-1025"></a><span>                      </span><span class="hs-special">[</span><a href="#local-6989586621679080431"><span class="hs-identifier hs-var">ne</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080408"><span class="hs-identifier hs-var">y1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679080404"><span class="hs-identifier hs-var">y0</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080416"><span class="hs-identifier hs-var">b1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679080412"><span class="hs-identifier hs-var">b0</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- [t]</span><span>
</span><a name="line-1026"></a><span>                </span><a name="local-6989586621679080423"><a href="#local-6989586621679080423"><span class="hs-identifier">ma'</span></a></a><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080437"><span class="hs-identifier hs-var">toR</span></a><span> </span><a href="#local-6989586621679080422"><span class="hs-identifier hs-var">ma</span></a><span>
</span><a name="line-1027"></a><span>                </span><a name="local-6989586621679080424"><a href="#local-6989586621679080424"><span class="hs-identifier">ivm</span></a></a><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080432"><span class="hs-identifier hs-var">invR</span></a><span> </span><a href="#local-6989586621679080423"><span class="hs-identifier hs-var">ma'</span></a><span>
</span><a name="line-1028"></a><span>                </span><a name="local-6989586621679080425"><a href="#local-6989586621679080425"><span class="hs-identifier">v'</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679080403"><span class="hs-identifier hs-var">x0</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679080411"><span class="hs-identifier hs-var">a0</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- p&#8320; - q&#8320;</span><span>
</span><a name="line-1029"></a><span>                      </span><span class="hs-special">[</span><a href="#local-6989586621679080404"><span class="hs-identifier hs-var">y0</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679080412"><span class="hs-identifier hs-var">b0</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-1030"></a><span>                </span><a name="local-6989586621679080426"><a href="#local-6989586621679080426"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080437"><span class="hs-identifier hs-var">toR</span></a><span> </span><a href="#local-6989586621679080425"><span class="hs-identifier hs-var">v'</span></a><span>
</span><a name="line-1031"></a><span>                </span><span class="hs-comment">-- solve s and t</span><span>
</span><a name="line-1032"></a><span>                </span><span class="hs-comment">-- [s]</span><span>
</span><a name="line-1033"></a><span>                </span><span class="hs-comment">-- [t]</span><span>
</span><a name="line-1034"></a><span>                </span><a name="local-6989586621679080427"><a href="#local-6989586621679080427"><span class="hs-identifier">st</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080424"><span class="hs-identifier hs-var">ivm</span></a><span> </span><a href="#local-6989586621679080433"><span class="hs-operator hs-var">*.</span></a><span> </span><a href="#local-6989586621679080426"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1035"></a><span>                </span><a name="local-6989586621679080428"><a href="#local-6989586621679080428"><span class="hs-identifier">s</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">head</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080427"><span class="hs-identifier hs-var">st</span></a><span> </span><span class="hs-comment">-- st = [[s],[t]]</span><span>
</span><a name="line-1036"></a><span>                </span><a name="local-6989586621679080429"><a href="#local-6989586621679080429"><span class="hs-identifier">p0'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toRational</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080402"><span class="hs-identifier hs-var">p0</span></a><span>
</span><a name="line-1037"></a><span>                </span><a name="local-6989586621679080430"><a href="#local-6989586621679080430"><span class="hs-identifier">pt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080429"><span class="hs-identifier hs-var">p0'</span></a><span> </span><a href="#local-6989586621679080438"><span class="hs-operator hs-var">+&gt;</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080428"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679080436"><span class="hs-operator hs-var">**:</span></a><span> </span><a href="#local-6989586621679080420"><span class="hs-identifier hs-var">v01</span></a><span class="hs-special">)</span><span>
</span><a name="line-1038"></a><span>                </span><a name="local-6989586621679080431"><a href="#local-6989586621679080431"><span class="hs-identifier">ne</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">negate</span><span>
</span><a name="line-1039"></a><span>                </span><span class="hs-identifier">invR</span><span class="hs-glyph">::</span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Rational</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Rational</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-1040"></a><span>                </span><a name="local-6989586621679080432"><a href="#local-6989586621679080432"><span class="hs-identifier">invR</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a name="local-6989586621679080439"><a href="#local-6989586621679080439"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080440"><a href="#local-6989586621679080440"><span class="hs-identifier">b</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679080441"><a href="#local-6989586621679080441"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080442"><a href="#local-6989586621679080442"><span class="hs-identifier">d</span></a></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span class="hs-operator hs-var">/</span><a href="#local-6989586621679080434"><span class="hs-identifier hs-var">detR</span></a><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679080439"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080440"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679080441"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080442"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080435"><span class="hs-operator hs-var">#:</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679080442"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679080440"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679080441"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080439"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-1041"></a><span>
</span><a name="line-1042"></a><span>                </span><span class="hs-special">(</span><span class="hs-operator">*.</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Rational</span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Rational</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Rational</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-1043"></a><span>                </span><span class="hs-special">(</span><a name="local-6989586621679080433"><a href="#local-6989586621679080433"><span class="hs-operator">*.</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a name="local-6989586621679080443"><a href="#local-6989586621679080443"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080444"><a href="#local-6989586621679080444"><span class="hs-identifier">b</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679080445"><a href="#local-6989586621679080445"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080446"><a href="#local-6989586621679080446"><span class="hs-identifier">d</span></a></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a name="local-6989586621679080447"><a href="#local-6989586621679080447"><span class="hs-identifier">x</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679080448"><a href="#local-6989586621679080448"><span class="hs-identifier">y</span></a></a><span class="hs-special">]</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679080443"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679080447"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679080444"><span class="hs-identifier hs-var">b</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679080448"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679080445"><span class="hs-identifier hs-var">c</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679080447"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679080446"><span class="hs-identifier hs-var">d</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679080448"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-1044"></a><span>
</span><a name="line-1045"></a><span>                </span><span class="hs-identifier">detR</span><span class="hs-glyph">::</span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Rational</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Rational</span><span>
</span><a name="line-1046"></a><span>                </span><a name="local-6989586621679080434"><a href="#local-6989586621679080434"><span class="hs-identifier">detR</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a name="local-6989586621679080449"><a href="#local-6989586621679080449"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080450"><a href="#local-6989586621679080450"><span class="hs-identifier">b</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679080451"><a href="#local-6989586621679080451"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080452"><a href="#local-6989586621679080452"><span class="hs-identifier">d</span></a></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080449"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679080452"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679080450"><span class="hs-identifier hs-var">b</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679080451"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-1047"></a><span>                </span><span class="hs-special">(</span><span class="hs-operator">#:</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Rational</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Rational</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Rational</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-1048"></a><span>                </span><span class="hs-special">(</span><a name="local-6989586621679080435"><a href="#local-6989586621679080435"><span class="hs-operator">#:</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679080453"><a href="#local-6989586621679080453"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679080454"><a href="#local-6989586621679080454"><span class="hs-identifier">cx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fmap</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679080453"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080454"><span class="hs-identifier hs-var">cx</span></a><span>
</span><a name="line-1049"></a><span>
</span><a name="line-1050"></a><span>                </span><span class="hs-special">(</span><span class="hs-operator">**:</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Rational</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">Rational</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">Rational</span><span>
</span><a name="line-1051"></a><span>                </span><span class="hs-special">(</span><a name="local-6989586621679080436"><a href="#local-6989586621679080436"><span class="hs-operator">**:</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679080455"><a href="#local-6989586621679080455"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679080456"><a href="#local-6989586621679080456"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679080457"><a href="#local-6989586621679080457"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679080458"><a href="#local-6989586621679080458"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vector3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080455"><span class="hs-identifier hs-var">r</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679080456"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080455"><span class="hs-identifier hs-var">r</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679080457"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080455"><span class="hs-identifier hs-var">r</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679080458"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span>
</span><a name="line-1052"></a><span>
</span><a name="line-1053"></a><span>                </span><a name="local-6989586621679080437"><a href="#local-6989586621679080437"><span class="hs-identifier">toR</span></a></a><span> </span><a name="local-6989586621679080459"><a href="#local-6989586621679080459"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fmap</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toRational</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080459"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-1054"></a><span>
</span><a name="line-1055"></a><span>                </span><span class="hs-special">(</span><span class="hs-operator">+&gt;</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">Rational</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">Rational</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">Rational</span><span>
</span><a name="line-1056"></a><span>                </span><span class="hs-special">(</span><a name="local-6989586621679080438"><a href="#local-6989586621679080438"><span class="hs-operator">+&gt;</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679080460"><a href="#local-6989586621679080460"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679080461"><a href="#local-6989586621679080461"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679080462"><a href="#local-6989586621679080462"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679080463"><a href="#local-6989586621679080463"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679080464"><a href="#local-6989586621679080464"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679080465"><a href="#local-6989586621679080465"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080460"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679080463"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080461"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679080464"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080462"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679080465"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span>
</span><a name="line-1057"></a><span>
</span><a name="line-1058"></a><span class="hs-comment">{-|
 === Three points rotation order can be determinated by the \( \color{red}{\text{Right Hand Rule}} \)
 &lt;http://localhost/html/indexConvexHullAlgorithm.html#rotate_dir Three_Points_Direction&gt;
 
  If given three points in following order:

  p&#8320; = (1, 0)

  p&#8321; = (0, 0)

  p&#8322; = (1, 0)

  then vectors are computed in following:

  v10 = p&#8320; - p&#8321;

  v12 = p&#8322; - p&#8321;

 matrix can be formed as following:

 m = [v10, v12]

 \( \vec{v_{01}} \times \vec{v_{02}} \) in Right Hand Rule

 \[
  m = \begin{bmatrix}
      1 &amp; 0 \\
      0 &amp; 1 \\
      \end{bmatrix} \\
  \det m = 1 &gt; 0 \\
 \]

 If the three points are collinear: 
                                   
 \( \det M = 0 \)

 If the order of three points in clockwise order:

 \( \det M &gt; 0 \)

 If the order of three points in counter clockwise order:

 \( \det M &lt; 0 \)

-}</span><span>
</span><a name="line-1103"></a><span class="hs-identifier">threePtDeterminant</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679076134"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679076134"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679076134"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679076134"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679076134"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1104"></a><a name="threePtDeterminant"><a href="AronGraphic.html#threePtDeterminant"><span class="hs-identifier">threePtDeterminant</span></a></a><span> </span><a name="local-6989586621679080466"><a href="#local-6989586621679080466"><span class="hs-identifier">p0</span></a></a><span> </span><a name="local-6989586621679080467"><a href="#local-6989586621679080467"><span class="hs-identifier">p1</span></a></a><span> </span><a name="local-6989586621679080468"><a href="#local-6989586621679080468"><span class="hs-identifier">p2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#det"><span class="hs-identifier hs-var">det</span></a><span> </span><a href="#local-6989586621679080472"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-1105"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1106"></a><span>    </span><a name="local-6989586621679080469"><a href="#local-6989586621679080469"><span class="hs-identifier">v10</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080471"><span class="hs-identifier hs-var">v2m</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679080466"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679080467"><span class="hs-identifier hs-var">p1</span></a><span>
</span><a name="line-1107"></a><span>    </span><a name="local-6989586621679080470"><a href="#local-6989586621679080470"><span class="hs-identifier">v12</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080471"><span class="hs-identifier hs-var">v2m</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679080468"><span class="hs-identifier hs-var">p2</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679080467"><span class="hs-identifier hs-var">p1</span></a><span>
</span><a name="line-1108"></a><span>    </span><a name="local-6989586621679080471"><a href="#local-6989586621679080471"><span class="hs-identifier">v2m</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679080473"><a href="#local-6989586621679080473"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679080474"><a href="#local-6989586621679080474"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679080475"><a href="#local-6989586621679080475"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679080473"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080474"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span>
</span><a name="line-1109"></a><span>    </span><a name="local-6989586621679080472"><a href="#local-6989586621679080472"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679080469"><span class="hs-identifier hs-var">v10</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080470"><span class="hs-identifier hs-var">v12</span></a><span class="hs-special">]</span><span>
</span><a name="line-1110"></a><span>
</span><a name="line-1111"></a><span class="hs-comment">{-|
 === Three points in Counter ClockWise order
 \(  \det M &gt; 0 \)
-}</span><span>
</span><a name="line-1115"></a><span class="hs-identifier">threePtCCW</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679076133"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679076133"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679076133"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679076133"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679076133"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1116"></a><a name="threePtCCW"><a href="AronGraphic.html#threePtCCW"><span class="hs-identifier">threePtCCW</span></a></a><span> </span><a name="local-6989586621679080476"><a href="#local-6989586621679080476"><span class="hs-identifier">p0</span></a></a><span> </span><a name="local-6989586621679080477"><a href="#local-6989586621679080477"><span class="hs-identifier">p1</span></a></a><span> </span><a name="local-6989586621679080478"><a href="#local-6989586621679080478"><span class="hs-identifier">p2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#threePtDeterminant"><span class="hs-identifier hs-var">threePtDeterminant</span></a><span> </span><a href="#local-6989586621679080476"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679080477"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679080478"><span class="hs-identifier hs-var">p2</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-1117"></a><span>
</span><a name="line-1118"></a><span class="hs-comment">{-|
 === Three points in ClockWise order
 \( \det M &lt; 0 \)
-}</span><span>
</span><a name="line-1122"></a><span class="hs-identifier">threePtCW</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679076132"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679076132"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679076132"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679076132"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679076132"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1123"></a><a name="threePtCW"><a href="AronGraphic.html#threePtCW"><span class="hs-identifier">threePtCW</span></a></a><span> </span><a name="local-6989586621679080479"><a href="#local-6989586621679080479"><span class="hs-identifier">p0</span></a></a><span> </span><a name="local-6989586621679080480"><a href="#local-6989586621679080480"><span class="hs-identifier">p1</span></a></a><span> </span><a name="local-6989586621679080481"><a href="#local-6989586621679080481"><span class="hs-identifier">p2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#threePtDeterminant"><span class="hs-identifier hs-var">threePtDeterminant</span></a><span> </span><a href="#local-6989586621679080479"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679080480"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679080481"><span class="hs-identifier hs-var">p2</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-1124"></a><span>
</span><a name="line-1125"></a><span class="hs-comment">{-|
    === Three points are collinear

\[ 
    \begin{aligned}
    p_0 &amp;= (x_0, y_0) \\
    p_1 &amp;= (x_1, y_1) \\
    p_2 &amp;= (x_2, y_2) \\
    u   &amp;= p_0 - p_1 \\
    u   &amp;= (x_0 - x_1, y_0 - y_1) \\
    v   &amp;= p_2 - p_1 \\
    v   &amp;= (x_2 - x_1, y_2 - y_1) \\
    M   &amp;= \begin{bmatrix}
           u &amp; v
           \end{bmatrix} \\
    &amp;\mbox{If three pts are colinear, then } \\
    \det M &amp;= 0 \\
    \end{aligned}
\]
-}</span><span>
</span><a name="line-1145"></a><span class="hs-identifier">threePtCollinear</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679076131"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679076131"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679076131"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679076131"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679076131"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1146"></a><a name="threePtCollinear"><a href="AronGraphic.html#threePtCollinear"><span class="hs-identifier">threePtCollinear</span></a></a><span> </span><a name="local-6989586621679080482"><a href="#local-6989586621679080482"><span class="hs-identifier">p0</span></a></a><span> </span><a name="local-6989586621679080483"><a href="#local-6989586621679080483"><span class="hs-identifier">p1</span></a></a><span> </span><a name="local-6989586621679080484"><a href="#local-6989586621679080484"><span class="hs-identifier">p2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#threePtDeterminant"><span class="hs-identifier hs-var">threePtDeterminant</span></a><span> </span><a href="#local-6989586621679080482"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679080483"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679080484"><span class="hs-identifier hs-var">p2</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0.0</span><span>
</span><a name="line-1147"></a><span>
</span><a name="line-1148"></a><span class="hs-comment">{-| 
    Given a point \( p_0 \), a line \(q_0, q_2 \)
    === Check whether a point \(p_0\) is on the left size of a line \( q_0, q_2 \), it is based on 'threePtDeterminant' with additional condtion: \(y_2 &gt; y_0 \) or \( y_2 &lt; y_0 \) since 

    __NOTE__ y2 \(\neq\) y0 where given (Vertex3 x0 y0 z0) and (Vertex3 x2 y2 z2)

    ==== Assume \( p_0, p_2 \) are not __coincide__

    * If pt on the line, return False
    * If pt on the right side of the line, return False
    * Else return True

    \[
        \begin{aligned}
        p_1 &amp;= (x_1, y_1) \\ 
        p_0 &amp;= (x_0, y_0) \\
        p_2 &amp;= (x_2, y_2) \\
        u &amp;= \overrightarrow{p1 p0}  \\
        v &amp;= \overrightarrow{p1 p2}  \\
        \end{aligned}
    \]
    
    if \( y_2 &gt; y_0 \) 
    form a determinant 
    \[
        \begin{aligned} 
         \det \begin{vmatrix}
                u &amp; v
                \end{vmatrix} &gt; 0
        \end{aligned} 
    \]
    if \( y_2 &lt; y_0 \) 
    form a determinant 
    \[
        \begin{aligned} 
         \det \begin{vmatrix}
                u &amp; v
                \end{vmatrix} &lt; 0
        \end{aligned} 
    \]

    If \( y_2 = y_0 \), compare \( x_0, x_2 \)

    === Check whether a point is below a line \(p_0, p_2\)
    if \( x_2 &lt; x_0 \)
    \[
        \begin{aligned} 
         \det \begin{vmatrix}
                u &amp; v
                \end{vmatrix} &gt; 0
        \end{aligned} 
    \]

    if \( x_2 &gt; x_0 \)
    \[
        \begin{aligned} 
         \det \begin{vmatrix}
                u &amp; v
                \end{vmatrix} &lt; 0
        \end{aligned} 
    \]


-}</span><span>
</span><a name="line-1212"></a><span class="hs-identifier">ptOnLeftLine</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679076130"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679076130"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679076130"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679076130"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679076130"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1213"></a><a name="ptOnLeftLine"><a href="AronGraphic.html#ptOnLeftLine"><span class="hs-identifier">ptOnLeftLine</span></a></a><span> </span><a name="local-6989586621679080485"><a href="#local-6989586621679080485"><span class="hs-identifier">p0</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679080486"><a href="#local-6989586621679080486"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679080487"><a href="#local-6989586621679080487"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679080488"><a href="#local-6989586621679080488"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1214"></a><span>             </span><a name="local-6989586621679080489"><a href="#local-6989586621679080489"><span class="hs-identifier">p1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679080490"><a href="#local-6989586621679080490"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679080491"><a href="#local-6989586621679080491"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679080492"><a href="#local-6989586621679080492"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1215"></a><span>             </span><a name="local-6989586621679080493"><a href="#local-6989586621679080493"><span class="hs-identifier">p2</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679080494"><a href="#local-6989586621679080494"><span class="hs-identifier">x2</span></a></a><span> </span><a name="local-6989586621679080495"><a href="#local-6989586621679080495"><span class="hs-identifier">y2</span></a></a><span> </span><a name="local-6989586621679080496"><a href="#local-6989586621679080496"><span class="hs-identifier">z2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679080495"><span class="hs-identifier hs-var">y2</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-6989586621679080487"><span class="hs-identifier hs-var">y0</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080497"><span class="hs-identifier hs-var">de</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1216"></a><span>                                        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679080495"><span class="hs-identifier hs-var">y2</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679080487"><span class="hs-identifier hs-var">y0</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080497"><span class="hs-identifier hs-var">de</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080497"><span class="hs-identifier hs-var">de</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1217"></a><span>             </span><span class="hs-keyword">where</span><span>
</span><a name="line-1218"></a><span>                </span><a name="local-6989586621679080497"><a href="#local-6989586621679080497"><span class="hs-identifier">de</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#threePtDeterminant"><span class="hs-identifier hs-var">threePtDeterminant</span></a><span> </span><a href="#local-6989586621679080485"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679080489"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679080493"><span class="hs-identifier hs-var">p2</span></a><span>
</span><a name="line-1219"></a><span>
</span><a name="line-1220"></a><span class="hs-comment">--ptOnUpLine::(Fractional a, Ord a)=&gt;(Vertex3 a) -&gt;(Vertex3 a)-&gt;(Vertex3 a) -&gt; Bool</span><span>
</span><a name="line-1221"></a><span class="hs-comment">--</span><span>
</span><a name="line-1222"></a><span>
</span><a name="line-1223"></a><span class="hs-comment">{-|
  === Check whether a point \(p_0\) is inside a triangle \( \triangle ABC \)

  * __NOTE__ the order of three pts: \(A, B, C\) does't matter. e.g CCW or CW
  * \(p_0\) can NOT be the same point as \(A, B, C\)
  * If \(p_0\) is collinear with AB, BC, or AC, then \(p_0\) is considered inside the \( \triangle ABC \) 

  \(p_0\) is the point that is tested
  three points \(A, B, C\) forms a triangle

  if point p0 inside the triangle, return true

  The sum of three angles are in degree.

  &gt;let p0 = Vertex3 0.1 0.1 0
  &gt;let a  = Vertex3 1 0 0
  &gt;let b  = Vertex3 0 0 0
  &gt;let c  = Vertex3 0 1 0
  &gt;
  &gt;ptInsideTri p0 a b c
  &gt;(True, 360.0)

  TODO: how to check whether a pt is inside a n-polygon
  &lt;http://localhost/html/indexConvexHullAlgorithm.html#npolygon N-Polygon&gt;

-}</span><span>
</span><a name="line-1249"></a><span class="hs-identifier">ptInsideTri</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span>
</span><a name="line-1250"></a><a name="ptInsideTri"><a href="AronGraphic.html#ptInsideTri"><span class="hs-identifier">ptInsideTri</span></a></a><span> </span><a name="local-6989586621679080498"><a href="#local-6989586621679080498"><span class="hs-identifier">p0</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679080499"><a href="#local-6989586621679080499"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080500"><a href="#local-6989586621679080500"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080501"><a href="#local-6989586621679080501"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080504"><span class="hs-identifier hs-var">is</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080502"><span class="hs-identifier hs-var">degree</span></a><span class="hs-special">)</span><span>
</span><a name="line-1251"></a><span>                           </span><span class="hs-keyword">where</span><span>
</span><a name="line-1252"></a><span>                             </span><a name="local-6989586621679080502"><a href="#local-6989586621679080502"><span class="hs-identifier">degree</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080505"><span class="hs-identifier hs-var">dePerRad</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679080503"><span class="hs-identifier hs-var">rad</span></a><span>
</span><a name="line-1253"></a><span>                             </span><a name="local-6989586621679080503"><a href="#local-6989586621679080503"><span class="hs-identifier">rad</span></a></a><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">acos</span><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#cosVex3"><span class="hs-identifier hs-var">cosVex3</span></a><span> </span><a href="#local-6989586621679080500"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679080498"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679080499"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier hs-var">acos</span><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#cosVex3"><span class="hs-identifier hs-var">cosVex3</span></a><span> </span><a href="#local-6989586621679080501"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679080498"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679080500"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier hs-var">acos</span><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#cosVex3"><span class="hs-identifier hs-var">cosVex3</span></a><span> </span><a href="#local-6989586621679080501"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679080498"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679080499"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1254"></a><span>                             </span><a name="local-6989586621679080504"><a href="#local-6989586621679080504"><span class="hs-identifier">is</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">abs</span><span class="hs-special">(</span><a href="#local-6989586621679080503"><span class="hs-identifier hs-var">rad</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">2</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">pi</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0.001</span><span>
</span><a name="line-1255"></a><span>                             </span><a name="local-6989586621679080505"><a href="#local-6989586621679080505"><span class="hs-identifier">dePerRad</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">360</span><span class="hs-operator hs-var">/</span><span class="hs-special">(</span><span class="hs-number">2</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">pi</span><span class="hs-special">)</span><span>
</span><a name="line-1256"></a><span class="hs-comment">{-|
Given a point p0 and three pts: q0, q1, q2, 

Compute the intersection of line is perpendicular to the plane and passes point p0
  
If three pts (q0, q1, q2) are colinear, return Nothing

otherwise, return Just (Vertex3 GLfloat)
-}</span><span>
</span><a name="line-1265"></a><span class="hs-identifier">perpPlane</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1266"></a><span>           </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1267"></a><span>           </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1268"></a><span>           </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1269"></a><span>           </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">Rational</span><span class="hs-special">)</span><span>
</span><a name="line-1270"></a><a name="perpPlane"><a href="AronGraphic.html#perpPlane"><span class="hs-identifier">perpPlane</span></a></a><span> </span><a name="local-6989586621679080506"><a href="#local-6989586621679080506"><span class="hs-identifier">p0</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679080507"><a href="#local-6989586621679080507"><span class="hs-identifier">e0</span></a></a><span> </span><a name="local-6989586621679080508"><a href="#local-6989586621679080508"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679080509"><a href="#local-6989586621679080509"><span class="hs-identifier">e2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1271"></a><span>          </span><a name="local-6989586621679080510"><a href="#local-6989586621679080510"><span class="hs-identifier">q0</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679080511"><a href="#local-6989586621679080511"><span class="hs-identifier">m0</span></a></a><span> </span><a name="local-6989586621679080512"><a href="#local-6989586621679080512"><span class="hs-identifier">m1</span></a></a><span> </span><a name="local-6989586621679080513"><a href="#local-6989586621679080513"><span class="hs-identifier">m2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1272"></a><span>          </span><a name="local-6989586621679080514"><a href="#local-6989586621679080514"><span class="hs-identifier">q1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679080515"><a href="#local-6989586621679080515"><span class="hs-identifier">k0</span></a></a><span> </span><a name="local-6989586621679080516"><a href="#local-6989586621679080516"><span class="hs-identifier">k1</span></a></a><span> </span><a name="local-6989586621679080517"><a href="#local-6989586621679080517"><span class="hs-identifier">k2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1273"></a><span>          </span><a name="local-6989586621679080518"><a href="#local-6989586621679080518"><span class="hs-identifier">q2</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679080519"><a href="#local-6989586621679080519"><span class="hs-identifier">d0</span></a></a><span> </span><a name="local-6989586621679080520"><a href="#local-6989586621679080520"><span class="hs-identifier">d1</span></a></a><span> </span><a name="local-6989586621679080521"><a href="#local-6989586621679080521"><span class="hs-identifier">d2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1274"></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679080522"><span class="hs-identifier hs-var">is</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679080533"><span class="hs-identifier hs-var">pt</span></a><span>
</span><a name="line-1275"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-1276"></a><span>            </span><a name="local-6989586621679080522"><a href="#local-6989586621679080522"><span class="hs-identifier">is</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#isColinear"><span class="hs-identifier hs-var">isColinear</span></a><span> </span><a href="#local-6989586621679080510"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679080514"><span class="hs-identifier hs-var">q1</span></a><span> </span><a href="#local-6989586621679080518"><span class="hs-identifier hs-var">q2</span></a><span>
</span><a name="line-1277"></a><span>            </span><a name="local-6989586621679080523"><a href="#local-6989586621679080523"><span class="hs-identifier">nr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromJust</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#normal3"><span class="hs-identifier hs-var">normal3</span></a><span> </span><a href="#local-6989586621679080510"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679080514"><span class="hs-identifier hs-var">q1</span></a><span> </span><a href="#local-6989586621679080518"><span class="hs-identifier hs-var">q2</span></a><span>
</span><a name="line-1278"></a><span>            </span><a name="local-6989586621679080524"><a href="#local-6989586621679080524"><span class="hs-identifier">v1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080514"><span class="hs-identifier hs-var">q1</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679080510"><span class="hs-identifier hs-var">q0</span></a><span>
</span><a name="line-1279"></a><span>            </span><a name="local-6989586621679080525"><a href="#local-6989586621679080525"><span class="hs-identifier">v2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080518"><span class="hs-identifier hs-var">q2</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679080510"><span class="hs-identifier hs-var">q0</span></a><span>
</span><a name="line-1280"></a><span>            </span><a name="local-6989586621679080526"><a href="#local-6989586621679080526"><span class="hs-identifier">qp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080506"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679080510"><span class="hs-identifier hs-var">q0</span></a><span>
</span><a name="line-1281"></a><span>            </span><a name="local-6989586621679080527"><a href="#local-6989586621679080527"><span class="hs-identifier">vqp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toRational</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679080534"><span class="hs-identifier hs-var">veMat</span></a><span> </span><a href="#local-6989586621679080526"><span class="hs-identifier hs-var">qp</span></a><span>
</span><a name="line-1282"></a><span>            </span><a name="local-6989586621679080528"><a href="#local-6989586621679080528"><span class="hs-identifier">mat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">zipWith3</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080538"><a href="#local-6989586621679080538"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679080539"><a href="#local-6989586621679080539"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679080540"><a href="#local-6989586621679080540"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679080538"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679080539"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679080540"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080534"><span class="hs-identifier hs-var">veMat</span></a><span> </span><a href="#local-6989586621679080524"><span class="hs-identifier hs-var">v1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080534"><span class="hs-identifier hs-var">veMat</span></a><span> </span><a href="#local-6989586621679080525"><span class="hs-identifier hs-var">v2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080534"><span class="hs-identifier hs-var">veMat</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679080536"><span class="hs-identifier hs-var">neg</span></a><span> </span><a href="#local-6989586621679080523"><span class="hs-identifier hs-var">nr</span></a><span class="hs-special">)</span><span>
</span><a name="line-1283"></a><span>            </span><a name="local-6989586621679080529"><a href="#local-6989586621679080529"><span class="hs-identifier">mat'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toRational</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080528"><span class="hs-identifier hs-var">mat</span></a><span>
</span><a name="line-1284"></a><span>            </span><a name="local-6989586621679080530"><a href="#local-6989586621679080530"><span class="hs-identifier">ima</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#inverseR"><span class="hs-identifier hs-var">inverseR</span></a><span> </span><a href="#local-6989586621679080529"><span class="hs-identifier hs-var">mat'</span></a><span>
</span><a name="line-1285"></a><span>            </span><a name="local-6989586621679080531"><a href="#local-6989586621679080531"><span class="hs-identifier">sth</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#multiMatR"><span class="hs-identifier hs-var">multiMatR</span></a><span> </span><a href="#local-6989586621679080530"><span class="hs-identifier hs-var">ima</span></a><span> </span><a href="#local-6989586621679080527"><span class="hs-identifier hs-var">vqp</span></a><span> </span><span class="hs-comment">-- sth =  [[s], [t], [h]]</span><span>
</span><a name="line-1286"></a><span>            </span><a name="local-6989586621679080532"><a href="#local-6989586621679080532"><span class="hs-identifier">h</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">last</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">last</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080531"><span class="hs-identifier hs-var">sth</span></a><span>
</span><a name="line-1287"></a><span>            </span><a name="local-6989586621679080533"><a href="#local-6989586621679080533"><span class="hs-identifier">pt</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080541"><span class="hs-identifier hs-var">p0'</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679080544"><span class="hs-identifier hs-var">ad</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080532"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679080542"><span class="hs-identifier hs-var">mu</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679080543"><span class="hs-identifier hs-var">nr'</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1288"></a><span>                                        </span><a name="local-6989586621679080541"><a href="#local-6989586621679080541"><span class="hs-identifier">p0'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080537"><span class="hs-identifier hs-var">toR</span></a><span> </span><a href="#local-6989586621679080506"><span class="hs-identifier hs-var">p0</span></a><span> </span><span class="hs-comment">-- toRational</span><span>
</span><a name="line-1289"></a><span>                                        </span><a name="local-6989586621679080542"><a href="#local-6989586621679080542"><span class="hs-identifier">mu</span></a></a><span> </span><a name="local-6989586621679080545"><a href="#local-6989586621679080545"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679080546"><a href="#local-6989586621679080546"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span class="hs-special">(</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679080545"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080546"><span class="hs-identifier hs-var">y</span></a><span>  </span><span class="hs-comment">-- t*v</span><span>
</span><a name="line-1290"></a><span>                                        </span><a name="local-6989586621679080543"><a href="#local-6989586621679080543"><span class="hs-identifier">nr'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080537"><span class="hs-identifier hs-var">toR</span></a><span> </span><a href="#local-6989586621679080523"><span class="hs-identifier hs-var">nr</span></a><span>  </span><span class="hs-comment">-- toRational</span><span>
</span><a name="line-1291"></a><span>                                        </span><span class="hs-comment">-- pt = p0 + v in affine space:)</span><span>
</span><a name="line-1292"></a><span>                                        </span><a name="local-6989586621679080544"><a href="#local-6989586621679080544"><span class="hs-identifier">ad</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679080547"><a href="#local-6989586621679080547"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679080548"><a href="#local-6989586621679080548"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679080549"><a href="#local-6989586621679080549"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679080550"><a href="#local-6989586621679080550"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679080551"><a href="#local-6989586621679080551"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679080552"><a href="#local-6989586621679080552"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080547"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679080550"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080548"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679080551"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080549"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679080552"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-1293"></a><span>
</span><a name="line-1294"></a><span>            </span><span class="hs-comment">-- | local functions</span><span>
</span><a name="line-1295"></a><span>            </span><a name="local-6989586621679080534"><a href="#local-6989586621679080534"><span class="hs-identifier">veMat</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679080553"><a href="#local-6989586621679080553"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679080554"><a href="#local-6989586621679080554"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679080555"><a href="#local-6989586621679080555"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679080553"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679080554"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679080555"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-1296"></a><span>            </span><a name="local-6989586621679080535"><a href="#local-6989586621679080535"><span class="hs-identifier">matVx</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a name="local-6989586621679080556"><a href="#local-6989586621679080556"><span class="hs-identifier">x</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679080557"><a href="#local-6989586621679080557"><span class="hs-identifier">y</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679080558"><a href="#local-6989586621679080558"><span class="hs-identifier">z</span></a></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a href="#local-6989586621679080556"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679080557"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679080558"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span>
</span><a name="line-1297"></a><span>            </span><a name="local-6989586621679080536"><a href="#local-6989586621679080536"><span class="hs-identifier">neg</span></a></a><span> </span><a name="local-6989586621679080559"><a href="#local-6989586621679080559"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">negate</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080559"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1298"></a><span>            </span><a name="local-6989586621679080537"><a href="#local-6989586621679080537"><span class="hs-identifier">toR</span></a></a><span> </span><a name="local-6989586621679080560"><a href="#local-6989586621679080560"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toRational</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080560"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1299"></a><span>
</span><a name="line-1300"></a><span class="hs-comment">-- | Line intersects Plane</span><span>
</span><a name="line-1301"></a><span class="hs-comment">-- | Given Line: p0 p1 and Plane: q0 q1 q2 </span><span>
</span><a name="line-1302"></a><span class="hs-comment">-- | Compute the intersection of line and plane</span><span>
</span><a name="line-1303"></a><span class="hs-comment">-- | </span><span>
</span><a name="line-1304"></a><span class="hs-comment">--  p1 = p0 +: h(p1 -: p0)</span><span>
</span><a name="line-1305"></a><span class="hs-identifier">lineIntersectPlane</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1306"></a><span>                    </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1307"></a><span>                    </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1308"></a><span>                    </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1309"></a><span>                    </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1310"></a><span>                    </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">Rational</span><span class="hs-special">)</span><span>
</span><a name="line-1311"></a><a name="lineIntersectPlane"><a href="AronGraphic.html#lineIntersectPlane"><span class="hs-identifier">lineIntersectPlane</span></a></a><span> </span><a name="local-6989586621679080561"><a href="#local-6989586621679080561"><span class="hs-identifier">p0</span></a></a><span> </span><a name="local-6989586621679080562"><a href="#local-6989586621679080562"><span class="hs-identifier">ve</span></a></a><span> </span><a name="local-6989586621679080563"><a href="#local-6989586621679080563"><span class="hs-identifier">q0</span></a></a><span> </span><a name="local-6989586621679080564"><a href="#local-6989586621679080564"><span class="hs-identifier">q1</span></a></a><span> </span><a name="local-6989586621679080565"><a href="#local-6989586621679080565"><span class="hs-identifier">q2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679080566"><span class="hs-identifier hs-var">is</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679080577"><span class="hs-identifier hs-var">pt</span></a><span>
</span><a name="line-1312"></a><span>                </span><span class="hs-keyword">where</span><span>
</span><a name="line-1313"></a><span>                    </span><a name="local-6989586621679080566"><a href="#local-6989586621679080566"><span class="hs-identifier">is</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#isColinear"><span class="hs-identifier hs-var">isColinear</span></a><span> </span><a href="#local-6989586621679080563"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679080564"><span class="hs-identifier hs-var">q1</span></a><span> </span><a href="#local-6989586621679080565"><span class="hs-identifier hs-var">q2</span></a><span>
</span><a name="line-1314"></a><span>                    </span><a name="local-6989586621679080567"><a href="#local-6989586621679080567"><span class="hs-identifier">v1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080564"><span class="hs-identifier hs-var">q1</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679080563"><span class="hs-identifier hs-var">q0</span></a><span> </span><span class="hs-comment">-- q0 -&gt; q1</span><span>
</span><a name="line-1315"></a><span>                    </span><a name="local-6989586621679080568"><a href="#local-6989586621679080568"><span class="hs-identifier">v2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080565"><span class="hs-identifier hs-var">q2</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679080563"><span class="hs-identifier hs-var">q0</span></a><span> </span><span class="hs-comment">-- q0 -&gt; q2</span><span>
</span><a name="line-1316"></a><span>                    </span><a name="local-6989586621679080569"><a href="#local-6989586621679080569"><span class="hs-identifier">nr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080562"><span class="hs-identifier hs-var">ve</span></a><span>
</span><a name="line-1317"></a><span>                    </span><a name="local-6989586621679080570"><a href="#local-6989586621679080570"><span class="hs-identifier">qp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080561"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679080563"><span class="hs-identifier hs-var">q0</span></a><span>
</span><a name="line-1318"></a><span>                    </span><a name="local-6989586621679080571"><a href="#local-6989586621679080571"><span class="hs-identifier">vqp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toRational</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679080578"><span class="hs-identifier hs-var">veMat</span></a><span> </span><a href="#local-6989586621679080570"><span class="hs-identifier hs-var">qp</span></a><span>
</span><a name="line-1319"></a><span>                    </span><a name="local-6989586621679080572"><a href="#local-6989586621679080572"><span class="hs-identifier">mat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">zipWith3</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080582"><a href="#local-6989586621679080582"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679080583"><a href="#local-6989586621679080583"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679080584"><a href="#local-6989586621679080584"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679080582"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679080583"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679080584"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080578"><span class="hs-identifier hs-var">veMat</span></a><span> </span><a href="#local-6989586621679080567"><span class="hs-identifier hs-var">v1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080578"><span class="hs-identifier hs-var">veMat</span></a><span> </span><a href="#local-6989586621679080568"><span class="hs-identifier hs-var">v2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080578"><span class="hs-identifier hs-var">veMat</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679080580"><span class="hs-identifier hs-var">neg</span></a><span> </span><a href="#local-6989586621679080569"><span class="hs-identifier hs-var">nr</span></a><span class="hs-special">)</span><span>
</span><a name="line-1320"></a><span>                    </span><a name="local-6989586621679080573"><a href="#local-6989586621679080573"><span class="hs-identifier">mat'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toRational</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080572"><span class="hs-identifier hs-var">mat</span></a><span>
</span><a name="line-1321"></a><span>                    </span><a name="local-6989586621679080574"><a href="#local-6989586621679080574"><span class="hs-identifier">ima</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#inverseR"><span class="hs-identifier hs-var">inverseR</span></a><span> </span><a href="#local-6989586621679080573"><span class="hs-identifier hs-var">mat'</span></a><span>
</span><a name="line-1322"></a><span>                    </span><a name="local-6989586621679080575"><a href="#local-6989586621679080575"><span class="hs-identifier">sth</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#multiMatR"><span class="hs-identifier hs-var">multiMatR</span></a><span> </span><a href="#local-6989586621679080574"><span class="hs-identifier hs-var">ima</span></a><span> </span><a href="#local-6989586621679080571"><span class="hs-identifier hs-var">vqp</span></a><span> </span><span class="hs-comment">-- sth =  [[s], [t], [h]]</span><span>
</span><a name="line-1323"></a><span>                    </span><a name="local-6989586621679080576"><a href="#local-6989586621679080576"><span class="hs-identifier">h</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">last</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">last</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080575"><span class="hs-identifier hs-var">sth</span></a><span>
</span><a name="line-1324"></a><span>                    </span><a name="local-6989586621679080577"><a href="#local-6989586621679080577"><span class="hs-identifier">pt</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080585"><span class="hs-identifier hs-var">p0'</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679080588"><span class="hs-identifier hs-var">ad</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080576"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679080586"><span class="hs-identifier hs-var">mu</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679080587"><span class="hs-identifier hs-var">nr'</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1325"></a><span>                                                </span><a name="local-6989586621679080585"><a href="#local-6989586621679080585"><span class="hs-identifier">p0'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080581"><span class="hs-identifier hs-var">toR</span></a><span> </span><a href="#local-6989586621679080561"><span class="hs-identifier hs-var">p0</span></a><span> </span><span class="hs-comment">-- toRational</span><span>
</span><a name="line-1326"></a><span>                                                </span><a name="local-6989586621679080586"><a href="#local-6989586621679080586"><span class="hs-identifier">mu</span></a></a><span> </span><a name="local-6989586621679080589"><a href="#local-6989586621679080589"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679080590"><a href="#local-6989586621679080590"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span class="hs-special">(</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679080589"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080590"><span class="hs-identifier hs-var">y</span></a><span>  </span><span class="hs-comment">-- t*v</span><span>
</span><a name="line-1327"></a><span>                                                </span><a name="local-6989586621679080587"><a href="#local-6989586621679080587"><span class="hs-identifier">nr'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080581"><span class="hs-identifier hs-var">toR</span></a><span> </span><a href="#local-6989586621679080569"><span class="hs-identifier hs-var">nr</span></a><span>  </span><span class="hs-comment">-- toRational</span><span>
</span><a name="line-1328"></a><span>                                                </span><span class="hs-comment">-- pt = p0 + v in affine space:)</span><span>
</span><a name="line-1329"></a><span>                                                </span><a name="local-6989586621679080588"><a href="#local-6989586621679080588"><span class="hs-identifier">ad</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679080591"><a href="#local-6989586621679080591"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679080592"><a href="#local-6989586621679080592"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679080593"><a href="#local-6989586621679080593"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679080594"><a href="#local-6989586621679080594"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679080595"><a href="#local-6989586621679080595"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679080596"><a href="#local-6989586621679080596"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080591"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679080594"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080592"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679080595"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080593"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679080596"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-1330"></a><span>
</span><a name="line-1331"></a><span>                    </span><span class="hs-comment">-- | local functions</span><span>
</span><a name="line-1332"></a><span>                    </span><a name="local-6989586621679080578"><a href="#local-6989586621679080578"><span class="hs-identifier">veMat</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679080597"><a href="#local-6989586621679080597"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679080598"><a href="#local-6989586621679080598"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679080599"><a href="#local-6989586621679080599"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679080597"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679080598"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679080599"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-1333"></a><span>                    </span><a name="local-6989586621679080579"><a href="#local-6989586621679080579"><span class="hs-identifier">matVx</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a name="local-6989586621679080600"><a href="#local-6989586621679080600"><span class="hs-identifier">x</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679080601"><a href="#local-6989586621679080601"><span class="hs-identifier">y</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679080602"><a href="#local-6989586621679080602"><span class="hs-identifier">z</span></a></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a href="#local-6989586621679080600"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679080601"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679080602"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span>
</span><a name="line-1334"></a><span>                    </span><a name="local-6989586621679080580"><a href="#local-6989586621679080580"><span class="hs-identifier">neg</span></a></a><span> </span><a name="local-6989586621679080603"><a href="#local-6989586621679080603"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">negate</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080603"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1335"></a><span>                    </span><a name="local-6989586621679080581"><a href="#local-6989586621679080581"><span class="hs-identifier">toR</span></a></a><span> </span><a name="local-6989586621679080604"><a href="#local-6989586621679080604"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toRational</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080604"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1336"></a><span>
</span><a name="line-1337"></a><span>
</span><a name="line-1338"></a><span class="hs-comment">{-|
 === Slow Algorithm 1 \( \color{red}{ \mathcal{O}(n^3)} \)
 1. find the a point \( p_0 \) which has the maximum y-axis value 
 2. find the a point \( p' \) from \( p_0 \) so that the rest of all the points on one side of the segment \( \overline{p_0 p'} \) 
 3. continua with the rest of points

 === Naive Algorithm to compute the convex hull in \( \color{red}{\mathcal{O}(nh)} \) where \( \color{red}{n} \) is the number of points on the plane, \( \color{red}{h} \) is the number of points on the convex hull

 If all the points are around the convex hull, then the runtime will be \( \color{red}{\mathcal{O}(n^2)} \)
 
 @
 convexHull n pts
 n is the total of vertices
 pts is length pts 
 
 p0 = Vertex3 0 0 0
 p1 = Vertex3 1 0 0
 p2 = Vertex3 0 1 0
 p3 = Vertex3 0.1 0.1 0
 pts= [p0, p1, p2, p3]
 n  = 4 = len pts
 pts = [p0, p1, p2, p3]
 exp= [[p2, p1], 
       [p1, p0], 
       [p0, p2]]
 @

 * __Algorithm__
 &lt;http://localhost/html/indexConvexHullAlgorithm.html#convexhull ConvexHull&gt;
 * Find a __top__ vertex: B(Vertex3 x y z) with maximum y-Axis value
 * Construct a new vertex: A(Vertex3 x+1 y z) = __top__(Vertex3 x + 1 y z) according to __top__(Vertex3 x y z)
 * Compute the angle \( \cos &#8736;ABC \) from three points: \(A, B, C\)
 * If there are only two points in pts for the list of Vertex3 e.g. p0 p1
 * then segments: \(\overline{AB} \) and \(\overline{BC} \) are drawn 
 &lt;http://localhost/html/indexConvexHullAlgorithm.html#three_pts_angle Three_pts_angle&gt;

 n = length pts \(\Rightarrow\) n vertices \(\Rightarrow\) n edges. if there is two vertices, then \((p_0, p_1)\) and \((p_1, p_0)\)

 vec(top x1) and vec(top x2)

 \(\vec{v_1}\) = top -&gt; x1 = x1 -: top 

 \(\vec{v_2}\) = top -&gt; x2 = x2 -: top 

 * TODO: Handle the case where the three points are colinear.

 * TODO: If there are more than one point that have maximum y-axis, then choose the left most point
 &lt;http://localhost/html/indexConvexHullAlgorithm.html#top_point Top_Point&gt;

 \( \color{red}{TODO} \): use eliminate points technic to improve the algorithm
 &lt;http://localhost/html/indexConvexHullAlgorithm.html#eliminate_points Eliminate_Points&gt;

 It seems that the algorithm is still \( \color{red}{ \mathcal{O}(nh)} \)
 Given n vertices on a plane. There are \(h\) points on the convex hull.
 Assume \( \frac{1}{h} n \) vertices may be eliminated when the next point is found on the convex hull.
 The total number of steps are: 
 \[
 \begin{aligned}
    s &amp;= n + \frac{h-1}{h} n + \frac{h-2}{h} n + \dots + \frac{1}{h} n \\
    s &amp;= n h (1 + 2 + 3 + \dots + h) \\
    s &amp;= n h \frac{(1 + h)h}{2} \\
    s &amp;= n \frac{1+ h}{2} \\
      &amp;= \mathcal{O}(nh) \\
 \end{aligned}
 \]
    


 When the algo walks around the convex hull in counter clokcwise order.

 segment can be drawn from top point to previous point

 All the points can be removed if they are on the left side of the segment

 \( \color{red}{TODO} \) use other algo: check whether a point is on the left or right side of a segment

 The algo can be check with the determinant of two vectors 'threePtDeterminant'
 &lt;http://localhost/html/indexConvexHullAlgorithm.html#rotate_dir Three_Points_Direction&gt;

-}</span><span>
</span><a name="line-1418"></a><span class="hs-identifier">convexHull</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int</span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1419"></a><span>        </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-1420"></a><a name="convexHull"><a href="AronGraphic.html#convexHull"><span class="hs-identifier">convexHull</span></a></a><span> </span><a name="local-6989586621679080605"><a href="#local-6989586621679080605"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679080606"><a href="#local-6989586621679080606"><span class="hs-identifier">pts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080615"><span class="hs-identifier hs-var">convexHull'</span></a><span> </span><a href="#local-6989586621679080605"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679080614"><span class="hs-identifier hs-var">xi</span></a><span> </span><a href="#local-6989586621679080613"><span class="hs-identifier hs-var">topx</span></a><span> </span><a href="#local-6989586621679080612"><span class="hs-identifier hs-var">top</span></a><span> </span><a href="#local-6989586621679080606"><span class="hs-identifier hs-var">pts</span></a><span>
</span><a name="line-1421"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1422"></a><span>        </span><a name="local-6989586621679080607"><a href="#local-6989586621679080607"><span class="hs-identifier">t1</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679080616"><a href="#local-6989586621679080616"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080617"><a href="#local-6989586621679080617"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080618"><a href="#local-6989586621679080618"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080616"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1423"></a><span>        </span><a name="local-6989586621679080608"><a href="#local-6989586621679080608"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679080619"><a href="#local-6989586621679080619"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080620"><a href="#local-6989586621679080620"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080621"><a href="#local-6989586621679080621"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080620"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-1424"></a><span>        </span><a name="local-6989586621679080609"><a href="#local-6989586621679080609"><span class="hs-identifier">t3</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679080622"><a href="#local-6989586621679080622"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080623"><a href="#local-6989586621679080623"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080624"><a href="#local-6989586621679080624"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080624"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-1425"></a><span>        </span><span class="hs-comment">-- find the vertex that has maximum y value.</span><span>
</span><a name="line-1426"></a><span>        </span><a name="local-6989586621679080610"><a href="#local-6989586621679080610"><span class="hs-identifier">ptsSort</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#qqsort"><span class="hs-identifier hs-var">qqsort</span></a><span> </span><a href="#local-6989586621679080625"><span class="hs-identifier hs-var">cmp</span></a><span> </span><a href="#local-6989586621679080606"><span class="hs-identifier hs-var">pts</span></a><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679080625"><a href="#local-6989586621679080625"><span class="hs-identifier">cmp</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679080626"><a href="#local-6989586621679080626"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679080627"><a href="#local-6989586621679080627"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679080628"><a href="#local-6989586621679080628"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679080629"><a href="#local-6989586621679080629"><span class="hs-identifier">x2</span></a></a><span> </span><a name="local-6989586621679080630"><a href="#local-6989586621679080630"><span class="hs-identifier">y2</span></a></a><span> </span><a name="local-6989586621679080631"><a href="#local-6989586621679080631"><span class="hs-identifier">z2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080627"><span class="hs-identifier hs-var">y1</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-6989586621679080630"><span class="hs-identifier hs-var">y2</span></a><span>
</span><a name="line-1427"></a><span>
</span><a name="line-1428"></a><span>        </span><span class="hs-comment">-- find the largest angle</span><span>
</span><a name="line-1429"></a><span>        </span><span class="hs-comment">-- angle: p0_p1_p2, vec: (p1, p2) and vec: (p1, p0)</span><span>
</span><a name="line-1430"></a><span>        </span><a name="local-6989586621679080611"><a href="#local-6989586621679080611"><span class="hs-identifier">vexSort</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#mergeSortC"><span class="hs-identifier hs-var">mergeSortC</span></a><span> </span><a href="#local-6989586621679080635"><span class="hs-identifier hs-var">cmp</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080642"><a href="#local-6989586621679080642"><span class="hs-identifier">p2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#cosVex3"><span class="hs-identifier hs-var">cosVex3</span></a><span> </span><a href="#local-6989586621679080633"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679080632"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679080642"><span class="hs-identifier hs-var">p2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080632"><span class="hs-identifier hs-var">p1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080642"><span class="hs-identifier hs-var">p2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080634"><span class="hs-identifier hs-var">cx</span></a><span>  </span><span class="hs-comment">-- p1 to all the rest of pts</span><span>
</span><a name="line-1431"></a><span>                        </span><span class="hs-keyword">where</span><span>
</span><a name="line-1432"></a><span>                            </span><a name="local-6989586621679080632"><a href="#local-6989586621679080632"><span class="hs-identifier">p1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679080610"><span class="hs-identifier hs-var">ptsSort</span></a><span>
</span><a name="line-1433"></a><span>                            </span><a name="local-6989586621679080633"><a href="#local-6989586621679080633"><span class="hs-identifier">p0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080636"><span class="hs-identifier hs-var">addx1</span></a><span> </span><a href="#local-6989586621679080632"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679080636"><a href="#local-6989586621679080636"><span class="hs-identifier">addx1</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679080637"><a href="#local-6989586621679080637"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679080638"><a href="#local-6989586621679080638"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679080639"><a href="#local-6989586621679080639"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080637"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080638"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679080639"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-1434"></a><span>                            </span><a name="local-6989586621679080634"><a href="#local-6989586621679080634"><span class="hs-identifier">cx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">tail</span><span> </span><a href="#local-6989586621679080610"><span class="hs-identifier hs-var">ptsSort</span></a><span>
</span><a name="line-1435"></a><span>                            </span><a name="local-6989586621679080635"><a href="#local-6989586621679080635"><span class="hs-identifier">cmp</span></a></a><span> </span><a name="local-6989586621679080640"><a href="#local-6989586621679080640"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-6989586621679080641"><a href="#local-6989586621679080641"><span class="hs-identifier">c2</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080607"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679080640"><span class="hs-identifier hs-var">c1</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-6989586621679080607"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679080641"><span class="hs-identifier hs-var">c2</span></a><span>
</span><a name="line-1436"></a><span>
</span><a name="line-1437"></a><span>        </span><a name="local-6989586621679080612"><a href="#local-6989586621679080612"><span class="hs-identifier">top</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679080643"><a href="#local-6989586621679080643"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679080644"><a href="#local-6989586621679080644"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080645"><a href="#local-6989586621679080645"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679080646"><a href="#local-6989586621679080646"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080645"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679080643"><span class="hs-identifier hs-var">t2</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronModule.html#head%27"><span class="hs-identifier hs-var">head'</span></a><span> </span><a href="#local-6989586621679080611"><span class="hs-identifier hs-var">vexSort</span></a><span>
</span><a name="line-1438"></a><span>        </span><a name="local-6989586621679080613"><a href="#local-6989586621679080613"><span class="hs-identifier">topx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080647"><span class="hs-identifier hs-var">addx1</span></a><span> </span><a href="#local-6989586621679080612"><span class="hs-identifier hs-var">top</span></a><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679080647"><a href="#local-6989586621679080647"><span class="hs-identifier">addx1</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679080648"><a href="#local-6989586621679080648"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679080649"><a href="#local-6989586621679080649"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679080650"><a href="#local-6989586621679080650"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080648"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080649"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679080650"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-1439"></a><span>        </span><a name="local-6989586621679080614"><a href="#local-6989586621679080614"><span class="hs-identifier">xi</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080612"><span class="hs-identifier hs-var">top</span></a><span>
</span><a name="line-1440"></a><span>        </span><a name="local-6989586621679080615"><a href="#local-6989586621679080615"><span class="hs-identifier">convexHull'</span></a></a><span> </span><a name="local-6989586621679080651"><a href="#local-6989586621679080651"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679080652"><a href="#local-6989586621679080652"><span class="hs-identifier">xi</span></a></a><span> </span><a name="local-6989586621679080653"><a href="#local-6989586621679080653"><span class="hs-identifier">topx</span></a></a><span> </span><a name="local-6989586621679080654"><a href="#local-6989586621679080654"><span class="hs-identifier">top</span></a></a><span> </span><a name="local-6989586621679080655"><a href="#local-6989586621679080655"><span class="hs-identifier">ptsSort</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080651"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679080652"><span class="hs-identifier hs-var">xi</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621679080659"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080615"><span class="hs-identifier hs-var">convexHull'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080651"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080652"><span class="hs-identifier hs-var">xi</span></a><span> </span><a href="#local-6989586621679080654"><span class="hs-identifier hs-var">top</span></a><span> </span><a href="#local-6989586621679080659"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="#local-6989586621679080655"><span class="hs-identifier hs-var">ptsSort</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679080659"><span class="hs-identifier hs-var">x1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080654"><span class="hs-identifier hs-var">top</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679080659"><span class="hs-identifier hs-var">x1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080654"><span class="hs-identifier hs-var">top</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-1441"></a><span>                            </span><span class="hs-keyword">where</span><span>
</span><a name="line-1442"></a><span>                                </span><span class="hs-comment">-- use merge sort here for y andthen x</span><span>
</span><a name="line-1443"></a><span>                                </span><span class="hs-comment">-- choose the left most vertex</span><span>
</span><a name="line-1444"></a><span>                                </span><span class="hs-comment">-- find the biggest dot product of vec(top x1) vec(top x2), the smallest angle</span><span>
</span><a name="line-1445"></a><span>                                </span><a name="local-6989586621679080656"><a href="#local-6989586621679080656"><span class="hs-identifier">cx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">filter</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080660"><a href="#local-6989586621679080660"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679080660"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621679080654"><span class="hs-identifier hs-var">top</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080655"><span class="hs-identifier hs-var">ptsSort</span></a><span> </span><span class="hs-comment">-- remove top pt</span><span>
</span><a name="line-1446"></a><span>                                </span><a name="local-6989586621679080657"><a href="#local-6989586621679080657"><span class="hs-identifier">vexSort</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#qqsort"><span class="hs-identifier hs-var">qqsort</span></a><span> </span><a href="#local-6989586621679080658"><span class="hs-identifier hs-var">cmp</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679080661"><a href="#local-6989586621679080661"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#cosVex3"><span class="hs-identifier hs-var">cosVex3</span></a><span> </span><a href="#local-6989586621679080653"><span class="hs-identifier hs-var">topx</span></a><span> </span><a href="#local-6989586621679080654"><span class="hs-identifier hs-var">top</span></a><span> </span><a href="#local-6989586621679080661"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080654"><span class="hs-identifier hs-var">top</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080661"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679080656"><span class="hs-identifier hs-var">cx</span></a><span>
</span><a name="line-1447"></a><span>                                </span><a name="local-6989586621679080658"><a href="#local-6989586621679080658"><span class="hs-identifier">cmp</span></a></a><span> </span><a name="local-6989586621679080662"><a href="#local-6989586621679080662"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-6989586621679080663"><a href="#local-6989586621679080663"><span class="hs-identifier">c2</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080607"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679080662"><span class="hs-identifier hs-var">c1</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679080607"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679080663"><span class="hs-identifier hs-var">c2</span></a><span> </span><span class="hs-comment">-- the largest angle for the smallest cos(angle) </span><span>
</span><a name="line-1448"></a><span>                                </span><a name="local-6989586621679080659"><a href="#local-6989586621679080659"><span class="hs-identifier">x1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080609"><span class="hs-identifier hs-var">t3</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679080657"><span class="hs-identifier hs-var">vexSort</span></a><span>
</span><a name="line-1449"></a><span>
</span><a name="line-1450"></a><span>
</span><a name="line-1451"></a><span class="hs-comment">{-|
    === Projection from \(u\) onto \(v\) in Vector3
    &lt;http://localhost/pdf/projectionlatex.pdf projection&gt;
-}</span><span>
</span><a name="line-1455"></a><span class="hs-identifier">projv</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span>
</span><a name="line-1456"></a><a name="projv"><a href="AronGraphic.html#projv"><span class="hs-identifier">projv</span></a></a><span> </span><a name="local-6989586621679080664"><a href="#local-6989586621679080664"><span class="hs-identifier">u</span></a></a><span> </span><a name="local-6989586621679080665"><a href="#local-6989586621679080665"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080669"><span class="hs-identifier hs-var">w'</span></a><span>
</span><a name="line-1457"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1458"></a><span>    </span><a name="local-6989586621679080666"><a href="#local-6989586621679080666"><span class="hs-identifier">u'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#veMat"><span class="hs-identifier hs-var">veMat</span></a><span> </span><a href="#local-6989586621679080664"><span class="hs-identifier hs-var">u</span></a><span>
</span><a name="line-1459"></a><span>    </span><a name="local-6989586621679080667"><a href="#local-6989586621679080667"><span class="hs-identifier">v'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#veMat"><span class="hs-identifier hs-var">veMat</span></a><span> </span><a href="#local-6989586621679080665"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1460"></a><span>    </span><a name="local-6989586621679080668"><a href="#local-6989586621679080668"><span class="hs-identifier">w</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#projn"><span class="hs-identifier hs-var">projn</span></a><span> </span><a href="#local-6989586621679080666"><span class="hs-identifier hs-var">u'</span></a><span> </span><a href="#local-6989586621679080667"><span class="hs-identifier hs-var">v'</span></a><span>
</span><a name="line-1461"></a><span>    </span><a name="local-6989586621679080669"><a href="#local-6989586621679080669"><span class="hs-identifier">w'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#matVe"><span class="hs-identifier hs-var">matVe</span></a><span> </span><a href="#local-6989586621679080668"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-1462"></a><span>
</span><a name="line-1463"></a><span class="hs-comment">{-|
   === Compute the norm of a vector
   \(v = (x, y, z)\) 

   \(|v| = \sqrt{ x^2 + y^2 + z^2} \)
-}</span><span>
</span><a name="line-1469"></a><span class="hs-identifier">nr</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-1470"></a><a name="nr"><a href="AronGraphic.html#nr"><span class="hs-identifier">nr</span></a></a><span> </span><a name="local-6989586621679080670"><a href="#local-6989586621679080670"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sqrt</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#dot3ve"><span class="hs-identifier hs-var">dot3ve</span></a><span> </span><a href="#local-6989586621679080670"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679080670"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1471"></a><span>
</span><a name="line-1472"></a><span class="hs-comment">{-|
  === Normalize a vector 
  e.g \( \|\vec{v}\| = 1 \)
-}</span><span>
</span><a name="line-1476"></a><span class="hs-identifier">uv</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span>
</span><a name="line-1477"></a><a name="uv"><a href="AronGraphic.html#uv"><span class="hs-identifier">uv</span></a></a><span> </span><a name="local-6989586621679080671"><a href="#local-6989586621679080671"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">/</span><a href="#local-6989586621679080672"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679080671"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1478"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1479"></a><span>        </span><a name="local-6989586621679080672"><a href="#local-6989586621679080672"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#nr"><span class="hs-identifier hs-var">nr</span></a><span> </span><a href="#local-6989586621679080671"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1480"></a><span class="hs-comment">{-|
    === Rodrigue formula

    \(u\) rotates around \(v\) in angle \(\phi\) in right hand rule
     
    rejection = \(u - p\)
     
    gx &lt;http://localhost/pdf/rotate_arbitrary_axis.pdf Rotation&gt;
-}</span><span>
</span><a name="line-1489"></a><a name="rod"><a href="AronGraphic.html#rod"><span class="hs-identifier">rod</span></a></a><span> </span><a name="local-6989586621679080673"><a href="#local-6989586621679080673"><span class="hs-identifier">u</span></a></a><span> </span><a name="local-6989586621679080674"><a href="#local-6989586621679080674"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679080675"><a href="#local-6989586621679080675"><span class="hs-identifier">&#952;</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080680"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-1490"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1491"></a><span>    </span><a name="local-6989586621679080676"><a href="#local-6989586621679080676"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#projv"><span class="hs-identifier hs-var">projv</span></a><span> </span><a href="#local-6989586621679080673"><span class="hs-identifier hs-var">u</span></a><span> </span><a href="#local-6989586621679080674"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1492"></a><span>    </span><a name="local-6989586621679080677"><a href="#local-6989586621679080677"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080673"><span class="hs-identifier hs-var">u</span></a><span> </span><a href="AronGraphic.html#%2297"><span class="hs-operator hs-var">&#8855;</span></a><span> </span><a href="#local-6989586621679080674"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-comment">-- right hand rule</span><span>
</span><a name="line-1493"></a><span>    </span><a name="local-6989586621679080678"><a href="#local-6989586621679080678"><span class="hs-identifier">re</span></a></a><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080673"><span class="hs-identifier hs-var">u</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679080676"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-1494"></a><span>    </span><a name="local-6989586621679080679"><a href="#local-6989586621679080679"><span class="hs-identifier">u'</span></a></a><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">cos</span><span> </span><a href="#local-6989586621679080675"><span class="hs-identifier hs-var">&#952;</span></a><span class="hs-special">)</span><span> </span><a href="AronGraphic.html#%2A%3A"><span class="hs-operator hs-var">*:</span></a><span> </span><a href="#local-6989586621679080678"><span class="hs-identifier hs-var">re</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">sin</span><span> </span><a href="#local-6989586621679080675"><span class="hs-identifier hs-var">&#952;</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#nr"><span class="hs-identifier hs-var">nr</span></a><span> </span><a href="#local-6989586621679080678"><span class="hs-identifier hs-var">re</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="AronGraphic.html#%2A%3A"><span class="hs-operator hs-var">*:</span></a><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#uv"><span class="hs-identifier hs-var">uv</span></a><span> </span><a href="#local-6989586621679080677"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1495"></a><span>    </span><a name="local-6989586621679080680"><a href="#local-6989586621679080680"><span class="hs-identifier">tv</span></a></a><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080676"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679080679"><span class="hs-identifier hs-var">u'</span></a><span>
</span><a name="line-1496"></a><span>
</span><a name="line-1497"></a><span class="hs-comment">{-|
    === Compute an angle from three points: \(a, b, c \) with dot product
    &gt;let a = Vertex3 1 0 0
    &gt;let b = Vertex3 0 0 0
    &gt;let c = Vertex3 1 0 0
    &gt;cosVex3 a b c
    &gt;0.0

    \( \vec{ba} = a - b \)

    \( \vec{bc} = c - b \)

    \[ 
        \begin{equation}
        \begin{aligned}
            \vec{ba} \circ \vec{bc} &amp;= | \vec{ba} | | \vec{bc} | \cos{\angle ABC}  \\
            \cos{\angle ABC} &amp;= \frac{ \vec{bc} \circ \vec{bc} }{| \vec{ba} | | \vec{bc}|} \\
        \end{aligned}
        \end{equation}
    \] 

-}</span><span>
</span><a name="line-1519"></a><span class="hs-identifier">cosVex3</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-1520"></a><a name="cosVex3"><a href="AronGraphic.html#cosVex3"><span class="hs-identifier">cosVex3</span></a></a><span> </span><a name="local-6989586621679080681"><a href="#local-6989586621679080681"><span class="hs-identifier">p0</span></a></a><span> </span><a name="local-6989586621679080682"><a href="#local-6989586621679080682"><span class="hs-identifier">p1</span></a></a><span> </span><a name="local-6989586621679080683"><a href="#local-6989586621679080683"><span class="hs-identifier">p2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080686"><span class="hs-identifier hs-var">d</span></a><span class="hs-operator hs-var">/</span><span class="hs-special">(</span><a href="#local-6989586621679080687"><span class="hs-identifier hs-var">n1</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679080688"><span class="hs-identifier hs-var">n2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1521"></a><span>                    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1522"></a><span>                        </span><a name="local-6989586621679080684"><a href="#local-6989586621679080684"><span class="hs-identifier">v10</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080681"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679080682"><span class="hs-identifier hs-var">p1</span></a><span>
</span><a name="line-1523"></a><span>                        </span><a name="local-6989586621679080685"><a href="#local-6989586621679080685"><span class="hs-identifier">v12</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679080683"><span class="hs-identifier hs-var">p2</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679080682"><span class="hs-identifier hs-var">p1</span></a><span>
</span><a name="line-1524"></a><span>                        </span><a name="local-6989586621679080686"><a href="#local-6989586621679080686"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#dot3ve"><span class="hs-identifier hs-var">dot3ve</span></a><span> </span><a href="#local-6989586621679080684"><span class="hs-identifier hs-var">v10</span></a><span> </span><a href="#local-6989586621679080685"><span class="hs-identifier hs-var">v12</span></a><span>
</span><a name="line-1525"></a><span>                        </span><a name="local-6989586621679080687"><a href="#local-6989586621679080687"><span class="hs-identifier">n1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#nr"><span class="hs-identifier hs-var">nr</span></a><span> </span><a href="#local-6989586621679080684"><span class="hs-identifier hs-var">v10</span></a><span>
</span><a name="line-1526"></a><span>                        </span><a name="local-6989586621679080688"><a href="#local-6989586621679080688"><span class="hs-identifier">n2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#nr"><span class="hs-identifier hs-var">nr</span></a><span> </span><a href="#local-6989586621679080685"><span class="hs-identifier hs-var">v12</span></a><span>
</span><a name="line-1527"></a></pre></body></html>