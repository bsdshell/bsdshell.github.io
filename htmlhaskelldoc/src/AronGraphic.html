<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">AronGraphic</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control.Concurrent</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">threadDelay</span><span class="hs-special">)</span><span>
</span><a name="line-4"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control.Monad</span><span>                        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unless</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">when</span><span class="hs-special">)</span><span>
</span><a name="line-5"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control.Monad</span><span>
</span><a name="line-6"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.IORef</span><span>
</span><a name="line-7"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Maybe</span><span>
</span><a name="line-8"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Set</span><span>                             </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">delete</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">fromList</span><span class="hs-special">)</span><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Set</span><span>                             </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">S</span><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.List</span><span>                             </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">L</span><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">GHC.Real</span><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Graphics.Rendering.OpenGL</span><span>            </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">GL</span><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Graphics.Rendering.OpenGL.GLU.Matrix</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">GM</span><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Graphics.UI.GLFW</span><span>                     </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">FW</span><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">System.Exit</span><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">System.IO</span><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">System.Random</span><span>
</span><a name="line-18"></a><span class="hs-comment">--import Linear.V3</span><span>
</span><a name="line-19"></a><span class="hs-comment">--import Linear.V3(cross)</span><span>
</span><a name="line-20"></a><span class="hs-comment">--import Linear.Vector</span><span>
</span><a name="line-21"></a><span class="hs-comment">--import Linear.Matrix</span><span>
</span><a name="line-22"></a><span class="hs-comment">--import Linear.Projection as P</span><span>
</span><a name="line-23"></a><span class="hs-comment">--import Linear.Metric(norm, signorm)</span><span>
</span><a name="line-24"></a><span>
</span><a name="line-25"></a><span class="hs-keyword">import</span><span>           </span><a href="AronModule.html"><span class="hs-identifier">AronModule</span></a><span>
</span><a name="line-26"></a><span>
</span><a name="line-27"></a><span class="hs-identifier">lightDiffuse</span><span> </span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Color4</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-28"></a><a name="lightDiffuse"><a href="AronGraphic.html#lightDiffuse"><span class="hs-identifier">lightDiffuse</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Color4</span><span> </span><span class="hs-number">0.6</span><span> </span><span class="hs-number">1.0</span><span> </span><span class="hs-number">0.5</span><span> </span><span class="hs-number">0.6</span><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span class="hs-identifier">lightAmbient</span><span> </span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Color4</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-31"></a><a name="lightAmbient"><a href="AronGraphic.html#lightAmbient"><span class="hs-identifier">lightAmbient</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Color4</span><span> </span><span class="hs-number">0.0</span><span> </span><span class="hs-number">0.0</span><span> </span><span class="hs-number">1.0</span><span> </span><span class="hs-number">1.0</span><span>
</span><a name="line-32"></a><span>
</span><a name="line-33"></a><span class="hs-identifier">lightPosition</span><span> </span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex4</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-34"></a><a name="lightPosition"><a href="AronGraphic.html#lightPosition"><span class="hs-identifier">lightPosition</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex4</span><span> </span><span class="hs-number">1.0</span><span> </span><span class="hs-number">1.0</span><span> </span><span class="hs-number">1.2</span><span> </span><span class="hs-number">0.0</span><span>
</span><a name="line-35"></a><span>
</span><a name="line-36"></a><span class="hs-identifier">lightSpecular</span><span> </span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Color4</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-37"></a><a name="lightSpecular"><a href="AronGraphic.html#lightSpecular"><span class="hs-identifier">lightSpecular</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Color4</span><span> </span><span class="hs-number">1.0</span><span> </span><span class="hs-number">0.7</span><span> </span><span class="hs-number">1.0</span><span> </span><span class="hs-number">0.8</span><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span class="hs-keyword">data</span><span> </span><a name="SegEndPt"><a href="AronGraphic.html#SegEndPt"><span class="hs-identifier">SegEndPt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="No"><a href="AronGraphic.html#No"><span class="hs-identifier">No</span></a></a><span>      </span><span class="hs-comment">-- no pt, just a segment</span><span>
</span><a name="line-40"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a name="End"><a href="AronGraphic.html#End"><span class="hs-identifier">End</span></a></a><span>   </span><span class="hs-comment">-- end pt</span><span>
</span><a name="line-41"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a name="Beg"><a href="AronGraphic.html#Beg"><span class="hs-identifier">Beg</span></a></a><span>   </span><span class="hs-comment">-- begin pt</span><span>
</span><a name="line-42"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a name="Both"><a href="AronGraphic.html#Both"><span class="hs-identifier">Both</span></a></a><span>  </span><span class="hs-comment">-- begin and end pts</span><span>
</span><a name="line-43"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a name="Cen"><a href="AronGraphic.html#Cen"><span class="hs-identifier">Cen</span></a></a><span>   </span><span class="hs-comment">-- center pt</span><span>
</span><a name="line-44"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a name="All"><a href="AronGraphic.html#All"><span class="hs-identifier">All</span></a></a><span>   </span><span class="hs-comment">-- all pts: begin, end and ceneter</span><span>
</span><a name="line-45"></a><span>
</span><a name="line-46"></a><span class="hs-comment">--   /\</span><span>
</span><a name="line-47"></a><span class="hs-comment">--   | ccw</span><span>
</span><a name="line-48"></a><span class="hs-comment">--    --&gt;</span><span>
</span><a name="line-49"></a><span class="hs-comment">--   | cw</span><span>
</span><a name="line-50"></a><span class="hs-comment">--   V</span><span>
</span><a name="line-51"></a><span class="hs-comment">-- | counter clockwise | clock wise</span><span>
</span><a name="line-52"></a><span class="hs-keyword">data</span><span> </span><a name="NormalDir"><a href="AronGraphic.html#NormalDir"><span class="hs-identifier">NormalDir</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="NCCW"><a href="AronGraphic.html#NCCW"><span class="hs-identifier">NCCW</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="NCW"><a href="AronGraphic.html#NCW"><span class="hs-identifier">NCW</span></a></a><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">)</span><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span>
</span><a name="line-55"></a><span class="hs-comment">{-|
    === Compute the distance between two points

    \( v = (x, y, z) \)

    \( \| v \| = \sqrt{ x^2 + y^2 + z^2} = \sqrt{ v \cdot v} \)

    &gt;let v1 = Vertex3 1 2 3
    &gt;let v2 = Vertex3 2 3 4
    &gt;dist v1 v2
-}</span><span>
</span><a name="line-66"></a><span class="hs-identifier">dist</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-67"></a><a name="dist"><a href="AronGraphic.html#dist"><span class="hs-identifier">dist</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679094545"><a href="#local-6989586621679094545"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679094546"><a href="#local-6989586621679094546"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679094547"><a href="#local-6989586621679094547"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679094548"><a href="#local-6989586621679094548"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679094549"><a href="#local-6989586621679094549"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679094550"><a href="#local-6989586621679094550"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sqrt</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094548"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679094545"><span class="hs-identifier hs-var">x0</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">**</span><span class="hs-number">2</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094549"><span class="hs-identifier hs-var">y1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679094546"><span class="hs-identifier hs-var">y0</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">**</span><span class="hs-number">2</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094550"><span class="hs-identifier hs-var">z1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679094547"><span class="hs-identifier hs-var">z0</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">**</span><span class="hs-number">2</span><span>
</span><a name="line-68"></a><span>
</span><a name="line-69"></a><span>
</span><a name="line-70"></a><span class="hs-comment">{-|
    === Compute the norm-squared

    \( v = (x, y, z)\)

    \( |v|^2 = x^2 + y^2 + z^2 \)

    &gt;let v1 = Vertex3 1 2 3
    &gt;let v2 = Vertex3 2 3 4
    &gt;sqdist v1 v2
-}</span><span>
</span><a name="line-81"></a><span class="hs-identifier">sqdist</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-82"></a><a name="sqdist"><a href="AronGraphic.html#sqdist"><span class="hs-identifier">sqdist</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679094551"><a href="#local-6989586621679094551"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679094552"><a href="#local-6989586621679094552"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679094553"><a href="#local-6989586621679094553"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679094554"><a href="#local-6989586621679094554"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679094555"><a href="#local-6989586621679094555"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679094556"><a href="#local-6989586621679094556"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094554"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679094551"><span class="hs-identifier hs-var">x0</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">**</span><span class="hs-number">2</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094555"><span class="hs-identifier hs-var">y1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679094552"><span class="hs-identifier hs-var">y0</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">**</span><span class="hs-number">2</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094556"><span class="hs-identifier hs-var">z1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679094553"><span class="hs-identifier hs-var">z0</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">**</span><span class="hs-number">2</span><span>
</span><a name="line-83"></a><span>
</span><a name="line-84"></a><span class="hs-comment">-- | dot product for Vector3</span><span>
</span><a name="line-85"></a><span class="hs-identifier">dot3ve</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679094544"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-identifier hs-type">Vector3</span><span> </span><a href="#local-6989586621679094544"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><a href="#local-6989586621679094544"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679094544"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-86"></a><a name="dot3ve"><a href="AronGraphic.html#dot3ve"><span class="hs-identifier">dot3ve</span></a></a><span> </span><a name="local-6989586621679094557"><a href="#local-6989586621679094557"><span class="hs-identifier">v1</span></a></a><span> </span><a name="local-6989586621679094558"><a href="#local-6989586621679094558"><span class="hs-identifier">v2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#dot3vx"><span class="hs-identifier hs-var">dot3vx</span></a><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#v2x"><span class="hs-identifier hs-var">v2x</span></a><span> </span><a href="#local-6989586621679094557"><span class="hs-identifier hs-var">v1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#v2x"><span class="hs-identifier hs-var">v2x</span></a><span> </span><a href="#local-6989586621679094558"><span class="hs-identifier hs-var">v2</span></a><span class="hs-special">)</span><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span class="hs-comment">-- | dot product for Vertex3</span><span>
</span><a name="line-89"></a><span class="hs-identifier">dot3vx</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679094543"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679094543"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679094543"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679094543"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-90"></a><a name="dot3vx"><a href="AronGraphic.html#dot3vx"><span class="hs-identifier">dot3vx</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679094559"><a href="#local-6989586621679094559"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679094560"><a href="#local-6989586621679094560"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679094561"><a href="#local-6989586621679094561"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679094562"><a href="#local-6989586621679094562"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679094563"><a href="#local-6989586621679094563"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679094564"><a href="#local-6989586621679094564"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679094559"><span class="hs-identifier hs-var">x0</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679094562"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679094560"><span class="hs-identifier hs-var">y0</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679094563"><span class="hs-identifier hs-var">y1</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679094561"><span class="hs-identifier hs-var">z0</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679094564"><span class="hs-identifier hs-var">z1</span></a><span>
</span><a name="line-91"></a><span>
</span><a name="line-92"></a><span class="hs-special">(</span><span class="hs-operator">+:</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679094542"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679094542"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><a href="#local-6989586621679094542"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679094542"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-93"></a><span class="hs-special">(</span><a name="%2B%3A"><a href="AronGraphic.html#%2B%3A"><span class="hs-operator">+:</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679094565"><a href="#local-6989586621679094565"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679094566"><a href="#local-6989586621679094566"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679094567"><a href="#local-6989586621679094567"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679094568"><a href="#local-6989586621679094568"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679094569"><a href="#local-6989586621679094569"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679094570"><a href="#local-6989586621679094570"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094565"><span class="hs-identifier hs-var">x0</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679094568"><span class="hs-identifier hs-var">x1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094566"><span class="hs-identifier hs-var">y0</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679094569"><span class="hs-identifier hs-var">y1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094567"><span class="hs-identifier hs-var">z0</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679094570"><span class="hs-identifier hs-var">z1</span></a><span class="hs-special">)</span><span>
</span><a name="line-94"></a><span>
</span><a name="line-95"></a><span class="hs-special">(</span><span class="hs-operator">-:</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679094541"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679094541"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679094541"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><a href="#local-6989586621679094541"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-96"></a><span class="hs-special">(</span><a name="-%3A"><a href="AronGraphic.html#-%3A"><span class="hs-operator">-:</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679094571"><a href="#local-6989586621679094571"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679094572"><a href="#local-6989586621679094572"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679094573"><a href="#local-6989586621679094573"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679094574"><a href="#local-6989586621679094574"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679094575"><a href="#local-6989586621679094575"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679094576"><a href="#local-6989586621679094576"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vector3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094571"><span class="hs-identifier hs-var">x0</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679094574"><span class="hs-identifier hs-var">x1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094572"><span class="hs-identifier hs-var">y0</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679094575"><span class="hs-identifier hs-var">y1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094573"><span class="hs-identifier hs-var">z0</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679094576"><span class="hs-identifier hs-var">z1</span></a><span class="hs-special">)</span><span>
</span><a name="line-97"></a><span>
</span><a name="line-98"></a><span class="hs-special">(</span><span class="hs-operator">&#8869;</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-99"></a><span class="hs-special">(</span><a name="%22A5"><a href="AronGraphic.html#%22A5"><span class="hs-operator">&#8869;</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679094577"><a href="#local-6989586621679094577"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679094578"><a href="#local-6989586621679094578"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679094579"><a href="#local-6989586621679094579"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vector3</span><span> </span><a href="#local-6989586621679094578"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679094577"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679094579"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-100"></a><span>
</span><a name="line-101"></a><span class="hs-identifier">perpcw</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679094540"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-identifier hs-type">Vector3</span><span> </span><a href="#local-6989586621679094540"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Vector3</span><span> </span><a href="#local-6989586621679094540"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-102"></a><a name="perpcw"><a href="AronGraphic.html#perpcw"><span class="hs-identifier">perpcw</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679094580"><a href="#local-6989586621679094580"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679094581"><a href="#local-6989586621679094581"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679094582"><a href="#local-6989586621679094582"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vector3</span><span> </span><a href="#local-6989586621679094581"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679094580"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679094582"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span class="hs-identifier">perpccw</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679094539"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-identifier hs-type">Vector3</span><span> </span><a href="#local-6989586621679094539"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Vector3</span><span> </span><a href="#local-6989586621679094539"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-105"></a><a name="perpccw"><a href="AronGraphic.html#perpccw"><span class="hs-identifier">perpccw</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679094583"><a href="#local-6989586621679094583"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679094584"><a href="#local-6989586621679094584"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679094585"><a href="#local-6989586621679094585"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vector3</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679094584"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679094583"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679094585"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-106"></a><span>
</span><a name="line-107"></a><span class="hs-special">(</span><span class="hs-operator">*:</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679094538"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><a href="#local-6989586621679094538"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><a href="#local-6989586621679094538"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><a href="#local-6989586621679094538"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-108"></a><span class="hs-special">(</span><a name="%2A%3A"><a href="AronGraphic.html#%2A%3A"><span class="hs-operator">*:</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679094586"><a href="#local-6989586621679094586"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679094587"><a href="#local-6989586621679094587"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679094588"><a href="#local-6989586621679094588"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679094589"><a href="#local-6989586621679094589"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vector3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094586"><span class="hs-identifier hs-var">k</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679094587"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094586"><span class="hs-identifier hs-var">k</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679094588"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094586"><span class="hs-identifier hs-var">k</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679094589"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span>
</span><a name="line-109"></a><span>
</span><a name="line-110"></a><span class="hs-special">(</span><span class="hs-operator">**:</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-111"></a><span class="hs-special">(</span><a name="%2A%2A%3A"><a href="AronGraphic.html#%2A%2A%3A"><span class="hs-operator">**:</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679094590"><a href="#local-6989586621679094590"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679094591"><a href="#local-6989586621679094591"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679094592"><a href="#local-6989586621679094592"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679094593"><a href="#local-6989586621679094593"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094590"><span class="hs-identifier hs-var">t</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679094591"><span class="hs-identifier hs-var">x0</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094590"><span class="hs-identifier hs-var">t</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679094592"><span class="hs-identifier hs-var">y0</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094590"><span class="hs-identifier hs-var">t</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679094593"><span class="hs-identifier hs-var">z0</span></a><span class="hs-special">)</span><span>
</span><a name="line-112"></a><span>
</span><a name="line-113"></a><span class="hs-special">(</span><span class="hs-operator">*&gt;:</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-114"></a><span class="hs-special">(</span><a name="%2A%3E%3A"><a href="AronGraphic.html#%2A%3E%3A"><span class="hs-operator">*&gt;:</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679094594"><a href="#local-6989586621679094594"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679094595"><a href="#local-6989586621679094595"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679094596"><a href="#local-6989586621679094596"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679094597"><a href="#local-6989586621679094597"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094594"><span class="hs-identifier hs-var">k</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679094595"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094594"><span class="hs-identifier hs-var">k</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679094596"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094594"><span class="hs-identifier hs-var">k</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679094597"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span>
</span><a name="line-115"></a><span>
</span><a name="line-116"></a><span class="hs-special">(</span><span class="hs-operator">&gt;&gt;:</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-117"></a><span class="hs-special">(</span><a name="%3E%3E%3A"><a href="AronGraphic.html#%3E%3E%3A"><span class="hs-operator">&gt;&gt;:</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679094598"><a href="#local-6989586621679094598"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679094599"><a href="#local-6989586621679094599"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679094600"><a href="#local-6989586621679094600"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679094601"><a href="#local-6989586621679094601"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vector3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094598"><span class="hs-identifier hs-var">k</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679094599"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094598"><span class="hs-identifier hs-var">k</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679094600"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094598"><span class="hs-identifier hs-var">k</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679094601"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span>
</span><a name="line-118"></a><span>
</span><a name="line-119"></a><span class="hs-special">(</span><span class="hs-operator">.&gt;</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-120"></a><span class="hs-special">(</span><a name=".%3E"><a href="AronGraphic.html#.%3E"><span class="hs-operator">.&gt;</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">3</span><span>
</span><a name="line-121"></a><span>
</span><a name="line-122"></a><span class="hs-comment">-- | dot product  odot</span><span>
</span><a name="line-123"></a><span class="hs-special">(</span><span class="hs-operator">&#8857;</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-124"></a><span class="hs-special">(</span><a name="%2299"><a href="AronGraphic.html#%2299"><span class="hs-operator">&#8857;</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679094602"><a href="#local-6989586621679094602"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679094603"><a href="#local-6989586621679094603"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679094604"><a href="#local-6989586621679094604"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679094605"><a href="#local-6989586621679094605"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679094606"><a href="#local-6989586621679094606"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679094607"><a href="#local-6989586621679094607"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094602"><span class="hs-identifier hs-var">x0</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679094605"><span class="hs-identifier hs-var">x1</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094603"><span class="hs-identifier hs-var">y0</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679094606"><span class="hs-identifier hs-var">y1</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094604"><span class="hs-identifier hs-var">z0</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679094607"><span class="hs-identifier hs-var">z1</span></a><span class="hs-special">)</span><span>
</span><a name="line-125"></a><span>
</span><a name="line-126"></a><span class="hs-special">(</span><span class="hs-operator">&#8712;</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679094537"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679094537"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><a href="#local-6989586621679094537"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679094537"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-127"></a><span class="hs-special">(</span><a name="%2208"><a href="AronGraphic.html#%2208"><span class="hs-operator">&#8712;</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679094608"><a href="#local-6989586621679094608"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621679094609"><a href="#local-6989586621679094609"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679094610"><a href="#local-6989586621679094610"><span class="hs-identifier">c</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679094608"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><a href="#local-6989586621679094609"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679094608"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621679094610"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-128"></a><span>
</span><a name="line-129"></a><span class="hs-special">(</span><span class="hs-operator">&#8728;</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679094536"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><a href="#local-6989586621679094536"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><a href="#local-6989586621679094536"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><a href="#local-6989586621679094536"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-130"></a><span class="hs-special">(</span><a name="%2218"><a href="AronGraphic.html#%2218"><span class="hs-operator">&#8728;</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679094611"><a href="#local-6989586621679094611"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679094612"><a href="#local-6989586621679094612"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679094613"><a href="#local-6989586621679094613"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679094614"><a href="#local-6989586621679094614"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vector3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094611"><span class="hs-identifier hs-var">k</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679094612"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094611"><span class="hs-identifier hs-var">k</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679094613"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094611"><span class="hs-identifier hs-var">k</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679094614"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span>
</span><a name="line-131"></a><span>
</span><a name="line-132"></a><span class="hs-special">(</span><span class="hs-operator">&#8721;</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-133"></a><span class="hs-special">(</span><a name="%2211"><a href="AronGraphic.html#%2211"><span class="hs-operator">&#8721;</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">4</span><span>
</span><a name="line-134"></a><span class="hs-special">(</span><span class="hs-operator">&#8718;</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-135"></a><span class="hs-special">(</span><a name="%220E"><a href="AronGraphic.html#%220E"><span class="hs-operator">&#8718;</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679094615"><a href="#local-6989586621679094615"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679094616"><a href="#local-6989586621679094616"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679094617"><a href="#local-6989586621679094617"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679094618"><a href="#local-6989586621679094618"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vector3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094615"><span class="hs-identifier hs-var">k</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679094618"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094615"><span class="hs-identifier hs-var">k</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679094617"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094615"><span class="hs-identifier hs-var">k</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679094618"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span>
</span><a name="line-136"></a><span>
</span><a name="line-137"></a><span class="hs-identifier">v2x</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679094535"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-identifier hs-type">Vector3</span><span> </span><a href="#local-6989586621679094535"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679094535"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-138"></a><a name="v2x"><a href="AronGraphic.html#v2x"><span class="hs-identifier">v2x</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679094619"><a href="#local-6989586621679094619"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679094620"><a href="#local-6989586621679094620"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679094621"><a href="#local-6989586621679094621"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a href="#local-6989586621679094619"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679094620"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679094621"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-139"></a><span>
</span><a name="line-140"></a><span class="hs-identifier">x2v</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679094534"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679094534"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><a href="#local-6989586621679094534"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-141"></a><a name="x2v"><a href="AronGraphic.html#x2v"><span class="hs-identifier">x2v</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679094622"><a href="#local-6989586621679094622"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679094623"><a href="#local-6989586621679094623"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679094624"><a href="#local-6989586621679094624"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vector3</span><span> </span><a href="#local-6989586621679094622"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679094623"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679094624"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-142"></a><span>
</span><a name="line-143"></a><span class="hs-comment">-- Tue Jan  1 17:57:32 2019</span><span>
</span><a name="line-144"></a><span class="hs-comment">-- remove it</span><span>
</span><a name="line-145"></a><span class="hs-comment">--smulv::GLfloat -&gt; Vector3 GLfloat -&gt;Vector3 GLfloat</span><span>
</span><a name="line-146"></a><span class="hs-comment">--smulv k (Vector3 x y z) = Vector3 (k*x) (k*y) (k*z)</span><span>
</span><a name="line-147"></a><span>
</span><a name="line-148"></a><span class="hs-comment">-- | Shorten realToFrac</span><span>
</span><a name="line-149"></a><span class="hs-comment">--rf::(Real a, Fractional b) =&gt; a -&gt; b</span><span>
</span><a name="line-150"></a><span class="hs-comment">--rf = realToFrac</span><span>
</span><a name="line-151"></a><span>
</span><a name="line-152"></a><span class="hs-comment">-- | --------------------------------------------------------------------------------</span><span>
</span><a name="line-153"></a><span class="hs-comment">-- | Fri Dec  7 14:35:38 2018</span><span>
</span><a name="line-154"></a><span class="hs-comment">-- | three colors: data Color3 a = Color3 !a !a !a</span><span>
</span><a name="line-155"></a><a name="red"><a href="AronGraphic.html#red"><span class="hs-identifier">red</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Color3</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span>
</span><a name="line-156"></a><a name="green"><a href="AronGraphic.html#green"><span class="hs-identifier">green</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Color3</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span>
</span><a name="line-157"></a><a name="blue"><a href="AronGraphic.html#blue"><span class="hs-identifier">blue</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Color3</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span>
</span><a name="line-158"></a><span>
</span><a name="line-159"></a><span>
</span><a name="line-160"></a><span class="hs-comment">{-|
    === Form a __skew symmetric matrix__ from \( \color{red}{Vertex3}  \)
    __cross product__ of a x b = [a] b where [a] is skew symmetric matrix from vector a
    colIndex x rowIndex = [c][r]

    &gt;Vertex3 a1 a2 a3

    \[
     \begin{bmatrix}
            0    &amp; -a_3 &amp; a_2 \\
            a_3  &amp; 0    &amp; -a_1 \\
            -a_2 &amp; a_1  &amp; 0 \\
     \end{bmatrix}
    \]

-}</span><span>
</span><a name="line-176"></a><span class="hs-identifier">skew</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679094533"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679094533"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679094533"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-177"></a><a name="skew"><a href="AronGraphic.html#skew"><span class="hs-identifier">skew</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679094625"><a href="#local-6989586621679094625"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679094626"><a href="#local-6989586621679094626"><span class="hs-identifier">a2</span></a></a><span> </span><a name="local-6989586621679094627"><a href="#local-6989586621679094627"><span class="hs-identifier">a3</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span>
</span><a name="line-178"></a><span>                            </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span>     </span><span class="hs-glyph">-</span><a href="#local-6989586621679094627"><span class="hs-identifier hs-var">a3</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679094626"><span class="hs-identifier hs-var">a2</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-179"></a><span>                            </span><span class="hs-special">[</span><a href="#local-6989586621679094627"><span class="hs-identifier hs-var">a3</span></a><span class="hs-special">,</span><span>    </span><span class="hs-number">0</span><span class="hs-special">,</span><span>  </span><span class="hs-glyph">-</span><a href="#local-6989586621679094625"><span class="hs-identifier hs-var">a1</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-180"></a><span>                            </span><span class="hs-special">[</span><span class="hs-glyph">-</span><a href="#local-6989586621679094626"><span class="hs-identifier hs-var">a2</span></a><span class="hs-special">,</span><span>   </span><a href="#local-6989586621679094625"><span class="hs-identifier hs-var">a1</span></a><span class="hs-special">,</span><span>   </span><span class="hs-number">0</span><span class="hs-special">]</span><span>
</span><a name="line-181"></a><span>                          </span><span class="hs-special">]</span><span>
</span><a name="line-182"></a><span>
</span><a name="line-183"></a><span>
</span><a name="line-184"></a><span class="hs-comment">{-|
    === Form a __skew symmetric matrix__ from \( \color{red}{Vector3}  \)
    __cross product__ of a x b = [a] b where [a] is skew symmetric matrix from vector a
    colIndex x rowIndex = [c][r]

    &gt;Vertex3 a1 a2 a3

    \[
     \begin{bmatrix}
            0    &amp; -a_3 &amp; a_2 \\
            a_3  &amp; 0    &amp; -a_1 \\
            -a_2 &amp; a_1  &amp; 0 \\
     \end{bmatrix}
    \]
-}</span><span>
</span><a name="line-199"></a><span class="hs-identifier">skew'</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679094532"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-identifier hs-type">Vector3</span><span> </span><a href="#local-6989586621679094532"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679094532"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-200"></a><a name="skew%27"><a href="AronGraphic.html#skew%27"><span class="hs-identifier">skew'</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679094628"><a href="#local-6989586621679094628"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679094629"><a href="#local-6989586621679094629"><span class="hs-identifier">a2</span></a></a><span> </span><a name="local-6989586621679094630"><a href="#local-6989586621679094630"><span class="hs-identifier">a3</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span>
</span><a name="line-201"></a><span>                            </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span>     </span><span class="hs-glyph">-</span><a href="#local-6989586621679094630"><span class="hs-identifier hs-var">a3</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679094629"><span class="hs-identifier hs-var">a2</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-202"></a><span>                            </span><span class="hs-special">[</span><a href="#local-6989586621679094630"><span class="hs-identifier hs-var">a3</span></a><span class="hs-special">,</span><span>    </span><span class="hs-number">0</span><span class="hs-special">,</span><span>  </span><span class="hs-glyph">-</span><a href="#local-6989586621679094628"><span class="hs-identifier hs-var">a1</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-203"></a><span>                            </span><span class="hs-special">[</span><span class="hs-glyph">-</span><a href="#local-6989586621679094629"><span class="hs-identifier hs-var">a2</span></a><span class="hs-special">,</span><span>   </span><a href="#local-6989586621679094628"><span class="hs-identifier hs-var">a1</span></a><span class="hs-special">,</span><span>   </span><span class="hs-number">0</span><span class="hs-special">]</span><span>
</span><a name="line-204"></a><span>                           </span><span class="hs-special">]</span><span>
</span><a name="line-205"></a><span>
</span><a name="line-206"></a><span>
</span><a name="line-207"></a><span class="hs-comment">{-|
  === Cross product of two vectors.
  * The directin is determinated by the the Right Hadle Rule
-}</span><span>
</span><a name="line-211"></a><span class="hs-special">(</span><span class="hs-operator">&#8855;</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-212"></a><span class="hs-special">(</span><a name="%2297"><a href="AronGraphic.html#%2297"><span class="hs-operator">&#8855;</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679094631"><a href="#local-6989586621679094631"><span class="hs-identifier">v0</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679094632"><a href="#local-6989586621679094632"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679094633"><a href="#local-6989586621679094633"><span class="hs-identifier">a2</span></a></a><span> </span><a name="local-6989586621679094634"><a href="#local-6989586621679094634"><span class="hs-identifier">a3</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679094635"><a href="#local-6989586621679094635"><span class="hs-identifier">v1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679094636"><a href="#local-6989586621679094636"><span class="hs-identifier">b1</span></a></a><span> </span><a name="local-6989586621679094637"><a href="#local-6989586621679094637"><span class="hs-identifier">b2</span></a></a><span> </span><a name="local-6989586621679094638"><a href="#local-6989586621679094638"><span class="hs-identifier">b3</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vector3</span><span> </span><a href="#local-6989586621679094643"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679094644"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679094645"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-213"></a><span>                    </span><span class="hs-keyword">where</span><span>
</span><a name="line-214"></a><span>                        </span><a name="local-6989586621679094639"><a href="#local-6989586621679094639"><span class="hs-identifier">vs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679094636"><span class="hs-identifier hs-var">b1</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679094637"><span class="hs-identifier hs-var">b2</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679094638"><span class="hs-identifier hs-var">b3</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-215"></a><span>                        </span><span class="hs-comment">-- form a skew matrix from v0</span><span>
</span><a name="line-216"></a><span>                        </span><a name="local-6989586621679094640"><a href="#local-6989586621679094640"><span class="hs-identifier">sm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#skew%27"><span class="hs-identifier hs-var">skew'</span></a><span> </span><a href="#local-6989586621679094631"><span class="hs-identifier hs-var">v0</span></a><span>
</span><a name="line-217"></a><span>                        </span><span class="hs-comment">-- cross product: v0 X v1</span><span>
</span><a name="line-218"></a><span>                        </span><a name="local-6989586621679094641"><a href="#local-6989586621679094641"><span class="hs-identifier">vc</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#multiMat"><span class="hs-identifier hs-var">multiMat</span></a><span> </span><a href="#local-6989586621679094640"><span class="hs-identifier hs-var">sm</span></a><span> </span><a href="#local-6989586621679094639"><span class="hs-identifier hs-var">vs</span></a><span>
</span><a name="line-219"></a><span>                        </span><a name="local-6989586621679094642"><a href="#local-6989586621679094642"><span class="hs-identifier">vp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vector3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">head</span><span class="hs-special">)</span><span>
</span><a name="line-220"></a><span>
</span><a name="line-221"></a><span>                        </span><span class="hs-comment">-- vc = [[x], [y], [z]]</span><span>
</span><a name="line-222"></a><span>                        </span><a name="local-6989586621679094643"><a href="#local-6989586621679094643"><span class="hs-identifier">x</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">head</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679094641"><span class="hs-identifier hs-var">vc</span></a><span>
</span><a name="line-223"></a><span>                        </span><a name="local-6989586621679094644"><a href="#local-6989586621679094644"><span class="hs-identifier">y</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">head</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">tail</span><span> </span><a href="#local-6989586621679094641"><span class="hs-identifier hs-var">vc</span></a><span>
</span><a name="line-224"></a><span>                        </span><a name="local-6989586621679094645"><a href="#local-6989586621679094645"><span class="hs-identifier">z</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">last</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">last</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679094641"><span class="hs-identifier hs-var">vc</span></a><span>
</span><a name="line-225"></a><span>
</span><a name="line-226"></a><span>
</span><a name="line-227"></a><span class="hs-comment">-- | check whether four points are coplanar</span><span>
</span><a name="line-228"></a><span class="hs-comment">--</span><span>
</span><a name="line-229"></a><span class="hs-comment">-- | /Users/cat/myfile/bitbucket/math/coplanar.pdf</span><span>
</span><a name="line-230"></a><span class="hs-comment">--</span><span>
</span><a name="line-231"></a><span class="hs-identifier">isCoplanar</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-232"></a><a name="isCoplanar"><a href="AronGraphic.html#isCoplanar"><span class="hs-identifier">isCoplanar</span></a></a><span> </span><a name="local-6989586621679094646"><a href="#local-6989586621679094646"><span class="hs-identifier">p0</span></a></a><span> </span><a name="local-6989586621679094647"><a href="#local-6989586621679094647"><span class="hs-identifier">p1</span></a></a><span> </span><a name="local-6989586621679094648"><a href="#local-6989586621679094648"><span class="hs-identifier">q0</span></a></a><span> </span><a name="local-6989586621679094649"><a href="#local-6989586621679094649"><span class="hs-identifier">q1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679094650"><span class="hs-identifier hs-var">nis0</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679094651"><span class="hs-identifier hs-var">nis1</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679094658"><span class="hs-identifier hs-var">norm</span></a><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#cross"><span class="hs-identifier hs-var">cross</span></a><span> </span><a href="#local-6989586621679094656"><span class="hs-identifier hs-var">v01</span></a><span> </span><a href="#local-6989586621679094657"><span class="hs-identifier hs-var">v12</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0.0</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-233"></a><span>                </span><span class="hs-keyword">where</span><span>
</span><a name="line-234"></a><span>                    </span><a name="local-6989586621679094650"><a href="#local-6989586621679094650"><span class="hs-identifier">nis0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#isColinear"><span class="hs-identifier hs-var">isColinear</span></a><span> </span><a href="#local-6989586621679094646"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679094648"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679094649"><span class="hs-identifier hs-var">q1</span></a><span>
</span><a name="line-235"></a><span>                    </span><a name="local-6989586621679094651"><a href="#local-6989586621679094651"><span class="hs-identifier">nis1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#isColinear"><span class="hs-identifier hs-var">isColinear</span></a><span> </span><a href="#local-6989586621679094647"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679094648"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679094649"><span class="hs-identifier hs-var">q1</span></a><span>
</span><a name="line-236"></a><span>                    </span><a name="local-6989586621679094652"><a href="#local-6989586621679094652"><span class="hs-identifier">v0</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679094648"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679094646"><span class="hs-identifier hs-var">p0</span></a><span> </span><span class="hs-comment">-- p0 -&gt; q0</span><span>
</span><a name="line-237"></a><span>                    </span><a name="local-6989586621679094653"><a href="#local-6989586621679094653"><span class="hs-identifier">v1</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679094649"><span class="hs-identifier hs-var">q1</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679094646"><span class="hs-identifier hs-var">p0</span></a><span> </span><span class="hs-comment">-- p0 -&gt; q1</span><span>
</span><a name="line-238"></a><span>                    </span><a name="local-6989586621679094654"><a href="#local-6989586621679094654"><span class="hs-identifier">v2</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679094648"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679094647"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-comment">-- p1 -&gt; q0</span><span>
</span><a name="line-239"></a><span>                    </span><a name="local-6989586621679094655"><a href="#local-6989586621679094655"><span class="hs-identifier">v3</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679094649"><span class="hs-identifier hs-var">q1</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679094647"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-comment">-- p1 -&gt; q1</span><span>
</span><a name="line-240"></a><span>                    </span><a name="local-6989586621679094656"><a href="#local-6989586621679094656"><span class="hs-identifier">v01</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#cross"><span class="hs-identifier hs-var">cross</span></a><span> </span><a href="#local-6989586621679094652"><span class="hs-identifier hs-var">v0</span></a><span> </span><a href="#local-6989586621679094653"><span class="hs-identifier hs-var">v1</span></a><span> </span><span class="hs-comment">-- v0 X v1</span><span>
</span><a name="line-241"></a><span>                    </span><a name="local-6989586621679094657"><a href="#local-6989586621679094657"><span class="hs-identifier">v12</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#cross"><span class="hs-identifier hs-var">cross</span></a><span> </span><a href="#local-6989586621679094654"><span class="hs-identifier hs-var">v2</span></a><span> </span><a href="#local-6989586621679094655"><span class="hs-identifier hs-var">v3</span></a><span> </span><span class="hs-comment">-- v2 X v3</span><span>
</span><a name="line-242"></a><span>                    </span><a name="local-6989586621679094658"><a href="#local-6989586621679094658"><span class="hs-identifier">norm</span></a></a><span> </span><a name="local-6989586621679094659"><a href="#local-6989586621679094659"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sqrt</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#dot3ve"><span class="hs-identifier hs-var">dot3ve</span></a><span> </span><a href="#local-6989586621679094659"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679094659"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-243"></a><span>
</span><a name="line-244"></a><span class="hs-identifier">cross</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-245"></a><a name="cross"><a href="AronGraphic.html#cross"><span class="hs-identifier">cross</span></a></a><span> </span><a name="local-6989586621679094660"><a href="#local-6989586621679094660"><span class="hs-identifier">u</span></a></a><span> </span><a name="local-6989586621679094661"><a href="#local-6989586621679094661"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679094660"><span class="hs-identifier hs-var">u</span></a><span> </span><a href="AronGraphic.html#%2297"><span class="hs-operator hs-var">&#8855;</span></a><span> </span><a href="#local-6989586621679094661"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-246"></a><span>
</span><a name="line-247"></a><span class="hs-comment">-- | compute the normal of three points</span><span>
</span><a name="line-248"></a><span class="hs-identifier">normal3</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span>
</span><a name="line-249"></a><a name="normal3"><a href="AronGraphic.html#normal3"><span class="hs-identifier">normal3</span></a></a><span> </span><a name="local-6989586621679094662"><a href="#local-6989586621679094662"><span class="hs-identifier">p0</span></a></a><span> </span><a name="local-6989586621679094663"><a href="#local-6989586621679094663"><span class="hs-identifier">q0</span></a></a><span> </span><a name="local-6989586621679094664"><a href="#local-6989586621679094664"><span class="hs-identifier">q1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679094665"><span class="hs-identifier hs-var">isc</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679094668"><span class="hs-identifier hs-var">nr</span></a><span class="hs-special">)</span><span>
</span><a name="line-250"></a><span>                </span><span class="hs-keyword">where</span><span>
</span><a name="line-251"></a><span>                    </span><a name="local-6989586621679094665"><a href="#local-6989586621679094665"><span class="hs-identifier">isc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#isColinear"><span class="hs-identifier hs-var">isColinear</span></a><span> </span><a href="#local-6989586621679094662"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679094663"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679094664"><span class="hs-identifier hs-var">q1</span></a><span>
</span><a name="line-252"></a><span>                    </span><a name="local-6989586621679094666"><a href="#local-6989586621679094666"><span class="hs-identifier">v0</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679094663"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679094662"><span class="hs-identifier hs-var">p0</span></a><span>
</span><a name="line-253"></a><span>                    </span><a name="local-6989586621679094667"><a href="#local-6989586621679094667"><span class="hs-identifier">v1</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679094664"><span class="hs-identifier hs-var">q1</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679094662"><span class="hs-identifier hs-var">p0</span></a><span>
</span><a name="line-254"></a><span>                    </span><a name="local-6989586621679094668"><a href="#local-6989586621679094668"><span class="hs-identifier">nr</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679094666"><span class="hs-identifier hs-var">v0</span></a><span> </span><a href="AronGraphic.html#%2297"><span class="hs-operator hs-var">&#8855;</span></a><span> </span><a href="#local-6989586621679094667"><span class="hs-identifier hs-var">v1</span></a><span>
</span><a name="line-255"></a><span>
</span><a name="line-256"></a><span class="hs-comment">-- | compute the normal of plane with two given vectors</span><span>
</span><a name="line-257"></a><span class="hs-identifier">normal3'</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-258"></a><a name="normal3%27"><a href="AronGraphic.html#normal3%27"><span class="hs-identifier">normal3'</span></a></a><span> </span><a name="local-6989586621679094669"><a href="#local-6989586621679094669"><span class="hs-identifier">v0</span></a></a><span> </span><a name="local-6989586621679094670"><a href="#local-6989586621679094670"><span class="hs-identifier">v1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679094669"><span class="hs-identifier hs-var">v0</span></a><span> </span><a href="AronGraphic.html#%2297"><span class="hs-operator hs-var">&#8855;</span></a><span> </span><a href="#local-6989586621679094670"><span class="hs-identifier hs-var">v1</span></a><span>
</span><a name="line-259"></a><span>
</span><a name="line-260"></a><span>
</span><a name="line-261"></a><span>
</span><a name="line-262"></a><span>
</span><a name="line-263"></a><span class="hs-comment">-- | (Vertex3 a) operator: (-) (+)</span><span>
</span><a name="line-264"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679092611"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-identifier hs-type">Num</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679092611"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-265"></a><span>    </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679092612"><a href="#local-6989586621679092612"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679092613"><a href="#local-6989586621679092613"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679092614"><a href="#local-6989586621679092614"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679092615"><a href="#local-6989586621679092615"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679092616"><a href="#local-6989586621679092616"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679092617"><a href="#local-6989586621679092617"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679092612"><span class="hs-identifier hs-var">x0</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679092615"><span class="hs-identifier hs-var">x1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679092613"><span class="hs-identifier hs-var">y0</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679092616"><span class="hs-identifier hs-var">y1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679092614"><span class="hs-identifier hs-var">z0</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679092617"><span class="hs-identifier hs-var">z1</span></a><span class="hs-special">)</span><span>
</span><a name="line-266"></a><span>    </span><span class="hs-special">(</span><a name="local-8214565720323784853"><span class="hs-operator">+</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679092618"><a href="#local-6989586621679092618"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679092619"><a href="#local-6989586621679092619"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679092620"><a href="#local-6989586621679092620"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679092621"><a href="#local-6989586621679092621"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679092622"><a href="#local-6989586621679092622"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679092623"><a href="#local-6989586621679092623"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679092618"><span class="hs-identifier hs-var">x0</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679092621"><span class="hs-identifier hs-var">x1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679092619"><span class="hs-identifier hs-var">y0</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679092622"><span class="hs-identifier hs-var">y1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679092620"><span class="hs-identifier hs-var">z0</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679092623"><span class="hs-identifier hs-var">z1</span></a><span class="hs-special">)</span><span>
</span><a name="line-267"></a><span>    </span><a name="local-3458764513820541097"><span class="hs-identifier">negate</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679092624"><a href="#local-6989586621679092624"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679092625"><a href="#local-6989586621679092625"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679092626"><a href="#local-6989586621679092626"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679092624"><span class="hs-identifier hs-var">x0</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679092625"><span class="hs-identifier hs-var">y0</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679092626"><span class="hs-identifier hs-var">z0</span></a><span class="hs-special">)</span><span>
</span><a name="line-268"></a><span>    </span><a name="local-8214565720323784854"><span class="hs-identifier">abs</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679092627"><a href="#local-6989586621679092627"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679092628"><a href="#local-6989586621679092628"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679092629"><a href="#local-6989586621679092629"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">abs</span><span> </span><a href="#local-6989586621679092627"><span class="hs-identifier hs-var">x0</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">abs</span><span> </span><a href="#local-6989586621679092628"><span class="hs-identifier hs-var">y0</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">abs</span><span> </span><a href="#local-6989586621679092629"><span class="hs-identifier hs-var">z0</span></a><span class="hs-special">)</span><span>
</span><a name="line-269"></a><span>    </span><a name="local-8214565720323784855"><span class="hs-identifier">signum</span></a><span> </span><span class="hs-identifier">_</span><span>                                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">undefined</span><span>
</span><a name="line-270"></a><span>    </span><span class="hs-special">(</span><a name="local-8214565720323784852"><span class="hs-operator">*</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>                                   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">undefined</span><span>
</span><a name="line-271"></a><span>    </span><a name="local-3458764513820541088"><span class="hs-identifier">fromInteger</span></a><span> </span><span class="hs-identifier">_</span><span>                             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">undefined</span><span>
</span><a name="line-272"></a><span>
</span><a name="line-273"></a><span class="hs-comment">-- | (Vector3 a) operator: (-) (+)</span><span>
</span><a name="line-274"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679091116"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-identifier hs-type">Num</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector3</span><span> </span><a href="#local-6989586621679091116"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-275"></a><span>    </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679092593"><a href="#local-6989586621679092593"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679092594"><a href="#local-6989586621679092594"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679092595"><a href="#local-6989586621679092595"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679092596"><a href="#local-6989586621679092596"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679092597"><a href="#local-6989586621679092597"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679092598"><a href="#local-6989586621679092598"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vector3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679092593"><span class="hs-identifier hs-var">x0</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679092596"><span class="hs-identifier hs-var">x1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679092594"><span class="hs-identifier hs-var">y0</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679092597"><span class="hs-identifier hs-var">y1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679092595"><span class="hs-identifier hs-var">z0</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679092598"><span class="hs-identifier hs-var">z1</span></a><span class="hs-special">)</span><span>
</span><a name="line-276"></a><span>    </span><span class="hs-special">(</span><a name="local-8214565720323784853"><span class="hs-operator">+</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679092599"><a href="#local-6989586621679092599"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679092600"><a href="#local-6989586621679092600"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679092601"><a href="#local-6989586621679092601"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679092602"><a href="#local-6989586621679092602"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679092603"><a href="#local-6989586621679092603"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679092604"><a href="#local-6989586621679092604"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vector3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679092599"><span class="hs-identifier hs-var">x0</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679092602"><span class="hs-identifier hs-var">x1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679092600"><span class="hs-identifier hs-var">y0</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679092603"><span class="hs-identifier hs-var">y1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679092601"><span class="hs-identifier hs-var">z0</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679092604"><span class="hs-identifier hs-var">z1</span></a><span class="hs-special">)</span><span>
</span><a name="line-277"></a><span>    </span><a name="local-3458764513820541097"><span class="hs-identifier">negate</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679092605"><a href="#local-6989586621679092605"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679092606"><a href="#local-6989586621679092606"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679092607"><a href="#local-6989586621679092607"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vector3</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679092605"><span class="hs-identifier hs-var">x0</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679092606"><span class="hs-identifier hs-var">y0</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679092607"><span class="hs-identifier hs-var">z0</span></a><span class="hs-special">)</span><span>
</span><a name="line-278"></a><span>    </span><a name="local-8214565720323784854"><span class="hs-identifier">abs</span></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679092608"><a href="#local-6989586621679092608"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679092609"><a href="#local-6989586621679092609"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679092610"><a href="#local-6989586621679092610"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vector3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">abs</span><span> </span><a href="#local-6989586621679092608"><span class="hs-identifier hs-var">x0</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">abs</span><span> </span><a href="#local-6989586621679092609"><span class="hs-identifier hs-var">y0</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">abs</span><span> </span><a href="#local-6989586621679092610"><span class="hs-identifier hs-var">z0</span></a><span class="hs-special">)</span><span>
</span><a name="line-279"></a><span>    </span><a name="local-8214565720323784855"><span class="hs-identifier">signum</span></a><span> </span><span class="hs-identifier">_</span><span>                                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">undefined</span><span>
</span><a name="line-280"></a><span>    </span><span class="hs-special">(</span><a name="local-8214565720323784852"><span class="hs-operator">*</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>                                   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">undefined</span><span>
</span><a name="line-281"></a><span>    </span><a name="local-3458764513820541088"><span class="hs-identifier">fromInteger</span></a><span> </span><span class="hs-identifier">_</span><span>                             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">undefined</span><span>
</span><a name="line-282"></a><span>
</span><a name="line-283"></a><span class="hs-comment">-- | Vector: p0 -&gt; p1 = p1 - p0</span><span>
</span><a name="line-284"></a><span class="hs-identifier">vec</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-285"></a><a name="vec"><a href="AronGraphic.html#vec"><span class="hs-identifier">vec</span></a></a><span> </span><a name="local-6989586621679094671"><a href="#local-6989586621679094671"><span class="hs-identifier">p0</span></a></a><span> </span><a name="local-6989586621679094672"><a href="#local-6989586621679094672"><span class="hs-identifier">p1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679094672"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679094671"><span class="hs-identifier hs-var">p0</span></a><span>
</span><a name="line-286"></a><span>
</span><a name="line-287"></a><span class="hs-comment">-- | Given a point and vector,</span><span>
</span><a name="line-288"></a><span class="hs-comment">--</span><span>
</span><a name="line-289"></a><span class="hs-comment">-- | draw a line passes the point and alone the vector</span><span>
</span><a name="line-290"></a><span class="hs-comment">--</span><span>
</span><a name="line-291"></a><span class="hs-comment">-- | r(t) = p0 + t(p1 - p0)</span><span>
</span><a name="line-292"></a><span class="hs-comment">--</span><span>
</span><a name="line-293"></a><span class="hs-identifier">ray</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-294"></a><a name="ray"><a href="AronGraphic.html#ray"><span class="hs-identifier">ray</span></a></a><span> </span><a name="local-6989586621679094673"><a href="#local-6989586621679094673"><span class="hs-identifier">p0</span></a></a><span> </span><a name="local-6989586621679094674"><a href="#local-6989586621679094674"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679094675"><a href="#local-6989586621679094675"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679094673"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="AronGraphic.html#%2B%3A"><span class="hs-operator hs-var">+:</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094674"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="AronGraphic.html#%2A%3A"><span class="hs-operator hs-var">*:</span></a><span> </span><a href="#local-6989586621679094675"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-295"></a><span>
</span><a name="line-296"></a><span class="hs-comment">-- | Given s, t, p0 and p1</span><span>
</span><a name="line-297"></a><span class="hs-comment">--   1. c&#8320; = center p&#8320; p&#8321;</span><span>
</span><a name="line-298"></a><span class="hs-comment">--   2. p1' = p0 + s(&#8869; p0 p1), p2' = p0 + t(&#8869; p0 p1)</span><span>
</span><a name="line-299"></a><span class="hs-comment">--   3. draw line from p1' to p2'</span><span>
</span><a name="line-300"></a><span class="hs-identifier">perpenLine</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span>
</span><a name="line-301"></a><a name="perpenLine"><a href="AronGraphic.html#perpenLine"><span class="hs-identifier">perpenLine</span></a></a><span> </span><a name="local-6989586621679094676"><a href="#local-6989586621679094676"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679094677"><a href="#local-6989586621679094677"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679094678"><a href="#local-6989586621679094678"><span class="hs-identifier">p0</span></a></a><span> </span><a name="local-6989586621679094679"><a href="#local-6989586621679094679"><span class="hs-identifier">p1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679094681"><span class="hs-identifier hs-var">c0</span></a><span> </span><a href="AronGraphic.html#%2B%3A"><span class="hs-operator hs-var">+:</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094676"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="AronGraphic.html#%2A%3A"><span class="hs-operator hs-var">*:</span></a><span> </span><a href="#local-6989586621679094680"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679094681"><span class="hs-identifier hs-var">c0</span></a><span> </span><a href="AronGraphic.html#%2B%3A"><span class="hs-operator hs-var">+:</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094677"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="AronGraphic.html#%2A%3A"><span class="hs-operator hs-var">*:</span></a><span> </span><a href="#local-6989586621679094680"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-302"></a><span>           </span><span class="hs-keyword">where</span><span>
</span><a name="line-303"></a><span>             </span><a name="local-6989586621679094680"><a href="#local-6989586621679094680"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#perpcw"><span class="hs-identifier hs-var">perpcw</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#vec"><span class="hs-identifier hs-var">vec</span></a><span> </span><a href="#local-6989586621679094678"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679094679"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-comment">-- p&#8320; &#8594; p&#8321;</span><span>
</span><a name="line-304"></a><span>             </span><a name="local-6989586621679094681"><a href="#local-6989586621679094681"><span class="hs-identifier">c0</span></a></a><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#cen"><span class="hs-identifier hs-var">cen</span></a><span> </span><a href="#local-6989586621679094678"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679094679"><span class="hs-identifier hs-var">p1</span></a><span>
</span><a name="line-305"></a><span>
</span><a name="line-306"></a><span class="hs-identifier">curvePt</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span>
</span><a name="line-307"></a><a name="curvePt"><a href="AronGraphic.html#curvePt"><span class="hs-identifier">curvePt</span></a></a><span> </span><a name="local-6989586621679094682"><a href="#local-6989586621679094682"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679094683"><a href="#local-6989586621679094683"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679094684"><a href="#local-6989586621679094684"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a href="#local-6989586621679094688"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094682"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679094688"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679094688"><a href="#local-6989586621679094688"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679094685"><a href="#local-6989586621679094685"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">100</span><span class="hs-special">;</span><span> </span><a name="local-6989586621679094686"><a href="#local-6989586621679094686"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094684"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679094683"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">/</span><a href="#local-6989586621679094685"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">;</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679094687"><a href="#local-6989586621679094687"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679094683"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679094687"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679094686"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><a href="#local-6989586621679094685"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-308"></a><span>
</span><a name="line-309"></a><span>
</span><a name="line-310"></a><span class="hs-comment">{-| 
    === Given a function \(f\), interval \( (a, b) \)
    draw the curve from \(a\) to \(b\)

    &gt;mapM_ (\n -&gt; drawCurve (\x -&gt; x^n) (-1.0, 1.0) green) [1..20] 
-}</span><span>
</span><a name="line-316"></a><span class="hs-identifier">drawCurve</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-317"></a><a name="drawCurve"><a href="AronGraphic.html#drawCurve"><span class="hs-identifier">drawCurve</span></a></a><span> </span><a name="local-6989586621679094689"><a href="#local-6989586621679094689"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679094690"><a href="#local-6989586621679094690"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679094691"><a href="#local-6989586621679094691"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679094692"><a href="#local-6989586621679094692"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">renderPrimitive</span><span> </span><span class="hs-identifier hs-var">LineStrip</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mapM_</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679094724"><a href="#local-6989586621679094724"><span class="hs-identifier">vx</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-318"></a><span>                                            </span><span class="hs-identifier hs-var">color</span><span> </span><a href="#local-6989586621679094692"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-319"></a><span>                                            </span><span class="hs-identifier hs-var">vertex</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679094724"><span class="hs-identifier hs-var">vx</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#curvePt"><span class="hs-identifier hs-var">curvePt</span></a><span> </span><a href="#local-6989586621679094689"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679094690"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679094691"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-320"></a><span>
</span><a name="line-321"></a><span class="hs-comment">{-| 
    === draw Surface for equation \( f(x, y) = x^2 + y^2 \) form

    Draw \( f (x, y) = x^2 + y^2 \)

    &gt; drawSurface (\x y -&gt; x^2 + y^2)
-}</span><span>
</span><a name="line-328"></a><span class="hs-identifier">drawSurface</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-329"></a><a name="drawSurface"><a href="AronGraphic.html#drawSurface"><span class="hs-identifier">drawSurface</span></a></a><span> </span><a name="local-6989586621679096569"><a href="#local-6989586621679096569"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-330"></a><span>    </span><span class="hs-identifier hs-var">mapM_</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679096570"><a href="#local-6989586621679096570"><span class="hs-identifier">row</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="AronGraphic.html#drawSegmentFromTo"><span class="hs-identifier hs-var">drawSegmentFromTo</span></a><span> </span><a href="AronGraphic.html#red"><span class="hs-identifier hs-var">red</span></a><span> </span><a href="#local-6989586621679096570"><span class="hs-identifier hs-var">row</span></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#grid2"><span class="hs-identifier hs-var">grid2</span></a><span> </span><a href="#local-6989586621679096569"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-331"></a><span>    </span><span class="hs-identifier hs-var">mapM_</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679096571"><a href="#local-6989586621679096571"><span class="hs-identifier">row</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="AronGraphic.html#drawSegmentFromTo"><span class="hs-identifier hs-var">drawSegmentFromTo</span></a><span> </span><a href="AronGraphic.html#red"><span class="hs-identifier hs-var">red</span></a><span> </span><a href="#local-6989586621679096571"><span class="hs-identifier hs-var">row</span></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronModule.html#tran"><span class="hs-identifier hs-var">tran</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#grid2"><span class="hs-identifier hs-var">grid2</span></a><span> </span><a href="#local-6989586621679096569"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-332"></a><span>
</span><a name="line-333"></a><span class="hs-comment">{-| 
    === draw Surface for equation \( f(x, y) = x^2 + y^2 \) form

    Draw \( f (x, y) = x^2 + y^2 \)

    &gt; r = 2 =&gt; 1/(r*n) 
    &gt; drawSurfaceR (\x y -&gt; x^2 + y^2) r 
-}</span><span>
</span><a name="line-341"></a><span class="hs-identifier">drawSurfaceR</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-342"></a><a name="drawSurfaceR"><a href="AronGraphic.html#drawSurfaceR"><span class="hs-identifier">drawSurfaceR</span></a></a><span> </span><a name="local-6989586621679096572"><a href="#local-6989586621679096572"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679096573"><a href="#local-6989586621679096573"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-343"></a><span>    </span><span class="hs-identifier hs-var">mapM_</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679096574"><a href="#local-6989586621679096574"><span class="hs-identifier">row</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="AronGraphic.html#drawSegmentFromTo"><span class="hs-identifier hs-var">drawSegmentFromTo</span></a><span> </span><a href="AronGraphic.html#red"><span class="hs-identifier hs-var">red</span></a><span> </span><a href="#local-6989586621679096574"><span class="hs-identifier hs-var">row</span></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#grid2Ratio"><span class="hs-identifier hs-var">grid2Ratio</span></a><span> </span><a href="#local-6989586621679096572"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679096573"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-344"></a><span>    </span><span class="hs-identifier hs-var">mapM_</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679096575"><a href="#local-6989586621679096575"><span class="hs-identifier">row</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="AronGraphic.html#drawSegmentFromTo"><span class="hs-identifier hs-var">drawSegmentFromTo</span></a><span> </span><a href="AronGraphic.html#red"><span class="hs-identifier hs-var">red</span></a><span> </span><a href="#local-6989586621679096575"><span class="hs-identifier hs-var">row</span></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronModule.html#tran"><span class="hs-identifier hs-var">tran</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#grid2Ratio"><span class="hs-identifier hs-var">grid2Ratio</span></a><span> </span><a href="#local-6989586621679096572"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679096573"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-345"></a><span>
</span><a name="line-346"></a><span class="hs-comment">--drawParamSurf::(GLfloat -&gt; GLfloat) -&gt; (GLfloat -&gt; GLfloat) -&gt; (GLfloat -&gt; GLfloat) -&gt; IO() </span><span>
</span><a name="line-347"></a><span class="hs-comment">--drawParamSurf fx fy fz = do </span><span>
</span><a name="line-348"></a><span class="hs-comment">--    mapM_ (\row -&gt; drawSegmentFromTo red row ) $ pts </span><span>
</span><a name="line-349"></a><span class="hs-comment">--    mapM_ (\row -&gt; drawSegmentFromTo red row ) $ tran pts </span><span>
</span><a name="line-350"></a><span class="hs-comment">--        where </span><span>
</span><a name="line-351"></a><span class="hs-comment">--            n  = 10 </span><span>
</span><a name="line-352"></a><span class="hs-comment">--            fa = 1/(1.5*n)</span><span>
</span><a name="line-353"></a><span class="hs-comment">--            t = map(\x -&gt; rf $ fa * x) [-n..n]</span><span>
</span><a name="line-354"></a><span class="hs-comment">--            pts = [[ Vertex3 (fx t) (fy t) (fz t)]]</span><span>
</span><a name="line-355"></a><span>
</span><a name="line-356"></a><span>
</span><a name="line-357"></a><span class="hs-comment">{-| 
    === Plot all pts

    &lt;http://localhost/image/opengl_plot_pt.png Plot_Points&gt;

    &gt;interval from [-len/2.. len/2]
    &gt;let pts = [0.3, 0.4, 0.1, 0.2] 
    &gt;plotPts red pts 
    &gt;plotPts green $ quickSort1 pts 
-}</span><span>
</span><a name="line-367"></a><span class="hs-identifier">plotPts</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-368"></a><a name="plotPts"><a href="AronGraphic.html#plotPts"><span class="hs-identifier">plotPts</span></a></a><span> </span><a name="local-6989586621679096576"><a href="#local-6989586621679096576"><span class="hs-identifier">co</span></a></a><span> </span><a name="local-6989586621679096577"><a href="#local-6989586621679096577"><span class="hs-identifier">cx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-369"></a><span>                </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679096578"><a href="#local-6989586621679096578"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">div</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679096577"><span class="hs-identifier hs-var">cx</span></a><span class="hs-special">)</span><span> </span><span class="hs-number">2</span><span>
</span><a name="line-370"></a><span>                </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679096579"><a href="#local-6989586621679096579"><span class="hs-identifier">xx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679096580"><a href="#local-6989586621679096580"><span class="hs-identifier">del</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span class="hs-operator hs-var">/</span><span class="hs-special">(</span><a href="AronModule.html#rf"><span class="hs-identifier hs-var">rf</span></a><span> </span><a href="#local-6989586621679096578"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679096581"><a href="#local-6989586621679096581"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679096580"><span class="hs-identifier hs-var">del</span></a><span class="hs-operator hs-var">*</span><span class="hs-special">(</span><a href="AronModule.html#rf"><span class="hs-identifier hs-var">rf</span></a><span> </span><a href="#local-6989586621679096581"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">-</span><a href="#local-6989586621679096578"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">..</span><a href="#local-6989586621679096578"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span>
</span><a name="line-371"></a><span>                </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679096582"><a href="#local-6989586621679096582"><span class="hs-identifier">xx'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679096583"><a href="#local-6989586621679096583"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="AronModule.html#rf"><span class="hs-identifier hs-var">rf</span></a><span> </span><a href="#local-6989586621679096583"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679096579"><span class="hs-identifier hs-var">xx</span></a><span>
</span><a name="line-372"></a><span>                </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679096584"><a href="#local-6989586621679096584"><span class="hs-identifier">vl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">zipWith</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679096585"><a href="#local-6989586621679096585"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679096586"><a href="#local-6989586621679096586"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a href="#local-6989586621679096585"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679096586"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679096582"><span class="hs-identifier hs-var">xx'</span></a><span> </span><a href="#local-6989586621679096577"><span class="hs-identifier hs-var">cx</span></a><span>
</span><a name="line-373"></a><span>                </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679096587"><a href="#local-6989586621679096587"><span class="hs-identifier">pair</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">join</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zipWith</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679096588"><a href="#local-6989586621679096588"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679096589"><a href="#local-6989586621679096589"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679096588"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679096589"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">init</span><span> </span><a href="#local-6989586621679096584"><span class="hs-identifier hs-var">vl</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tail</span><span> </span><a href="#local-6989586621679096584"><span class="hs-identifier hs-var">vl</span></a><span class="hs-special">)</span><span>
</span><a name="line-374"></a><span>                </span><span class="hs-identifier hs-var">mapM_</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679096590"><a href="#local-6989586621679096590"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="AronGraphic.html#drawCircleColor"><span class="hs-identifier hs-var">drawCircleColor</span></a><span> </span><a href="#local-6989586621679096590"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="AronGraphic.html#red"><span class="hs-identifier hs-var">red</span></a><span> </span><span class="hs-number">0.01</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679096584"><span class="hs-identifier hs-var">vl</span></a><span>
</span><a name="line-375"></a><span>                </span><a href="AronGraphic.html#drawPrimitive%27"><span class="hs-identifier hs-var">drawPrimitive'</span></a><span> </span><span class="hs-identifier hs-var">Lines</span><span> </span><a href="#local-6989586621679096576"><span class="hs-identifier hs-var">co</span></a><span> </span><a href="#local-6989586621679096587"><span class="hs-identifier hs-var">pair</span></a><span>
</span><a name="line-376"></a><span>
</span><a name="line-377"></a><span class="hs-comment">{-|
  Draw a line that is tangent at pt (c, f(c)) where x in [x0, x1]

  &lt;http://localhost/image/tangleline.png tangentLine&gt;

  1. Given a function f, and x0 on x-Axis

  2. Derive a tangent line at (c, f(c)) with slop = f'(c)

  3. Interpolate (x0, f(x0)) and (x1, f(x1))

-}</span><span>
</span><a name="line-389"></a><span class="hs-identifier">tangentLine</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679094531"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-special">(</span><a href="#local-6989586621679094531"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679094531"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><a href="#local-6989586621679094531"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679094531"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679094531"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679094531"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-390"></a><a name="tangentLine"><a href="AronGraphic.html#tangentLine"><span class="hs-identifier">tangentLine</span></a></a><span> </span><a name="local-6989586621679096591"><a href="#local-6989586621679096591"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679096592"><a href="#local-6989586621679096592"><span class="hs-identifier">x0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679096593"><a href="#local-6989586621679096593"><span class="hs-identifier">x1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679096594"><a href="#local-6989586621679096594"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#interpolate%27"><span class="hs-identifier hs-var">interpolate'</span></a><span> </span><span class="hs-number">1</span><span> </span><a href="#local-6989586621679096597"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679096598"><span class="hs-identifier hs-var">p1</span></a><span>
</span><a name="line-391"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-392"></a><span>            </span><a name="local-6989586621679096595"><a href="#local-6989586621679096595"><span class="hs-identifier">y0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#tangent"><span class="hs-identifier hs-var">tangent</span></a><span> </span><a href="#local-6989586621679096591"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679096592"><span class="hs-identifier hs-var">x0</span></a><span> </span><a href="#local-6989586621679096594"><span class="hs-identifier hs-var">c</span></a><span>  </span><span class="hs-comment">-- y = slop(x - c) + (f x0)</span><span>
</span><a name="line-393"></a><span>            </span><a name="local-6989586621679096596"><a href="#local-6989586621679096596"><span class="hs-identifier">y1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#tangent"><span class="hs-identifier hs-var">tangent</span></a><span> </span><a href="#local-6989586621679096591"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679096593"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="#local-6989586621679096594"><span class="hs-identifier hs-var">c</span></a><span>  </span><span class="hs-comment">-- y = slop(x - c) + (f x1)</span><span>
</span><a name="line-394"></a><span>            </span><a name="local-6989586621679096597"><a href="#local-6989586621679096597"><span class="hs-identifier">p0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a href="#local-6989586621679096592"><span class="hs-identifier hs-var">x0</span></a><span> </span><a href="#local-6989586621679096595"><span class="hs-identifier hs-var">y0</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-395"></a><span>            </span><a name="local-6989586621679096598"><a href="#local-6989586621679096598"><span class="hs-identifier">p1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a href="#local-6989586621679096593"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="#local-6989586621679096596"><span class="hs-identifier hs-var">y1</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-396"></a><span>
</span><a name="line-397"></a><span class="hs-identifier">interpolate'</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679094530"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679094530"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679094530"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679094530"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-398"></a><a name="interpolate%27"><a href="AronGraphic.html#interpolate%27"><span class="hs-identifier">interpolate'</span></a></a><span> </span><a name="local-6989586621679096599"><a href="#local-6989586621679096599"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679096600"><a href="#local-6989586621679096600"><span class="hs-identifier">p0</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679096601"><a href="#local-6989586621679096601"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679096602"><a href="#local-6989586621679096602"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679096603"><a href="#local-6989586621679096603"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679096604"><a href="#local-6989586621679096604"><span class="hs-identifier">p1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679096605"><a href="#local-6989586621679096605"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679096606"><a href="#local-6989586621679096606"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679096607"><a href="#local-6989586621679096607"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679096610"><a href="#local-6989586621679096610"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679096611"><a href="#local-6989586621679096611"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679096609"><span class="hs-identifier hs-var">d</span></a><span class="hs-operator hs-var">*</span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679096610"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679096600"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="AronGraphic.html#%2B%3A"><span class="hs-operator hs-var">+:</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679096611"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="AronGraphic.html#%2A%3A"><span class="hs-operator hs-var">*:</span></a><span> </span><a href="#local-6989586621679096608"><span class="hs-identifier hs-var">ve</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><a href="#local-6989586621679096599"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span>
</span><a name="line-399"></a><span>                    </span><span class="hs-keyword">where</span><span>
</span><a name="line-400"></a><span>                        </span><a name="local-6989586621679096608"><a href="#local-6989586621679096608"><span class="hs-identifier">ve</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679096604"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679096600"><span class="hs-identifier hs-var">p0</span></a><span> </span><span class="hs-comment">-- vector: p0 -&gt; p1</span><span>
</span><a name="line-401"></a><span>                        </span><a name="local-6989586621679096609"><a href="#local-6989586621679096609"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span class="hs-operator hs-var">/</span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621679096599"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-402"></a><span>
</span><a name="line-403"></a><span class="hs-comment">{-|
    === Given a function f, interval (a, b),
        draw a tangent line at (x0, f(x0)) from a to b
    &gt;f::x -&gt; y

    (a, b) is interval

    differentiate at (x0, f x0)
-}</span><span>
</span><a name="line-412"></a><span class="hs-identifier">drawTangentLine</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-413"></a><a name="drawTangentLine"><a href="AronGraphic.html#drawTangentLine"><span class="hs-identifier">drawTangentLine</span></a></a><span> </span><a name="local-6989586621679096612"><a href="#local-6989586621679096612"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679096613"><a href="#local-6989586621679096613"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679096614"><a href="#local-6989586621679096614"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679096615"><a href="#local-6989586621679096615"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679096616"><a href="#local-6989586621679096616"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">renderPrimitive</span><span> </span><span class="hs-identifier hs-var">LineStrip</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mapM_</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679096618"><a href="#local-6989586621679096618"><span class="hs-identifier">vx</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-414"></a><span>                                            </span><span class="hs-identifier hs-var">color</span><span> </span><a href="#local-6989586621679096616"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-415"></a><span>                                            </span><span class="hs-identifier hs-var">vertex</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679096618"><span class="hs-identifier hs-var">vx</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679096617"><span class="hs-identifier hs-var">pts</span></a><span>
</span><a name="line-416"></a><span>                    </span><span class="hs-keyword">where</span><span>
</span><a name="line-417"></a><span>                        </span><a name="local-6989586621679096617"><a href="#local-6989586621679096617"><span class="hs-identifier">pts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#tangentLine"><span class="hs-identifier hs-var">tangentLine</span></a><span> </span><a href="#local-6989586621679096612"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679096613"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679096614"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679096615"><span class="hs-identifier hs-var">x0</span></a><span>
</span><a name="line-418"></a><span>
</span><a name="line-419"></a><span class="hs-comment">{-|
 === NormalDir is either counter clockwise or clockwise for normal

 (x0, x1) is interval for the normal
 f is  any function
 x=c is the tangent point at (c, f c)

 &gt;data NormalDir = NCCW | NCW deriving (Eq)
-}</span><span>
</span><a name="line-428"></a><span class="hs-identifier">normalLine</span><span class="hs-glyph">::</span><a href="AronGraphic.html#NormalDir"><span class="hs-identifier hs-type">NormalDir</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span>
</span><a name="line-429"></a><a name="normalLine"><a href="AronGraphic.html#normalLine"><span class="hs-identifier">normalLine</span></a></a><span> </span><a name="local-6989586621679096619"><a href="#local-6989586621679096619"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679096620"><a href="#local-6989586621679096620"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679096621"><a href="#local-6989586621679096621"><span class="hs-identifier">x0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679096622"><a href="#local-6989586621679096622"><span class="hs-identifier">x1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679096623"><a href="#local-6989586621679096623"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#interpolate%27"><span class="hs-identifier hs-var">interpolate'</span></a><span> </span><span class="hs-number">1</span><span> </span><a href="#local-6989586621679096626"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679096630"><span class="hs-identifier hs-var">p1'</span></a><span>
</span><a name="line-430"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-431"></a><span>            </span><a name="local-6989586621679096624"><a href="#local-6989586621679096624"><span class="hs-identifier">y0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#tangent"><span class="hs-identifier hs-var">tangent</span></a><span> </span><a href="#local-6989586621679096620"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679096621"><span class="hs-identifier hs-var">x0</span></a><span> </span><a href="#local-6989586621679096623"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-432"></a><span>            </span><a name="local-6989586621679096625"><a href="#local-6989586621679096625"><span class="hs-identifier">y1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#tangent"><span class="hs-identifier hs-var">tangent</span></a><span> </span><a href="#local-6989586621679096620"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679096622"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="#local-6989586621679096623"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-433"></a><span>            </span><a name="local-6989586621679096626"><a href="#local-6989586621679096626"><span class="hs-identifier">p0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a href="#local-6989586621679096621"><span class="hs-identifier hs-var">x0</span></a><span> </span><a href="#local-6989586621679096624"><span class="hs-identifier hs-var">y0</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-434"></a><span>            </span><a name="local-6989586621679096627"><a href="#local-6989586621679096627"><span class="hs-identifier">p1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a href="#local-6989586621679096622"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="#local-6989586621679096625"><span class="hs-identifier hs-var">y1</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-435"></a><span>            </span><a name="local-6989586621679096628"><a href="#local-6989586621679096628"><span class="hs-identifier">ve</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679096627"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679096626"><span class="hs-identifier hs-var">p0</span></a><span>  </span><span class="hs-comment">-- p0 -&gt; p1</span><span>
</span><a name="line-436"></a><span>            </span><a name="local-6989586621679096629"><a href="#local-6989586621679096629"><span class="hs-identifier">nr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679096619"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="AronGraphic.html#NCW"><span class="hs-identifier hs-var">NCW</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="AronGraphic.html#perpccw"><span class="hs-identifier hs-var">perpccw</span></a><span> </span><a href="#local-6989586621679096628"><span class="hs-identifier hs-var">ve</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="AronGraphic.html#perpcw"><span class="hs-identifier hs-var">perpcw</span></a><span> </span><a href="#local-6989586621679096628"><span class="hs-identifier hs-var">ve</span></a><span>
</span><a name="line-437"></a><span>            </span><a name="local-6989586621679096630"><a href="#local-6989586621679096630"><span class="hs-identifier">p1'</span></a></a><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679096626"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="AronGraphic.html#%2B%3A"><span class="hs-operator hs-var">+:</span></a><span> </span><a href="#local-6989586621679096629"><span class="hs-identifier hs-var">nr</span></a><span>
</span><a name="line-438"></a><span>
</span><a name="line-439"></a><span class="hs-identifier">normalLineNew</span><span class="hs-glyph">::</span><a href="AronGraphic.html#NormalDir"><span class="hs-identifier hs-type">NormalDir</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span>
</span><a name="line-440"></a><a name="normalLineNew"><a href="AronGraphic.html#normalLineNew"><span class="hs-identifier">normalLineNew</span></a></a><span> </span><a name="local-6989586621679096631"><a href="#local-6989586621679096631"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679096632"><a href="#local-6989586621679096632"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679096633"><a href="#local-6989586621679096633"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679096634"><a href="#local-6989586621679096634"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#interpolate%27"><span class="hs-identifier hs-var">interpolate'</span></a><span> </span><span class="hs-number">1</span><span> </span><a href="#local-6989586621679096637"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679096641"><span class="hs-identifier hs-var">p1'</span></a><span>
</span><a name="line-441"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-442"></a><span>            </span><a name="local-6989586621679096635"><a href="#local-6989586621679096635"><span class="hs-identifier">y0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#tangent"><span class="hs-identifier hs-var">tangent</span></a><span> </span><a href="#local-6989586621679096632"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679096633"><span class="hs-identifier hs-var">x0</span></a><span> </span><a href="#local-6989586621679096634"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-443"></a><span>            </span><a name="local-6989586621679096636"><a href="#local-6989586621679096636"><span class="hs-identifier">y1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#tangent"><span class="hs-identifier hs-var">tangent</span></a><span> </span><a href="#local-6989586621679096632"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679096633"><span class="hs-identifier hs-var">x0</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679096642"><span class="hs-identifier hs-var">len</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679096634"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-444"></a><span>            </span><a name="local-6989586621679096637"><a href="#local-6989586621679096637"><span class="hs-identifier">p0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a href="#local-6989586621679096633"><span class="hs-identifier hs-var">x0</span></a><span> </span><a href="#local-6989586621679096635"><span class="hs-identifier hs-var">y0</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-445"></a><span>            </span><a name="local-6989586621679096638"><a href="#local-6989586621679096638"><span class="hs-identifier">p1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679096633"><span class="hs-identifier hs-var">x0</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679096642"><span class="hs-identifier hs-var">len</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679096636"><span class="hs-identifier hs-var">y1</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-446"></a><span>            </span><a name="local-6989586621679096639"><a href="#local-6989586621679096639"><span class="hs-identifier">ve</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679096638"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679096637"><span class="hs-identifier hs-var">p0</span></a><span>  </span><span class="hs-comment">-- p0 -&gt; p1</span><span>
</span><a name="line-447"></a><span>            </span><a name="local-6989586621679096640"><a href="#local-6989586621679096640"><span class="hs-identifier">nr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679096631"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="AronGraphic.html#NCW"><span class="hs-identifier hs-var">NCW</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="AronGraphic.html#perpccw"><span class="hs-identifier hs-var">perpccw</span></a><span> </span><a href="#local-6989586621679096639"><span class="hs-identifier hs-var">ve</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="AronGraphic.html#perpcw"><span class="hs-identifier hs-var">perpcw</span></a><span> </span><a href="#local-6989586621679096639"><span class="hs-identifier hs-var">ve</span></a><span>
</span><a name="line-448"></a><span>            </span><a name="local-6989586621679096641"><a href="#local-6989586621679096641"><span class="hs-identifier">p1'</span></a></a><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679096637"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="AronGraphic.html#%2B%3A"><span class="hs-operator hs-var">+:</span></a><span> </span><a href="#local-6989586621679096640"><span class="hs-identifier hs-var">nr</span></a><span>
</span><a name="line-449"></a><span>            </span><a name="local-6989586621679096642"><a href="#local-6989586621679096642"><span class="hs-identifier">len</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0.1</span><span>
</span><a name="line-450"></a><span>
</span><a name="line-451"></a><span class="hs-identifier">drawNormalLine</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-452"></a><a name="drawNormalLine"><a href="AronGraphic.html#drawNormalLine"><span class="hs-identifier">drawNormalLine</span></a></a><span> </span><a name="local-6989586621679096643"><a href="#local-6989586621679096643"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679096644"><a href="#local-6989586621679096644"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679096645"><a href="#local-6989586621679096645"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679096646"><a href="#local-6989586621679096646"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679096647"><a href="#local-6989586621679096647"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">renderPrimitive</span><span> </span><span class="hs-identifier hs-var">LineStrip</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mapM_</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679096649"><a href="#local-6989586621679096649"><span class="hs-identifier">vx</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-453"></a><span>                                            </span><span class="hs-identifier hs-var">color</span><span> </span><a href="#local-6989586621679096647"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-454"></a><span>                                            </span><span class="hs-identifier hs-var">vertex</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679096649"><span class="hs-identifier hs-var">vx</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679096648"><span class="hs-identifier hs-var">pts</span></a><span>
</span><a name="line-455"></a><span>                    </span><span class="hs-keyword">where</span><span>
</span><a name="line-456"></a><span>                        </span><a name="local-6989586621679096648"><a href="#local-6989586621679096648"><span class="hs-identifier">pts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#normalLine"><span class="hs-identifier hs-var">normalLine</span></a><span> </span><a href="AronGraphic.html#NCCW"><span class="hs-identifier hs-var">NCCW</span></a><span> </span><a href="#local-6989586621679096643"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679096644"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679096645"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679096646"><span class="hs-identifier hs-var">x0</span></a><span>
</span><a name="line-457"></a><span>
</span><a name="line-458"></a><span class="hs-identifier">drawNormalLineNew</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-459"></a><a name="drawNormalLineNew"><a href="AronGraphic.html#drawNormalLineNew"><span class="hs-identifier">drawNormalLineNew</span></a></a><span> </span><a name="local-6989586621679096650"><a href="#local-6989586621679096650"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679096651"><a href="#local-6989586621679096651"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679096652"><a href="#local-6989586621679096652"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679096653"><a href="#local-6989586621679096653"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">renderPrimitive</span><span> </span><span class="hs-identifier hs-var">LineStrip</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mapM_</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679096656"><a href="#local-6989586621679096656"><span class="hs-identifier">vx</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-460"></a><span>                                            </span><span class="hs-identifier hs-var">color</span><span> </span><a href="#local-6989586621679096653"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-461"></a><span>                                            </span><span class="hs-identifier hs-var">vertex</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679096656"><span class="hs-identifier hs-var">vx</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679096654"><span class="hs-identifier hs-var">pts</span></a><span>
</span><a name="line-462"></a><span>                    </span><span class="hs-keyword">where</span><span>
</span><a name="line-463"></a><span>                        </span><a name="local-6989586621679096654"><a href="#local-6989586621679096654"><span class="hs-identifier">pts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#normalLineNew"><span class="hs-identifier hs-var">normalLineNew</span></a><span> </span><a href="AronGraphic.html#NCCW"><span class="hs-identifier hs-var">NCCW</span></a><span> </span><a href="#local-6989586621679096650"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679096651"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679096652"><span class="hs-identifier hs-var">x0</span></a><span>
</span><a name="line-464"></a><span>                        </span><a name="local-6989586621679096655"><a href="#local-6989586621679096655"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0.1</span><span>
</span><a name="line-465"></a><span>
</span><a name="line-466"></a><span class="hs-comment">-- | compute the center of two vertices/vertex</span><span>
</span><a name="line-467"></a><span class="hs-identifier">cen</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-468"></a><a name="cen"><a href="AronGraphic.html#cen"><span class="hs-identifier">cen</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679096657"><a href="#local-6989586621679096657"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679096658"><a href="#local-6989586621679096658"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679096659"><a href="#local-6989586621679096659"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679096660"><a href="#local-6989586621679096660"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679096661"><a href="#local-6989586621679096661"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679096662"><a href="#local-6989586621679096662"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679096657"><span class="hs-identifier hs-var">x0</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679096660"><span class="hs-identifier hs-var">x1</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">/</span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679096658"><span class="hs-identifier hs-var">y0</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679096661"><span class="hs-identifier hs-var">y1</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">/</span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679096659"><span class="hs-identifier hs-var">z0</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679096662"><span class="hs-identifier hs-var">z1</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">/</span><span class="hs-number">2</span><span class="hs-special">)</span><span>
</span><a name="line-469"></a><span>
</span><a name="line-470"></a><span class="hs-comment">-- | check two vectors whether they are perpendicular</span><span>
</span><a name="line-471"></a><span class="hs-identifier">isPerpen</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-472"></a><a name="isPerpen"><a href="AronGraphic.html#isPerpen"><span class="hs-identifier">isPerpen</span></a></a><span> </span><a name="local-6989586621679096663"><a href="#local-6989586621679096663"><span class="hs-identifier">v1</span></a></a><span> </span><a name="local-6989586621679096664"><a href="#local-6989586621679096664"><span class="hs-identifier">v2</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="#local-6989586621679096663"><span class="hs-identifier hs-var">v1</span></a><span> </span><a href="AronGraphic.html#%2299"><span class="hs-operator hs-var">&#8857;</span></a><span> </span><a href="#local-6989586621679096664"><span class="hs-identifier hs-var">v2</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-473"></a><span>
</span><a name="line-474"></a><span class="hs-comment">{-|
    === Check whether three pts are colinear
    __NOTE__

    * If two points or three points are overlapped, then they are still colinear

    @
    f(t) = p0 + t(p1 - p0)
    f(s) = p0 + s(p2 - p0)
    f(t) = f(s) =&gt;
    t(p1 - p0) = s(p2 - p0)
    t v1 = s v2, let A = [v1 v2]
    det A =? 0
    det A = 0 =&gt; p0 p1 p2 are colinear
    @
-}</span><span>
</span><a name="line-490"></a><span class="hs-identifier">isColinear</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-491"></a><a name="isColinear"><a href="AronGraphic.html#isColinear"><span class="hs-identifier">isColinear</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679096665"><a href="#local-6989586621679096665"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679096666"><a href="#local-6989586621679096666"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679096667"><a href="#local-6989586621679096667"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679096668"><a href="#local-6989586621679096668"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679096669"><a href="#local-6989586621679096669"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679096670"><a href="#local-6989586621679096670"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679096671"><a href="#local-6989586621679096671"><span class="hs-identifier">x2</span></a></a><span> </span><a name="local-6989586621679096672"><a href="#local-6989586621679096672"><span class="hs-identifier">y2</span></a></a><span> </span><a name="local-6989586621679096673"><a href="#local-6989586621679096673"><span class="hs-identifier">z2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679096674"><span class="hs-identifier hs-var">det</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-492"></a><span>                </span><span class="hs-keyword">where</span><span>
</span><a name="line-493"></a><span>                    </span><span class="hs-comment">-- v01 = Vertex3 (x1 - x0) (y1 - y0) (z1 - z0)</span><span>
</span><a name="line-494"></a><span>                    </span><span class="hs-comment">-- v02 = Vertex3 (x2 - x0) (y2 - y0) (z2 - z0)</span><span>
</span><a name="line-495"></a><span>                    </span><a name="local-6989586621679096674"><a href="#local-6989586621679096674"><span class="hs-identifier">det</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679096668"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679096665"><span class="hs-identifier hs-var">x0</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><span class="hs-special">(</span><a href="#local-6989586621679096672"><span class="hs-identifier hs-var">y2</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679096666"><span class="hs-identifier hs-var">y0</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679096671"><span class="hs-identifier hs-var">x2</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679096665"><span class="hs-identifier hs-var">x0</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><span class="hs-special">(</span><a href="#local-6989586621679096669"><span class="hs-identifier hs-var">y1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679096666"><span class="hs-identifier hs-var">y0</span></a><span class="hs-special">)</span><span>
</span><a name="line-496"></a><span>
</span><a name="line-497"></a><span class="hs-comment">{-|
    === Check whether a given point is inside the segment

    __NOTE__ use 'ptOnSegment' instead

    * Assume three pts are different pts

    * Given p0, q0 q1, check whether p0 is inside the segment of q0 q1

    * __If__ they are colinear
    * __then__ check the distance \( \overline{p_0 q_0} \)  \( \overline{p_0 q_1} \) and \( \overline{q_0 q_1} \)

    Using following __Affine combination on points__ formula

    === Linear combination on vector \( \{ x_1, x_2, \dots \} \)
    \[
        \begin{aligned}
            \sum_{i=1}^{n} \alpha_{i} x_i
        \end{aligned}
    \]

    If the sum of all the coefficients is 1
    \[
        \begin{aligned}
            \sum_{i=1}^{n} \alpha_{i} &amp;= 1
        \end{aligned}
    \]
    is called __Affine Combination__ of \( \{x_1, x_2, \dots \} \)

    __NOTE__
    If we extend above definition to highter power on \(t\),
    \(t\) can have any power \( n &gt; 0 \) or \( t^{n} \)

    \( [(1 - t) + t]^{n} \) is just Binomial Expansion

    &lt;http://localhost/html/indexBezierCurve.html Bezier_Curve&gt;

    \[
        \begin{aligned}
            1 &amp;= [(1 - t) + t]^{1} \\
            Q &amp;= (1 - t)p_0 + t p_1 \\ \\
            1 &amp;= [(1 - t) + t]^{2} = (1 - t)^{2} + 2t(1-t) + t^2 \\
            Q &amp;= (1-t)^{2} p_0 + 2t(1-t) p_1 + t^2 p_2  \\
        \end{aligned}
    \]



    In out case, there are only two points \( p_0, p_1 \)
    so \( p \) is the __Affine Combination__ of \( p_0, p_1 \)
    \[
        \begin{aligned}
            p &amp;= (1 - t) p_0 + t p_1 \\
        \end{aligned}
    \]
    If \( 0 &lt; t &lt; 1 \) then the point on the segment \( \overline{p_0 p_1} \) but not overlapping on \( p_0, p_1 \)

    If \( t = 0 \) or \( t = 1 \) then the point \(p\) is overlapping \( p_0 \) or \( p_1 \)

    If \( t &lt; 0 \) or \( t &gt; 1 \) then the point \(p\) is NOT on the segment \( \overline{p_0 p_1} \)

    &gt;p0 = Vertex3 0.5 0.5 0
    &gt;q0 = Vertex3 1 1 0
    &gt;q1 = Vertex3 0 0 0
    &gt;isInSegment p0 q0 q1
    &gt;Just True
-}</span><span>
</span><a name="line-564"></a><span class="hs-identifier">isInSegment</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-565"></a><a name="isInSegment"><a href="AronGraphic.html#isInSegment"><span class="hs-identifier">isInSegment</span></a></a><span> </span><a name="local-6989586621679096675"><a href="#local-6989586621679096675"><span class="hs-identifier">p0</span></a></a><span> </span><a name="local-6989586621679096676"><a href="#local-6989586621679096676"><span class="hs-identifier">q0</span></a></a><span> </span><a name="local-6989586621679096677"><a href="#local-6989586621679096677"><span class="hs-identifier">q1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679096678"><span class="hs-identifier hs-var">is</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679096680"><span class="hs-identifier hs-var">d1</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-6989586621679096679"><span class="hs-identifier hs-var">ds</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679096681"><span class="hs-identifier hs-var">d2</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-6989586621679096679"><span class="hs-identifier hs-var">ds</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-566"></a><span>                </span><span class="hs-keyword">where</span><span>
</span><a name="line-567"></a><span>                    </span><a name="local-6989586621679096678"><a href="#local-6989586621679096678"><span class="hs-identifier">is</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#isColinear"><span class="hs-identifier hs-var">isColinear</span></a><span> </span><a href="#local-6989586621679096675"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679096676"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679096677"><span class="hs-identifier hs-var">q1</span></a><span> </span><span class="hs-comment">-- has to be colinear</span><span>
</span><a name="line-568"></a><span>                    </span><a name="local-6989586621679096679"><a href="#local-6989586621679096679"><span class="hs-identifier">ds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#dist"><span class="hs-identifier hs-var">dist</span></a><span> </span><a href="#local-6989586621679096676"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679096677"><span class="hs-identifier hs-var">q1</span></a><span>
</span><a name="line-569"></a><span>                    </span><a name="local-6989586621679096680"><a href="#local-6989586621679096680"><span class="hs-identifier">d1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#dist"><span class="hs-identifier hs-var">dist</span></a><span> </span><a href="#local-6989586621679096675"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679096676"><span class="hs-identifier hs-var">q0</span></a><span>
</span><a name="line-570"></a><span>                    </span><a name="local-6989586621679096681"><a href="#local-6989586621679096681"><span class="hs-identifier">d2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#dist"><span class="hs-identifier hs-var">dist</span></a><span> </span><a href="#local-6989586621679096675"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679096677"><span class="hs-identifier hs-var">q1</span></a><span>
</span><a name="line-571"></a><span>
</span><a name="line-572"></a><span class="hs-keyword">data</span><span> </span><a name="PtSeg"><a href="AronGraphic.html#PtSeg"><span class="hs-identifier">PtSeg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="OnEndPt"><a href="AronGraphic.html#OnEndPt"><span class="hs-identifier">OnEndPt</span></a></a><span>
</span><a name="line-573"></a><span>             </span><span class="hs-glyph">|</span><span> </span><a name="InSeg"><a href="AronGraphic.html#InSeg"><span class="hs-identifier">InSeg</span></a></a><span>
</span><a name="line-574"></a><span>             </span><span class="hs-glyph">|</span><span> </span><a name="OutSeg"><a href="AronGraphic.html#OutSeg"><span class="hs-identifier">OutSeg</span></a></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-575"></a><span>
</span><a name="line-576"></a><span class="hs-comment">{-|
    === Better version of 'isInSegment'

    (1) If \(p_0\) is overlapped with \(q_0, q_1\) then OnPt
    (2) If \(\overline{p_0 q_0} + \overline{p_0 q_1} &gt; 0\) then OutSeg
    (3) Else InSeg

    @
    data PtSeg = OnEndPt -- ^ Overlapped pt
                 | InSeg   -- ^ Inside the segment
                 | OutSeg  -- ^ Out the segment
    @

    Maybe use better name:
    crossSegments - No endpt is overlapped

   &gt;1. Three pts are colinear
   &gt;    1. one endpts is overlapped
   &gt;    2. No endpt is overlapped, one endpt is &quot;inside&quot; the segment
   &gt;    3. Not intersected
   &gt;2. Four pts are colinear
   &gt;     1. No endpts is overlapped
   &gt;         1. one segment &quot;inside&quot; the other segment
   &gt;         2. one segment &quot;outside&quot; the other segment
   &gt;     2. One endpts is overlapped
   &gt;         1. one endpt is &quot;outside&quot; a segment
   &gt;         2. one endpt is &quot;inside&quot; a segment
   &gt;     3. two endpts are overlapped =&gt; same segment
   &gt;3. No three pts are colinear
   &gt;    1. If two segment is intersected, one must cross other segment
   &gt;    2. Two segments DO NOT intersect

-}</span><span>
</span><a name="line-609"></a><span class="hs-identifier">ptOnSegment</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="AronGraphic.html#PtSeg"><span class="hs-identifier hs-type">PtSeg</span></a><span>
</span><a name="line-610"></a><a name="ptOnSegment"><a href="AronGraphic.html#ptOnSegment"><span class="hs-identifier">ptOnSegment</span></a></a><span> </span><a name="local-6989586621679096682"><a href="#local-6989586621679096682"><span class="hs-identifier">p0</span></a></a><span> </span><a name="local-6989586621679096683"><a href="#local-6989586621679096683"><span class="hs-identifier">q0</span></a></a><span> </span><a name="local-6989586621679096684"><a href="#local-6989586621679096684"><span class="hs-identifier">q1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679096685"><span class="hs-identifier hs-var">is</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="AronGraphic.html#OnEndPt"><span class="hs-identifier hs-var">OnEndPt</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679096687"><span class="hs-identifier hs-var">d1</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679096688"><span class="hs-identifier hs-var">d2</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-6989586621679096686"><span class="hs-identifier hs-var">ds</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="AronGraphic.html#OutSeg"><span class="hs-identifier hs-var">OutSeg</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="AronGraphic.html#InSeg"><span class="hs-identifier hs-var">InSeg</span></a><span class="hs-special">)</span><span>
</span><a name="line-611"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-612"></a><span>        </span><a name="local-6989586621679096685"><a href="#local-6989586621679096685"><span class="hs-identifier">is</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#containPt"><span class="hs-identifier hs-var">containPt</span></a><span> </span><a href="#local-6989586621679096682"><span class="hs-identifier hs-var">p0</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679096683"><span class="hs-identifier hs-var">q0</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679096684"><span class="hs-identifier hs-var">q1</span></a><span class="hs-special">]</span><span>
</span><a name="line-613"></a><span>        </span><a name="local-6989586621679096686"><a href="#local-6989586621679096686"><span class="hs-identifier">ds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#dist"><span class="hs-identifier hs-var">dist</span></a><span> </span><a href="#local-6989586621679096683"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679096684"><span class="hs-identifier hs-var">q1</span></a><span>
</span><a name="line-614"></a><span>        </span><a name="local-6989586621679096687"><a href="#local-6989586621679096687"><span class="hs-identifier">d1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#dist"><span class="hs-identifier hs-var">dist</span></a><span> </span><a href="#local-6989586621679096682"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679096683"><span class="hs-identifier hs-var">q0</span></a><span>
</span><a name="line-615"></a><span>        </span><a name="local-6989586621679096688"><a href="#local-6989586621679096688"><span class="hs-identifier">d2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#dist"><span class="hs-identifier hs-var">dist</span></a><span> </span><a href="#local-6989586621679096682"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679096684"><span class="hs-identifier hs-var">q1</span></a><span>
</span><a name="line-616"></a><span>
</span><a name="line-617"></a><span class="hs-comment">{-|
    === draw primitive such lines, points, lineloop etc

    &lt;http://localhost/html/indexHaskellOpenGLPrimitiveMode.html PrimitiveMode&gt;

    @
    PrimitiveMode
    Lines
    LineStrip
    LineLoop
    TriangleStrip
    TriangleFan
    Quad
    QuadStrip
    Polygon
    Patches
    @
-}</span><span>
</span><a name="line-635"></a><span class="hs-identifier">drawPrimitive</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">PrimitiveMode</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-636"></a><a name="drawPrimitive"><a href="AronGraphic.html#drawPrimitive"><span class="hs-identifier">drawPrimitive</span></a></a><span> </span><a name="local-6989586621679096689"><a href="#local-6989586621679096689"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679096690"><a href="#local-6989586621679096690"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679096691"><a href="#local-6989586621679096691"><span class="hs-identifier">list</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-637"></a><span>    </span><span class="hs-identifier hs-var">renderPrimitive</span><span> </span><a href="#local-6989586621679096689"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mapM_</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679096692"><a href="#local-6989586621679096692"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679096693"><a href="#local-6989586621679096693"><span class="hs-identifier">y</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679096694"><a href="#local-6989586621679096694"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-638"></a><span>        </span><span class="hs-identifier hs-var">color</span><span> </span><a href="#local-6989586621679096690"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-639"></a><span>        </span><span class="hs-identifier hs-var">vertex</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a href="#local-6989586621679096692"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679096693"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679096694"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679096691"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-640"></a><span>
</span><a name="line-641"></a><span class="hs-comment">{-| 
    === draw primitive such lines, points, lineloop etc

    &lt;http://localhost/html/indexHaskellOpenGLPrimitiveMode.html PrimitiveMode&gt;

    @
    Lines
    LineStrip
    LineLoop
    TriangleStrip
    TriangleFan
    Quad
    QuadStrip
    Polygon
    Patches
    @

    'AronOpenGL.randomVertex'

    &gt;list &lt;- randomVertex 60
    &gt;drawPrimitive' Lines red list
-}</span><span>
</span><a name="line-663"></a><span class="hs-identifier">drawPrimitive'</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">PrimitiveMode</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-664"></a><a name="drawPrimitive%27"><a href="AronGraphic.html#drawPrimitive%27"><span class="hs-identifier">drawPrimitive'</span></a></a><span> </span><a name="local-6989586621679096695"><a href="#local-6989586621679096695"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679096696"><a href="#local-6989586621679096696"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679096697"><a href="#local-6989586621679096697"><span class="hs-identifier">list</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-665"></a><span>    </span><span class="hs-identifier hs-var">renderPrimitive</span><span> </span><a href="#local-6989586621679096695"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mapM_</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679096698"><a href="#local-6989586621679096698"><span class="hs-identifier">v3</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-666"></a><span>        </span><span class="hs-identifier hs-var">color</span><span> </span><a href="#local-6989586621679096696"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-667"></a><span>        </span><span class="hs-identifier hs-var">vertex</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679096698"><span class="hs-identifier hs-var">v3</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679096697"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-668"></a><span>
</span><a name="line-669"></a><span class="hs-identifier">drawLines</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-670"></a><a name="drawLines"><a href="AronGraphic.html#drawLines"><span class="hs-identifier">drawLines</span></a></a><span> </span><a name="local-6989586621679096699"><a href="#local-6989586621679096699"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679096700"><a href="#local-6989586621679096700"><span class="hs-identifier">list</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-671"></a><span>    </span><span class="hs-identifier hs-var">renderPrimitive</span><span> </span><span class="hs-identifier hs-var">Lines</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mapM_</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679096701"><a href="#local-6989586621679096701"><span class="hs-identifier">v3</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-672"></a><span>        </span><span class="hs-identifier hs-var">color</span><span> </span><a href="#local-6989586621679096699"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-673"></a><span>        </span><span class="hs-identifier hs-var">vertex</span><span> </span><a href="#local-6989586621679096701"><span class="hs-identifier hs-var">v3</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679096700"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-674"></a><span>    </span><span class="hs-identifier hs-var">mapM_</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679096702"><a href="#local-6989586621679096702"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679096703"><a href="#local-6989586621679096703"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mod</span><span> </span><a href="#local-6989586621679096702"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="AronGraphic.html#drawCircleColor%27"><span class="hs-identifier hs-var">drawCircleColor'</span></a><span> </span><a href="AronGraphic.html#red"><span class="hs-identifier hs-var">red</span></a><span> </span><span class="hs-number">0.01</span><span> </span><a href="#local-6989586621679096703"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679096700"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-675"></a><span>    </span><span class="hs-identifier hs-var">mapM_</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679096704"><a href="#local-6989586621679096704"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679096705"><a href="#local-6989586621679096705"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mod</span><span> </span><a href="#local-6989586621679096704"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="AronGraphic.html#drawCircleColor%27"><span class="hs-identifier hs-var">drawCircleColor'</span></a><span> </span><a href="AronGraphic.html#green"><span class="hs-identifier hs-var">green</span></a><span> </span><span class="hs-number">0.015</span><span> </span><a href="#local-6989586621679096705"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679096700"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-676"></a><span>
</span><a name="line-677"></a><span>
</span><a name="line-678"></a><span class="hs-comment">{-|
    === Draw Segment with Two End Pts

    &gt;v = [Vertex3 0.1 0.1 0.2, Vertex3 0.4 0.2 0.7]
    &gt;drawSegmentWithEndPt red v
    &gt;
    &gt;v = [[Vertex3 0.1 0.1 0.2, Vertex3 0.4 0.2 0.7]]
    &gt;mapM_(\x -&gt; drawSegmentWithEndPt red x) vv
-}</span><span>
</span><a name="line-687"></a><span class="hs-identifier">drawSegmentWithEndPt</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-688"></a><a name="drawSegmentWithEndPt"><a href="AronGraphic.html#drawSegmentWithEndPt"><span class="hs-identifier">drawSegmentWithEndPt</span></a></a><span> </span><a name="local-6989586621679096706"><a href="#local-6989586621679096706"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679096707"><a href="#local-6989586621679096707"><span class="hs-identifier">list</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-689"></a><span>    </span><span class="hs-identifier hs-var">renderPrimitive</span><span> </span><span class="hs-identifier hs-var">Lines</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mapM_</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679096708"><a href="#local-6989586621679096708"><span class="hs-identifier">v3</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-690"></a><span>        </span><span class="hs-identifier hs-var">color</span><span> </span><a href="#local-6989586621679096706"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-691"></a><span>        </span><span class="hs-identifier hs-var">vertex</span><span> </span><a href="#local-6989586621679096708"><span class="hs-identifier hs-var">v3</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679096707"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-692"></a><span>    </span><span class="hs-identifier hs-var">mapM_</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679096709"><a href="#local-6989586621679096709"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679096710"><a href="#local-6989586621679096710"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mod</span><span> </span><a href="#local-6989586621679096709"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="AronGraphic.html#drawCircleColor%27"><span class="hs-identifier hs-var">drawCircleColor'</span></a><span> </span><a href="AronGraphic.html#red"><span class="hs-identifier hs-var">red</span></a><span> </span><span class="hs-number">0.01</span><span> </span><a href="#local-6989586621679096710"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679096707"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-693"></a><span>    </span><span class="hs-identifier hs-var">mapM_</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679096711"><a href="#local-6989586621679096711"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679096712"><a href="#local-6989586621679096712"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mod</span><span> </span><a href="#local-6989586621679096711"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="AronGraphic.html#drawCircleColor%27"><span class="hs-identifier hs-var">drawCircleColor'</span></a><span> </span><a href="AronGraphic.html#green"><span class="hs-identifier hs-var">green</span></a><span> </span><span class="hs-number">0.015</span><span> </span><a href="#local-6989586621679096712"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679096707"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-694"></a><span>
</span><a name="line-695"></a><span class="hs-identifier">drawSegmentNoEndPt</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-696"></a><a name="drawSegmentNoEndPt"><a href="AronGraphic.html#drawSegmentNoEndPt"><span class="hs-identifier">drawSegmentNoEndPt</span></a></a><span> </span><a name="local-6989586621679096713"><a href="#local-6989586621679096713"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679096714"><a href="#local-6989586621679096714"><span class="hs-identifier">list</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-697"></a><span>    </span><span class="hs-identifier hs-var">renderPrimitive</span><span> </span><span class="hs-identifier hs-var">Lines</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mapM_</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679096715"><a href="#local-6989586621679096715"><span class="hs-identifier">v3</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-698"></a><span>        </span><span class="hs-identifier hs-var">color</span><span> </span><a href="#local-6989586621679096713"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-699"></a><span>        </span><span class="hs-identifier hs-var">vertex</span><span> </span><a href="#local-6989586621679096715"><span class="hs-identifier hs-var">v3</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679096714"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-700"></a><span>
</span><a name="line-701"></a><span class="hs-comment">{-|
    === Draw a set of segments

    Segment contains two end points, one is begin point, other is end point

    &gt; [p0, p1] = p0 -&gt; p1
-}</span><span>
</span><a name="line-708"></a><span class="hs-identifier">drawSegments</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-709"></a><a name="drawSegments"><a href="AronGraphic.html#drawSegments"><span class="hs-identifier">drawSegments</span></a></a><span> </span><a name="local-6989586621679096716"><a href="#local-6989586621679096716"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679096717"><a href="#local-6989586621679096717"><span class="hs-identifier">list</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-710"></a><span>    </span><span class="hs-identifier hs-var">renderPrimitive</span><span> </span><span class="hs-identifier hs-var">Lines</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mapM_</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679096718"><a href="#local-6989586621679096718"><span class="hs-identifier">v3</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-711"></a><span>        </span><span class="hs-identifier hs-var">color</span><span> </span><a href="#local-6989586621679096716"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-712"></a><span>        </span><span class="hs-identifier hs-var">vertex</span><span> </span><a href="#local-6989586621679096718"><span class="hs-identifier hs-var">v3</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679096717"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-713"></a><span>    </span><span class="hs-identifier hs-var">mapM_</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679096719"><a href="#local-6989586621679096719"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679096720"><a href="#local-6989586621679096720"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mod</span><span> </span><a href="#local-6989586621679096719"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="AronGraphic.html#drawCircleColor%27"><span class="hs-identifier hs-var">drawCircleColor'</span></a><span> </span><a href="AronGraphic.html#red"><span class="hs-identifier hs-var">red</span></a><span> </span><span class="hs-number">0.01</span><span> </span><a href="#local-6989586621679096720"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679096717"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-714"></a><span>    </span><span class="hs-identifier hs-var">mapM_</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679096721"><a href="#local-6989586621679096721"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679096722"><a href="#local-6989586621679096722"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mod</span><span> </span><a href="#local-6989586621679096721"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="AronGraphic.html#drawCircleColor%27"><span class="hs-identifier hs-var">drawCircleColor'</span></a><span> </span><a href="AronGraphic.html#green"><span class="hs-identifier hs-var">green</span></a><span> </span><span class="hs-number">0.015</span><span> </span><a href="#local-6989586621679096722"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679096717"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-715"></a><span>
</span><a name="line-716"></a><span class="hs-comment">-- | Draw one segment from p0 to p1</span><span>
</span><a name="line-717"></a><span class="hs-comment">-- | drawSegment color (p0, p1)</span><span>
</span><a name="line-718"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-719"></a><span class="hs-identifier">drawSegment</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-720"></a><a name="drawSegment"><a href="AronGraphic.html#drawSegment"><span class="hs-identifier">drawSegment</span></a></a><span> </span><a name="local-6989586621679096723"><a href="#local-6989586621679096723"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679096724"><a href="#local-6989586621679096724"><span class="hs-identifier">p0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679096725"><a href="#local-6989586621679096725"><span class="hs-identifier">p1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-721"></a><span>    </span><span class="hs-identifier hs-var">renderPrimitive</span><span> </span><span class="hs-identifier hs-var">Lines</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mapM_</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679096727"><a href="#local-6989586621679096727"><span class="hs-identifier">v3</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-722"></a><span>        </span><span class="hs-identifier hs-var">color</span><span> </span><a href="#local-6989586621679096723"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-723"></a><span>        </span><span class="hs-identifier hs-var">vertex</span><span> </span><a href="#local-6989586621679096727"><span class="hs-identifier hs-var">v3</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679096726"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-724"></a><span>    </span><span class="hs-identifier hs-var">mapM_</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679096728"><a href="#local-6989586621679096728"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679096729"><a href="#local-6989586621679096729"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mod</span><span> </span><a href="#local-6989586621679096728"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="AronGraphic.html#drawCircleColor%27"><span class="hs-identifier hs-var">drawCircleColor'</span></a><span> </span><a href="AronGraphic.html#red"><span class="hs-identifier hs-var">red</span></a><span> </span><span class="hs-number">0.01</span><span> </span><a href="#local-6989586621679096729"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679096726"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-725"></a><span>    </span><span class="hs-identifier hs-var">mapM_</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679096730"><a href="#local-6989586621679096730"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679096731"><a href="#local-6989586621679096731"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mod</span><span> </span><a href="#local-6989586621679096730"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="AronGraphic.html#drawCircleColor%27"><span class="hs-identifier hs-var">drawCircleColor'</span></a><span> </span><a href="AronGraphic.html#green"><span class="hs-identifier hs-var">green</span></a><span> </span><span class="hs-number">0.015</span><span> </span><a href="#local-6989586621679096731"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679096726"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-726"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-727"></a><span>            </span><a name="local-6989586621679096726"><a href="#local-6989586621679096726"><span class="hs-identifier">list</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679096724"><span class="hs-identifier hs-var">p0</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679096725"><span class="hs-identifier hs-var">p1</span></a><span class="hs-special">]</span><span>
</span><a name="line-728"></a><span>
</span><a name="line-729"></a><span class="hs-comment">{-| 
    === Draw one segment with no endpt
-}</span><span>
</span><a name="line-732"></a><span class="hs-identifier">drawSegmentNoEnd</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-733"></a><a name="drawSegmentNoEnd"><a href="AronGraphic.html#drawSegmentNoEnd"><span class="hs-identifier">drawSegmentNoEnd</span></a></a><span> </span><a name="local-6989586621679096732"><a href="#local-6989586621679096732"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679096733"><a href="#local-6989586621679096733"><span class="hs-identifier">p0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679096734"><a href="#local-6989586621679096734"><span class="hs-identifier">p1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-734"></a><span>    </span><span class="hs-identifier hs-var">renderPrimitive</span><span> </span><span class="hs-identifier hs-var">Lines</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mapM_</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679096736"><a href="#local-6989586621679096736"><span class="hs-identifier">v3</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-735"></a><span>        </span><span class="hs-identifier hs-var">color</span><span> </span><a href="#local-6989586621679096732"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-736"></a><span>        </span><span class="hs-identifier hs-var">vertex</span><span> </span><a href="#local-6989586621679096736"><span class="hs-identifier hs-var">v3</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679096735"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-737"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-738"></a><span>            </span><a name="local-6989586621679096735"><a href="#local-6989586621679096735"><span class="hs-identifier">list</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679096733"><span class="hs-identifier hs-var">p0</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679096734"><span class="hs-identifier hs-var">p1</span></a><span class="hs-special">]</span><span>
</span><a name="line-739"></a><span>
</span><a name="line-740"></a><span class="hs-comment">-- | definition:</span><span>
</span><a name="line-741"></a><span class="hs-comment">--   Segment contains two end points, one is begin point, other is end point</span><span>
</span><a name="line-742"></a><span class="hs-comment">--   [p0, p1] = p0 -&gt; p1</span><span>
</span><a name="line-743"></a><span class="hs-comment">--</span><span>
</span><a name="line-744"></a><span class="hs-comment">--data SegEndPt = No      -- no pt, just a segment</span><span>
</span><a name="line-745"></a><span class="hs-comment">--                | End   -- end pt</span><span>
</span><a name="line-746"></a><span class="hs-comment">--                | Beg   -- begin pt</span><span>
</span><a name="line-747"></a><span class="hs-comment">--                | Both  -- begin and end pts</span><span>
</span><a name="line-748"></a><span class="hs-comment">--                | Cen   -- center pt</span><span>
</span><a name="line-749"></a><span class="hs-comment">--                | All   -- all pts: begin, end and ceneter</span><span>
</span><a name="line-750"></a><span class="hs-identifier">drawSegment'</span><span class="hs-glyph">::</span><a href="AronGraphic.html#SegEndPt"><span class="hs-identifier hs-type">SegEndPt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-751"></a><a name="drawSegment%27"><a href="AronGraphic.html#drawSegment%27"><span class="hs-identifier">drawSegment'</span></a></a><span> </span><a name="local-6989586621679096737"><a href="#local-6989586621679096737"><span class="hs-identifier">endpt</span></a></a><span> </span><a name="local-6989586621679096738"><a href="#local-6989586621679096738"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679096739"><a href="#local-6989586621679096739"><span class="hs-identifier">list</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-752"></a><span>    </span><span class="hs-identifier hs-var">renderPrimitive</span><span> </span><span class="hs-identifier hs-var">Lines</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mapM_</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679096740"><a href="#local-6989586621679096740"><span class="hs-identifier">v3</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-753"></a><span>        </span><span class="hs-identifier hs-var">color</span><span> </span><a href="#local-6989586621679096738"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-754"></a><span>        </span><span class="hs-identifier hs-var">vertex</span><span> </span><a href="#local-6989586621679096740"><span class="hs-identifier hs-var">v3</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679096739"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-755"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679096741"><a href="#local-6989586621679096741"><span class="hs-identifier">bList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapM_</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679096747"><a href="#local-6989586621679096747"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679096748"><a href="#local-6989586621679096748"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mod</span><span> </span><a href="#local-6989586621679096747"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="AronGraphic.html#drawCircleColor%27"><span class="hs-identifier hs-var">drawCircleColor'</span></a><span> </span><a href="AronGraphic.html#red"><span class="hs-identifier hs-var">red</span></a><span> </span><span class="hs-number">0.01</span><span> </span><a href="#local-6989586621679096748"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679096739"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-756"></a><span>        </span><a name="local-6989586621679096742"><a href="#local-6989586621679096742"><span class="hs-identifier">eList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapM_</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679096749"><a href="#local-6989586621679096749"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679096750"><a href="#local-6989586621679096750"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mod</span><span> </span><a href="#local-6989586621679096749"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="AronGraphic.html#drawCircleColor%27"><span class="hs-identifier hs-var">drawCircleColor'</span></a><span> </span><a href="AronGraphic.html#green"><span class="hs-identifier hs-var">green</span></a><span> </span><span class="hs-number">0.015</span><span> </span><a href="#local-6989586621679096750"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679096739"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-757"></a><span>        </span><a name="local-6989586621679096743"><a href="#local-6989586621679096743"><span class="hs-identifier">ols</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#odds"><span class="hs-identifier hs-var">odds</span></a><span>  </span><a href="#local-6989586621679096739"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-758"></a><span>        </span><a name="local-6989586621679096744"><a href="#local-6989586621679096744"><span class="hs-identifier">els</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#evens"><span class="hs-identifier hs-var">evens</span></a><span> </span><a href="#local-6989586621679096739"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-759"></a><span>        </span><a name="local-6989586621679096745"><a href="#local-6989586621679096745"><span class="hs-identifier">cls</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">zipWith</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679096751"><a href="#local-6989586621679096751"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679096752"><a href="#local-6989586621679096752"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span class="hs-special">(</span><span class="hs-operator hs-var">/</span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pure</span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="#local-6989586621679096751"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="#local-6989586621679096752"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679096743"><span class="hs-identifier hs-var">ols</span></a><span> </span><a href="#local-6989586621679096744"><span class="hs-identifier hs-var">els</span></a><span>
</span><a name="line-760"></a><span>        </span><a name="local-6989586621679096746"><a href="#local-6989586621679096746"><span class="hs-identifier">cList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapM_</span><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#drawCircleColor%27"><span class="hs-identifier hs-var">drawCircleColor'</span></a><span> </span><a href="AronGraphic.html#blue"><span class="hs-identifier hs-var">blue</span></a><span> </span><span class="hs-number">0.012</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679096745"><span class="hs-identifier hs-var">cls</span></a><span>
</span><a name="line-761"></a><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679096737"><span class="hs-identifier hs-var">endpt</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-762"></a><span>            </span><a href="AronGraphic.html#Beg"><span class="hs-identifier hs-var">Beg</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679096741"><span class="hs-identifier hs-var">bList</span></a><span> </span><span class="hs-comment">-- begin pt</span><span>
</span><a name="line-763"></a><span>            </span><a href="AronGraphic.html#End"><span class="hs-identifier hs-var">End</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679096742"><span class="hs-identifier hs-var">eList</span></a><span> </span><span class="hs-comment">-- end pt</span><span>
</span><a name="line-764"></a><span>            </span><a href="AronGraphic.html#Cen"><span class="hs-identifier hs-var">Cen</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679096746"><span class="hs-identifier hs-var">cList</span></a><span> </span><span class="hs-comment">-- center pt</span><span>
</span><a name="line-765"></a><span>            </span><a href="AronGraphic.html#Both"><span class="hs-identifier hs-var">Both</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-766"></a><span>                </span><a href="#local-6989586621679096741"><span class="hs-identifier hs-var">bList</span></a><span>
</span><a name="line-767"></a><span>                </span><a href="#local-6989586621679096742"><span class="hs-identifier hs-var">eList</span></a><span>
</span><a name="line-768"></a><span>            </span><a href="AronGraphic.html#All"><span class="hs-identifier hs-var">All</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-769"></a><span>                </span><a href="#local-6989586621679096741"><span class="hs-identifier hs-var">bList</span></a><span>
</span><a name="line-770"></a><span>                </span><a href="#local-6989586621679096742"><span class="hs-identifier hs-var">eList</span></a><span>
</span><a name="line-771"></a><span>                </span><a href="#local-6989586621679096746"><span class="hs-identifier hs-var">cList</span></a><span>
</span><a name="line-772"></a><span>            </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-773"></a><span>
</span><a name="line-774"></a><span class="hs-comment">-- | Draw intersection pt from two segments</span><span>
</span><a name="line-775"></a><span class="hs-comment">-- | Two segments need not have an intersection.</span><span>
</span><a name="line-776"></a><span class="hs-comment">--</span><span>
</span><a name="line-777"></a><span class="hs-identifier">drawSegmentArg</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-778"></a><span>                </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-779"></a><span>                </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-780"></a><span>                </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-781"></a><a name="drawSegmentArg"><a href="AronGraphic.html#drawSegmentArg"><span class="hs-identifier">drawSegmentArg</span></a></a><span> </span><a name="local-6989586621679096753"><a href="#local-6989586621679096753"><span class="hs-identifier">p0</span></a></a><span> </span><a name="local-6989586621679096754"><a href="#local-6989586621679096754"><span class="hs-identifier">p1</span></a></a><span> </span><a name="local-6989586621679096755"><a href="#local-6989586621679096755"><span class="hs-identifier">q0</span></a></a><span> </span><a name="local-6989586621679096756"><a href="#local-6989586621679096756"><span class="hs-identifier">q1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-782"></a><span>            </span><a href="AronGraphic.html#drawLines"><span class="hs-identifier hs-var">drawLines</span></a><span> </span><a href="AronGraphic.html#green"><span class="hs-identifier hs-var">green</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679096753"><span class="hs-identifier hs-var">p0</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679096761"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">]</span><span>
</span><a name="line-783"></a><span>            </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679096759"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="AronGraphic.html#%2208"><span class="hs-operator hs-var">&#8712;</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span> </span><span class="hs-number">1</span><span class="hs-special">]</span><span>
</span><a name="line-784"></a><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679096759"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-785"></a><span>                </span><span class="hs-keyword">then</span><span> </span><a href="AronGraphic.html#drawLines"><span class="hs-identifier hs-var">drawLines</span></a><span> </span><a href="AronGraphic.html#blue"><span class="hs-identifier hs-var">blue</span></a><span>  </span><span class="hs-special">[</span><a href="#local-6989586621679096754"><span class="hs-identifier hs-var">p1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679096761"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- (p0 --&gt; p1) --&gt; ps</span><span>
</span><a name="line-786"></a><span>                </span><span class="hs-keyword">else</span><span> </span><a href="AronGraphic.html#drawLines"><span class="hs-identifier hs-var">drawLines</span></a><span> </span><a href="AronGraphic.html#green"><span class="hs-identifier hs-var">green</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679096753"><span class="hs-identifier hs-var">p0</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679096761"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ps &lt;-- (p0 --&gt; p1</span><span>
</span><a name="line-787"></a><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-788"></a><span>            </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679096760"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679096760"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-789"></a><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679096760"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-790"></a><span>                </span><span class="hs-keyword">then</span><span> </span><a href="AronGraphic.html#drawLines"><span class="hs-identifier hs-var">drawLines</span></a><span> </span><a href="AronGraphic.html#green"><span class="hs-identifier hs-var">green</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679096756"><span class="hs-identifier hs-var">q1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679096762"><span class="hs-identifier hs-var">qt</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- (q0 --&gt; q1) --&gt; qt</span><span>
</span><a name="line-791"></a><span>                </span><span class="hs-keyword">else</span><span> </span><a href="AronGraphic.html#drawLines"><span class="hs-identifier hs-var">drawLines</span></a><span> </span><a href="AronGraphic.html#blue"><span class="hs-identifier hs-var">blue</span></a><span>  </span><span class="hs-special">[</span><a href="#local-6989586621679096755"><span class="hs-identifier hs-var">q0</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679096762"><span class="hs-identifier hs-var">qt</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- qt &lt;-- (q0 --&gt; q1)</span><span>
</span><a name="line-792"></a><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-793"></a><span>            </span><span class="hs-keyword">where</span><span>
</span><a name="line-794"></a><span>                </span><a name="local-6989586621679096757"><a href="#local-6989586621679096757"><span class="hs-identifier">tup</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromJust</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#intersectLine"><span class="hs-identifier hs-var">intersectLine</span></a><span>  </span><a href="#local-6989586621679096753"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679096754"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679096755"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679096756"><span class="hs-identifier hs-var">q1</span></a><span>
</span><a name="line-795"></a><span>                </span><a name="local-6989586621679096758"><a href="#local-6989586621679096758"><span class="hs-identifier">vx</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621679096757"><span class="hs-identifier hs-var">tup</span></a><span>
</span><a name="line-796"></a><span>                </span><a name="local-6989586621679096759"><a href="#local-6989586621679096759"><span class="hs-identifier">s</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">head</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679096757"><span class="hs-identifier hs-var">tup</span></a><span>
</span><a name="line-797"></a><span>                </span><a name="local-6989586621679096760"><a href="#local-6989586621679096760"><span class="hs-identifier">t</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">last</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">last</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679096757"><span class="hs-identifier hs-var">tup</span></a><span>
</span><a name="line-798"></a><span>                </span><a name="local-6989586621679096761"><a href="#local-6989586621679096761"><span class="hs-identifier">ps</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679096753"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="AronGraphic.html#%2B%3A"><span class="hs-operator hs-var">+:</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679096759"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="AronGraphic.html#%2A%3A"><span class="hs-operator hs-var">*:</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679096754"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679096753"><span class="hs-identifier hs-var">p0</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-799"></a><span>                </span><a name="local-6989586621679096762"><a href="#local-6989586621679096762"><span class="hs-identifier">qt</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679096755"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="AronGraphic.html#%2B%3A"><span class="hs-operator hs-var">+:</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679096760"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="AronGraphic.html#%2A%3A"><span class="hs-operator hs-var">*:</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679096756"><span class="hs-identifier hs-var">q1</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679096755"><span class="hs-identifier hs-var">q0</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-800"></a><span>
</span><a name="line-801"></a><span class="hs-comment">{-|
  === draw sphere center at c with radius r
  * &#946; is in x-y plane, it rotates around z-Axis. &#981; is x-z plane, it rotates aroound y-Axis
  * \( r*\cos(&#981;) \) is the radius of circle cut through x-y plane

-}</span><span>
</span><a name="line-807"></a><span class="hs-identifier">drawSpherePt</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span>
</span><a name="line-808"></a><a name="drawSpherePt"><a href="AronGraphic.html#drawSpherePt"><span class="hs-identifier">drawSpherePt</span></a></a><span> </span><a name="local-6989586621679096763"><a href="#local-6989586621679096763"><span class="hs-identifier">c</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679096764"><a href="#local-6989586621679096764"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679096765"><a href="#local-6989586621679096765"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679096766"><a href="#local-6989586621679096766"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679096767"><a href="#local-6989586621679096767"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679096776"><span class="hs-identifier hs-var">pp</span></a><span>
</span><a name="line-809"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-810"></a><span>            </span><a name="local-6989586621679096768"><a href="#local-6989586621679096768"><span class="hs-identifier">fx</span></a></a><span> </span><a name="local-6989586621679096777"><a href="#local-6989586621679096777"><span class="hs-identifier">&#981;</span></a></a><span> </span><a name="local-6989586621679096778"><a href="#local-6989586621679096778"><span class="hs-identifier">&#946;</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679096767"><span class="hs-identifier hs-var">r</span></a><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">cos</span><span class="hs-special">(</span><a href="#local-6989586621679096777"><span class="hs-identifier hs-var">&#981;</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">cos</span><span class="hs-special">(</span><a href="#local-6989586621679096778"><span class="hs-identifier hs-var">&#946;</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679096764"><span class="hs-identifier hs-var">x0</span></a><span>
</span><a name="line-811"></a><span>            </span><a name="local-6989586621679096769"><a href="#local-6989586621679096769"><span class="hs-identifier">fy</span></a></a><span> </span><a name="local-6989586621679096779"><a href="#local-6989586621679096779"><span class="hs-identifier">&#981;</span></a></a><span> </span><a name="local-6989586621679096780"><a href="#local-6989586621679096780"><span class="hs-identifier">&#946;</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679096767"><span class="hs-identifier hs-var">r</span></a><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">cos</span><span class="hs-special">(</span><a href="#local-6989586621679096779"><span class="hs-identifier hs-var">&#981;</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">sin</span><span class="hs-special">(</span><a href="#local-6989586621679096780"><span class="hs-identifier hs-var">&#946;</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679096765"><span class="hs-identifier hs-var">y0</span></a><span>
</span><a name="line-812"></a><span>            </span><a name="local-6989586621679096770"><a href="#local-6989586621679096770"><span class="hs-identifier">fz</span></a></a><span> </span><a name="local-6989586621679096781"><a href="#local-6989586621679096781"><span class="hs-identifier">&#981;</span></a></a><span> </span><a name="local-6989586621679096782"><a href="#local-6989586621679096782"><span class="hs-identifier">&#946;</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679096767"><span class="hs-identifier hs-var">r</span></a><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">sin</span><span class="hs-special">(</span><a href="#local-6989586621679096781"><span class="hs-identifier hs-var">&#981;</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679096766"><span class="hs-identifier hs-var">z0</span></a><span>
</span><a name="line-813"></a><span>            </span><a name="local-6989586621679096771"><a href="#local-6989586621679096771"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">50</span><span>
</span><a name="line-814"></a><span>            </span><a name="local-6989586621679096772"><a href="#local-6989586621679096772"><span class="hs-identifier">&#960;</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pi</span><span>
</span><a name="line-815"></a><span>            </span><a name="local-6989586621679096773"><a href="#local-6989586621679096773"><span class="hs-identifier">&#948;</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">2</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679096772"><span class="hs-identifier hs-var">&#960;</span></a><span class="hs-operator hs-var">/</span><a href="#local-6989586621679096771"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-816"></a><span>            </span><a name="local-6989586621679096774"><a href="#local-6989586621679096774"><span class="hs-identifier">ll</span></a></a><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679096783"><a href="#local-6989586621679096783"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679096783"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679096773"><span class="hs-identifier hs-var">&#948;</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><a href="#local-6989586621679096771"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span>
</span><a name="line-817"></a><span>            </span><a name="local-6989586621679096775"><a href="#local-6989586621679096775"><span class="hs-identifier">ls</span></a></a><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679096784"><a href="#local-6989586621679096784"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679096784"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679096773"><span class="hs-identifier hs-var">&#948;</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><a href="#local-6989586621679096771"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span>
</span><a name="line-818"></a><span>            </span><a name="local-6989586621679096776"><a href="#local-6989586621679096776"><span class="hs-identifier">pp</span></a></a><span class="hs-glyph">=</span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679096768"><span class="hs-identifier hs-var">fx</span></a><span> </span><a href="#local-6989586621679096786"><span class="hs-identifier hs-var">&#981;</span></a><span> </span><a href="#local-6989586621679096787"><span class="hs-identifier hs-var">&#946;</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679096769"><span class="hs-identifier hs-var">fy</span></a><span> </span><a href="#local-6989586621679096786"><span class="hs-identifier hs-var">&#981;</span></a><span> </span><a href="#local-6989586621679096787"><span class="hs-identifier hs-var">&#946;</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679096770"><span class="hs-identifier hs-var">fz</span></a><span> </span><a href="#local-6989586621679096786"><span class="hs-identifier hs-var">&#981;</span></a><span> </span><a href="#local-6989586621679096787"><span class="hs-identifier hs-var">&#946;</span></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679096786"><a href="#local-6989586621679096786"><span class="hs-identifier">&#981;</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679096785"><a href="#local-6989586621679096785"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679096772"><span class="hs-identifier hs-var">&#960;</span></a><span class="hs-operator hs-var">/</span><span class="hs-number">10</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679096785"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><span class="hs-number">10</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679096787"><a href="#local-6989586621679096787"><span class="hs-identifier">&#946;</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679096775"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">]</span><span>
</span><a name="line-819"></a><span>
</span><a name="line-820"></a><span>
</span><a name="line-821"></a><span>
</span><a name="line-822"></a><span class="hs-comment">-- | draw plane with three points</span><span>
</span><a name="line-823"></a><span class="hs-comment">-- | no check whether they are co-linear</span><span>
</span><a name="line-824"></a><span class="hs-comment">--</span><span>
</span><a name="line-825"></a><span class="hs-identifier">drawPlane</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-826"></a><span>           </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-827"></a><span>           </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-828"></a><span>           </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-829"></a><a name="drawPlane"><a href="AronGraphic.html#drawPlane"><span class="hs-identifier">drawPlane</span></a></a><span> </span><a name="local-6989586621679096788"><a href="#local-6989586621679096788"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679096789"><a href="#local-6989586621679096789"><span class="hs-identifier">q0</span></a></a><span> </span><a name="local-6989586621679096790"><a href="#local-6989586621679096790"><span class="hs-identifier">q1</span></a></a><span> </span><a name="local-6989586621679096791"><a href="#local-6989586621679096791"><span class="hs-identifier">q2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-830"></a><span>  </span><span class="hs-identifier hs-var">renderPrimitive</span><span> </span><span class="hs-identifier hs-var">Lines</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mapM_</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679096792"><a href="#local-6989586621679096792"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-831"></a><span>                                    </span><span class="hs-identifier hs-var">color</span><span> </span><a href="#local-6989586621679096788"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-832"></a><span>                                    </span><span class="hs-identifier hs-var">vertex</span><span> </span><a href="#local-6989586621679096792"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679096789"><span class="hs-identifier hs-var">q0</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679096790"><span class="hs-identifier hs-var">q1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679096789"><span class="hs-identifier hs-var">q0</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679096791"><span class="hs-identifier hs-var">q2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679096790"><span class="hs-identifier hs-var">q1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679096791"><span class="hs-identifier hs-var">q2</span></a><span class="hs-special">]</span><span>
</span><a name="line-833"></a><span class="hs-comment">{-|
    === Generate a circle 

    &gt; let radius = 0.1
    &gt; let pts = circlePt (Vertex3 0 0 0) radius 
-}</span><span>
</span><a name="line-839"></a><span class="hs-identifier">circlePt</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span>
</span><a name="line-840"></a><a name="circlePt"><a href="AronGraphic.html#circlePt"><span class="hs-identifier">circlePt</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679096793"><a href="#local-6989586621679096793"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679096794"><a href="#local-6989586621679096794"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679096795"><a href="#local-6989586621679096795"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679096796"><a href="#local-6989586621679096796"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span class="hs-special">[</span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679096800"><a href="#local-6989586621679096800"><span class="hs-identifier">alpha</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679096798"><span class="hs-identifier hs-var">pi2</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679096799"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">/</span><a href="#local-6989586621679096797"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="AronModule.html#rf"><span class="hs-identifier hs-var">rf</span></a><span> </span><a href="#local-6989586621679096796"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">sin</span><span class="hs-special">(</span><a href="#local-6989586621679096800"><span class="hs-identifier hs-var">alpha</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679096793"><span class="hs-identifier hs-var">x0</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="AronModule.html#rf"><span class="hs-identifier hs-var">rf</span></a><span> </span><a href="#local-6989586621679096796"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">cos</span><span class="hs-special">(</span><a href="#local-6989586621679096800"><span class="hs-identifier hs-var">alpha</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679096794"><span class="hs-identifier hs-var">y0</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679096795"><span class="hs-identifier hs-var">z0</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679096799"><a href="#local-6989586621679096799"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><a href="#local-6989586621679096797"><span class="hs-identifier hs-var">num</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-841"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-842"></a><span>            </span><a name="local-6989586621679096797"><a href="#local-6989586621679096797"><span class="hs-identifier">num</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">4</span><span>
</span><a name="line-843"></a><span>            </span><a name="local-6989586621679096798"><a href="#local-6989586621679096798"><span class="hs-identifier">pi2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">2</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">pi</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Float</span><span>
</span><a name="line-844"></a><span>
</span><a name="line-845"></a><span class="hs-comment">{-|
    \(\color{red}{Deprecated} \) Use 'circlePt'

    === Fri Feb 15 11:13:17 2019 

    === Draw xy-plane circle
-}</span><span>
</span><a name="line-852"></a><span class="hs-identifier">circle'</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span>
</span><a name="line-853"></a><a name="circle%27"><a href="AronGraphic.html#circle%27"><span class="hs-identifier">circle'</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679096801"><a href="#local-6989586621679096801"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679096802"><a href="#local-6989586621679096802"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679096803"><a href="#local-6989586621679096803"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679096804"><a href="#local-6989586621679096804"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span class="hs-special">[</span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679096808"><a href="#local-6989586621679096808"><span class="hs-identifier">alpha</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679096806"><span class="hs-identifier hs-var">pi2</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679096807"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">/</span><a href="#local-6989586621679096805"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="AronModule.html#rf"><span class="hs-identifier hs-var">rf</span></a><span> </span><a href="#local-6989586621679096804"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">sin</span><span class="hs-special">(</span><a href="#local-6989586621679096808"><span class="hs-identifier hs-var">alpha</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679096801"><span class="hs-identifier hs-var">x0</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="AronModule.html#rf"><span class="hs-identifier hs-var">rf</span></a><span> </span><a href="#local-6989586621679096804"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">cos</span><span class="hs-special">(</span><a href="#local-6989586621679096808"><span class="hs-identifier hs-var">alpha</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679096802"><span class="hs-identifier hs-var">y0</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679096803"><span class="hs-identifier hs-var">z0</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679096807"><a href="#local-6989586621679096807"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><a href="#local-6989586621679096805"><span class="hs-identifier hs-var">num</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-854"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-855"></a><span>            </span><a name="local-6989586621679096805"><a href="#local-6989586621679096805"><span class="hs-identifier">num</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">4</span><span>
</span><a name="line-856"></a><span>            </span><a name="local-6989586621679096806"><a href="#local-6989586621679096806"><span class="hs-identifier">pi2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">2</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">pi</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Float</span><span>
</span><a name="line-857"></a><span>
</span><a name="line-858"></a><span class="hs-comment">{-|
    === Draw xz-plane circle
-}</span><span>
</span><a name="line-861"></a><span class="hs-identifier">circleXY</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span>
</span><a name="line-862"></a><a name="circleXY"><a href="AronGraphic.html#circleXY"><span class="hs-identifier">circleXY</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679096809"><a href="#local-6989586621679096809"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679096810"><a href="#local-6989586621679096810"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679096811"><a href="#local-6989586621679096811"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679096812"><a href="#local-6989586621679096812"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span class="hs-special">[</span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679096816"><a href="#local-6989586621679096816"><span class="hs-identifier">alpha</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679096814"><span class="hs-identifier hs-var">pi2</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679096815"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">/</span><a href="#local-6989586621679096813"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="AronModule.html#rf"><span class="hs-identifier hs-var">rf</span></a><span> </span><a href="#local-6989586621679096812"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">cos</span><span class="hs-special">(</span><a href="#local-6989586621679096816"><span class="hs-identifier hs-var">alpha</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679096809"><span class="hs-identifier hs-var">x0</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="AronModule.html#rf"><span class="hs-identifier hs-var">rf</span></a><span> </span><a href="#local-6989586621679096812"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">sin</span><span class="hs-special">(</span><a href="#local-6989586621679096816"><span class="hs-identifier hs-var">alpha</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679096810"><span class="hs-identifier hs-var">y0</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679096811"><span class="hs-identifier hs-var">z0</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679096815"><a href="#local-6989586621679096815"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><a href="#local-6989586621679096813"><span class="hs-identifier hs-var">num</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-863"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-864"></a><span>            </span><a name="local-6989586621679096813"><a href="#local-6989586621679096813"><span class="hs-identifier">num</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">4</span><span>
</span><a name="line-865"></a><span>            </span><a name="local-6989586621679096814"><a href="#local-6989586621679096814"><span class="hs-identifier">pi2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">2</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">pi</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Float</span><span>
</span><a name="line-866"></a><span>
</span><a name="line-867"></a><span class="hs-comment">{-|
    === Draw xz-plane circle
-}</span><span>
</span><a name="line-870"></a><span class="hs-identifier">circleXZ</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span>
</span><a name="line-871"></a><a name="circleXZ"><a href="AronGraphic.html#circleXZ"><span class="hs-identifier">circleXZ</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679096817"><a href="#local-6989586621679096817"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679096818"><a href="#local-6989586621679096818"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679096819"><a href="#local-6989586621679096819"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679096820"><a href="#local-6989586621679096820"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span class="hs-special">[</span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679096824"><a href="#local-6989586621679096824"><span class="hs-identifier">alpha</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679096822"><span class="hs-identifier hs-var">pi2</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679096823"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">/</span><a href="#local-6989586621679096821"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="AronModule.html#rf"><span class="hs-identifier hs-var">rf</span></a><span> </span><a href="#local-6989586621679096820"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">cos</span><span class="hs-special">(</span><a href="#local-6989586621679096824"><span class="hs-identifier hs-var">alpha</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679096817"><span class="hs-identifier hs-var">x0</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679096818"><span class="hs-identifier hs-var">y0</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="AronModule.html#rf"><span class="hs-identifier hs-var">rf</span></a><span> </span><a href="#local-6989586621679096820"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">sin</span><span class="hs-special">(</span><a href="#local-6989586621679096824"><span class="hs-identifier hs-var">alpha</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679096819"><span class="hs-identifier hs-var">z0</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679096823"><a href="#local-6989586621679096823"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><a href="#local-6989586621679096821"><span class="hs-identifier hs-var">num</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-872"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-873"></a><span>            </span><a name="local-6989586621679096821"><a href="#local-6989586621679096821"><span class="hs-identifier">num</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">4</span><span>
</span><a name="line-874"></a><span>            </span><a name="local-6989586621679096822"><a href="#local-6989586621679096822"><span class="hs-identifier">pi2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">2</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">pi</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Float</span><span>
</span><a name="line-875"></a><span>
</span><a name="line-876"></a><span class="hs-comment">{-|
    === Draw yz-plane circle
-}</span><span>
</span><a name="line-879"></a><span class="hs-identifier">circleYZ</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span>
</span><a name="line-880"></a><a name="circleYZ"><a href="AronGraphic.html#circleYZ"><span class="hs-identifier">circleYZ</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679096825"><a href="#local-6989586621679096825"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679096826"><a href="#local-6989586621679096826"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679096827"><a href="#local-6989586621679096827"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679096828"><a href="#local-6989586621679096828"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span class="hs-special">[</span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679096832"><a href="#local-6989586621679096832"><span class="hs-identifier">alpha</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679096830"><span class="hs-identifier hs-var">pi2</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679096831"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">/</span><a href="#local-6989586621679096829"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span>  </span><span class="hs-special">(</span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679096825"><span class="hs-identifier hs-var">x0</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="AronModule.html#rf"><span class="hs-identifier hs-var">rf</span></a><span> </span><a href="#local-6989586621679096828"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">cos</span><span class="hs-special">(</span><a href="#local-6989586621679096832"><span class="hs-identifier hs-var">alpha</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679096826"><span class="hs-identifier hs-var">y0</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="AronModule.html#rf"><span class="hs-identifier hs-var">rf</span></a><span> </span><a href="#local-6989586621679096828"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">sin</span><span class="hs-special">(</span><a href="#local-6989586621679096832"><span class="hs-identifier hs-var">alpha</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679096827"><span class="hs-identifier hs-var">z0</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679096831"><a href="#local-6989586621679096831"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><a href="#local-6989586621679096829"><span class="hs-identifier hs-var">num</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-881"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-882"></a><span>            </span><a name="local-6989586621679096829"><a href="#local-6989586621679096829"><span class="hs-identifier">num</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">4</span><span>
</span><a name="line-883"></a><span>            </span><a name="local-6989586621679096830"><a href="#local-6989586621679096830"><span class="hs-identifier">pi2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">2</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">pi</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Float</span><span>
</span><a name="line-884"></a><span>
</span><a name="line-885"></a><span>
</span><a name="line-886"></a><span class="hs-comment">-- | draw dot, small circle</span><span>
</span><a name="line-887"></a><span class="hs-identifier">drawDot</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-888"></a><a name="drawDot"><a href="AronGraphic.html#drawDot"><span class="hs-identifier">drawDot</span></a></a><span> </span><a name="local-6989586621679096833"><a href="#local-6989586621679096833"><span class="hs-identifier">cen</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#drawPrimitive%27"><span class="hs-identifier hs-var">drawPrimitive'</span></a><span> </span><span class="hs-identifier hs-var">LineLoop</span><span> </span><a href="#local-6989586621679096835"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#circle%27"><span class="hs-identifier hs-var">circle'</span></a><span> </span><a href="#local-6989586621679096833"><span class="hs-identifier hs-var">cen</span></a><span> </span><a href="#local-6989586621679096834"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-889"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-890"></a><span>            </span><a name="local-6989586621679096834"><a href="#local-6989586621679096834"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0.01</span><span>
</span><a name="line-891"></a><span>            </span><a name="local-6989586621679096835"><a href="#local-6989586621679096835"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#red"><span class="hs-identifier hs-var">red</span></a><span>
</span><a name="line-892"></a><span>
</span><a name="line-893"></a><span class="hs-comment">-- | Given an Vector3 x y z or Vertex3 x y z</span><span>
</span><a name="line-894"></a><span class="hs-comment">-- | Convert Cartesian Coordinates to Polar Coordinates</span><span>
</span><a name="line-895"></a><span class="hs-comment">-- | beta  x-y plane,</span><span>
</span><a name="line-896"></a><span class="hs-comment">-- | alpha x-z plane</span><span>
</span><a name="line-897"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-898"></a><span class="hs-comment">-- |             y  z</span><span>
</span><a name="line-899"></a><span class="hs-comment">-- |             | /</span><span>
</span><a name="line-900"></a><span class="hs-comment">-- |          ---|/--- x</span><span>
</span><a name="line-901"></a><span class="hs-comment">-- |             /</span><span>
</span><a name="line-902"></a><span class="hs-comment">--</span><span>
</span><a name="line-903"></a><span class="hs-identifier">cartToPolar</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span>
</span><a name="line-904"></a><a name="cartToPolar"><a href="AronGraphic.html#cartToPolar"><span class="hs-identifier">cartToPolar</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679096836"><a href="#local-6989586621679096836"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679096837"><a href="#local-6989586621679096837"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679096838"><a href="#local-6989586621679096838"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">atan</span><span class="hs-special">(</span><a href="#local-6989586621679096837"><span class="hs-identifier hs-var">y</span></a><span class="hs-operator hs-var">/</span><a href="#local-6989586621679096836"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">asin</span><span class="hs-special">(</span><a href="#local-6989586621679096838"><span class="hs-identifier hs-var">z</span></a><span class="hs-operator hs-var">/</span><a href="#local-6989586621679096840"><span class="hs-identifier hs-var">rxz</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-905"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-906"></a><span>            </span><a name="local-6989586621679096839"><a href="#local-6989586621679096839"><span class="hs-identifier">rxy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sqrt</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#dot3ve"><span class="hs-identifier hs-var">dot3ve</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a href="#local-6989586621679096836"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679096837"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-number">0.0</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a href="#local-6989586621679096836"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679096837"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-number">0.0</span><span class="hs-special">)</span><span>
</span><a name="line-907"></a><span>            </span><a name="local-6989586621679096840"><a href="#local-6989586621679096840"><span class="hs-identifier">rxz</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sqrt</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#dot3ve"><span class="hs-identifier hs-var">dot3ve</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a href="#local-6989586621679096836"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-number">0.0</span><span> </span><a href="#local-6989586621679096838"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a href="#local-6989586621679096836"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-number">0.0</span><span> </span><a href="#local-6989586621679096838"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span>
</span><a name="line-908"></a><span>            </span><span class="hs-comment">-- | at  = if y &lt; 0 &amp;&amp; x &lt; 0 then pi + atan(y/x) else atan(y/x)</span><span>
</span><a name="line-909"></a><span>
</span><a name="line-910"></a><span class="hs-comment">-- | right hand coordinates system in OpenGL</span><span>
</span><a name="line-911"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-912"></a><span class="hs-comment">-- | x-z plane</span><span>
</span><a name="line-913"></a><a name="roty"><a href="AronGraphic.html#roty"><span class="hs-identifier">roty</span></a></a><span> </span><a name="local-6989586621679096841"><a href="#local-6989586621679096841"><span class="hs-identifier">&#945;</span></a></a><span> </span><span class="hs-glyph">=</span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-var">cos</span><span> </span><a href="#local-6989586621679096841"><span class="hs-identifier hs-var">&#945;</span></a><span class="hs-special">,</span><span>          </span><span class="hs-number">0.0</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier hs-var">sin</span><span> </span><a href="#local-6989586621679096841"><span class="hs-identifier hs-var">&#945;</span></a><span class="hs-special">]</span><span>
</span><a name="line-914"></a><span>        </span><span class="hs-special">,</span><span class="hs-special">[</span><span> </span><span class="hs-number">0.0</span><span> </span><span class="hs-special">,</span><span>          </span><span class="hs-number">1.0</span><span class="hs-special">,</span><span>  </span><span class="hs-number">0.0</span><span>  </span><span class="hs-special">]</span><span>
</span><a name="line-915"></a><span>        </span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-identifier hs-var">negate</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">sin</span><span> </span><a href="#local-6989586621679096841"><span class="hs-identifier hs-var">&#945;</span></a><span class="hs-special">,</span><span> </span><span class="hs-number">0.0</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier hs-var">cos</span><span> </span><a href="#local-6989586621679096841"><span class="hs-identifier hs-var">&#945;</span></a><span class="hs-special">]</span><span>
</span><a name="line-916"></a><span>         </span><span class="hs-special">]</span><span>
</span><a name="line-917"></a><span>
</span><a name="line-918"></a><span class="hs-comment">-- | x-y plane</span><span>
</span><a name="line-919"></a><a name="rotz"><a href="AronGraphic.html#rotz"><span class="hs-identifier">rotz</span></a></a><span> </span><a name="local-6989586621679096842"><a href="#local-6989586621679096842"><span class="hs-identifier">&#981;</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">cos</span><span> </span><a href="#local-6989586621679096842"><span class="hs-identifier hs-var">&#981;</span></a><span class="hs-special">,</span><span>          </span><span class="hs-identifier hs-var">negate</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">sin</span><span> </span><a href="#local-6989586621679096842"><span class="hs-identifier hs-var">&#981;</span></a><span class="hs-special">,</span><span> </span><span class="hs-number">0.0</span><span class="hs-special">]</span><span>
</span><a name="line-920"></a><span>         </span><span class="hs-special">,</span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">sin</span><span> </span><a href="#local-6989586621679096842"><span class="hs-identifier hs-var">&#981;</span></a><span class="hs-special">,</span><span>          </span><span class="hs-identifier hs-var">cos</span><span> </span><a href="#local-6989586621679096842"><span class="hs-identifier hs-var">&#981;</span></a><span class="hs-special">,</span><span> </span><span class="hs-number">0.0</span><span class="hs-special">]</span><span>
</span><a name="line-921"></a><span>          </span><span class="hs-special">,</span><span class="hs-special">[</span><span> </span><span class="hs-number">0.0</span><span> </span><span class="hs-special">,</span><span>            </span><span class="hs-number">0.0</span><span class="hs-special">,</span><span> </span><span class="hs-number">1.0</span><span class="hs-special">]</span><span>
</span><a name="line-922"></a><span>          </span><span class="hs-special">]</span><span>
</span><a name="line-923"></a><span>
</span><a name="line-924"></a><span>
</span><a name="line-925"></a><span class="hs-identifier">coordTip</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-926"></a><a name="coordTip"><a href="AronGraphic.html#coordTip"><span class="hs-identifier">coordTip</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-927"></a><span>    </span><span class="hs-identifier hs-var">renderPrimitive</span><span> </span><span class="hs-identifier hs-var">Lines</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">mapM_</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679096843"><a href="#local-6989586621679096843"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679096844"><a href="#local-6989586621679096844"><span class="hs-identifier">y</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679096845"><a href="#local-6989586621679096845"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-928"></a><span>        </span><span class="hs-identifier hs-var">color</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Color3</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span class="hs-special">)</span><span>
</span><a name="line-929"></a><span>        </span><span class="hs-identifier hs-var">vertex</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a href="#local-6989586621679096843"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679096844"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679096845"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span>
</span><a name="line-930"></a><span>        </span><span class="hs-special">)</span><span> </span><a href="AronGraphic.html#conic"><span class="hs-identifier hs-var">conic</span></a><span>
</span><a name="line-931"></a><span>
</span><a name="line-932"></a><span class="hs-identifier">coordTipX</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-933"></a><a name="coordTipX"><a href="AronGraphic.html#coordTipX"><span class="hs-identifier">coordTipX</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-934"></a><span>    </span><span class="hs-identifier hs-var">preservingMatrix</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-935"></a><span>        </span><span class="hs-identifier hs-var">translate</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span class="hs-special">)</span><span>
</span><a name="line-936"></a><span>        </span><span class="hs-comment">--rotate (90)$ (Vector3 0 0 1 :: Vector3 GLdouble)</span><span>
</span><a name="line-937"></a><span>        </span><a href="AronGraphic.html#coordTip"><span class="hs-identifier hs-var">coordTip</span></a><span>
</span><a name="line-938"></a><span>
</span><a name="line-939"></a><span class="hs-identifier">coordTipY</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-940"></a><a name="coordTipY"><a href="AronGraphic.html#coordTipY"><span class="hs-identifier">coordTipY</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-941"></a><span>    </span><span class="hs-identifier hs-var">preservingMatrix</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-942"></a><span>        </span><span class="hs-identifier hs-var">translate</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span class="hs-special">)</span><span>
</span><a name="line-943"></a><span>        </span><span class="hs-identifier hs-var">rotate</span><span> </span><span class="hs-special">(</span><span class="hs-number">90</span><span class="hs-special">)</span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span class="hs-special">)</span><span>
</span><a name="line-944"></a><span>        </span><a href="AronGraphic.html#coordTip"><span class="hs-identifier hs-var">coordTip</span></a><span>
</span><a name="line-945"></a><span>
</span><a name="line-946"></a><span class="hs-identifier">coordTipZ</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-947"></a><a name="coordTipZ"><a href="AronGraphic.html#coordTipZ"><span class="hs-identifier">coordTipZ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-948"></a><span>    </span><span class="hs-identifier hs-var">preservingMatrix</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-949"></a><span>        </span><span class="hs-identifier hs-var">translate</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span class="hs-special">)</span><span>
</span><a name="line-950"></a><span>        </span><span class="hs-identifier hs-var">rotate</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">90</span><span class="hs-special">)</span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span class="hs-special">)</span><span>
</span><a name="line-951"></a><span>        </span><a href="AronGraphic.html#coordTip"><span class="hs-identifier hs-var">coordTip</span></a><span>
</span><a name="line-952"></a><span>
</span><a name="line-953"></a><span class="hs-comment">{-|
    === Coordinate with tips

    positive dir is the tips dir
-}</span><span>
</span><a name="line-958"></a><span class="hs-identifier">renderCoordinates</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-959"></a><a name="renderCoordinates"><a href="AronGraphic.html#renderCoordinates"><span class="hs-identifier">renderCoordinates</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-960"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679097827"><a href="#local-6989586621679097827"><span class="hs-identifier">u</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0.5</span><span>
</span><a name="line-961"></a><span>    </span><a href="AronGraphic.html#coordTipX"><span class="hs-identifier hs-var">coordTipX</span></a><span>
</span><a name="line-962"></a><span>    </span><a href="AronGraphic.html#coordTipY"><span class="hs-identifier hs-var">coordTipY</span></a><span>
</span><a name="line-963"></a><span>    </span><a href="AronGraphic.html#coordTipZ"><span class="hs-identifier hs-var">coordTipZ</span></a><span>
</span><a name="line-964"></a><span>    </span><span class="hs-identifier hs-var">renderPrimitive</span><span> </span><span class="hs-identifier hs-var">Lines</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-965"></a><span>        </span><span class="hs-comment">-- x-Axis</span><span>
</span><a name="line-966"></a><span>        </span><span class="hs-identifier hs-var">color</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Color3</span><span> </span><a href="#local-6989586621679097827"><span class="hs-identifier hs-var">u</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span class="hs-special">)</span><span>
</span><a name="line-967"></a><span>        </span><span class="hs-identifier hs-var">vertex</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679097827"><span class="hs-identifier hs-var">u</span></a><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span class="hs-special">)</span><span>
</span><a name="line-968"></a><span>        </span><span class="hs-identifier hs-var">color</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Color3</span><span> </span><a href="#local-6989586621679097827"><span class="hs-identifier hs-var">u</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span class="hs-special">)</span><span>
</span><a name="line-969"></a><span>        </span><span class="hs-identifier hs-var">vertex</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a href="#local-6989586621679097827"><span class="hs-identifier hs-var">u</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span class="hs-special">)</span><span>
</span><a name="line-970"></a><span>        </span><span class="hs-comment">-- y-Axis</span><span>
</span><a name="line-971"></a><span>        </span><span class="hs-identifier hs-var">color</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Color3</span><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679097827"><span class="hs-identifier hs-var">u</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span class="hs-special">)</span><span>
</span><a name="line-972"></a><span>        </span><span class="hs-identifier hs-var">vertex</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679097827"><span class="hs-identifier hs-var">u</span></a><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span class="hs-special">)</span><span>
</span><a name="line-973"></a><span>        </span><span class="hs-identifier hs-var">color</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Color3</span><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679097827"><span class="hs-identifier hs-var">u</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span class="hs-special">)</span><span>
</span><a name="line-974"></a><span>        </span><span class="hs-identifier hs-var">vertex</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679097827"><span class="hs-identifier hs-var">u</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span class="hs-special">)</span><span>
</span><a name="line-975"></a><span>        </span><span class="hs-comment">-- z-Axis</span><span>
</span><a name="line-976"></a><span>        </span><span class="hs-identifier hs-var">color</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Color3</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679097827"><span class="hs-identifier hs-var">u</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span class="hs-special">)</span><span>
</span><a name="line-977"></a><span>        </span><span class="hs-identifier hs-var">vertex</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679097827"><span class="hs-identifier hs-var">u</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span class="hs-special">)</span><span>
</span><a name="line-978"></a><span>        </span><span class="hs-identifier hs-var">color</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Color3</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679097827"><span class="hs-identifier hs-var">u</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span class="hs-special">)</span><span>
</span><a name="line-979"></a><span>        </span><span class="hs-identifier hs-var">vertex</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679097827"><span class="hs-identifier hs-var">u</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span class="hs-special">)</span><span>
</span><a name="line-980"></a><span>
</span><a name="line-981"></a><span class="hs-comment">-- | Given an radius r, center Vertex3 vx, and Vector ve</span><span>
</span><a name="line-982"></a><span class="hs-comment">--   Draw circle(r, vx) which is perpendicular to ve</span><span>
</span><a name="line-983"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-984"></a><span class="hs-identifier">drawCircleVec</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-985"></a><a name="drawCircleVec"><a href="AronGraphic.html#drawCircleVec"><span class="hs-identifier">drawCircleVec</span></a></a><span> </span><a name="local-6989586621679097828"><a href="#local-6989586621679097828"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679097829"><a href="#local-6989586621679097829"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679097830"><a href="#local-6989586621679097830"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-986"></a><span>  </span><span class="hs-identifier hs-var">mapM_</span><span> </span><a href="AronGraphic.html#drawDot"><span class="hs-identifier hs-var">drawDot</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#matVx"><span class="hs-identifier hs-var">matVx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679097835"><span class="hs-identifier hs-var">ls'</span></a><span>
</span><a name="line-987"></a><span>  </span><a href="AronGraphic.html#drawLines"><span class="hs-identifier hs-var">drawLines</span></a><span> </span><a href="AronGraphic.html#blue"><span class="hs-identifier hs-var">blue</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679097829"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679097829"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="AronGraphic.html#%2B%3A"><span class="hs-operator hs-var">+:</span></a><span> </span><a href="#local-6989586621679097830"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">]</span><span>
</span><a name="line-988"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-989"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679097831"><a href="#local-6989586621679097831"><span class="hs-identifier">&#981;</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679097832"><a href="#local-6989586621679097832"><span class="hs-identifier">&#945;</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#cartToPolar"><span class="hs-identifier hs-var">cartToPolar</span></a><span> </span><a href="#local-6989586621679097830"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-990"></a><span>    </span><a name="local-6989586621679097833"><a href="#local-6989586621679097833"><span class="hs-identifier">circ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-number">0.0</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679097828"><span class="hs-identifier hs-var">r</span></a><span class="hs-operator hs-var">*</span><span class="hs-special">(</span><span class="hs-identifier hs-var">cos</span><span> </span><a href="#local-6989586621679097846"><span class="hs-identifier hs-var">&#946;</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679097828"><span class="hs-identifier hs-var">r</span></a><span class="hs-operator hs-var">*</span><span class="hs-special">(</span><span class="hs-identifier hs-var">sin</span><span> </span><a href="#local-6989586621679097846"><span class="hs-identifier hs-var">&#946;</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679097846"><a href="#local-6989586621679097846"><span class="hs-identifier">&#946;</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679097844"><a href="#local-6989586621679097844"><span class="hs-identifier">&#960;</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">3.1415</span><span class="hs-special">;</span><span> </span><a name="local-6989586621679097845"><a href="#local-6989586621679097845"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">2</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679097844"><span class="hs-identifier hs-var">&#960;</span></a><span class="hs-operator hs-var">/</span><span class="hs-number">100</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679097845"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-number">100</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-991"></a><span>    </span><span class="hs-comment">-- | circ = [[[0.5], [0.5], [0.0]]]</span><span>
</span><a name="line-992"></a><span>    </span><a name="local-6989586621679097834"><a href="#local-6989586621679097834"><span class="hs-identifier">ls</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><a href="AronModule.html#multiMat"><span class="hs-identifier hs-var">multiMat</span></a><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#rotz"><span class="hs-identifier hs-var">rotz</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679097831"><span class="hs-identifier hs-var">&#981;</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679097833"><span class="hs-identifier hs-var">circ</span></a><span> </span><span class="hs-comment">-- rotate x-y plane</span><span>
</span><a name="line-993"></a><span>    </span><a name="local-6989586621679097835"><a href="#local-6989586621679097835"><span class="hs-identifier">ls'</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><a href="AronModule.html#multiMat"><span class="hs-identifier hs-var">multiMat</span></a><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#roty"><span class="hs-identifier hs-var">roty</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679097832"><span class="hs-identifier hs-var">&#945;</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679097834"><span class="hs-identifier hs-var">ls</span></a><span>   </span><span class="hs-comment">-- rotate x-z plane</span><span>
</span><a name="line-994"></a><span>    </span><span class="hs-comment">-- |  v'   = multiMat (rotz $ &#981;) (veMat v)</span><span>
</span><a name="line-995"></a><span>    </span><span class="hs-comment">-- |  v''  = multiMat (roty $ &#945;) v'</span><span>
</span><a name="line-996"></a><span>    </span><span class="hs-comment">-- | matVx [[x], [y], [z]] = Vertex3 x y z</span><span>
</span><a name="line-997"></a><span>    </span><span class="hs-comment">-- | veMat (Vector3 x y z) = [[x], [y], [z]]</span><span>
</span><a name="line-998"></a><span>    </span><span class="hs-comment">-- | ls   = map(multiMat (rotz $ 0.0)) circ</span><span>
</span><a name="line-999"></a><span>    </span><a name="local-6989586621679097836"><a href="#local-6989586621679097836"><span class="hs-identifier">ls1</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><a href="AronModule.html#multiMat"><span class="hs-identifier hs-var">multiMat</span></a><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#rotz"><span class="hs-identifier hs-var">rotz</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">pi</span><span class="hs-operator hs-var">/</span><span class="hs-number">4</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679097833"><span class="hs-identifier hs-var">circ</span></a><span>
</span><a name="line-1000"></a><span>    </span><a name="local-6989586621679097837"><a href="#local-6989586621679097837"><span class="hs-identifier">ls2</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><a href="AronModule.html#multiMat"><span class="hs-identifier hs-var">multiMat</span></a><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#rotz"><span class="hs-identifier hs-var">rotz</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-number">2</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">pi</span><span class="hs-operator hs-var">/</span><span class="hs-number">4</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679097833"><span class="hs-identifier hs-var">circ</span></a><span>
</span><a name="line-1001"></a><span>    </span><a name="local-6989586621679097838"><a href="#local-6989586621679097838"><span class="hs-identifier">ls3</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><a href="AronModule.html#multiMat"><span class="hs-identifier hs-var">multiMat</span></a><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#rotz"><span class="hs-identifier hs-var">rotz</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-number">3</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">pi</span><span class="hs-operator hs-var">/</span><span class="hs-number">4</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679097833"><span class="hs-identifier hs-var">circ</span></a><span>
</span><a name="line-1002"></a><span>    </span><a name="local-6989586621679097839"><a href="#local-6989586621679097839"><span class="hs-identifier">ls4</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><a href="AronModule.html#multiMat"><span class="hs-identifier hs-var">multiMat</span></a><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#rotz"><span class="hs-identifier hs-var">rotz</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-number">4</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">pi</span><span class="hs-operator hs-var">/</span><span class="hs-number">4</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679097833"><span class="hs-identifier hs-var">circ</span></a><span>
</span><a name="line-1003"></a><span>    </span><a name="local-6989586621679097840"><a href="#local-6989586621679097840"><span class="hs-identifier">ls5</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><a href="AronModule.html#multiMat"><span class="hs-identifier hs-var">multiMat</span></a><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#rotz"><span class="hs-identifier hs-var">rotz</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-number">5</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">pi</span><span class="hs-operator hs-var">/</span><span class="hs-number">4</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679097833"><span class="hs-identifier hs-var">circ</span></a><span>
</span><a name="line-1004"></a><span>    </span><a name="local-6989586621679097841"><a href="#local-6989586621679097841"><span class="hs-identifier">ls6</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><a href="AronModule.html#multiMat"><span class="hs-identifier hs-var">multiMat</span></a><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#rotz"><span class="hs-identifier hs-var">rotz</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-number">6</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">pi</span><span class="hs-operator hs-var">/</span><span class="hs-number">4</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679097833"><span class="hs-identifier hs-var">circ</span></a><span>
</span><a name="line-1005"></a><span>    </span><a name="local-6989586621679097842"><a href="#local-6989586621679097842"><span class="hs-identifier">ls7</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><a href="AronModule.html#multiMat"><span class="hs-identifier hs-var">multiMat</span></a><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#rotz"><span class="hs-identifier hs-var">rotz</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-number">7</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">pi</span><span class="hs-operator hs-var">/</span><span class="hs-number">4</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679097833"><span class="hs-identifier hs-var">circ</span></a><span>
</span><a name="line-1006"></a><span>    </span><a name="local-6989586621679097843"><a href="#local-6989586621679097843"><span class="hs-identifier">ls8</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><a href="AronModule.html#multiMat"><span class="hs-identifier hs-var">multiMat</span></a><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#rotz"><span class="hs-identifier hs-var">rotz</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-number">8</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">pi</span><span class="hs-operator hs-var">/</span><span class="hs-number">4</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679097833"><span class="hs-identifier hs-var">circ</span></a><span>
</span><a name="line-1007"></a><span>
</span><a name="line-1008"></a><span class="hs-comment">-- | matrix to Vertex</span><span>
</span><a name="line-1009"></a><a name="matVx"><a href="AronGraphic.html#matVx"><span class="hs-identifier">matVx</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a name="local-6989586621679097847"><a href="#local-6989586621679097847"><span class="hs-identifier">x</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679097848"><a href="#local-6989586621679097848"><span class="hs-identifier">y</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679097849"><a href="#local-6989586621679097849"><span class="hs-identifier">z</span></a></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a href="#local-6989586621679097847"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679097848"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679097849"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-1010"></a><span class="hs-comment">-- | matrix to Vector</span><span>
</span><a name="line-1011"></a><a name="matVe"><a href="AronGraphic.html#matVe"><span class="hs-identifier">matVe</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a name="local-6989586621679097850"><a href="#local-6989586621679097850"><span class="hs-identifier">x</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679097851"><a href="#local-6989586621679097851"><span class="hs-identifier">y</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679097852"><a href="#local-6989586621679097852"><span class="hs-identifier">z</span></a></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vector3</span><span> </span><a href="#local-6989586621679097850"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679097851"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679097852"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-1012"></a><span class="hs-comment">-- | Vector to matrix</span><span>
</span><a name="line-1013"></a><a name="veMat"><a href="AronGraphic.html#veMat"><span class="hs-identifier">veMat</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679097853"><a href="#local-6989586621679097853"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679097854"><a href="#local-6989586621679097854"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679097855"><a href="#local-6989586621679097855"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679097853"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679097854"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679097855"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-1014"></a><span>
</span><a name="line-1015"></a><span>
</span><a name="line-1016"></a><span class="hs-identifier">drawRect</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1017"></a><a name="drawRect"><a href="AronGraphic.html#drawRect"><span class="hs-identifier">drawRect</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679097856"><a href="#local-6989586621679097856"><span class="hs-identifier">p0</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679097857"><a href="#local-6989586621679097857"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679097858"><a href="#local-6989586621679097858"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679097859"><a href="#local-6989586621679097859"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679097860"><a href="#local-6989586621679097860"><span class="hs-identifier">p1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679097861"><a href="#local-6989586621679097861"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679097862"><a href="#local-6989586621679097862"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679097863"><a href="#local-6989586621679097863"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1018"></a><span>        </span><a href="AronGraphic.html#drawSegmentNoEnd"><span class="hs-identifier hs-var">drawSegmentNoEnd</span></a><span> </span><a href="AronGraphic.html#red"><span class="hs-identifier hs-var">red</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a href="#local-6989586621679097857"><span class="hs-identifier hs-var">x0</span></a><span> </span><a href="#local-6989586621679097858"><span class="hs-identifier hs-var">y0</span></a><span> </span><a href="#local-6989586621679097859"><span class="hs-identifier hs-var">z0</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a href="#local-6989586621679097861"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="#local-6989586621679097858"><span class="hs-identifier hs-var">y0</span></a><span> </span><a href="#local-6989586621679097859"><span class="hs-identifier hs-var">z0</span></a><span class="hs-special">)</span><span>  </span><span class="hs-comment">--  top horizontal </span><span>
</span><a name="line-1019"></a><span>        </span><a href="AronGraphic.html#drawSegmentNoEnd"><span class="hs-identifier hs-var">drawSegmentNoEnd</span></a><span> </span><a href="AronGraphic.html#red"><span class="hs-identifier hs-var">red</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a href="#local-6989586621679097857"><span class="hs-identifier hs-var">x0</span></a><span> </span><a href="#local-6989586621679097858"><span class="hs-identifier hs-var">y0</span></a><span> </span><a href="#local-6989586621679097859"><span class="hs-identifier hs-var">z0</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a href="#local-6989586621679097857"><span class="hs-identifier hs-var">x0</span></a><span> </span><a href="#local-6989586621679097862"><span class="hs-identifier hs-var">y1</span></a><span> </span><a href="#local-6989586621679097859"><span class="hs-identifier hs-var">z0</span></a><span class="hs-special">)</span><span>  </span><span class="hs-comment">--  left vertical  </span><span>
</span><a name="line-1020"></a><span>        </span><a href="AronGraphic.html#drawSegmentNoEnd"><span class="hs-identifier hs-var">drawSegmentNoEnd</span></a><span> </span><a href="AronGraphic.html#red"><span class="hs-identifier hs-var">red</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a href="#local-6989586621679097861"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="#local-6989586621679097858"><span class="hs-identifier hs-var">y0</span></a><span> </span><a href="#local-6989586621679097859"><span class="hs-identifier hs-var">z0</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a href="#local-6989586621679097861"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="#local-6989586621679097862"><span class="hs-identifier hs-var">y1</span></a><span> </span><a href="#local-6989586621679097863"><span class="hs-identifier hs-var">z1</span></a><span class="hs-special">)</span><span>  </span><span class="hs-comment">--  right vertical</span><span>
</span><a name="line-1021"></a><span>        </span><a href="AronGraphic.html#drawSegmentNoEnd"><span class="hs-identifier hs-var">drawSegmentNoEnd</span></a><span> </span><a href="AronGraphic.html#red"><span class="hs-identifier hs-var">red</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a href="#local-6989586621679097857"><span class="hs-identifier hs-var">x0</span></a><span> </span><a href="#local-6989586621679097862"><span class="hs-identifier hs-var">y1</span></a><span> </span><a href="#local-6989586621679097859"><span class="hs-identifier hs-var">z0</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a href="#local-6989586621679097861"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="#local-6989586621679097862"><span class="hs-identifier hs-var">y1</span></a><span> </span><a href="#local-6989586621679097863"><span class="hs-identifier hs-var">z1</span></a><span class="hs-special">)</span><span>  </span><span class="hs-comment">--  bottom horizontal</span><span>
</span><a name="line-1022"></a><span>
</span><a name="line-1023"></a><span class="hs-identifier">drawQuads</span><span class="hs-glyph">::</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1024"></a><a name="drawQuads"><a href="AronGraphic.html#drawQuads"><span class="hs-identifier">drawQuads</span></a></a><span> </span><a name="local-6989586621679097864"><a href="#local-6989586621679097864"><span class="hs-identifier">cx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#drawPrimitive%27"><span class="hs-identifier hs-var">drawPrimitive'</span></a><span> </span><span class="hs-identifier hs-var">Quads</span><span> </span><a href="AronGraphic.html#red"><span class="hs-identifier hs-var">red</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679097864"><span class="hs-identifier hs-var">cx</span></a><span>
</span><a name="line-1025"></a><span>
</span><a name="line-1026"></a><span>
</span><a name="line-1027"></a><span class="hs-comment">{-|
    === draw circle with center and radius

    &gt;drawCircle cen r = drawPrimitive LineLoop red $ circle cen r
-}</span><span>
</span><a name="line-1032"></a><span class="hs-identifier">drawCircle'</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1033"></a><a name="drawCircle%27"><a href="AronGraphic.html#drawCircle%27"><span class="hs-identifier">drawCircle'</span></a></a><span> </span><a name="local-6989586621679097865"><a href="#local-6989586621679097865"><span class="hs-identifier">cen</span></a></a><span> </span><a name="local-6989586621679097866"><a href="#local-6989586621679097866"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#drawPrimitive%27"><span class="hs-identifier hs-var">drawPrimitive'</span></a><span> </span><span class="hs-identifier hs-var">LineLoop</span><span> </span><a href="AronGraphic.html#red"><span class="hs-identifier hs-var">red</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#circle%27"><span class="hs-identifier hs-var">circle'</span></a><span> </span><a href="#local-6989586621679097865"><span class="hs-identifier hs-var">cen</span></a><span> </span><a href="#local-6989586621679097866"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-1034"></a><span>
</span><a name="line-1035"></a><span class="hs-identifier">drawCircleXYZ</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1036"></a><a name="drawCircleXYZ"><a href="AronGraphic.html#drawCircleXYZ"><span class="hs-identifier">drawCircleXYZ</span></a></a><span> </span><a name="local-6989586621679097867"><a href="#local-6989586621679097867"><span class="hs-identifier">cen</span></a></a><span> </span><a name="local-6989586621679097868"><a href="#local-6989586621679097868"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1037"></a><span>                </span><a href="AronGraphic.html#drawPrimitive%27"><span class="hs-identifier hs-var">drawPrimitive'</span></a><span> </span><span class="hs-identifier hs-var">LineLoop</span><span> </span><a href="AronGraphic.html#red"><span class="hs-identifier hs-var">red</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#circleXY"><span class="hs-identifier hs-var">circleXY</span></a><span> </span><a href="#local-6989586621679097867"><span class="hs-identifier hs-var">cen</span></a><span> </span><a href="#local-6989586621679097868"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-1038"></a><span>                </span><a href="AronGraphic.html#drawPrimitive%27"><span class="hs-identifier hs-var">drawPrimitive'</span></a><span> </span><span class="hs-identifier hs-var">LineLoop</span><span> </span><a href="AronGraphic.html#red"><span class="hs-identifier hs-var">red</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#circleXZ"><span class="hs-identifier hs-var">circleXZ</span></a><span> </span><a href="#local-6989586621679097867"><span class="hs-identifier hs-var">cen</span></a><span> </span><a href="#local-6989586621679097868"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-1039"></a><span>                </span><a href="AronGraphic.html#drawPrimitive%27"><span class="hs-identifier hs-var">drawPrimitive'</span></a><span> </span><span class="hs-identifier hs-var">LineLoop</span><span> </span><a href="AronGraphic.html#red"><span class="hs-identifier hs-var">red</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#circleYZ"><span class="hs-identifier hs-var">circleYZ</span></a><span> </span><a href="#local-6989586621679097867"><span class="hs-identifier hs-var">cen</span></a><span> </span><a href="#local-6989586621679097868"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-1040"></a><span>
</span><a name="line-1041"></a><span class="hs-identifier">drawCircleXYZColor</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1042"></a><a name="drawCircleXYZColor"><a href="AronGraphic.html#drawCircleXYZColor"><span class="hs-identifier">drawCircleXYZColor</span></a></a><span> </span><a name="local-6989586621679097869"><a href="#local-6989586621679097869"><span class="hs-identifier">cen</span></a></a><span> </span><a name="local-6989586621679097870"><a href="#local-6989586621679097870"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679097871"><a href="#local-6989586621679097871"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1043"></a><span>                </span><a href="AronGraphic.html#drawPrimitive%27"><span class="hs-identifier hs-var">drawPrimitive'</span></a><span> </span><span class="hs-identifier hs-var">LineLoop</span><span> </span><a href="#local-6989586621679097871"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#circleXY"><span class="hs-identifier hs-var">circleXY</span></a><span> </span><a href="#local-6989586621679097869"><span class="hs-identifier hs-var">cen</span></a><span> </span><a href="#local-6989586621679097870"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-1044"></a><span class="hs-comment">--                drawPrimitive' LineLoop c $ circleXZ cen r</span><span>
</span><a name="line-1045"></a><span class="hs-comment">--                drawPrimitive' LineLoop c $ circleYZ cen r</span><span>
</span><a name="line-1046"></a><span>
</span><a name="line-1047"></a><span>
</span><a name="line-1048"></a><span class="hs-comment">{-|
    === draw circle with center , Color3, radius

    &gt;drawCircleColor (Vertex3 0.1 0.2 0.3) red 0.5
-}</span><span>
</span><a name="line-1053"></a><span class="hs-identifier">drawCircleColor</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1054"></a><a name="drawCircleColor"><a href="AronGraphic.html#drawCircleColor"><span class="hs-identifier">drawCircleColor</span></a></a><span> </span><a name="local-6989586621679097872"><a href="#local-6989586621679097872"><span class="hs-identifier">cen</span></a></a><span> </span><a name="local-6989586621679097873"><a href="#local-6989586621679097873"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679097874"><a href="#local-6989586621679097874"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#drawPrimitive%27"><span class="hs-identifier hs-var">drawPrimitive'</span></a><span> </span><span class="hs-identifier hs-var">LineLoop</span><span> </span><a href="#local-6989586621679097873"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#circle%27"><span class="hs-identifier hs-var">circle'</span></a><span> </span><a href="#local-6989586621679097872"><span class="hs-identifier hs-var">cen</span></a><span> </span><a href="#local-6989586621679097874"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-1055"></a><span>
</span><a name="line-1056"></a><span class="hs-comment">{-|
    === Similar to drawCircleColor, but it can do more

    * draw two circles with different centers

    &gt;mapM_ (drawCircleColor' red 0.5) [Vertex3 0.1 0.2 0.3, Vertex3 0.2 0.3 04]
-}</span><span>
</span><a name="line-1063"></a><span class="hs-identifier">drawCircleColor'</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1064"></a><a name="drawCircleColor%27"><a href="AronGraphic.html#drawCircleColor%27"><span class="hs-identifier">drawCircleColor'</span></a></a><span> </span><a name="local-6989586621679097875"><a href="#local-6989586621679097875"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679097876"><a href="#local-6989586621679097876"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679097877"><a href="#local-6989586621679097877"><span class="hs-identifier">cen</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#drawPrimitive%27"><span class="hs-identifier hs-var">drawPrimitive'</span></a><span> </span><span class="hs-identifier hs-var">LineLoop</span><span> </span><a href="#local-6989586621679097875"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#circle%27"><span class="hs-identifier hs-var">circle'</span></a><span> </span><a href="#local-6989586621679097877"><span class="hs-identifier hs-var">cen</span></a><span> </span><a href="#local-6989586621679097876"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-1065"></a><span>
</span><a name="line-1066"></a><span class="hs-comment">{-|
    === Conic Parameter Equation
    gx &lt;http://localhost/html/indexThebeautyofTorus.html Conic&gt;
-}</span><span>
</span><a name="line-1070"></a><span class="hs-identifier">conic</span><span class="hs-glyph">::</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1071"></a><a name="conic"><a href="AronGraphic.html#conic"><span class="hs-identifier">conic</span></a></a><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679097887"><a href="#local-6989586621679097887"><span class="hs-identifier">r'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679097881"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679097884"><span class="hs-identifier hs-var">rd</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679097885"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097883"><span class="hs-identifier hs-var">d'</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679097885"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679097887"><span class="hs-identifier hs-var">r'</span></a><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">sin</span><span class="hs-special">(</span><a href="#local-6989586621679097882"><span class="hs-identifier hs-var">del</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679097886"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679097887"><span class="hs-identifier hs-var">r'</span></a><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">cos</span><span class="hs-special">(</span><a href="#local-6989586621679097882"><span class="hs-identifier hs-var">del</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679097886"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679097885"><a href="#local-6989586621679097885"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><a href="#local-6989586621679097879"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679097886"><a href="#local-6989586621679097886"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><a href="#local-6989586621679097878"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-1072"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-1073"></a><span>            </span><a name="local-6989586621679097878"><a href="#local-6989586621679097878"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">40</span><span>
</span><a name="line-1074"></a><span>            </span><a name="local-6989586621679097879"><a href="#local-6989586621679097879"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">20</span><span>
</span><a name="line-1075"></a><span>            </span><a name="local-6989586621679097880"><a href="#local-6989586621679097880"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0.1</span><span>
</span><a name="line-1076"></a><span>            </span><a name="local-6989586621679097881"><a href="#local-6989586621679097881"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0.05</span><span>
</span><a name="line-1077"></a><span>            </span><a name="local-6989586621679097882"><a href="#local-6989586621679097882"><span class="hs-identifier">del</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">2</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">pi</span><span class="hs-operator hs-var">/</span><a href="#local-6989586621679097878"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1078"></a><span>            </span><a name="local-6989586621679097883"><a href="#local-6989586621679097883"><span class="hs-identifier">d'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679097880"><span class="hs-identifier hs-var">h</span></a><span class="hs-operator hs-var">/</span><a href="#local-6989586621679097879"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-1079"></a><span>            </span><a name="local-6989586621679097884"><a href="#local-6989586621679097884"><span class="hs-identifier">rd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679097881"><span class="hs-identifier hs-var">r</span></a><span class="hs-operator hs-var">/</span><a href="#local-6989586621679097879"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-1080"></a><span>
</span><a name="line-1081"></a><span>
</span><a name="line-1082"></a><span>
</span><a name="line-1083"></a><span class="hs-comment">-- | determinant of two dimension matrix</span><span>
</span><a name="line-1084"></a><span class="hs-identifier">det2</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679094319"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679094319"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679094319"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1085"></a><a name="det2"><a href="AronGraphic.html#det2"><span class="hs-identifier">det2</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a name="local-6989586621679097888"><a href="#local-6989586621679097888"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679097889"><a href="#local-6989586621679097889"><span class="hs-identifier">b</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679097890"><a href="#local-6989586621679097890"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679097891"><a href="#local-6989586621679097891"><span class="hs-identifier">d</span></a></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679097888"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679097891"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679097889"><span class="hs-identifier hs-var">b</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679097890"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-1086"></a><span>
</span><a name="line-1087"></a><span>
</span><a name="line-1088"></a><span class="hs-comment">--- | Sat Dec 22 20:59:28 2018</span><span>
</span><a name="line-1089"></a><span class="hs-comment">--- |</span><span>
</span><a name="line-1090"></a><span class="hs-comment">--- | find the inverse of matrix in Rational number</span><span>
</span><a name="line-1091"></a><span class="hs-comment">--- | it is not much difference from the Integer code</span><span>
</span><a name="line-1092"></a><span class="hs-comment">--- | change division from (div n m) =&gt; (n / m)</span><span>
</span><a name="line-1093"></a><span class="hs-comment">--- |</span><span>
</span><a name="line-1094"></a><span class="hs-identifier">inverseR</span><span class="hs-glyph">::</span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Rational</span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Rational</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-1095"></a><a name="inverseR"><a href="AronGraphic.html#inverseR"><span class="hs-identifier">inverseR</span></a></a><span> </span><a name="local-6989586621679097892"><a href="#local-6989586621679097892"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679097896"><span class="hs-identifier hs-var">diag</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679097911"><span class="hs-identifier hs-var">mb'</span></a><span>
</span><a name="line-1096"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-1097"></a><span>            </span><a name="local-6989586621679097893"><a href="#local-6989586621679097893"><span class="hs-identifier">id</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#ident%27"><span class="hs-identifier hs-var">ident'</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679097892"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-1098"></a><span>            </span><span class="hs-comment">-- argumented matrix [m] ++ [id]</span><span>
</span><a name="line-1099"></a><span>            </span><a name="local-6989586621679097894"><a href="#local-6989586621679097894"><span class="hs-identifier">argm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">zipWith</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679097912"><a href="#local-6989586621679097912"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679097913"><a href="#local-6989586621679097913"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679097912"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679097913"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679097892"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679097893"><span class="hs-identifier hs-var">id</span></a><span>
</span><a name="line-1100"></a><span>            </span><span class="hs-comment">-- argm =</span><span>
</span><a name="line-1101"></a><span>            </span><span class="hs-comment">-- [[1 2 3 1 0 0]]</span><span>
</span><a name="line-1102"></a><span>            </span><span class="hs-comment">-- [[4 5 6 0 1 0]]</span><span>
</span><a name="line-1103"></a><span>            </span><span class="hs-comment">-- [[7 8 9 0 0 1]]</span><span>
</span><a name="line-1104"></a><span>            </span><a name="local-6989586621679097895"><a href="#local-6989586621679097895"><span class="hs-identifier">mt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#upperTri%27"><span class="hs-identifier hs-var">upperTri'</span></a><span> </span><a href="#local-6989586621679097894"><span class="hs-identifier hs-var">argm</span></a><span>
</span><a name="line-1105"></a><span>            </span><span class="hs-comment">-- mt =</span><span>
</span><a name="line-1106"></a><span>            </span><span class="hs-comment">-- [[1, 2, 3 x x x]]</span><span>
</span><a name="line-1107"></a><span>            </span><span class="hs-comment">-- [[   2, 2 x x x]]</span><span>
</span><a name="line-1108"></a><span>            </span><span class="hs-comment">-- [[      1 x x x]]</span><span>
</span><a name="line-1109"></a><span>            </span><span class="hs-comment">--</span><span>
</span><a name="line-1110"></a><span>            </span><span class="hs-comment">-- If diag[onal] == 0 then it is single matrix</span><span>
</span><a name="line-1111"></a><span>            </span><a name="local-6989586621679097896"><a href="#local-6989586621679097896"><span class="hs-identifier">diag</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl</span><span class="hs-special">(</span><span class="hs-operator hs-var">*</span><span class="hs-special">)</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679097914"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679097914"><a href="#local-6989586621679097914"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679097895"><span class="hs-identifier hs-var">mt</span></a><span class="hs-special">]</span><span>
</span><a name="line-1112"></a><span>            </span><a name="local-6989586621679097897"><a href="#local-6989586621679097897"><span class="hs-identifier">ar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">zipWith</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679097915"><a href="#local-6989586621679097915"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679097916"><a href="#local-6989586621679097916"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">replicate</span><span> </span><a href="#local-6989586621679097915"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679097916"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679097895"><span class="hs-identifier hs-var">mt</span></a><span>
</span><a name="line-1113"></a><span>            </span><span class="hs-comment">-- ar =</span><span>
</span><a name="line-1114"></a><span>            </span><span class="hs-comment">-- [[1 2 3 x x x]</span><span>
</span><a name="line-1115"></a><span>            </span><span class="hs-comment">--  [0 2 2 x x x]</span><span>
</span><a name="line-1116"></a><span>            </span><span class="hs-comment">--  [0 0 1 x x x]]</span><span>
</span><a name="line-1117"></a><span>            </span><a name="local-6989586621679097898"><a href="#local-6989586621679097898"><span class="hs-identifier">pm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679097917"><a href="#local-6989586621679097917"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="AronModule.html#partList"><span class="hs-identifier hs-var">partList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679097897"><span class="hs-identifier hs-var">ar</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679097917"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679097897"><span class="hs-identifier hs-var">ar</span></a><span>
</span><a name="line-1118"></a><span>            </span><span class="hs-comment">-- pm =</span><span>
</span><a name="line-1119"></a><span>            </span><span class="hs-comment">-- [[[1 2 3] [x x x]]</span><span>
</span><a name="line-1120"></a><span>            </span><span class="hs-comment">--  [[0 1 2] [x x x]]</span><span>
</span><a name="line-1121"></a><span>            </span><span class="hs-comment">--  [[0 0 1] [x x x]]]</span><span>
</span><a name="line-1122"></a><span>            </span><a name="local-6989586621679097899"><a href="#local-6989586621679097899"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679097918"><a href="#local-6989586621679097918"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679097918"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679097898"><span class="hs-identifier hs-var">pm</span></a><span>
</span><a name="line-1123"></a><span>            </span><a name="local-6989586621679097900"><a href="#local-6989586621679097900"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679097919"><a href="#local-6989586621679097919"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">last</span><span> </span><a href="#local-6989586621679097919"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679097898"><span class="hs-identifier hs-var">pm</span></a><span>
</span><a name="line-1124"></a><span>            </span><span class="hs-comment">-- m1 =</span><span>
</span><a name="line-1125"></a><span>            </span><span class="hs-comment">-- [[1 2 3]</span><span>
</span><a name="line-1126"></a><span>            </span><span class="hs-comment">--  [0 1 2]</span><span>
</span><a name="line-1127"></a><span>            </span><span class="hs-comment">--  [0 0 1]]</span><span>
</span><a name="line-1128"></a><span>            </span><span class="hs-comment">-- m2 =</span><span>
</span><a name="line-1129"></a><span>            </span><span class="hs-comment">-- [[x x x]</span><span>
</span><a name="line-1130"></a><span>            </span><span class="hs-comment">--  [x x x]</span><span>
</span><a name="line-1131"></a><span>            </span><span class="hs-comment">--  [x x x]]</span><span>
</span><a name="line-1132"></a><span>            </span><a name="local-6989586621679097901"><a href="#local-6989586621679097901"><span class="hs-identifier">m11</span></a></a><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679097920"><a href="#local-6989586621679097920"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679097920"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679097899"><span class="hs-identifier hs-var">m1</span></a><span>
</span><a name="line-1133"></a><span>            </span><span class="hs-comment">-- m11 =</span><span>
</span><a name="line-1134"></a><span>            </span><span class="hs-comment">-- [[3 2 1]</span><span>
</span><a name="line-1135"></a><span>            </span><span class="hs-comment">--  [2 1 0]</span><span>
</span><a name="line-1136"></a><span>            </span><span class="hs-comment">--  [1 0 0]]</span><span>
</span><a name="line-1137"></a><span>            </span><span class="hs-comment">-- [[1 0 0]</span><span>
</span><a name="line-1138"></a><span>            </span><span class="hs-comment">--  [2 1 0]</span><span>
</span><a name="line-1139"></a><span>            </span><span class="hs-comment">--  [3 2 1]]</span><span>
</span><a name="line-1140"></a><span>            </span><a name="local-6989586621679097902"><a href="#local-6989586621679097902"><span class="hs-identifier">m22</span></a></a><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679097921"><a href="#local-6989586621679097921"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679097921"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679097900"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1141"></a><span>            </span><span class="hs-comment">-- m22 =</span><span>
</span><a name="line-1142"></a><span>            </span><span class="hs-comment">-- [[x x x]</span><span>
</span><a name="line-1143"></a><span>            </span><span class="hs-comment">--  [x x x]</span><span>
</span><a name="line-1144"></a><span>            </span><span class="hs-comment">--  [x x x]]</span><span>
</span><a name="line-1145"></a><span>
</span><a name="line-1146"></a><span>            </span><a name="local-6989586621679097903"><a href="#local-6989586621679097903"><span class="hs-identifier">m3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">zipWith</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679097922"><a href="#local-6989586621679097922"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679097923"><a href="#local-6989586621679097923"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679097922"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679097923"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679097901"><span class="hs-identifier hs-var">m11</span></a><span> </span><a href="#local-6989586621679097902"><span class="hs-identifier hs-var">m22</span></a><span>
</span><a name="line-1147"></a><span>            </span><a name="local-6989586621679097904"><a href="#local-6989586621679097904"><span class="hs-identifier">m4</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#upperTri%27"><span class="hs-identifier hs-var">upperTri'</span></a><span> </span><a href="#local-6989586621679097903"><span class="hs-identifier hs-var">m3</span></a><span>
</span><a name="line-1148"></a><span>            </span><span class="hs-comment">--m4'= map(\r -&gt; map(\x -&gt; divI x   $ toInteger (head r))</span><span>
</span><a name="line-1149"></a><span>            </span><span class="hs-comment">-- Fri Dec 14 16:04:32 2018</span><span>
</span><a name="line-1150"></a><span>            </span><span class="hs-comment">-- remove the division here</span><span>
</span><a name="line-1151"></a><span>            </span><a name="local-6989586621679097905"><a href="#local-6989586621679097905"><span class="hs-identifier">m4'</span></a></a><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679097924"><a href="#local-6989586621679097924"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679097925"><a href="#local-6989586621679097925"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679097925"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679097924"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679097924"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679097904"><span class="hs-identifier hs-var">m4</span></a><span>
</span><a name="line-1152"></a><span>            </span><span class="hs-comment">-- Not full inverse matrix here</span><span>
</span><a name="line-1153"></a><span>            </span><a name="local-6989586621679097906"><a href="#local-6989586621679097906"><span class="hs-identifier">mm'</span></a></a><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">zipWith</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679097926"><a href="#local-6989586621679097926"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679097927"><a href="#local-6989586621679097927"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">replicate</span><span> </span><a href="#local-6989586621679097926"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679097927"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679097905"><span class="hs-identifier hs-var">m4'</span></a><span>
</span><a name="line-1154"></a><span>            </span><a name="local-6989586621679097907"><a href="#local-6989586621679097907"><span class="hs-identifier">mm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679097928"><a href="#local-6989586621679097928"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="AronModule.html#partList"><span class="hs-identifier hs-var">partList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679097906"><span class="hs-identifier hs-var">mm'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679097928"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679097906"><span class="hs-identifier hs-var">mm'</span></a><span>
</span><a name="line-1155"></a><span>            </span><a name="local-6989586621679097908"><a href="#local-6989586621679097908"><span class="hs-identifier">m1'</span></a></a><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679097929"><a href="#local-6989586621679097929"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679097929"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679097907"><span class="hs-identifier hs-var">mm</span></a><span>
</span><a name="line-1156"></a><span>            </span><a name="local-6989586621679097909"><a href="#local-6989586621679097909"><span class="hs-identifier">m2'</span></a></a><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679097930"><a href="#local-6989586621679097930"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">last</span><span> </span><a href="#local-6989586621679097930"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679097907"><span class="hs-identifier hs-var">mm</span></a><span>
</span><a name="line-1157"></a><span>            </span><a name="local-6989586621679097910"><a href="#local-6989586621679097910"><span class="hs-identifier">ma'</span></a></a><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679097931"><a href="#local-6989586621679097931"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679097931"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679097908"><span class="hs-identifier hs-var">m1'</span></a><span>
</span><a name="line-1158"></a><span>            </span><a name="local-6989586621679097911"><a href="#local-6989586621679097911"><span class="hs-identifier">mb'</span></a></a><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679097932"><a href="#local-6989586621679097932"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679097932"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679097909"><span class="hs-identifier hs-var">m2'</span></a><span>
</span><a name="line-1159"></a><span>
</span><a name="line-1160"></a><span>
</span><a name="line-1161"></a><span>
</span><a name="line-1162"></a><span>
</span><a name="line-1163"></a><span>
</span><a name="line-1164"></a><span>
</span><a name="line-1165"></a><span>
</span><a name="line-1166"></a><span class="hs-comment">{-|
  === Inverse of two dimension matrix
  &lt;http://localhost/pdf/inverse_matrix2.pdf Inverse_matrix_determinant&gt;

    \[
        \begin{equation}
        \begin{aligned}
        A &amp;= \begin{bmatrix}
            a &amp; b \\
            c &amp; d \\
            \end{bmatrix} \\
        A^{ -1} &amp;= \frac{1}{ \det A }
                \begin{bmatrix}
                 d &amp; -b \\
                 -c &amp; a \\
                 \end{bmatrix}
        \end{aligned}
        \end{equation}
    \]
    * inverse should be used in general.

    * Or 'isInver' should be used for large matrix because 'isInver' is implemented
      in &lt;http://localhost/pdf/gram_schmidt.pdf QR_Decompoisition&gt;

    @
    isInver::(Fractional a, Ord a)=&gt; [[a]] -&gt; Bool
    isInver m = if len (filter(&lt; 0.0001) cx) &gt; 0 then False else True
    @

    * Following function is implemented in Gaussian Elimination

    * There is some Integer overflow issue, it only works for small matrix, e.g. 10 by 10

    @
    isInvertible::[[Integer]]-&gt;Bool
    @
-}</span><span>
</span><a name="line-1203"></a><span class="hs-identifier">inv2</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679094318"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679094318"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679094318"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-1204"></a><a name="inv2"><a href="AronGraphic.html#inv2"><span class="hs-identifier">inv2</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a name="local-6989586621679097933"><a href="#local-6989586621679097933"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679097934"><a href="#local-6989586621679097934"><span class="hs-identifier">b</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679097935"><a href="#local-6989586621679097935"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679097936"><a href="#local-6989586621679097936"><span class="hs-identifier">d</span></a></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span class="hs-operator hs-var">/</span><a href="AronGraphic.html#det2"><span class="hs-identifier hs-var">det2</span></a><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679097933"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679097934"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679097935"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679097936"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679097937"><span class="hs-operator hs-var">*:</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679097936"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679097934"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679097935"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679097933"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-1205"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1206"></a><span>        </span><span class="hs-comment">-- scalar multiply 2x2 matrix</span><span>
</span><a name="line-1207"></a><span>        </span><span class="hs-special">(</span><span class="hs-operator">*:</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679097939"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><a href="#local-6989586621679097939"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679097939"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679097939"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-1208"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679097937"><a href="#local-6989586621679097937"><span class="hs-operator">*:</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679097940"><a href="#local-6989586621679097940"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679097941"><a href="#local-6989586621679097941"><span class="hs-identifier">cx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679097940"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679097941"><span class="hs-identifier hs-var">cx</span></a><span>
</span><a name="line-1209"></a><span>        </span><a name="local-6989586621679097938"><a href="#local-6989586621679097938"><span class="hs-identifier">dt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#det2"><span class="hs-identifier hs-var">det2</span></a><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679097933"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679097934"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679097935"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679097936"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1210"></a><span>
</span><a name="line-1211"></a><span class="hs-keyword">data</span><span> </span><a name="SegColinear"><a href="AronGraphic.html#SegColinear"><span class="hs-identifier">SegColinear</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Colinear3"><a href="AronGraphic.html#Colinear3"><span class="hs-identifier">Colinear3</span></a></a><span> </span><span class="hs-comment">-- ^ If three pts are colinear =&gt; Colinear3</span><span>
</span><a name="line-1212"></a><span>                   </span><span class="hs-glyph">|</span><span> </span><a name="Colinear4"><a href="AronGraphic.html#Colinear4"><span class="hs-identifier">Colinear4</span></a></a><span> </span><span class="hs-comment">-- ^ If four pts are colinear =&gt; Colinear4</span><span>
</span><a name="line-1213"></a><span>                   </span><span class="hs-glyph">|</span><span> </span><a name="None"><a href="AronGraphic.html#None"><span class="hs-identifier">None</span></a></a><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-1214"></a><span class="hs-comment">{-|
    === If four points are colinear then return 'Colinear4'
    === If only three points are colinear then return 'Colinear3'
    === Else return 'None'

    &gt;data SegColinear = Colinear3 -- ^ If three pts are colinear =&gt; Colinear3
    &gt;                   | Colinear4 -- ^ If four pts are colinear =&gt; Colinear4
    &gt;                   | None deriving (Eq, Show) -- ^ else =&gt; None

    The function uses 'isColinear'
-}</span><span>
</span><a name="line-1225"></a><span class="hs-identifier">fourPtColinear</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="AronGraphic.html#SegColinear"><span class="hs-identifier hs-type">SegColinear</span></a><span>
</span><a name="line-1226"></a><a name="fourPtColinear"><a href="AronGraphic.html#fourPtColinear"><span class="hs-identifier">fourPtColinear</span></a></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621679097942"><a href="#local-6989586621679097942"><span class="hs-identifier">p0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679097943"><a href="#local-6989586621679097943"><span class="hs-identifier">p1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679097944"><a href="#local-6989586621679097944"><span class="hs-identifier">q0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679097945"><a href="#local-6989586621679097945"><span class="hs-identifier">q1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097946"><span class="hs-identifier hs-var">is0</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679097947"><span class="hs-identifier hs-var">is1</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="AronGraphic.html#Colinear4"><span class="hs-identifier hs-var">Colinear4</span></a><span> </span><span class="hs-keyword">else</span><span>
</span><a name="line-1227"></a><span>                                            </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097946"><span class="hs-identifier hs-var">is0</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679097947"><span class="hs-identifier hs-var">is1</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097948"><span class="hs-identifier hs-var">is0'</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679097949"><span class="hs-identifier hs-var">is1'</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="AronGraphic.html#Colinear3"><span class="hs-identifier hs-var">Colinear3</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="AronGraphic.html#None"><span class="hs-identifier hs-var">None</span></a><span>
</span><a name="line-1228"></a><span>           </span><span class="hs-keyword">where</span><span>
</span><a name="line-1229"></a><span>                </span><a name="local-6989586621679097946"><a href="#local-6989586621679097946"><span class="hs-identifier">is0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#isColinear"><span class="hs-identifier hs-var">isColinear</span></a><span> </span><a href="#local-6989586621679097942"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679097944"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679097945"><span class="hs-identifier hs-var">q1</span></a><span>
</span><a name="line-1230"></a><span>                </span><a name="local-6989586621679097947"><a href="#local-6989586621679097947"><span class="hs-identifier">is1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#isColinear"><span class="hs-identifier hs-var">isColinear</span></a><span> </span><a href="#local-6989586621679097943"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679097944"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679097945"><span class="hs-identifier hs-var">q1</span></a><span>
</span><a name="line-1231"></a><span>                </span><a name="local-6989586621679097948"><a href="#local-6989586621679097948"><span class="hs-identifier">is0'</span></a></a><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#isColinear"><span class="hs-identifier hs-var">isColinear</span></a><span> </span><a href="#local-6989586621679097944"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679097942"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679097943"><span class="hs-identifier hs-var">p1</span></a><span>
</span><a name="line-1232"></a><span>                </span><a name="local-6989586621679097949"><a href="#local-6989586621679097949"><span class="hs-identifier">is1'</span></a></a><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#isColinear"><span class="hs-identifier hs-var">isColinear</span></a><span> </span><a href="#local-6989586621679097945"><span class="hs-identifier hs-var">q1</span></a><span> </span><a href="#local-6989586621679097942"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679097943"><span class="hs-identifier hs-var">p1</span></a><span>
</span><a name="line-1233"></a><span>
</span><a name="line-1234"></a><span>
</span><a name="line-1235"></a><span class="hs-comment">{-|
    === Find the intersection of two lines, also see 'intersectSeg'
    ==== Assume that two endpoints of each segment are not overlapped.(segment has non-zero length)

    __NOTE__ This function is ONLY for two dimensions

    __Line__ extends infinitly in both direction


    * If both line intersect at one pt =&gt; return the pt
        1. Intersection can be on a segments or NOT on a segment 
    * If four points are colinear: return Nothing, see 'fourPtColinear'

    &gt;let p0 = Vertex3 0 0 0
    &gt;let p1 = Vertex3 1 0 0
    &gt;let q0 = Vertex3 1 0 0
    &gt;let q1 = Vertex3 2 0 0
    &gt;intersectLine p0 p1 q0 q1
    &gt;Nothing

    * two dimensions determinant is used here

    * The Intersection of two line is __NOT__ necessary in their segments
    * If two lines are __parallel__ or __overlapped__ then return Nothing
    * Else return the intersection and \( s, t \)

    Given four pts: \(p_0, p_1\) and \(q_0, q_1\)
    \[
        \begin{aligned}
        v_0 &amp;= p_1 - p_0 \\
        v_1 &amp;= q_1 - q_0 \\
        A &amp;= \begin{bmatrix}
             v_0 &amp; v_1
             \end{bmatrix} \\
        \det A &amp;= 0  \quad \text{they are linearly dependent }
        \end{aligned}
    \]

    @
    data Seg a = Seg a a
    fun::Seg GLflat -&gt; Seg GLfloat -&gt; Maybe(Vertex3 GLfloat, [[GLfloat]])
    fun (Seg (Vertex3 x0 y0 z0) (Vertex3 x1 y1 z1)) = Nothing
    @

    &lt;http://localhost/pdf/intersectionLine.pdf intersect_line&gt;

    @
    intersectLine p0 p1 q0 q1
    (Just ((Vertex3 2.0 2.0 0), [[2.0],[2.0]]))= intersectLine
                                                (Vertex3 0 0 0)
                                                (Vertex3 1 1 0)
                                                (Vertex3 2 0 0)
                                                (Vertex3 2 1 0)
    @
-}</span><span>
</span><a name="line-1290"></a><span class="hs-identifier">intersectLine</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1291"></a><span>               </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1292"></a><span>               </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1293"></a><span>               </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1294"></a><span>               </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1295"></a><a name="intersectLine"><a href="AronGraphic.html#intersectLine"><span class="hs-identifier">intersectLine</span></a></a><span> </span><a name="local-6989586621679097950"><a href="#local-6989586621679097950"><span class="hs-identifier">p0</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679097951"><a href="#local-6989586621679097951"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679097952"><a href="#local-6989586621679097952"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679097953"><a href="#local-6989586621679097953"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1296"></a><span>              </span><a name="local-6989586621679097954"><a href="#local-6989586621679097954"><span class="hs-identifier">p1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679097955"><a href="#local-6989586621679097955"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679097956"><a href="#local-6989586621679097956"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679097957"><a href="#local-6989586621679097957"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1297"></a><span>              </span><a name="local-6989586621679097958"><a href="#local-6989586621679097958"><span class="hs-identifier">q0</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679097959"><a href="#local-6989586621679097959"><span class="hs-identifier">a0</span></a></a><span> </span><a name="local-6989586621679097960"><a href="#local-6989586621679097960"><span class="hs-identifier">b0</span></a></a><span> </span><a name="local-6989586621679097961"><a href="#local-6989586621679097961"><span class="hs-identifier">c0</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1298"></a><span>              </span><a name="local-6989586621679097962"><a href="#local-6989586621679097962"><span class="hs-identifier">q1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679097963"><a href="#local-6989586621679097963"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679097964"><a href="#local-6989586621679097964"><span class="hs-identifier">b1</span></a></a><span> </span><a name="local-6989586621679097965"><a href="#local-6989586621679097965"><span class="hs-identifier">c1</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1299"></a><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679097969"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679097966"><span class="hs-identifier hs-var">c4</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="AronGraphic.html#Colinear4"><span class="hs-identifier hs-var">Colinear4</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097977"><span class="hs-identifier hs-var">pt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679097975"><span class="hs-identifier hs-var">st</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1300"></a><span>              </span><span class="hs-keyword">where</span><span>
</span><a name="line-1301"></a><span class="hs-comment">--                is0 = isColinear p0 q0 q1</span><span>
</span><a name="line-1302"></a><span class="hs-comment">--                is1 = isColinear p1 q0 q1</span><span>
</span><a name="line-1303"></a><span class="hs-comment">--</span><span>
</span><a name="line-1304"></a><span>                </span><span class="hs-comment">-- if c4 == Colinear4 then four pts are colinear</span><span>
</span><a name="line-1305"></a><span>                </span><a name="local-6989586621679097966"><a href="#local-6989586621679097966"><span class="hs-identifier">c4</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#fourPtColinear"><span class="hs-identifier hs-var">fourPtColinear</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097950"><span class="hs-identifier hs-var">p0</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679097954"><span class="hs-identifier hs-var">p1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097958"><span class="hs-identifier hs-var">q0</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679097962"><span class="hs-identifier hs-var">q1</span></a><span class="hs-special">)</span><span>
</span><a name="line-1306"></a><span>                </span><a name="local-6989586621679097967"><a href="#local-6989586621679097967"><span class="hs-identifier">w1</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679097980"><span class="hs-identifier hs-var">v2a</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679097954"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679097950"><span class="hs-identifier hs-var">p0</span></a><span>  </span><span class="hs-comment">-- [[1, 2]]</span><span>
</span><a name="line-1307"></a><span>                </span><a name="local-6989586621679097968"><a href="#local-6989586621679097968"><span class="hs-identifier">w2</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679097980"><span class="hs-identifier hs-var">v2a</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679097962"><span class="hs-identifier hs-var">q1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679097958"><span class="hs-identifier hs-var">q0</span></a><span>  </span><span class="hs-comment">-- [[4, 5]]</span><span>
</span><a name="line-1308"></a><span>                </span><span class="hs-comment">-- if d == 0 then two lines are parallel</span><span>
</span><a name="line-1309"></a><span>                </span><a name="local-6989586621679097969"><a href="#local-6989586621679097969"><span class="hs-identifier">d</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#det2"><span class="hs-identifier hs-var">det2</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679097967"><span class="hs-identifier hs-var">w1</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679097968"><span class="hs-identifier hs-var">w2</span></a><span> </span><span class="hs-comment">-- det2 [[1, 2], [4, 5]]</span><span>
</span><a name="line-1310"></a><span>                </span><a name="local-6989586621679097970"><a href="#local-6989586621679097970"><span class="hs-identifier">v01</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679097954"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679097950"><span class="hs-identifier hs-var">p0</span></a><span> </span><span class="hs-comment">-- p&#8321; - p&#8320;  f(t) = p&#8320; + s(p&#8321; - p&#8320;)</span><span>
</span><a name="line-1311"></a><span>                </span><a name="local-6989586621679097971"><a href="#local-6989586621679097971"><span class="hs-identifier">u01</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679097962"><span class="hs-identifier hs-var">q1</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679097958"><span class="hs-identifier hs-var">q0</span></a><span> </span><span class="hs-comment">-- q&#8321; - q&#8320;  f(s) = q&#8320; + t(q&#8321; - q&#8320;)</span><span>
</span><a name="line-1312"></a><span>                </span><a name="local-6989586621679097972"><a href="#local-6989586621679097972"><span class="hs-identifier">ma</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679097978"><span class="hs-identifier hs-var">ne</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097955"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679097951"><span class="hs-identifier hs-var">x0</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097963"><span class="hs-identifier hs-var">a1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679097959"><span class="hs-identifier hs-var">a0</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>  </span><span class="hs-comment">-- [s]</span><span>
</span><a name="line-1313"></a><span>                      </span><span class="hs-special">[</span><a href="#local-6989586621679097978"><span class="hs-identifier hs-var">ne</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097956"><span class="hs-identifier hs-var">y1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679097952"><span class="hs-identifier hs-var">y0</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097964"><span class="hs-identifier hs-var">b1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679097960"><span class="hs-identifier hs-var">b0</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- [t]</span><span>
</span><a name="line-1314"></a><span>                </span><a name="local-6989586621679097973"><a href="#local-6989586621679097973"><span class="hs-identifier">ivm</span></a></a><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#inv2"><span class="hs-identifier hs-var">inv2</span></a><span> </span><a href="#local-6989586621679097972"><span class="hs-identifier hs-var">ma</span></a><span>
</span><a name="line-1315"></a><span>                </span><a name="local-6989586621679097974"><a href="#local-6989586621679097974"><span class="hs-identifier">v</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679097951"><span class="hs-identifier hs-var">x0</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679097959"><span class="hs-identifier hs-var">a0</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- p&#8320; - q&#8320;</span><span>
</span><a name="line-1316"></a><span>                      </span><span class="hs-special">[</span><a href="#local-6989586621679097952"><span class="hs-identifier hs-var">y0</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679097960"><span class="hs-identifier hs-var">b0</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-1317"></a><span>                </span><span class="hs-comment">-- solve s and t</span><span>
</span><a name="line-1318"></a><span>                </span><span class="hs-comment">-- [s]</span><span>
</span><a name="line-1319"></a><span>                </span><span class="hs-comment">-- [t]</span><span>
</span><a name="line-1320"></a><span>                </span><a name="local-6989586621679097975"><a href="#local-6989586621679097975"><span class="hs-identifier">st</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#multiMat"><span class="hs-identifier hs-var">multiMat</span></a><span> </span><a href="#local-6989586621679097973"><span class="hs-identifier hs-var">ivm</span></a><span> </span><a href="#local-6989586621679097974"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1321"></a><span>                </span><span class="hs-comment">-- |  st = ivm *. v</span><span>
</span><a name="line-1322"></a><span>                </span><a name="local-6989586621679097976"><a href="#local-6989586621679097976"><span class="hs-identifier">s</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">head</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679097975"><span class="hs-identifier hs-var">st</span></a><span> </span><span class="hs-comment">-- st = [[s],[t]]</span><span>
</span><a name="line-1323"></a><span>                </span><span class="hs-comment">-- t  = (last . last) st</span><span>
</span><a name="line-1324"></a><span>                </span><a name="local-6989586621679097977"><a href="#local-6989586621679097977"><span class="hs-identifier">pt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679097950"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="AronGraphic.html#%2B%3A"><span class="hs-operator hs-var">+:</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097976"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="AronGraphic.html#%2A%3A"><span class="hs-operator hs-var">*:</span></a><span> </span><a href="#local-6989586621679097970"><span class="hs-identifier hs-var">v01</span></a><span class="hs-special">)</span><span>
</span><a name="line-1325"></a><span>                </span><a name="local-6989586621679097978"><a href="#local-6989586621679097978"><span class="hs-identifier">ne</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">negate</span><span>
</span><a name="line-1326"></a><span>                </span><span class="hs-special">(</span><a name="local-6989586621679097979"><a href="#local-6989586621679097979"><span class="hs-operator">*.</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a name="local-6989586621679097981"><a href="#local-6989586621679097981"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679097982"><a href="#local-6989586621679097982"><span class="hs-identifier">b</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679097983"><a href="#local-6989586621679097983"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679097984"><a href="#local-6989586621679097984"><span class="hs-identifier">d</span></a></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a name="local-6989586621679097985"><a href="#local-6989586621679097985"><span class="hs-identifier">x</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679097986"><a href="#local-6989586621679097986"><span class="hs-identifier">y</span></a></a><span class="hs-special">]</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679097981"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679097985"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679097982"><span class="hs-identifier hs-var">b</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679097986"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679097983"><span class="hs-identifier hs-var">c</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679097985"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679097984"><span class="hs-identifier hs-var">d</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679097986"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-1327"></a><span>
</span><a name="line-1328"></a><span>                </span><a name="local-6989586621679097980"><a href="#local-6989586621679097980"><span class="hs-identifier">v2a</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679097987"><a href="#local-6989586621679097987"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679097988"><a href="#local-6989586621679097988"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679097989"><a href="#local-6989586621679097989"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679097987"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679097988"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-1329"></a><span>
</span><a name="line-1330"></a><span class="hs-comment">{-| 
    === If two line parallel or four pts colinear =&gt; return Nothing
    === Else there is intersection pt, pt maybe on on segment or NOT on segment

    Sun Feb 17 15:32:59 2019 
    This function should replace 'intersectLine'
-}</span><span>
</span><a name="line-1337"></a><span class="hs-identifier">intersectLine2</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1338"></a><span>                </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1339"></a><span>                </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1340"></a><span>                </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1341"></a><span>                </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1342"></a><a name="intersectLine2"><a href="AronGraphic.html#intersectLine2"><span class="hs-identifier">intersectLine2</span></a></a><span> </span><a name="local-6989586621679097990"><a href="#local-6989586621679097990"><span class="hs-identifier">p0</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679097991"><a href="#local-6989586621679097991"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679097992"><a href="#local-6989586621679097992"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679097993"><a href="#local-6989586621679097993"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1343"></a><span>               </span><a name="local-6989586621679097994"><a href="#local-6989586621679097994"><span class="hs-identifier">p1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679097995"><a href="#local-6989586621679097995"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679097996"><a href="#local-6989586621679097996"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679097997"><a href="#local-6989586621679097997"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1344"></a><span>               </span><a name="local-6989586621679097998"><a href="#local-6989586621679097998"><span class="hs-identifier">q0</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679097999"><a href="#local-6989586621679097999"><span class="hs-identifier">a0</span></a></a><span> </span><a name="local-6989586621679098000"><a href="#local-6989586621679098000"><span class="hs-identifier">b0</span></a></a><span> </span><a name="local-6989586621679098001"><a href="#local-6989586621679098001"><span class="hs-identifier">c0</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1345"></a><span>               </span><a name="local-6989586621679098002"><a href="#local-6989586621679098002"><span class="hs-identifier">q1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679098003"><a href="#local-6989586621679098003"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679098004"><a href="#local-6989586621679098004"><span class="hs-identifier">b1</span></a></a><span> </span><a name="local-6989586621679098005"><a href="#local-6989586621679098005"><span class="hs-identifier">c1</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1346"></a><span>                 </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679098009"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679098006"><span class="hs-identifier hs-var">c4</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="AronGraphic.html#Colinear4"><span class="hs-identifier hs-var">Colinear4</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1347"></a><span>                 </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679098015"><span class="hs-identifier hs-var">overLappedMaybe</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098015"><span class="hs-identifier hs-var">overLappedMaybe</span></a><span>
</span><a name="line-1348"></a><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098019"><span class="hs-identifier hs-var">pt</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098017"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679098018"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1349"></a><span class="hs-comment">--                 | otherwise                  = (Just (pt, st)) </span><span>
</span><a name="line-1350"></a><span>                    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1351"></a><span>                        </span><span class="hs-comment">-- if c4 == Colinear4 then four pts are colinear</span><span>
</span><a name="line-1352"></a><span>                        </span><a name="local-6989586621679098006"><a href="#local-6989586621679098006"><span class="hs-identifier">c4</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#fourPtColinear"><span class="hs-identifier hs-var">fourPtColinear</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097990"><span class="hs-identifier hs-var">p0</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679097994"><span class="hs-identifier hs-var">p1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097998"><span class="hs-identifier hs-var">q0</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679098002"><span class="hs-identifier hs-var">q1</span></a><span class="hs-special">)</span><span>
</span><a name="line-1353"></a><span>                        </span><a name="local-6989586621679098007"><a href="#local-6989586621679098007"><span class="hs-identifier">w1</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098022"><span class="hs-identifier hs-var">v2a</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679097994"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679097990"><span class="hs-identifier hs-var">p0</span></a><span>  </span><span class="hs-comment">-- [[1, 2]]</span><span>
</span><a name="line-1354"></a><span>                        </span><a name="local-6989586621679098008"><a href="#local-6989586621679098008"><span class="hs-identifier">w2</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098022"><span class="hs-identifier hs-var">v2a</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679098002"><span class="hs-identifier hs-var">q1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679097998"><span class="hs-identifier hs-var">q0</span></a><span>  </span><span class="hs-comment">-- [[4, 5]]</span><span>
</span><a name="line-1355"></a><span>                        </span><span class="hs-comment">-- if d == 0 then two lines are parallel</span><span>
</span><a name="line-1356"></a><span>                        </span><a name="local-6989586621679098009"><a href="#local-6989586621679098009"><span class="hs-identifier">d</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#det2"><span class="hs-identifier hs-var">det2</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679098007"><span class="hs-identifier hs-var">w1</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679098008"><span class="hs-identifier hs-var">w2</span></a><span> </span><span class="hs-comment">-- det2 [[1, 2], [4, 5]]</span><span>
</span><a name="line-1357"></a><span>                        </span><a name="local-6989586621679098010"><a href="#local-6989586621679098010"><span class="hs-identifier">v01</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679097994"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679097990"><span class="hs-identifier hs-var">p0</span></a><span> </span><span class="hs-comment">-- p&#8321; - p&#8320;  f(s) = p&#8320; + s(p&#8321; - p&#8320;)</span><span>
</span><a name="line-1358"></a><span>                        </span><a name="local-6989586621679098011"><a href="#local-6989586621679098011"><span class="hs-identifier">u01</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098002"><span class="hs-identifier hs-var">q1</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679097998"><span class="hs-identifier hs-var">q0</span></a><span> </span><span class="hs-comment">-- q&#8321; - q&#8320;  f(t) = q&#8320; + t(q&#8321; - q&#8320;)</span><span>
</span><a name="line-1359"></a><span>                        </span><a name="local-6989586621679098012"><a href="#local-6989586621679098012"><span class="hs-identifier">ma</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679098020"><span class="hs-identifier hs-var">ne</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097995"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679097991"><span class="hs-identifier hs-var">x0</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098003"><span class="hs-identifier hs-var">a1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679097999"><span class="hs-identifier hs-var">a0</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>  </span><span class="hs-comment">-- [s]</span><span>
</span><a name="line-1360"></a><span>                              </span><span class="hs-special">[</span><a href="#local-6989586621679098020"><span class="hs-identifier hs-var">ne</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097996"><span class="hs-identifier hs-var">y1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679097992"><span class="hs-identifier hs-var">y0</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098004"><span class="hs-identifier hs-var">b1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679098000"><span class="hs-identifier hs-var">b0</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- [t]</span><span>
</span><a name="line-1361"></a><span>                        </span><a name="local-6989586621679098013"><a href="#local-6989586621679098013"><span class="hs-identifier">ivm</span></a></a><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#inv2"><span class="hs-identifier hs-var">inv2</span></a><span> </span><a href="#local-6989586621679098012"><span class="hs-identifier hs-var">ma</span></a><span>
</span><a name="line-1362"></a><span>                        </span><a name="local-6989586621679098014"><a href="#local-6989586621679098014"><span class="hs-identifier">v</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679097991"><span class="hs-identifier hs-var">x0</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679097999"><span class="hs-identifier hs-var">a0</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- p&#8320; - q&#8320;</span><span>
</span><a name="line-1363"></a><span>                              </span><span class="hs-special">[</span><a href="#local-6989586621679097992"><span class="hs-identifier hs-var">y0</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679098000"><span class="hs-identifier hs-var">b0</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-1364"></a><span>
</span><a name="line-1365"></a><span>                        </span><span class="hs-comment">-- If two segments are overlapped ONE endPt</span><span>
</span><a name="line-1366"></a><span>                        </span><a name="local-6989586621679098015"><a href="#local-6989586621679098015"><span class="hs-identifier">overLappedMaybe</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#onePtOverlappedSeg"><span class="hs-identifier hs-var">onePtOverlappedSeg</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097990"><span class="hs-identifier hs-var">p0</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679097994"><span class="hs-identifier hs-var">p1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097998"><span class="hs-identifier hs-var">q0</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679098002"><span class="hs-identifier hs-var">q1</span></a><span class="hs-special">)</span><span>
</span><a name="line-1367"></a><span>                        </span><span class="hs-comment">-- solve s and t</span><span>
</span><a name="line-1368"></a><span>                        </span><span class="hs-comment">-- [s]</span><span>
</span><a name="line-1369"></a><span>                        </span><span class="hs-comment">-- [t]</span><span>
</span><a name="line-1370"></a><span>                        </span><a name="local-6989586621679098016"><a href="#local-6989586621679098016"><span class="hs-identifier">st</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#multiMat"><span class="hs-identifier hs-var">multiMat</span></a><span> </span><a href="#local-6989586621679098013"><span class="hs-identifier hs-var">ivm</span></a><span> </span><a href="#local-6989586621679098014"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1371"></a><span>                        </span><span class="hs-comment">-- |  st = ivm *. v</span><span>
</span><a name="line-1372"></a><span>                        </span><a name="local-6989586621679098017"><a href="#local-6989586621679098017"><span class="hs-identifier">s</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">head</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098016"><span class="hs-identifier hs-var">st</span></a><span> </span><span class="hs-comment">-- st = [[s],[t]]</span><span>
</span><a name="line-1373"></a><span>                        </span><a name="local-6989586621679098018"><a href="#local-6989586621679098018"><span class="hs-identifier">t</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">last</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">last</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098016"><span class="hs-identifier hs-var">st</span></a><span> </span><span class="hs-comment">-- st = [[s],[t]]</span><span>
</span><a name="line-1374"></a><span>                        </span><a name="local-6989586621679098019"><a href="#local-6989586621679098019"><span class="hs-identifier">pt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679097990"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="AronGraphic.html#%2B%3A"><span class="hs-operator hs-var">+:</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098017"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="AronGraphic.html#%2A%3A"><span class="hs-operator hs-var">*:</span></a><span> </span><a href="#local-6989586621679098010"><span class="hs-identifier hs-var">v01</span></a><span class="hs-special">)</span><span>
</span><a name="line-1375"></a><span>                        </span><a name="local-6989586621679098020"><a href="#local-6989586621679098020"><span class="hs-identifier">ne</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">negate</span><span>
</span><a name="line-1376"></a><span>                        </span><span class="hs-special">(</span><a name="local-6989586621679098021"><a href="#local-6989586621679098021"><span class="hs-operator">*.</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a name="local-6989586621679098023"><a href="#local-6989586621679098023"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679098024"><a href="#local-6989586621679098024"><span class="hs-identifier">b</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679098025"><a href="#local-6989586621679098025"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679098026"><a href="#local-6989586621679098026"><span class="hs-identifier">d</span></a></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a name="local-6989586621679098027"><a href="#local-6989586621679098027"><span class="hs-identifier">x</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679098028"><a href="#local-6989586621679098028"><span class="hs-identifier">y</span></a></a><span class="hs-special">]</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679098023"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679098027"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679098024"><span class="hs-identifier hs-var">b</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679098028"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679098025"><span class="hs-identifier hs-var">c</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679098027"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679098026"><span class="hs-identifier hs-var">d</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679098028"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-1377"></a><span>
</span><a name="line-1378"></a><span>                        </span><a name="local-6989586621679098022"><a href="#local-6989586621679098022"><span class="hs-identifier">v2a</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679098029"><a href="#local-6989586621679098029"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679098030"><a href="#local-6989586621679098030"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679098031"><a href="#local-6989586621679098031"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679098029"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679098030"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-1379"></a><span>
</span><a name="line-1380"></a><span>
</span><a name="line-1381"></a><span class="hs-comment">{-| 
    === Given two segments: \( (p_0, p_1), (q_0, q_1) \), find the overlapped endPt

    == Precondition: Four pts are NOT colinear \( \Rightarrow \) __any three pts__ are NOT colinear

    If two segments are overlapped at one endPt, return Maybe(Vertex3 GLfloat, GLfloat s, GLfloat t)
    else return Nothing

    == Four cases
    1. \( p_0 = q_0 \)
    2. \( p_0 = q_1 \)
    3. \( p_1 = q_0 \)
    4. \( p_1 = q_1 \)

    &lt;http://localhost/html/indexConvexHullAlgorithm.html#onept_overlapped_segment onept_overlapped_segment&gt;

-}</span><span>
</span><a name="line-1398"></a><span class="hs-identifier">onePtOverlappedSeg</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1399"></a><span>                    </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1400"></a><span>                    </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1401"></a><a name="onePtOverlappedSeg"><a href="AronGraphic.html#onePtOverlappedSeg"><span class="hs-identifier">onePtOverlappedSeg</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679098032"><a href="#local-6989586621679098032"><span class="hs-identifier">p0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679098033"><a href="#local-6989586621679098033"><span class="hs-identifier">p1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679098034"><a href="#local-6989586621679098034"><span class="hs-identifier">q0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679098035"><a href="#local-6989586621679098035"><span class="hs-identifier">q1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679098032"><span class="hs-identifier hs-var">p0</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679098034"><span class="hs-identifier hs-var">q0</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098032"><span class="hs-identifier hs-var">p0</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">0.0</span><span class="hs-special">,</span><span> </span><span class="hs-number">0.0</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- (Vertex3, s, t) </span><span>
</span><a name="line-1402"></a><span>                                     </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679098032"><span class="hs-identifier hs-var">p0</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679098035"><span class="hs-identifier hs-var">q1</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098032"><span class="hs-identifier hs-var">p0</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">0.0</span><span class="hs-special">,</span><span> </span><span class="hs-number">1.0</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- (Vertex3, s, t) </span><span>
</span><a name="line-1403"></a><span>                                     </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679098033"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679098034"><span class="hs-identifier hs-var">q0</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098033"><span class="hs-identifier hs-var">p1</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">1.0</span><span class="hs-special">,</span><span> </span><span class="hs-number">0.0</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- (Vertex3, s, t) </span><span>
</span><a name="line-1404"></a><span>                                     </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679098033"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679098035"><span class="hs-identifier hs-var">q1</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098033"><span class="hs-identifier hs-var">p1</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">1.0</span><span class="hs-special">,</span><span> </span><span class="hs-number">1.0</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- (Vertex3, s, t) </span><span>
</span><a name="line-1405"></a><span>                                     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1406"></a><span>
</span><a name="line-1407"></a><span class="hs-comment">-- | Four Vertex3 in a list</span><span>
</span><a name="line-1408"></a><span class="hs-comment">--</span><span>
</span><a name="line-1409"></a><span class="hs-identifier">intersectLine'</span><span class="hs-glyph">::</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1410"></a><span>               </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1411"></a><a name="intersectLine%27"><a href="AronGraphic.html#intersectLine%27"><span class="hs-identifier">intersectLine'</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621679098036"><a href="#local-6989586621679098036"><span class="hs-identifier">p0</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679098037"><a href="#local-6989586621679098037"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679098038"><a href="#local-6989586621679098038"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679098039"><a href="#local-6989586621679098039"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1412"></a><span>               </span><span class="hs-special">,</span><a name="local-6989586621679098040"><a href="#local-6989586621679098040"><span class="hs-identifier">p1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679098041"><a href="#local-6989586621679098041"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679098042"><a href="#local-6989586621679098042"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679098043"><a href="#local-6989586621679098043"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1413"></a><span>               </span><span class="hs-special">,</span><a name="local-6989586621679098044"><a href="#local-6989586621679098044"><span class="hs-identifier">q0</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679098045"><a href="#local-6989586621679098045"><span class="hs-identifier">a0</span></a></a><span> </span><a name="local-6989586621679098046"><a href="#local-6989586621679098046"><span class="hs-identifier">b0</span></a></a><span> </span><a name="local-6989586621679098047"><a href="#local-6989586621679098047"><span class="hs-identifier">c0</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1414"></a><span>               </span><span class="hs-special">,</span><a name="local-6989586621679098048"><a href="#local-6989586621679098048"><span class="hs-identifier">q1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679098049"><a href="#local-6989586621679098049"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679098050"><a href="#local-6989586621679098050"><span class="hs-identifier">b1</span></a></a><span> </span><a name="local-6989586621679098051"><a href="#local-6989586621679098051"><span class="hs-identifier">c1</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1415"></a><span>               </span><span class="hs-special">]</span><span>
</span><a name="line-1416"></a><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679098052"><span class="hs-identifier hs-var">is0</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679098053"><span class="hs-identifier hs-var">is1</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098061"><span class="hs-identifier hs-var">pt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679098059"><span class="hs-identifier hs-var">st</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1417"></a><span>              </span><span class="hs-keyword">where</span><span>
</span><a name="line-1418"></a><span>                </span><a name="local-6989586621679098052"><a href="#local-6989586621679098052"><span class="hs-identifier">is0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#isColinear"><span class="hs-identifier hs-var">isColinear</span></a><span> </span><a href="#local-6989586621679098036"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679098044"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679098048"><span class="hs-identifier hs-var">q1</span></a><span>
</span><a name="line-1419"></a><span>                </span><a name="local-6989586621679098053"><a href="#local-6989586621679098053"><span class="hs-identifier">is1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#isColinear"><span class="hs-identifier hs-var">isColinear</span></a><span> </span><a href="#local-6989586621679098040"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679098044"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679098048"><span class="hs-identifier hs-var">q1</span></a><span>
</span><a name="line-1420"></a><span>                </span><a name="local-6989586621679098054"><a href="#local-6989586621679098054"><span class="hs-identifier">v01</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098040"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679098036"><span class="hs-identifier hs-var">p0</span></a><span> </span><span class="hs-comment">-- p&#8321; - p&#8320;  f(t) = p&#8320; + s(p&#8321; - p&#8320;)</span><span>
</span><a name="line-1421"></a><span>                </span><a name="local-6989586621679098055"><a href="#local-6989586621679098055"><span class="hs-identifier">u01</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098048"><span class="hs-identifier hs-var">q1</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679098044"><span class="hs-identifier hs-var">q0</span></a><span> </span><span class="hs-comment">-- q&#8321; - q&#8320;  f(s) = q&#8320; + t(q&#8321; - q&#8320;)</span><span>
</span><a name="line-1422"></a><span>                </span><a name="local-6989586621679098056"><a href="#local-6989586621679098056"><span class="hs-identifier">ma</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679098062"><span class="hs-identifier hs-var">ne</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098041"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679098037"><span class="hs-identifier hs-var">x0</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098049"><span class="hs-identifier hs-var">a1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679098045"><span class="hs-identifier hs-var">a0</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>  </span><span class="hs-comment">-- [s]</span><span>
</span><a name="line-1423"></a><span>                      </span><span class="hs-special">[</span><a href="#local-6989586621679098062"><span class="hs-identifier hs-var">ne</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098042"><span class="hs-identifier hs-var">y1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679098038"><span class="hs-identifier hs-var">y0</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098050"><span class="hs-identifier hs-var">b1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679098046"><span class="hs-identifier hs-var">b0</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- [t]</span><span>
</span><a name="line-1424"></a><span>                </span><a name="local-6989586621679098057"><a href="#local-6989586621679098057"><span class="hs-identifier">ivm</span></a></a><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#inv2"><span class="hs-identifier hs-var">inv2</span></a><span> </span><a href="#local-6989586621679098056"><span class="hs-identifier hs-var">ma</span></a><span>
</span><a name="line-1425"></a><span>                </span><a name="local-6989586621679098058"><a href="#local-6989586621679098058"><span class="hs-identifier">v</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679098037"><span class="hs-identifier hs-var">x0</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679098045"><span class="hs-identifier hs-var">a0</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- p&#8320; - q&#8320;</span><span>
</span><a name="line-1426"></a><span>                      </span><span class="hs-special">[</span><a href="#local-6989586621679098038"><span class="hs-identifier hs-var">y0</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679098046"><span class="hs-identifier hs-var">b0</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-1427"></a><span>                </span><span class="hs-comment">-- solve s and t</span><span>
</span><a name="line-1428"></a><span>                </span><span class="hs-comment">-- [s]</span><span>
</span><a name="line-1429"></a><span>                </span><span class="hs-comment">-- [t]</span><span>
</span><a name="line-1430"></a><span>                </span><a name="local-6989586621679098059"><a href="#local-6989586621679098059"><span class="hs-identifier">st</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#multiMat"><span class="hs-identifier hs-var">multiMat</span></a><span> </span><a href="#local-6989586621679098057"><span class="hs-identifier hs-var">ivm</span></a><span> </span><a href="#local-6989586621679098058"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1431"></a><span>                </span><span class="hs-comment">-- |  st = ivm *. v</span><span>
</span><a name="line-1432"></a><span>                </span><a name="local-6989586621679098060"><a href="#local-6989586621679098060"><span class="hs-identifier">s</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">head</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098059"><span class="hs-identifier hs-var">st</span></a><span> </span><span class="hs-comment">-- st = [[s],[t]]</span><span>
</span><a name="line-1433"></a><span>                </span><a name="local-6989586621679098061"><a href="#local-6989586621679098061"><span class="hs-identifier">pt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098036"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="AronGraphic.html#%2B%3A"><span class="hs-operator hs-var">+:</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098060"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="AronGraphic.html#%2A%3A"><span class="hs-operator hs-var">*:</span></a><span> </span><a href="#local-6989586621679098054"><span class="hs-identifier hs-var">v01</span></a><span class="hs-special">)</span><span>
</span><a name="line-1434"></a><span>                </span><a name="local-6989586621679098062"><a href="#local-6989586621679098062"><span class="hs-identifier">ne</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">negate</span><span>
</span><a name="line-1435"></a><span>                </span><span class="hs-special">(</span><a name="local-6989586621679098063"><a href="#local-6989586621679098063"><span class="hs-operator">*.</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a name="local-6989586621679098064"><a href="#local-6989586621679098064"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679098065"><a href="#local-6989586621679098065"><span class="hs-identifier">b</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679098066"><a href="#local-6989586621679098066"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679098067"><a href="#local-6989586621679098067"><span class="hs-identifier">d</span></a></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a name="local-6989586621679098068"><a href="#local-6989586621679098068"><span class="hs-identifier">x</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679098069"><a href="#local-6989586621679098069"><span class="hs-identifier">y</span></a></a><span class="hs-special">]</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679098064"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679098068"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679098065"><span class="hs-identifier hs-var">b</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679098069"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679098066"><span class="hs-identifier hs-var">c</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679098068"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679098067"><span class="hs-identifier hs-var">d</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679098069"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-1436"></a><span>
</span><a name="line-1437"></a><span class="hs-comment">-- | TODO: fix, the code only handles two dimension.</span><span>
</span><a name="line-1438"></a><span class="hs-comment">-- | Given a point: p0, line: q0 q1</span><span>
</span><a name="line-1439"></a><span class="hs-comment">-- | Compute the distance from p0 to line: q0 q1</span><span>
</span><a name="line-1440"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-1441"></a><span class="hs-identifier">pointToLine</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1442"></a><span>             </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1443"></a><span>             </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1444"></a><span>             </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-1445"></a><a name="pointToLine"><a href="AronGraphic.html#pointToLine"><span class="hs-identifier">pointToLine</span></a></a><span> </span><a name="local-6989586621679098070"><a href="#local-6989586621679098070"><span class="hs-identifier">p0</span></a></a><span> </span><a name="local-6989586621679098071"><a href="#local-6989586621679098071"><span class="hs-identifier">q0</span></a></a><span> </span><a name="local-6989586621679098072"><a href="#local-6989586621679098072"><span class="hs-identifier">q1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679098073"><span class="hs-identifier hs-var">is</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-number">0.0</span><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679098078"><span class="hs-identifier hs-var">di</span></a><span>
</span><a name="line-1446"></a><span>            </span><span class="hs-keyword">where</span><span>
</span><a name="line-1447"></a><span>                </span><a name="local-6989586621679098073"><a href="#local-6989586621679098073"><span class="hs-identifier">is</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#isColinear"><span class="hs-identifier hs-var">isColinear</span></a><span> </span><a href="#local-6989586621679098070"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679098071"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679098072"><span class="hs-identifier hs-var">q1</span></a><span> </span><span class="hs-comment">-- if three pts are colinear, return zero</span><span>
</span><a name="line-1448"></a><span>                </span><a name="local-6989586621679098074"><a href="#local-6989586621679098074"><span class="hs-identifier">nr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#perpcw"><span class="hs-identifier hs-var">perpcw</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098072"><span class="hs-identifier hs-var">q1</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679098071"><span class="hs-identifier hs-var">q0</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- normal of q0 -&gt; q1</span><span>
</span><a name="line-1449"></a><span>                </span><a name="local-6989586621679098075"><a href="#local-6989586621679098075"><span class="hs-identifier">p1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098070"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="AronGraphic.html#%2B%3A"><span class="hs-operator hs-var">+:</span></a><span> </span><a href="#local-6989586621679098074"><span class="hs-identifier hs-var">nr</span></a><span> </span><span class="hs-comment">-- p0 +: t*normal where t = 1</span><span>
</span><a name="line-1450"></a><span>                </span><a name="local-6989586621679098076"><a href="#local-6989586621679098076"><span class="hs-identifier">vx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fromJust</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#intersectLine"><span class="hs-identifier hs-var">intersectLine</span></a><span> </span><a href="#local-6989586621679098070"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679098075"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679098071"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679098072"><span class="hs-identifier hs-var">q1</span></a><span>  </span><span class="hs-comment">-- compute the insection of two lines</span><span>
</span><a name="line-1451"></a><span>
</span><a name="line-1452"></a><span>                </span><span class="hs-comment">-- square root can not be represented in Rational number in general,</span><span>
</span><a name="line-1453"></a><span>                </span><span class="hs-comment">-- Convert: Vertex3 Rational =&gt; Vertex3 GLfloat</span><span>
</span><a name="line-1454"></a><span>                </span><a name="local-6989586621679098077"><a href="#local-6989586621679098077"><span class="hs-identifier">vx'</span></a></a><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">realToFrac</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098076"><span class="hs-identifier hs-var">vx</span></a><span>
</span><a name="line-1455"></a><span>                </span><a name="local-6989586621679098078"><a href="#local-6989586621679098078"><span class="hs-identifier">di</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#dist"><span class="hs-identifier hs-var">dist</span></a><span> </span><a href="#local-6989586621679098070"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679098077"><span class="hs-identifier hs-var">vx'</span></a><span>
</span><a name="line-1456"></a><span>
</span><a name="line-1457"></a><span>
</span><a name="line-1458"></a><span class="hs-comment">{-|
    === Find the intersection of two segments, 'intersectLine' or 'intersectSegNoEndPt'
    ==== Assume that two endpoints of each segment are not overlapped.(segment has non-zero length)

    * If two EndPts from different segments are over overlapped =&gt; then Maybe(Vertex3 endpt)

    __NOTE__ This function is ONLY for two dimensions

    __NOTE__ endpoins of different segments may be coincide

    &gt; intersectSeg (p0, p1) (q0, q1)
    &gt; Nothing
    &gt;
    &gt; intersectSeg (p0, p1) (q0, q1)
    &gt; Vertex3 x y z

    The function is based on 'intersectLine'
    * If two segments are __parallel__ or __overlapped__ then return Nothing

    TODO: add test cases
-}</span><span>
</span><a name="line-1479"></a><span class="hs-identifier">intersectSeg</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span>
</span><a name="line-1480"></a><a name="intersectSeg"><a href="AronGraphic.html#intersectSeg"><span class="hs-identifier">intersectSeg</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679098079"><a href="#local-6989586621679098079"><span class="hs-identifier">p0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679098080"><a href="#local-6989586621679098080"><span class="hs-identifier">p1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679098081"><a href="#local-6989586621679098081"><span class="hs-identifier">q0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679098082"><a href="#local-6989586621679098082"><span class="hs-identifier">q1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679098083"><span class="hs-identifier hs-var">is</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1481"></a><span>                                      </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679098084"><a href="#local-6989586621679098084"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098085"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="AronGraphic.html#%2208"><span class="hs-operator hs-var">&#8712;</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">0.0</span><span class="hs-special">,</span><span> </span><span class="hs-number">1.0</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098086"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="AronGraphic.html#%2208"><span class="hs-operator hs-var">&#8712;</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">0.0</span><span class="hs-special">,</span><span> </span><span class="hs-number">1.0</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621679098084"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1482"></a><span>                                        </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679098085"><a href="#local-6989586621679098085"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">head</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679098084"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1483"></a><span>                                              </span><a name="local-6989586621679098086"><a href="#local-6989586621679098086"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">last</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">last</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679098084"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1484"></a><span>                                      </span><span class="hs-identifier">_</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1485"></a><span>               </span><span class="hs-keyword">where</span><span>
</span><a name="line-1486"></a><span>                </span><a name="local-6989586621679098083"><a href="#local-6989586621679098083"><span class="hs-identifier">is</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#intersectLine"><span class="hs-identifier hs-var">intersectLine</span></a><span> </span><a href="#local-6989586621679098079"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679098080"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679098081"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679098082"><span class="hs-identifier hs-var">q1</span></a><span>
</span><a name="line-1487"></a><span>
</span><a name="line-1488"></a><span class="hs-comment">{-|
    === intersection excluding two EndPts, 'intersectLine' or 'intersectSeg'

    Sun Feb 17 19:24:22 2019

    There are some issues in endpts overlapped

    Deprecated, Should use 'intersectSegNoEndPt2'

    If four pts are colinear \( \Rightarrow \) Nothing

-}</span><span>
</span><a name="line-1500"></a><span class="hs-identifier">intersectSegNoEndPt</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span>
</span><a name="line-1501"></a><a name="intersectSegNoEndPt"><a href="AronGraphic.html#intersectSegNoEndPt"><span class="hs-identifier">intersectSegNoEndPt</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679098087"><a href="#local-6989586621679098087"><span class="hs-identifier">p0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679098088"><a href="#local-6989586621679098088"><span class="hs-identifier">p1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679098089"><a href="#local-6989586621679098089"><span class="hs-identifier">q0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679098090"><a href="#local-6989586621679098090"><span class="hs-identifier">q1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679098091"><span class="hs-identifier hs-var">is</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1502"></a><span>                                      </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679098092"><a href="#local-6989586621679098092"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679098093"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0.0</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679098093"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">1.0</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679098094"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0.0</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679098094"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">1.0</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098093"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="AronGraphic.html#%2208"><span class="hs-operator hs-var">&#8712;</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">0.0</span><span class="hs-special">,</span><span> </span><span class="hs-number">1.0</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098094"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="AronGraphic.html#%2208"><span class="hs-operator hs-var">&#8712;</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">0.0</span><span class="hs-special">,</span><span> </span><span class="hs-number">1.0</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621679098092"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1503"></a><span>                                        </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679098093"><a href="#local-6989586621679098093"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">head</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679098092"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1504"></a><span>                                              </span><a name="local-6989586621679098094"><a href="#local-6989586621679098094"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">last</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">last</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679098092"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1505"></a><span>                                      </span><span class="hs-identifier">_</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1506"></a><span>               </span><span class="hs-keyword">where</span><span>
</span><a name="line-1507"></a><span>                </span><a name="local-6989586621679098091"><a href="#local-6989586621679098091"><span class="hs-identifier">is</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#intersectLine"><span class="hs-identifier hs-var">intersectLine</span></a><span> </span><a href="#local-6989586621679098087"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679098088"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679098089"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679098090"><span class="hs-identifier hs-var">q1</span></a><span>
</span><a name="line-1508"></a><span>
</span><a name="line-1509"></a><span class="hs-comment">{-| 
    === intersection excluding two EndPts, 'intersectLine' or 'intersectSeg'
    Sun Feb 17 19:26:05 2019 

    Fixed some bugs from 'intersectSegNoEndPt'
-}</span><span>
</span><a name="line-1515"></a><span class="hs-identifier">intersectSegNoEndPt2</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span>
</span><a name="line-1516"></a><a name="intersectSegNoEndPt2"><a href="AronGraphic.html#intersectSegNoEndPt2"><span class="hs-identifier">intersectSegNoEndPt2</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679098095"><a href="#local-6989586621679098095"><span class="hs-identifier">p0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679098096"><a href="#local-6989586621679098096"><span class="hs-identifier">p1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679098097"><a href="#local-6989586621679098097"><span class="hs-identifier">q0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679098098"><a href="#local-6989586621679098098"><span class="hs-identifier">q1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679098103"><span class="hs-identifier hs-var">overLapped</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1517"></a><span>                                       </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679098099"><span class="hs-identifier hs-var">is</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679098100"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="AronGraphic.html#%2208"><span class="hs-operator hs-var">&#8712;</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">0.0</span><span class="hs-special">,</span><span> </span><span class="hs-number">1.0</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098101"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="AronGraphic.html#%2208"><span class="hs-operator hs-var">&#8712;</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">0.0</span><span class="hs-special">,</span><span> </span><span class="hs-number">1.0</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679098102"><span class="hs-identifier hs-var">mj</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1518"></a><span>                                       </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-1519"></a><span>                                          </span><span class="hs-keyword">where</span><span>
</span><a name="line-1520"></a><span>                                                </span><a name="local-6989586621679098099"><a href="#local-6989586621679098099"><span class="hs-identifier">is</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#intersectLine2"><span class="hs-identifier hs-var">intersectLine2</span></a><span> </span><a href="#local-6989586621679098095"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679098096"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679098097"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679098098"><span class="hs-identifier hs-var">q1</span></a><span>
</span><a name="line-1521"></a><span>                                                </span><a name="local-6989586621679098100"><a href="#local-6989586621679098100"><span class="hs-identifier">s</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">snd</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fromJust</span><span> </span><a href="#local-6989586621679098099"><span class="hs-identifier hs-var">is</span></a><span>
</span><a name="line-1522"></a><span>                                                </span><a name="local-6989586621679098101"><a href="#local-6989586621679098101"><span class="hs-identifier">t</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">snd</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fromJust</span><span> </span><a href="#local-6989586621679098099"><span class="hs-identifier hs-var">is</span></a><span>
</span><a name="line-1523"></a><span>                                                </span><a name="local-6989586621679098102"><a href="#local-6989586621679098102"><span class="hs-identifier">mj</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fromJust</span><span> </span><a href="#local-6989586621679098099"><span class="hs-identifier hs-var">is</span></a><span>
</span><a name="line-1524"></a><span>                                                </span><a name="local-6989586621679098103"><a href="#local-6989586621679098103"><span class="hs-identifier">overLapped</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#onePtOverlappedSeg"><span class="hs-identifier hs-var">onePtOverlappedSeg</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098095"><span class="hs-identifier hs-var">p0</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679098096"><span class="hs-identifier hs-var">p1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098097"><span class="hs-identifier hs-var">q0</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679098098"><span class="hs-identifier hs-var">q1</span></a><span class="hs-special">)</span><span>
</span><a name="line-1525"></a><span>
</span><a name="line-1526"></a><span class="hs-comment">{-|
    === If four pts are colinear return False 
    === If the intersection is within \( s \in [0.0, 1.0], t \in [0.0, 1.0] \) return True
    === Else return False
-}</span><span>
</span><a name="line-1531"></a><span class="hs-identifier">isIntersectedSeg</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1532"></a><a name="isIntersectedSeg"><a href="AronGraphic.html#isIntersectedSeg"><span class="hs-identifier">isIntersectedSeg</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679098104"><a href="#local-6989586621679098104"><span class="hs-identifier">p0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679098105"><a href="#local-6989586621679098105"><span class="hs-identifier">p1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679098106"><a href="#local-6989586621679098106"><span class="hs-identifier">q0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679098107"><a href="#local-6989586621679098107"><span class="hs-identifier">q1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679098108"><span class="hs-identifier hs-var">is</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1533"></a><span>                                      </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679098109"><a href="#local-6989586621679098109"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098110"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="AronGraphic.html#%2208"><span class="hs-operator hs-var">&#8712;</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">0.0</span><span class="hs-special">,</span><span> </span><span class="hs-number">1.0</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098111"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="AronGraphic.html#%2208"><span class="hs-operator hs-var">&#8712;</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">0.0</span><span class="hs-special">,</span><span> </span><span class="hs-number">1.0</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1534"></a><span>                                        </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679098110"><a href="#local-6989586621679098110"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">head</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679098109"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1535"></a><span>                                              </span><a name="local-6989586621679098111"><a href="#local-6989586621679098111"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">last</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">last</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679098109"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1536"></a><span>                                      </span><span class="hs-identifier">_</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1537"></a><span>               </span><span class="hs-keyword">where</span><span>
</span><a name="line-1538"></a><span>                </span><a name="local-6989586621679098108"><a href="#local-6989586621679098108"><span class="hs-identifier">is</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#intersectLine"><span class="hs-identifier hs-var">intersectLine</span></a><span> </span><a href="#local-6989586621679098104"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679098105"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679098106"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679098107"><span class="hs-identifier hs-var">q1</span></a><span>
</span><a name="line-1539"></a><span>
</span><a name="line-1540"></a><span class="hs-comment">{-|
    === intersect line, return Rational
-}</span><span>
</span><a name="line-1543"></a><span class="hs-identifier">intersectLineR</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1544"></a><span>                </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1545"></a><span>                </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1546"></a><span>                </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1547"></a><span>                </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">Rational</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Rational</span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1548"></a><a name="intersectLineR"><a href="AronGraphic.html#intersectLineR"><span class="hs-identifier">intersectLineR</span></a></a><span> </span><a name="local-6989586621679098112"><a href="#local-6989586621679098112"><span class="hs-identifier">p0</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679098113"><a href="#local-6989586621679098113"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679098114"><a href="#local-6989586621679098114"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679098115"><a href="#local-6989586621679098115"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1549"></a><span>               </span><a name="local-6989586621679098116"><a href="#local-6989586621679098116"><span class="hs-identifier">p1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679098117"><a href="#local-6989586621679098117"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679098118"><a href="#local-6989586621679098118"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679098119"><a href="#local-6989586621679098119"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1550"></a><span>               </span><a name="local-6989586621679098120"><a href="#local-6989586621679098120"><span class="hs-identifier">q0</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679098121"><a href="#local-6989586621679098121"><span class="hs-identifier">a0</span></a></a><span> </span><a name="local-6989586621679098122"><a href="#local-6989586621679098122"><span class="hs-identifier">b0</span></a></a><span> </span><a name="local-6989586621679098123"><a href="#local-6989586621679098123"><span class="hs-identifier">c0</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1551"></a><span>               </span><a name="local-6989586621679098124"><a href="#local-6989586621679098124"><span class="hs-identifier">q1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679098125"><a href="#local-6989586621679098125"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679098126"><a href="#local-6989586621679098126"><span class="hs-identifier">b1</span></a></a><span> </span><a name="local-6989586621679098127"><a href="#local-6989586621679098127"><span class="hs-identifier">c1</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1552"></a><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679098128"><span class="hs-identifier hs-var">is0</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679098129"><span class="hs-identifier hs-var">is1</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098140"><span class="hs-identifier hs-var">pt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679098137"><span class="hs-identifier hs-var">st</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1553"></a><span>               </span><span class="hs-keyword">where</span><span>
</span><a name="line-1554"></a><span>                </span><a name="local-6989586621679098128"><a href="#local-6989586621679098128"><span class="hs-identifier">is0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#isColinear"><span class="hs-identifier hs-var">isColinear</span></a><span> </span><a href="#local-6989586621679098112"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679098120"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679098124"><span class="hs-identifier hs-var">q1</span></a><span>
</span><a name="line-1555"></a><span>                </span><a name="local-6989586621679098129"><a href="#local-6989586621679098129"><span class="hs-identifier">is1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#isColinear"><span class="hs-identifier hs-var">isColinear</span></a><span> </span><a href="#local-6989586621679098116"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679098120"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679098124"><span class="hs-identifier hs-var">q1</span></a><span>
</span><a name="line-1556"></a><span>                </span><a name="local-6989586621679098130"><a href="#local-6989586621679098130"><span class="hs-identifier">v01</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toRational</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679098116"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679098112"><span class="hs-identifier hs-var">p0</span></a><span> </span><span class="hs-comment">-- p&#8321; - p&#8320;  f(t) = p&#8320; + s(p&#8321; - p&#8320;)</span><span>
</span><a name="line-1557"></a><span>                </span><a name="local-6989586621679098131"><a href="#local-6989586621679098131"><span class="hs-identifier">u01</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098124"><span class="hs-identifier hs-var">q1</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679098120"><span class="hs-identifier hs-var">q0</span></a><span> </span><span class="hs-comment">-- q&#8321; - q&#8320;  f(s) = q&#8320; + t(q&#8321; - q&#8320;)</span><span>
</span><a name="line-1558"></a><span>                </span><a name="local-6989586621679098132"><a href="#local-6989586621679098132"><span class="hs-identifier">ma</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679098141"><span class="hs-identifier hs-var">ne</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098117"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679098113"><span class="hs-identifier hs-var">x0</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098125"><span class="hs-identifier hs-var">a1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679098121"><span class="hs-identifier hs-var">a0</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>  </span><span class="hs-comment">-- [s]</span><span>
</span><a name="line-1559"></a><span>                      </span><span class="hs-special">[</span><a href="#local-6989586621679098141"><span class="hs-identifier hs-var">ne</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098118"><span class="hs-identifier hs-var">y1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679098114"><span class="hs-identifier hs-var">y0</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098126"><span class="hs-identifier hs-var">b1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679098122"><span class="hs-identifier hs-var">b0</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- [t]</span><span>
</span><a name="line-1560"></a><span>                </span><a name="local-6989586621679098133"><a href="#local-6989586621679098133"><span class="hs-identifier">ma'</span></a></a><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098147"><span class="hs-identifier hs-var">toR</span></a><span> </span><a href="#local-6989586621679098132"><span class="hs-identifier hs-var">ma</span></a><span>
</span><a name="line-1561"></a><span>                </span><a name="local-6989586621679098134"><a href="#local-6989586621679098134"><span class="hs-identifier">ivm</span></a></a><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098142"><span class="hs-identifier hs-var">invR</span></a><span> </span><a href="#local-6989586621679098133"><span class="hs-identifier hs-var">ma'</span></a><span>
</span><a name="line-1562"></a><span>                </span><a name="local-6989586621679098135"><a href="#local-6989586621679098135"><span class="hs-identifier">v'</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679098113"><span class="hs-identifier hs-var">x0</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679098121"><span class="hs-identifier hs-var">a0</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- p&#8320; - q&#8320;</span><span>
</span><a name="line-1563"></a><span>                      </span><span class="hs-special">[</span><a href="#local-6989586621679098114"><span class="hs-identifier hs-var">y0</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679098122"><span class="hs-identifier hs-var">b0</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-1564"></a><span>                </span><a name="local-6989586621679098136"><a href="#local-6989586621679098136"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098147"><span class="hs-identifier hs-var">toR</span></a><span> </span><a href="#local-6989586621679098135"><span class="hs-identifier hs-var">v'</span></a><span>
</span><a name="line-1565"></a><span>                </span><span class="hs-comment">-- solve s and t</span><span>
</span><a name="line-1566"></a><span>                </span><span class="hs-comment">-- [s]</span><span>
</span><a name="line-1567"></a><span>                </span><span class="hs-comment">-- [t]</span><span>
</span><a name="line-1568"></a><span>                </span><a name="local-6989586621679098137"><a href="#local-6989586621679098137"><span class="hs-identifier">st</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098134"><span class="hs-identifier hs-var">ivm</span></a><span> </span><a href="#local-6989586621679098143"><span class="hs-operator hs-var">*.</span></a><span> </span><a href="#local-6989586621679098136"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1569"></a><span>                </span><a name="local-6989586621679098138"><a href="#local-6989586621679098138"><span class="hs-identifier">s</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">head</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098137"><span class="hs-identifier hs-var">st</span></a><span> </span><span class="hs-comment">-- st = [[s],[t]]</span><span>
</span><a name="line-1570"></a><span>                </span><a name="local-6989586621679098139"><a href="#local-6989586621679098139"><span class="hs-identifier">p0'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toRational</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098112"><span class="hs-identifier hs-var">p0</span></a><span>
</span><a name="line-1571"></a><span>                </span><a name="local-6989586621679098140"><a href="#local-6989586621679098140"><span class="hs-identifier">pt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098139"><span class="hs-identifier hs-var">p0'</span></a><span> </span><a href="#local-6989586621679098148"><span class="hs-operator hs-var">+&gt;</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098138"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679098146"><span class="hs-operator hs-var">**:</span></a><span> </span><a href="#local-6989586621679098130"><span class="hs-identifier hs-var">v01</span></a><span class="hs-special">)</span><span>
</span><a name="line-1572"></a><span>                </span><a name="local-6989586621679098141"><a href="#local-6989586621679098141"><span class="hs-identifier">ne</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">negate</span><span>
</span><a name="line-1573"></a><span>                </span><span class="hs-identifier">invR</span><span class="hs-glyph">::</span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Rational</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Rational</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-1574"></a><span>                </span><a name="local-6989586621679098142"><a href="#local-6989586621679098142"><span class="hs-identifier">invR</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a name="local-6989586621679098149"><a href="#local-6989586621679098149"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679098150"><a href="#local-6989586621679098150"><span class="hs-identifier">b</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679098151"><a href="#local-6989586621679098151"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679098152"><a href="#local-6989586621679098152"><span class="hs-identifier">d</span></a></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span class="hs-operator hs-var">/</span><a href="#local-6989586621679098144"><span class="hs-identifier hs-var">detR</span></a><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679098149"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679098150"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679098151"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679098152"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098145"><span class="hs-operator hs-var">#:</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679098152"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679098150"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679098151"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679098149"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-1575"></a><span>
</span><a name="line-1576"></a><span>                </span><span class="hs-special">(</span><span class="hs-operator">*.</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Rational</span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Rational</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Rational</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-1577"></a><span>                </span><span class="hs-special">(</span><a name="local-6989586621679098143"><a href="#local-6989586621679098143"><span class="hs-operator">*.</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a name="local-6989586621679098153"><a href="#local-6989586621679098153"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679098154"><a href="#local-6989586621679098154"><span class="hs-identifier">b</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679098155"><a href="#local-6989586621679098155"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679098156"><a href="#local-6989586621679098156"><span class="hs-identifier">d</span></a></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a name="local-6989586621679098157"><a href="#local-6989586621679098157"><span class="hs-identifier">x</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679098158"><a href="#local-6989586621679098158"><span class="hs-identifier">y</span></a></a><span class="hs-special">]</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679098153"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679098157"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679098154"><span class="hs-identifier hs-var">b</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679098158"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679098155"><span class="hs-identifier hs-var">c</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679098157"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679098156"><span class="hs-identifier hs-var">d</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679098158"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-1578"></a><span>
</span><a name="line-1579"></a><span>                </span><span class="hs-identifier">detR</span><span class="hs-glyph">::</span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Rational</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Rational</span><span>
</span><a name="line-1580"></a><span>                </span><a name="local-6989586621679098144"><a href="#local-6989586621679098144"><span class="hs-identifier">detR</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a name="local-6989586621679098159"><a href="#local-6989586621679098159"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679098160"><a href="#local-6989586621679098160"><span class="hs-identifier">b</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679098161"><a href="#local-6989586621679098161"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679098162"><a href="#local-6989586621679098162"><span class="hs-identifier">d</span></a></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098159"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679098162"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679098160"><span class="hs-identifier hs-var">b</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679098161"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-1581"></a><span>                </span><span class="hs-special">(</span><span class="hs-operator">#:</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Rational</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Rational</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Rational</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-1582"></a><span>                </span><span class="hs-special">(</span><a name="local-6989586621679098145"><a href="#local-6989586621679098145"><span class="hs-operator">#:</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679098163"><a href="#local-6989586621679098163"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679098164"><a href="#local-6989586621679098164"><span class="hs-identifier">cx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fmap</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679098163"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098164"><span class="hs-identifier hs-var">cx</span></a><span>
</span><a name="line-1583"></a><span>
</span><a name="line-1584"></a><span>                </span><span class="hs-special">(</span><span class="hs-operator">**:</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Rational</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">Rational</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">Rational</span><span>
</span><a name="line-1585"></a><span>                </span><span class="hs-special">(</span><a name="local-6989586621679098146"><a href="#local-6989586621679098146"><span class="hs-operator">**:</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679098165"><a href="#local-6989586621679098165"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679098166"><a href="#local-6989586621679098166"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679098167"><a href="#local-6989586621679098167"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679098168"><a href="#local-6989586621679098168"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vector3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098165"><span class="hs-identifier hs-var">r</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679098166"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098165"><span class="hs-identifier hs-var">r</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679098167"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098165"><span class="hs-identifier hs-var">r</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679098168"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span>
</span><a name="line-1586"></a><span>
</span><a name="line-1587"></a><span>                </span><a name="local-6989586621679098147"><a href="#local-6989586621679098147"><span class="hs-identifier">toR</span></a></a><span> </span><a name="local-6989586621679098169"><a href="#local-6989586621679098169"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fmap</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toRational</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098169"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-1588"></a><span>
</span><a name="line-1589"></a><span>                </span><span class="hs-special">(</span><span class="hs-operator">+&gt;</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">Rational</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">Rational</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">Rational</span><span>
</span><a name="line-1590"></a><span>                </span><span class="hs-special">(</span><a name="local-6989586621679098148"><a href="#local-6989586621679098148"><span class="hs-operator">+&gt;</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679098170"><a href="#local-6989586621679098170"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679098171"><a href="#local-6989586621679098171"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679098172"><a href="#local-6989586621679098172"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679098173"><a href="#local-6989586621679098173"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679098174"><a href="#local-6989586621679098174"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679098175"><a href="#local-6989586621679098175"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098170"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679098173"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098171"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679098174"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098172"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679098175"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span>
</span><a name="line-1591"></a><span>
</span><a name="line-1592"></a><span class="hs-comment">{-|
 === Three points rotation order can be determinated by the \( \color{red}{\text{Right Hand Rule}} \)
 &lt;http://localhost/html/indexConvexHullAlgorithm.html#rotate_dir Three_Points_Direction&gt;

  If given three points in following order:

  p&#8320; = (1, 0)

  p&#8321; = (0, 0)

  p&#8322; = (1, 0)

  then vectors are computed in following:

  v10 = p&#8320; - p&#8321;

  v12 = p&#8322; - p&#8321;

 matrix can be formed as following:

 m = [v10, v12]

 \( \vec{v_{01}} \times \vec{v_{02}} \) in Right Hand Rule

 \[
  m = \begin{bmatrix}
      1 &amp; 0 \\
      0 &amp; 1 \\
      \end{bmatrix} \\
  \det m = 1 &gt; 0 \\
 \]

 If the three points are collinear:

 \( \det M = 0 \)

 If the order of three points in clockwise order:

 \( \det M &gt; 0 \)

 If the order of three points in counter clockwise order:

 \( \det M &lt; 0 \)

-}</span><span>
</span><a name="line-1637"></a><span class="hs-identifier">threePtDeterminant</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679094317"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679094317"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679094317"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679094317"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679094317"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1638"></a><a name="threePtDeterminant"><a href="AronGraphic.html#threePtDeterminant"><span class="hs-identifier">threePtDeterminant</span></a></a><span> </span><a name="local-6989586621679098176"><a href="#local-6989586621679098176"><span class="hs-identifier">p0</span></a></a><span> </span><a name="local-6989586621679098177"><a href="#local-6989586621679098177"><span class="hs-identifier">p1</span></a></a><span> </span><a name="local-6989586621679098178"><a href="#local-6989586621679098178"><span class="hs-identifier">p2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#det"><span class="hs-identifier hs-var">det</span></a><span> </span><a href="#local-6989586621679098182"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-1639"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1640"></a><span>    </span><a name="local-6989586621679098179"><a href="#local-6989586621679098179"><span class="hs-identifier">v10</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098181"><span class="hs-identifier hs-var">v2m</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679098176"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679098177"><span class="hs-identifier hs-var">p1</span></a><span>
</span><a name="line-1641"></a><span>    </span><a name="local-6989586621679098180"><a href="#local-6989586621679098180"><span class="hs-identifier">v12</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098181"><span class="hs-identifier hs-var">v2m</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679098178"><span class="hs-identifier hs-var">p2</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679098177"><span class="hs-identifier hs-var">p1</span></a><span>
</span><a name="line-1642"></a><span>    </span><a name="local-6989586621679098181"><a href="#local-6989586621679098181"><span class="hs-identifier">v2m</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679098183"><a href="#local-6989586621679098183"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679098184"><a href="#local-6989586621679098184"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679098185"><a href="#local-6989586621679098185"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679098183"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679098184"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span>
</span><a name="line-1643"></a><span>    </span><a name="local-6989586621679098182"><a href="#local-6989586621679098182"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679098179"><span class="hs-identifier hs-var">v10</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679098180"><span class="hs-identifier hs-var">v12</span></a><span class="hs-special">]</span><span>
</span><a name="line-1644"></a><span>
</span><a name="line-1645"></a><span class="hs-comment">{-|
 === Three points in Counter ClockWise order
 \(  \det M &gt; 0 \)
-}</span><span>
</span><a name="line-1649"></a><span class="hs-identifier">threePtCCW</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679094316"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679094316"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679094316"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679094316"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679094316"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1650"></a><a name="threePtCCW"><a href="AronGraphic.html#threePtCCW"><span class="hs-identifier">threePtCCW</span></a></a><span> </span><a name="local-6989586621679098186"><a href="#local-6989586621679098186"><span class="hs-identifier">p0</span></a></a><span> </span><a name="local-6989586621679098187"><a href="#local-6989586621679098187"><span class="hs-identifier">p1</span></a></a><span> </span><a name="local-6989586621679098188"><a href="#local-6989586621679098188"><span class="hs-identifier">p2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#threePtDeterminant"><span class="hs-identifier hs-var">threePtDeterminant</span></a><span> </span><a href="#local-6989586621679098186"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679098187"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679098188"><span class="hs-identifier hs-var">p2</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-1651"></a><span>
</span><a name="line-1652"></a><span class="hs-comment">{-|
 === Three points in ClockWise order
 \( \det M &lt; 0 \)
-}</span><span>
</span><a name="line-1656"></a><span class="hs-identifier">threePtCW</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679094315"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679094315"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679094315"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679094315"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679094315"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1657"></a><a name="threePtCW"><a href="AronGraphic.html#threePtCW"><span class="hs-identifier">threePtCW</span></a></a><span> </span><a name="local-6989586621679098189"><a href="#local-6989586621679098189"><span class="hs-identifier">p0</span></a></a><span> </span><a name="local-6989586621679098190"><a href="#local-6989586621679098190"><span class="hs-identifier">p1</span></a></a><span> </span><a name="local-6989586621679098191"><a href="#local-6989586621679098191"><span class="hs-identifier">p2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#threePtDeterminant"><span class="hs-identifier hs-var">threePtDeterminant</span></a><span> </span><a href="#local-6989586621679098189"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679098190"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679098191"><span class="hs-identifier hs-var">p2</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-1658"></a><span>
</span><a name="line-1659"></a><span class="hs-comment">{-|
    === Three points are collinear

\[
    \begin{aligned}
    p_0 &amp;= (x_0, y_0) \\
    p_1 &amp;= (x_1, y_1) \\
    p_2 &amp;= (x_2, y_2) \\
    u   &amp;= p_0 - p_1 \\
    u   &amp;= (x_0 - x_1, y_0 - y_1) \\
    v   &amp;= p_2 - p_1 \\
    v   &amp;= (x_2 - x_1, y_2 - y_1) \\
    M   &amp;= \begin{bmatrix}
           u &amp; v
           \end{bmatrix} \\
    &amp;\mbox{If three pts are colinear, then } \\
    \det M &amp;= 0 \\
    \end{aligned}
\]
-}</span><span>
</span><a name="line-1679"></a><span class="hs-identifier">threePtCollinear</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679094314"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679094314"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679094314"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679094314"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679094314"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1680"></a><a name="threePtCollinear"><a href="AronGraphic.html#threePtCollinear"><span class="hs-identifier">threePtCollinear</span></a></a><span> </span><a name="local-6989586621679098192"><a href="#local-6989586621679098192"><span class="hs-identifier">p0</span></a></a><span> </span><a name="local-6989586621679098193"><a href="#local-6989586621679098193"><span class="hs-identifier">p1</span></a></a><span> </span><a name="local-6989586621679098194"><a href="#local-6989586621679098194"><span class="hs-identifier">p2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#threePtDeterminant"><span class="hs-identifier hs-var">threePtDeterminant</span></a><span> </span><a href="#local-6989586621679098192"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679098193"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679098194"><span class="hs-identifier hs-var">p2</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0.0</span><span>
</span><a name="line-1681"></a><span>
</span><a name="line-1682"></a><span class="hs-comment">{-|
    Given a point \( p_0 \), a line \(q_0, q_2 \)
    === Check whether a point \(p_0\) is on the left size of a line \( q_0, q_2 \), it is based on 'threePtDeterminant' with additional condtion: \(y_2 &gt; y_0 \) or \( y_2 &lt; y_0 \) since

    __NOTE__ y2 \(\neq\) y0 where given (Vertex3 x0 y0 z0) and (Vertex3 x2 y2 z2)

    ==== Assume \( p_0, p_2 \) are not __coincide__

    * If pt on the line, return False
    * If pt on the right side of the line, return False
    * Else return True

    \[
        \begin{aligned}
        p_1 &amp;= (x_1, y_1) \\
        p_0 &amp;= (x_0, y_0) \\
        p_2 &amp;= (x_2, y_2) \\
        u &amp;= \overrightarrow{p1 p0}  \\
        v &amp;= \overrightarrow{p1 p2}  \\
        \end{aligned}
    \]

    if \( y_2 &gt; y_0 \)
    form a determinant
    \[
        \begin{aligned}
         \det \begin{vmatrix}
                u &amp; v
                \end{vmatrix} &gt; 0
        \end{aligned}
    \]
    if \( y_2 &lt; y_0 \)
    form a determinant
    \[
        \begin{aligned}
         \det \begin{vmatrix}
                u &amp; v
                \end{vmatrix} &lt; 0
        \end{aligned}
    \]

    If \( y_2 = y_0 \), compare \( x_0, x_2 \)

    === Check whether a point is below a line \(p_0, p_2\)
    if \( x_2 &lt; x_0 \)
    \[
        \begin{aligned}
         \det \begin{vmatrix}
                u &amp; v
                \end{vmatrix} &gt; 0
        \end{aligned}
    \]

    if \( x_2 &gt; x_0 \)
    \[
        \begin{aligned}
         \det \begin{vmatrix}
                u &amp; v
                \end{vmatrix} &lt; 0
        \end{aligned}
    \]


-}</span><span>
</span><a name="line-1746"></a><span class="hs-identifier">ptOnLeftLine</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679094313"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679094313"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">=&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679094313"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679094313"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><a href="#local-6989586621679094313"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1747"></a><a name="ptOnLeftLine"><a href="AronGraphic.html#ptOnLeftLine"><span class="hs-identifier">ptOnLeftLine</span></a></a><span> </span><a name="local-6989586621679098195"><a href="#local-6989586621679098195"><span class="hs-identifier">p0</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679098196"><a href="#local-6989586621679098196"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679098197"><a href="#local-6989586621679098197"><span class="hs-identifier">y0</span></a></a><span> </span><a name="local-6989586621679098198"><a href="#local-6989586621679098198"><span class="hs-identifier">z0</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1748"></a><span>             </span><a name="local-6989586621679098199"><a href="#local-6989586621679098199"><span class="hs-identifier">p1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679098200"><a href="#local-6989586621679098200"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679098201"><a href="#local-6989586621679098201"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679098202"><a href="#local-6989586621679098202"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1749"></a><span>             </span><a name="local-6989586621679098203"><a href="#local-6989586621679098203"><span class="hs-identifier">p2</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679098204"><a href="#local-6989586621679098204"><span class="hs-identifier">x2</span></a></a><span> </span><a name="local-6989586621679098205"><a href="#local-6989586621679098205"><span class="hs-identifier">y2</span></a></a><span> </span><a name="local-6989586621679098206"><a href="#local-6989586621679098206"><span class="hs-identifier">z2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679098205"><span class="hs-identifier hs-var">y2</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-6989586621679098197"><span class="hs-identifier hs-var">y0</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098207"><span class="hs-identifier hs-var">de</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1750"></a><span>                                        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679098205"><span class="hs-identifier hs-var">y2</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679098197"><span class="hs-identifier hs-var">y0</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098207"><span class="hs-identifier hs-var">de</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098207"><span class="hs-identifier hs-var">de</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1751"></a><span>             </span><span class="hs-keyword">where</span><span>
</span><a name="line-1752"></a><span>                </span><a name="local-6989586621679098207"><a href="#local-6989586621679098207"><span class="hs-identifier">de</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#threePtDeterminant"><span class="hs-identifier hs-var">threePtDeterminant</span></a><span> </span><a href="#local-6989586621679098195"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679098199"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679098203"><span class="hs-identifier hs-var">p2</span></a><span>
</span><a name="line-1753"></a><span>
</span><a name="line-1754"></a><span class="hs-comment">--ptOnUpLine::(Fractional a, Ord a)=&gt;(Vertex3 a) -&gt;(Vertex3 a)-&gt;(Vertex3 a) -&gt; Bool</span><span>
</span><a name="line-1755"></a><span class="hs-comment">--</span><span>
</span><a name="line-1756"></a><span>
</span><a name="line-1757"></a><span class="hs-comment">{-|
  === Check whether a point \(p_0\) is inside a triangle \( \triangle ABC \)

  * __NOTE__ the order of three pts: \(A, B, C\) does't matter. e.g CCW or CW
  * \(p_0\) can NOT be the same point as \(A, B, C\)
  * If \(p_0\) is collinear with AB, BC, or AC, then \(p_0\) is considered inside the \( \triangle ABC \)

  \(p_0\) is the point that is tested
  three points \(A, B, C\) forms a triangle

  if point p0 inside the triangle, return true

  The sum of three angles are in degree.

  &gt;let p0 = Vertex3 0.1 0.1 0
  &gt;let a  = Vertex3 1 0 0
  &gt;let b  = Vertex3 0 0 0
  &gt;let c  = Vertex3 0 1 0
  &gt;
  &gt;ptInsideTri p0 a b c
  &gt;(True, 360.0)

  TODO: how to check whether a pt is inside a n-polygon 'ptInsidePolygon'
  &lt;http://localhost/html/indexConvexHullAlgorithm.html#npolygon N-Polygon&gt;

-}</span><span>
</span><a name="line-1783"></a><span class="hs-identifier">ptInsideTri</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span>
</span><a name="line-1784"></a><a name="ptInsideTri"><a href="AronGraphic.html#ptInsideTri"><span class="hs-identifier">ptInsideTri</span></a></a><span> </span><a name="local-6989586621679098208"><a href="#local-6989586621679098208"><span class="hs-identifier">p0</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679098209"><a href="#local-6989586621679098209"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679098210"><a href="#local-6989586621679098210"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679098211"><a href="#local-6989586621679098211"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098214"><span class="hs-identifier hs-var">is</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679098212"><span class="hs-identifier hs-var">degree</span></a><span class="hs-special">)</span><span>
</span><a name="line-1785"></a><span>                           </span><span class="hs-keyword">where</span><span>
</span><a name="line-1786"></a><span>                             </span><a name="local-6989586621679098212"><a href="#local-6989586621679098212"><span class="hs-identifier">degree</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098215"><span class="hs-identifier hs-var">dePerRad</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679098213"><span class="hs-identifier hs-var">rad</span></a><span>
</span><a name="line-1787"></a><span>                             </span><a name="local-6989586621679098213"><a href="#local-6989586621679098213"><span class="hs-identifier">rad</span></a></a><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">acos</span><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#cosVex3"><span class="hs-identifier hs-var">cosVex3</span></a><span> </span><a href="#local-6989586621679098210"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679098208"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679098209"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier hs-var">acos</span><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#cosVex3"><span class="hs-identifier hs-var">cosVex3</span></a><span> </span><a href="#local-6989586621679098211"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679098208"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679098210"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier hs-var">acos</span><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#cosVex3"><span class="hs-identifier hs-var">cosVex3</span></a><span> </span><a href="#local-6989586621679098211"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679098208"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679098209"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1788"></a><span>                             </span><a name="local-6989586621679098214"><a href="#local-6989586621679098214"><span class="hs-identifier">is</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">abs</span><span class="hs-special">(</span><a href="#local-6989586621679098213"><span class="hs-identifier hs-var">rad</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">2</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">pi</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0.001</span><span>
</span><a name="line-1789"></a><span>                             </span><a name="local-6989586621679098215"><a href="#local-6989586621679098215"><span class="hs-identifier">dePerRad</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">360</span><span class="hs-operator hs-var">/</span><span class="hs-special">(</span><span class="hs-number">2</span><span class="hs-operator hs-var">*</span><span class="hs-identifier hs-var">pi</span><span class="hs-special">)</span><span>
</span><a name="line-1790"></a><span class="hs-comment">{-|
Given a point p0 and three pts: q0, q1, q2,

Compute the intersection of line is perpendicular to the plane and passes point p0

If three pts (q0, q1, q2) are colinear, return Nothing

otherwise, return Just (Vertex3 GLfloat)
-}</span><span>
</span><a name="line-1799"></a><span class="hs-identifier">perpPlane</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1800"></a><span>           </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1801"></a><span>           </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1802"></a><span>           </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1803"></a><span>           </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">Rational</span><span class="hs-special">)</span><span>
</span><a name="line-1804"></a><a name="perpPlane"><a href="AronGraphic.html#perpPlane"><span class="hs-identifier">perpPlane</span></a></a><span> </span><a name="local-6989586621679098216"><a href="#local-6989586621679098216"><span class="hs-identifier">p0</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679098217"><a href="#local-6989586621679098217"><span class="hs-identifier">e0</span></a></a><span> </span><a name="local-6989586621679098218"><a href="#local-6989586621679098218"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679098219"><a href="#local-6989586621679098219"><span class="hs-identifier">e2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1805"></a><span>          </span><a name="local-6989586621679098220"><a href="#local-6989586621679098220"><span class="hs-identifier">q0</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679098221"><a href="#local-6989586621679098221"><span class="hs-identifier">m0</span></a></a><span> </span><a name="local-6989586621679098222"><a href="#local-6989586621679098222"><span class="hs-identifier">m1</span></a></a><span> </span><a name="local-6989586621679098223"><a href="#local-6989586621679098223"><span class="hs-identifier">m2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1806"></a><span>          </span><a name="local-6989586621679098224"><a href="#local-6989586621679098224"><span class="hs-identifier">q1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679098225"><a href="#local-6989586621679098225"><span class="hs-identifier">k0</span></a></a><span> </span><a name="local-6989586621679098226"><a href="#local-6989586621679098226"><span class="hs-identifier">k1</span></a></a><span> </span><a name="local-6989586621679098227"><a href="#local-6989586621679098227"><span class="hs-identifier">k2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1807"></a><span>          </span><a name="local-6989586621679098228"><a href="#local-6989586621679098228"><span class="hs-identifier">q2</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679098229"><a href="#local-6989586621679098229"><span class="hs-identifier">d0</span></a></a><span> </span><a name="local-6989586621679098230"><a href="#local-6989586621679098230"><span class="hs-identifier">d1</span></a></a><span> </span><a name="local-6989586621679098231"><a href="#local-6989586621679098231"><span class="hs-identifier">d2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1808"></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679098232"><span class="hs-identifier hs-var">is</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679098243"><span class="hs-identifier hs-var">pt</span></a><span>
</span><a name="line-1809"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-1810"></a><span>            </span><a name="local-6989586621679098232"><a href="#local-6989586621679098232"><span class="hs-identifier">is</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#isColinear"><span class="hs-identifier hs-var">isColinear</span></a><span> </span><a href="#local-6989586621679098220"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679098224"><span class="hs-identifier hs-var">q1</span></a><span> </span><a href="#local-6989586621679098228"><span class="hs-identifier hs-var">q2</span></a><span>
</span><a name="line-1811"></a><span>            </span><a name="local-6989586621679098233"><a href="#local-6989586621679098233"><span class="hs-identifier">nr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromJust</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#normal3"><span class="hs-identifier hs-var">normal3</span></a><span> </span><a href="#local-6989586621679098220"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679098224"><span class="hs-identifier hs-var">q1</span></a><span> </span><a href="#local-6989586621679098228"><span class="hs-identifier hs-var">q2</span></a><span>
</span><a name="line-1812"></a><span>            </span><a name="local-6989586621679098234"><a href="#local-6989586621679098234"><span class="hs-identifier">v1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098224"><span class="hs-identifier hs-var">q1</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679098220"><span class="hs-identifier hs-var">q0</span></a><span>
</span><a name="line-1813"></a><span>            </span><a name="local-6989586621679098235"><a href="#local-6989586621679098235"><span class="hs-identifier">v2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098228"><span class="hs-identifier hs-var">q2</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679098220"><span class="hs-identifier hs-var">q0</span></a><span>
</span><a name="line-1814"></a><span>            </span><a name="local-6989586621679098236"><a href="#local-6989586621679098236"><span class="hs-identifier">qp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098216"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679098220"><span class="hs-identifier hs-var">q0</span></a><span>
</span><a name="line-1815"></a><span>            </span><a name="local-6989586621679098237"><a href="#local-6989586621679098237"><span class="hs-identifier">vqp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toRational</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679098244"><span class="hs-identifier hs-var">veMat</span></a><span> </span><a href="#local-6989586621679098236"><span class="hs-identifier hs-var">qp</span></a><span>
</span><a name="line-1816"></a><span>            </span><a name="local-6989586621679098238"><a href="#local-6989586621679098238"><span class="hs-identifier">mat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">zipWith3</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679098248"><a href="#local-6989586621679098248"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679098249"><a href="#local-6989586621679098249"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679098250"><a href="#local-6989586621679098250"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679098248"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679098249"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679098250"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098244"><span class="hs-identifier hs-var">veMat</span></a><span> </span><a href="#local-6989586621679098234"><span class="hs-identifier hs-var">v1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098244"><span class="hs-identifier hs-var">veMat</span></a><span> </span><a href="#local-6989586621679098235"><span class="hs-identifier hs-var">v2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098244"><span class="hs-identifier hs-var">veMat</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679098246"><span class="hs-identifier hs-var">neg</span></a><span> </span><a href="#local-6989586621679098233"><span class="hs-identifier hs-var">nr</span></a><span class="hs-special">)</span><span>
</span><a name="line-1817"></a><span>            </span><a name="local-6989586621679098239"><a href="#local-6989586621679098239"><span class="hs-identifier">mat'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toRational</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098238"><span class="hs-identifier hs-var">mat</span></a><span>
</span><a name="line-1818"></a><span>            </span><a name="local-6989586621679098240"><a href="#local-6989586621679098240"><span class="hs-identifier">ima</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#inverseR"><span class="hs-identifier hs-var">inverseR</span></a><span> </span><a href="#local-6989586621679098239"><span class="hs-identifier hs-var">mat'</span></a><span>
</span><a name="line-1819"></a><span>            </span><a name="local-6989586621679098241"><a href="#local-6989586621679098241"><span class="hs-identifier">sth</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#multiMatR"><span class="hs-identifier hs-var">multiMatR</span></a><span> </span><a href="#local-6989586621679098240"><span class="hs-identifier hs-var">ima</span></a><span> </span><a href="#local-6989586621679098237"><span class="hs-identifier hs-var">vqp</span></a><span> </span><span class="hs-comment">-- sth =  [[s], [t], [h]]</span><span>
</span><a name="line-1820"></a><span>            </span><a name="local-6989586621679098242"><a href="#local-6989586621679098242"><span class="hs-identifier">h</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">last</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">last</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098241"><span class="hs-identifier hs-var">sth</span></a><span>
</span><a name="line-1821"></a><span>            </span><a name="local-6989586621679098243"><a href="#local-6989586621679098243"><span class="hs-identifier">pt</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098251"><span class="hs-identifier hs-var">p0'</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679098254"><span class="hs-identifier hs-var">ad</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098242"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679098252"><span class="hs-identifier hs-var">mu</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679098253"><span class="hs-identifier hs-var">nr'</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1822"></a><span>                                        </span><a name="local-6989586621679098251"><a href="#local-6989586621679098251"><span class="hs-identifier">p0'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098247"><span class="hs-identifier hs-var">toR</span></a><span> </span><a href="#local-6989586621679098216"><span class="hs-identifier hs-var">p0</span></a><span> </span><span class="hs-comment">-- toRational</span><span>
</span><a name="line-1823"></a><span>                                        </span><a name="local-6989586621679098252"><a href="#local-6989586621679098252"><span class="hs-identifier">mu</span></a></a><span> </span><a name="local-6989586621679098255"><a href="#local-6989586621679098255"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679098256"><a href="#local-6989586621679098256"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span class="hs-special">(</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679098255"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098256"><span class="hs-identifier hs-var">y</span></a><span>  </span><span class="hs-comment">-- t*v</span><span>
</span><a name="line-1824"></a><span>                                        </span><a name="local-6989586621679098253"><a href="#local-6989586621679098253"><span class="hs-identifier">nr'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098247"><span class="hs-identifier hs-var">toR</span></a><span> </span><a href="#local-6989586621679098233"><span class="hs-identifier hs-var">nr</span></a><span>  </span><span class="hs-comment">-- toRational</span><span>
</span><a name="line-1825"></a><span>                                        </span><span class="hs-comment">-- pt = p0 + v in affine space:)</span><span>
</span><a name="line-1826"></a><span>                                        </span><a name="local-6989586621679098254"><a href="#local-6989586621679098254"><span class="hs-identifier">ad</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679098257"><a href="#local-6989586621679098257"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679098258"><a href="#local-6989586621679098258"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679098259"><a href="#local-6989586621679098259"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679098260"><a href="#local-6989586621679098260"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679098261"><a href="#local-6989586621679098261"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679098262"><a href="#local-6989586621679098262"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098257"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679098260"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098258"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679098261"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098259"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679098262"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-1827"></a><span>
</span><a name="line-1828"></a><span>            </span><span class="hs-comment">-- | local functions</span><span>
</span><a name="line-1829"></a><span>            </span><a name="local-6989586621679098244"><a href="#local-6989586621679098244"><span class="hs-identifier">veMat</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679098263"><a href="#local-6989586621679098263"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679098264"><a href="#local-6989586621679098264"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679098265"><a href="#local-6989586621679098265"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679098263"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679098264"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679098265"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-1830"></a><span>            </span><a name="local-6989586621679098245"><a href="#local-6989586621679098245"><span class="hs-identifier">matVx</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a name="local-6989586621679098266"><a href="#local-6989586621679098266"><span class="hs-identifier">x</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679098267"><a href="#local-6989586621679098267"><span class="hs-identifier">y</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679098268"><a href="#local-6989586621679098268"><span class="hs-identifier">z</span></a></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a href="#local-6989586621679098266"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679098267"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679098268"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span>
</span><a name="line-1831"></a><span>            </span><a name="local-6989586621679098246"><a href="#local-6989586621679098246"><span class="hs-identifier">neg</span></a></a><span> </span><a name="local-6989586621679098269"><a href="#local-6989586621679098269"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">negate</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098269"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1832"></a><span>            </span><a name="local-6989586621679098247"><a href="#local-6989586621679098247"><span class="hs-identifier">toR</span></a></a><span> </span><a name="local-6989586621679098270"><a href="#local-6989586621679098270"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toRational</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098270"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1833"></a><span>
</span><a name="line-1834"></a><span class="hs-comment">-- | Line intersects Plane</span><span>
</span><a name="line-1835"></a><span class="hs-comment">-- | Given Line: p0 p1 and Plane: q0 q1 q2</span><span>
</span><a name="line-1836"></a><span class="hs-comment">-- | Compute the intersection of line and plane</span><span>
</span><a name="line-1837"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-1838"></a><span class="hs-comment">--  p1 = p0 +: h(p1 -: p0)</span><span>
</span><a name="line-1839"></a><span class="hs-identifier">lineIntersectPlane</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1840"></a><span>                    </span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1841"></a><span>                    </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1842"></a><span>                    </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1843"></a><span>                    </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1844"></a><span>                    </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">Rational</span><span class="hs-special">)</span><span>
</span><a name="line-1845"></a><a name="lineIntersectPlane"><a href="AronGraphic.html#lineIntersectPlane"><span class="hs-identifier">lineIntersectPlane</span></a></a><span> </span><a name="local-6989586621679098271"><a href="#local-6989586621679098271"><span class="hs-identifier">p0</span></a></a><span> </span><a name="local-6989586621679098272"><a href="#local-6989586621679098272"><span class="hs-identifier">ve</span></a></a><span> </span><a name="local-6989586621679098273"><a href="#local-6989586621679098273"><span class="hs-identifier">q0</span></a></a><span> </span><a name="local-6989586621679098274"><a href="#local-6989586621679098274"><span class="hs-identifier">q1</span></a></a><span> </span><a name="local-6989586621679098275"><a href="#local-6989586621679098275"><span class="hs-identifier">q2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679098276"><span class="hs-identifier hs-var">is</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679098287"><span class="hs-identifier hs-var">pt</span></a><span>
</span><a name="line-1846"></a><span>                </span><span class="hs-keyword">where</span><span>
</span><a name="line-1847"></a><span>                    </span><a name="local-6989586621679098276"><a href="#local-6989586621679098276"><span class="hs-identifier">is</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#isColinear"><span class="hs-identifier hs-var">isColinear</span></a><span> </span><a href="#local-6989586621679098273"><span class="hs-identifier hs-var">q0</span></a><span> </span><a href="#local-6989586621679098274"><span class="hs-identifier hs-var">q1</span></a><span> </span><a href="#local-6989586621679098275"><span class="hs-identifier hs-var">q2</span></a><span>
</span><a name="line-1848"></a><span>                    </span><a name="local-6989586621679098277"><a href="#local-6989586621679098277"><span class="hs-identifier">v1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098274"><span class="hs-identifier hs-var">q1</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679098273"><span class="hs-identifier hs-var">q0</span></a><span> </span><span class="hs-comment">-- q0 -&gt; q1</span><span>
</span><a name="line-1849"></a><span>                    </span><a name="local-6989586621679098278"><a href="#local-6989586621679098278"><span class="hs-identifier">v2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098275"><span class="hs-identifier hs-var">q2</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679098273"><span class="hs-identifier hs-var">q0</span></a><span> </span><span class="hs-comment">-- q0 -&gt; q2</span><span>
</span><a name="line-1850"></a><span>                    </span><a name="local-6989586621679098279"><a href="#local-6989586621679098279"><span class="hs-identifier">nr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098272"><span class="hs-identifier hs-var">ve</span></a><span>
</span><a name="line-1851"></a><span>                    </span><a name="local-6989586621679098280"><a href="#local-6989586621679098280"><span class="hs-identifier">qp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098271"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679098273"><span class="hs-identifier hs-var">q0</span></a><span>
</span><a name="line-1852"></a><span>                    </span><a name="local-6989586621679098281"><a href="#local-6989586621679098281"><span class="hs-identifier">vqp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toRational</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679098288"><span class="hs-identifier hs-var">veMat</span></a><span> </span><a href="#local-6989586621679098280"><span class="hs-identifier hs-var">qp</span></a><span>
</span><a name="line-1853"></a><span>                    </span><a name="local-6989586621679098282"><a href="#local-6989586621679098282"><span class="hs-identifier">mat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">zipWith3</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679098292"><a href="#local-6989586621679098292"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679098293"><a href="#local-6989586621679098293"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679098294"><a href="#local-6989586621679098294"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679098292"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679098293"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679098294"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098288"><span class="hs-identifier hs-var">veMat</span></a><span> </span><a href="#local-6989586621679098277"><span class="hs-identifier hs-var">v1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098288"><span class="hs-identifier hs-var">veMat</span></a><span> </span><a href="#local-6989586621679098278"><span class="hs-identifier hs-var">v2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098288"><span class="hs-identifier hs-var">veMat</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679098290"><span class="hs-identifier hs-var">neg</span></a><span> </span><a href="#local-6989586621679098279"><span class="hs-identifier hs-var">nr</span></a><span class="hs-special">)</span><span>
</span><a name="line-1854"></a><span>                    </span><a name="local-6989586621679098283"><a href="#local-6989586621679098283"><span class="hs-identifier">mat'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toRational</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098282"><span class="hs-identifier hs-var">mat</span></a><span>
</span><a name="line-1855"></a><span>                    </span><a name="local-6989586621679098284"><a href="#local-6989586621679098284"><span class="hs-identifier">ima</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#inverseR"><span class="hs-identifier hs-var">inverseR</span></a><span> </span><a href="#local-6989586621679098283"><span class="hs-identifier hs-var">mat'</span></a><span>
</span><a name="line-1856"></a><span>                    </span><a name="local-6989586621679098285"><a href="#local-6989586621679098285"><span class="hs-identifier">sth</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#multiMatR"><span class="hs-identifier hs-var">multiMatR</span></a><span> </span><a href="#local-6989586621679098284"><span class="hs-identifier hs-var">ima</span></a><span> </span><a href="#local-6989586621679098281"><span class="hs-identifier hs-var">vqp</span></a><span> </span><span class="hs-comment">-- sth =  [[s], [t], [h]]</span><span>
</span><a name="line-1857"></a><span>                    </span><a name="local-6989586621679098286"><a href="#local-6989586621679098286"><span class="hs-identifier">h</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">last</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">last</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098285"><span class="hs-identifier hs-var">sth</span></a><span>
</span><a name="line-1858"></a><span>                    </span><a name="local-6989586621679098287"><a href="#local-6989586621679098287"><span class="hs-identifier">pt</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098295"><span class="hs-identifier hs-var">p0'</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679098298"><span class="hs-identifier hs-var">ad</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098286"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679098296"><span class="hs-identifier hs-var">mu</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679098297"><span class="hs-identifier hs-var">nr'</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1859"></a><span>                                                </span><a name="local-6989586621679098295"><a href="#local-6989586621679098295"><span class="hs-identifier">p0'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098291"><span class="hs-identifier hs-var">toR</span></a><span> </span><a href="#local-6989586621679098271"><span class="hs-identifier hs-var">p0</span></a><span> </span><span class="hs-comment">-- toRational</span><span>
</span><a name="line-1860"></a><span>                                                </span><a name="local-6989586621679098296"><a href="#local-6989586621679098296"><span class="hs-identifier">mu</span></a></a><span> </span><a name="local-6989586621679098299"><a href="#local-6989586621679098299"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679098300"><a href="#local-6989586621679098300"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span class="hs-special">(</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679098299"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098300"><span class="hs-identifier hs-var">y</span></a><span>  </span><span class="hs-comment">-- t*v</span><span>
</span><a name="line-1861"></a><span>                                                </span><a name="local-6989586621679098297"><a href="#local-6989586621679098297"><span class="hs-identifier">nr'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098291"><span class="hs-identifier hs-var">toR</span></a><span> </span><a href="#local-6989586621679098279"><span class="hs-identifier hs-var">nr</span></a><span>  </span><span class="hs-comment">-- toRational</span><span>
</span><a name="line-1862"></a><span>                                                </span><span class="hs-comment">-- pt = p0 + v in affine space:)</span><span>
</span><a name="line-1863"></a><span>                                                </span><a name="local-6989586621679098298"><a href="#local-6989586621679098298"><span class="hs-identifier">ad</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679098301"><a href="#local-6989586621679098301"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679098302"><a href="#local-6989586621679098302"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679098303"><a href="#local-6989586621679098303"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679098304"><a href="#local-6989586621679098304"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679098305"><a href="#local-6989586621679098305"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679098306"><a href="#local-6989586621679098306"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098301"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679098304"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098302"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679098305"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098303"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679098306"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-1864"></a><span>
</span><a name="line-1865"></a><span>                    </span><span class="hs-comment">-- | local functions</span><span>
</span><a name="line-1866"></a><span>                    </span><a name="local-6989586621679098288"><a href="#local-6989586621679098288"><span class="hs-identifier">veMat</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vector3</span><span> </span><a name="local-6989586621679098307"><a href="#local-6989586621679098307"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679098308"><a href="#local-6989586621679098308"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679098309"><a href="#local-6989586621679098309"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679098307"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679098308"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679098309"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-1867"></a><span>                    </span><a name="local-6989586621679098289"><a href="#local-6989586621679098289"><span class="hs-identifier">matVx</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a name="local-6989586621679098310"><a href="#local-6989586621679098310"><span class="hs-identifier">x</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679098311"><a href="#local-6989586621679098311"><span class="hs-identifier">y</span></a></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679098312"><a href="#local-6989586621679098312"><span class="hs-identifier">z</span></a></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a href="#local-6989586621679098310"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679098311"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679098312"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span>
</span><a name="line-1868"></a><span>                    </span><a name="local-6989586621679098290"><a href="#local-6989586621679098290"><span class="hs-identifier">neg</span></a></a><span> </span><a name="local-6989586621679098313"><a href="#local-6989586621679098313"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">negate</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098313"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1869"></a><span>                    </span><a name="local-6989586621679098291"><a href="#local-6989586621679098291"><span class="hs-identifier">toR</span></a></a><span> </span><a name="local-6989586621679098314"><a href="#local-6989586621679098314"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toRational</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098314"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1870"></a><span>
</span><a name="line-1871"></a><span>
</span><a name="line-1872"></a><span class="hs-comment">{-|
 === Slow Algorithm 1 \( \color{red}{ \mathcal{O}(n^2)} \)
 1. find the a point \( p_0 \) which has the maximum y-axis value
 2. find the a point \( p' \) from \( p_0 \) so that the rest of all the points on one side of the segment \( \overline{p_0 p'} \)
 3. continua with the rest of points

 &lt;http://localhost/html/indexConvexHullAlgorithm.html Slow_Algorithm&gt;

 &gt;p0 p1 p2 p3
 &gt;(p0, p1) (p0, p2) (p0, p3)
 &gt;(p1, p2) (p1, p3)
 &gt;(p2, p3)

 === Naive Algorithm to compute the convex hull in \( \color{red}{\mathcal{O}(nh)} \) where \( \color{red}{n} \) is the number of points on the plane, \( \color{red}{h} \) is the number of points on the convex hull

 If all the points are around the convex hull, then the runtime will be \( \color{red}{\mathcal{O}(n^2)} \)

 @
 convexHull n pts
 n is the total of vertices
 pts is length pts

 p0 = Vertex3 0 0 0
 p1 = Vertex3 1 0 0
 p2 = Vertex3 0 1 0
 p3 = Vertex3 0.1 0.1 0
 pts= [p0, p1, p2, p3]
 n  = 4 = len pts
 pts = [p0, p1, p2, p3]
 exp= [[p2, p1],
       [p1, p0],
       [p0, p2]]
 @

 * __Algorithm__
 &lt;http://localhost/html/indexConvexHullAlgorithm.html#convexhull ConvexHull&gt;
 * Find a __top__ vertex: B(Vertex3 x y z) with maximum y-Axis value
 * Construct a new vertex: A(Vertex3 x+1 y z) = __top__(Vertex3 x + 1 y z) according to __top__(Vertex3 x y z)
 * Compute the angle \( \cos &#8736;ABC \) from three points: \(A, B, C\)
 * If there are only two points in pts for the list of Vertex3 e.g. p0 p1
 * then segments: \(\overline{AB} \) and \(\overline{BC} \) are drawn
 &lt;http://localhost/html/indexConvexHullAlgorithm.html#three_pts_angle Three_pts_angle&gt;

 n = length pts \(\Rightarrow\) n vertices \(\Rightarrow\) n edges. if there is two vertices, then \((p_0, p_1)\) and \((p_1, p_0)\)

 vec(top x1) and vec(top x2)

 \(\vec{v_1}\) = top -&gt; x1 = x1 -: top

 \(\vec{v_2}\) = top -&gt; x2 = x2 -: top

 * TODO: Handle the case where the three points are colinear.

 * TODO: If there are more than one point that have maximum y-axis, then choose the left most point
 &lt;http://localhost/html/indexConvexHullAlgorithm.html#top_point Top_Point&gt;

 \( \color{red}{TODO} \): use eliminate points technic to improve the algorithm
 &lt;http://localhost/html/indexConvexHullAlgorithm.html#eliminate_points Eliminate_Points&gt;

 It seems that the algorithm is still \( \color{red}{ \mathcal{O}(nh)} \)
 Given n vertices on a plane. There are \(h\) points on the convex hull.
 Assume \( \frac{1}{h} n \) vertices may be eliminated when the next point is found on the convex hull.
 The total number of steps are:
 \[
 \begin{aligned}
    s &amp;= n + \frac{h-1}{h} n + \frac{h-2}{h} n + \dots + \frac{1}{h} n \\
    s &amp;= n h (1 + 2 + 3 + \dots + h) \\
    s &amp;= n h \frac{(1 + h)h}{2} \\
    s &amp;= n \frac{1+ h}{2} \\
      &amp;= \mathcal{O}(nh) \\
 \end{aligned}
 \]



 When the algo walks around the convex hull in counter clokcwise order.

 segment can be drawn from top point to previous point

 All the points can be removed if they are on the left side of the segment

 \( \color{red}{TODO} \) use other algo: check whether a point is on the left or right side of a segment

 The algo can be check with the determinant of two vectors 'threePtDeterminant'
 &lt;http://localhost/html/indexConvexHullAlgorithm.html#rotate_dir Three_Points_Direction&gt;

-}</span><span>
</span><a name="line-1959"></a><span class="hs-identifier">convexHull</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int</span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1960"></a><span>        </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-1961"></a><a name="convexHull"><a href="AronGraphic.html#convexHull"><span class="hs-identifier">convexHull</span></a></a><span> </span><a name="local-6989586621679098315"><a href="#local-6989586621679098315"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679098316"><a href="#local-6989586621679098316"><span class="hs-identifier">pts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098325"><span class="hs-identifier hs-var">convexHull'</span></a><span> </span><a href="#local-6989586621679098315"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679098324"><span class="hs-identifier hs-var">xi</span></a><span> </span><a href="#local-6989586621679098323"><span class="hs-identifier hs-var">topx</span></a><span> </span><a href="#local-6989586621679098322"><span class="hs-identifier hs-var">top</span></a><span> </span><a href="#local-6989586621679098316"><span class="hs-identifier hs-var">pts</span></a><span>
</span><a name="line-1962"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1963"></a><span>        </span><a name="local-6989586621679098317"><a href="#local-6989586621679098317"><span class="hs-identifier">t1</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679098326"><a href="#local-6989586621679098326"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679098327"><a href="#local-6989586621679098327"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679098328"><a href="#local-6989586621679098328"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098326"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1964"></a><span>        </span><a name="local-6989586621679098318"><a href="#local-6989586621679098318"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679098329"><a href="#local-6989586621679098329"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679098330"><a href="#local-6989586621679098330"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679098331"><a href="#local-6989586621679098331"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098330"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-1965"></a><span>        </span><a name="local-6989586621679098319"><a href="#local-6989586621679098319"><span class="hs-identifier">t3</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679098332"><a href="#local-6989586621679098332"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679098333"><a href="#local-6989586621679098333"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679098334"><a href="#local-6989586621679098334"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098334"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-1966"></a><span>        </span><span class="hs-comment">-- find the vertex that has maximum y value.</span><span>
</span><a name="line-1967"></a><span>        </span><a name="local-6989586621679098320"><a href="#local-6989586621679098320"><span class="hs-identifier">ptsSort</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#qqsort"><span class="hs-identifier hs-var">qqsort</span></a><span> </span><a href="#local-6989586621679098335"><span class="hs-identifier hs-var">cmp</span></a><span> </span><a href="#local-6989586621679098316"><span class="hs-identifier hs-var">pts</span></a><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679098335"><a href="#local-6989586621679098335"><span class="hs-identifier">cmp</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679098336"><a href="#local-6989586621679098336"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679098337"><a href="#local-6989586621679098337"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679098338"><a href="#local-6989586621679098338"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679098339"><a href="#local-6989586621679098339"><span class="hs-identifier">x2</span></a></a><span> </span><a name="local-6989586621679098340"><a href="#local-6989586621679098340"><span class="hs-identifier">y2</span></a></a><span> </span><a name="local-6989586621679098341"><a href="#local-6989586621679098341"><span class="hs-identifier">z2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098337"><span class="hs-identifier hs-var">y1</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-6989586621679098340"><span class="hs-identifier hs-var">y2</span></a><span>
</span><a name="line-1968"></a><span>
</span><a name="line-1969"></a><span>        </span><span class="hs-comment">-- find the largest angle</span><span>
</span><a name="line-1970"></a><span>        </span><span class="hs-comment">-- angle: p0_p1_p2, vec: (p1, p2) and vec: (p1, p0)</span><span>
</span><a name="line-1971"></a><span>        </span><a name="local-6989586621679098321"><a href="#local-6989586621679098321"><span class="hs-identifier">vexSort</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#mergeSortC"><span class="hs-identifier hs-var">mergeSortC</span></a><span> </span><a href="#local-6989586621679098345"><span class="hs-identifier hs-var">cmp</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679098352"><a href="#local-6989586621679098352"><span class="hs-identifier">p2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#cosVex3"><span class="hs-identifier hs-var">cosVex3</span></a><span> </span><a href="#local-6989586621679098343"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679098342"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679098352"><span class="hs-identifier hs-var">p2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679098342"><span class="hs-identifier hs-var">p1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679098352"><span class="hs-identifier hs-var">p2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098344"><span class="hs-identifier hs-var">cx</span></a><span>  </span><span class="hs-comment">-- p1 to all the rest of pts</span><span>
</span><a name="line-1972"></a><span>                        </span><span class="hs-keyword">where</span><span>
</span><a name="line-1973"></a><span>                            </span><a name="local-6989586621679098342"><a href="#local-6989586621679098342"><span class="hs-identifier">p1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679098320"><span class="hs-identifier hs-var">ptsSort</span></a><span>
</span><a name="line-1974"></a><span>                            </span><a name="local-6989586621679098343"><a href="#local-6989586621679098343"><span class="hs-identifier">p0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098346"><span class="hs-identifier hs-var">addx1</span></a><span> </span><a href="#local-6989586621679098342"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679098346"><a href="#local-6989586621679098346"><span class="hs-identifier">addx1</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679098347"><a href="#local-6989586621679098347"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679098348"><a href="#local-6989586621679098348"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679098349"><a href="#local-6989586621679098349"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098347"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098348"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679098349"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-1975"></a><span>                            </span><a name="local-6989586621679098344"><a href="#local-6989586621679098344"><span class="hs-identifier">cx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">tail</span><span> </span><a href="#local-6989586621679098320"><span class="hs-identifier hs-var">ptsSort</span></a><span>
</span><a name="line-1976"></a><span>                            </span><a name="local-6989586621679098345"><a href="#local-6989586621679098345"><span class="hs-identifier">cmp</span></a></a><span> </span><a name="local-6989586621679098350"><a href="#local-6989586621679098350"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-6989586621679098351"><a href="#local-6989586621679098351"><span class="hs-identifier">c2</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098317"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679098350"><span class="hs-identifier hs-var">c1</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-6989586621679098317"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679098351"><span class="hs-identifier hs-var">c2</span></a><span>
</span><a name="line-1977"></a><span>
</span><a name="line-1978"></a><span>        </span><a name="local-6989586621679098322"><a href="#local-6989586621679098322"><span class="hs-identifier">top</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679098353"><a href="#local-6989586621679098353"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679098354"><a href="#local-6989586621679098354"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679098355"><a href="#local-6989586621679098355"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679098356"><a href="#local-6989586621679098356"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098355"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679098353"><span class="hs-identifier hs-var">t2</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronModule.html#head%27"><span class="hs-identifier hs-var">head'</span></a><span> </span><a href="#local-6989586621679098321"><span class="hs-identifier hs-var">vexSort</span></a><span>
</span><a name="line-1979"></a><span>        </span><a name="local-6989586621679098323"><a href="#local-6989586621679098323"><span class="hs-identifier">topx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098357"><span class="hs-identifier hs-var">addx1</span></a><span> </span><a href="#local-6989586621679098322"><span class="hs-identifier hs-var">top</span></a><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679098357"><a href="#local-6989586621679098357"><span class="hs-identifier">addx1</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679098358"><a href="#local-6989586621679098358"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679098359"><a href="#local-6989586621679098359"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679098360"><a href="#local-6989586621679098360"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098358"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098359"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679098360"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-1980"></a><span>        </span><a name="local-6989586621679098324"><a href="#local-6989586621679098324"><span class="hs-identifier">xi</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098322"><span class="hs-identifier hs-var">top</span></a><span>
</span><a name="line-1981"></a><span>        </span><a name="local-6989586621679098325"><a href="#local-6989586621679098325"><span class="hs-identifier">convexHull'</span></a></a><span> </span><a name="local-6989586621679098361"><a href="#local-6989586621679098361"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679098362"><a href="#local-6989586621679098362"><span class="hs-identifier">xi</span></a></a><span> </span><a name="local-6989586621679098363"><a href="#local-6989586621679098363"><span class="hs-identifier">topx</span></a></a><span> </span><a name="local-6989586621679098364"><a href="#local-6989586621679098364"><span class="hs-identifier">top</span></a></a><span> </span><a name="local-6989586621679098365"><a href="#local-6989586621679098365"><span class="hs-identifier">ptsSort</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098361"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679098362"><span class="hs-identifier hs-var">xi</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621679098369"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098325"><span class="hs-identifier hs-var">convexHull'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098361"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098362"><span class="hs-identifier hs-var">xi</span></a><span> </span><a href="#local-6989586621679098364"><span class="hs-identifier hs-var">top</span></a><span> </span><a href="#local-6989586621679098369"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="#local-6989586621679098365"><span class="hs-identifier hs-var">ptsSort</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679098369"><span class="hs-identifier hs-var">x1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679098364"><span class="hs-identifier hs-var">top</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679098369"><span class="hs-identifier hs-var">x1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679098364"><span class="hs-identifier hs-var">top</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-1982"></a><span>                            </span><span class="hs-keyword">where</span><span>
</span><a name="line-1983"></a><span>                                </span><span class="hs-comment">-- use merge sort here for y andthen x</span><span>
</span><a name="line-1984"></a><span>                                </span><span class="hs-comment">-- choose the left most vertex</span><span>
</span><a name="line-1985"></a><span>                                </span><span class="hs-comment">-- find the biggest dot product of vec(top x1) vec(top x2) =&gt; the smallest angle</span><span>
</span><a name="line-1986"></a><span>                                </span><a name="local-6989586621679098366"><a href="#local-6989586621679098366"><span class="hs-identifier">cx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">filter</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679098370"><a href="#local-6989586621679098370"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679098370"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621679098364"><span class="hs-identifier hs-var">top</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098365"><span class="hs-identifier hs-var">ptsSort</span></a><span> </span><span class="hs-comment">-- remove top pt</span><span>
</span><a name="line-1987"></a><span>                                </span><a name="local-6989586621679098367"><a href="#local-6989586621679098367"><span class="hs-identifier">vexSort</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#qqsort"><span class="hs-identifier hs-var">qqsort</span></a><span> </span><a href="#local-6989586621679098368"><span class="hs-identifier hs-var">cmp</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679098371"><a href="#local-6989586621679098371"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#cosVex3"><span class="hs-identifier hs-var">cosVex3</span></a><span> </span><a href="#local-6989586621679098363"><span class="hs-identifier hs-var">topx</span></a><span> </span><a href="#local-6989586621679098364"><span class="hs-identifier hs-var">top</span></a><span> </span><a href="#local-6989586621679098371"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679098364"><span class="hs-identifier hs-var">top</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679098371"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679098366"><span class="hs-identifier hs-var">cx</span></a><span>
</span><a name="line-1988"></a><span>                                </span><a name="local-6989586621679098368"><a href="#local-6989586621679098368"><span class="hs-identifier">cmp</span></a></a><span> </span><a name="local-6989586621679098372"><a href="#local-6989586621679098372"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-6989586621679098373"><a href="#local-6989586621679098373"><span class="hs-identifier">c2</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098317"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679098372"><span class="hs-identifier hs-var">c1</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679098317"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679098373"><span class="hs-identifier hs-var">c2</span></a><span> </span><span class="hs-comment">-- the largest angle for the smallest cos(angle)</span><span>
</span><a name="line-1989"></a><span>                                </span><a name="local-6989586621679098369"><a href="#local-6989586621679098369"><span class="hs-identifier">x1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098319"><span class="hs-identifier hs-var">t3</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679098367"><span class="hs-identifier hs-var">vexSort</span></a><span>
</span><a name="line-1990"></a><span>
</span><a name="line-1991"></a><span>
</span><a name="line-1992"></a><span class="hs-comment">{-| 
    === Same as convexHull, return [(Vertex3 GLfloat, Vertex3 GLfloat)]
-}</span><span>
</span><a name="line-1995"></a><span class="hs-identifier">convexHull2</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int</span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1996"></a><span>        </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1997"></a><a name="convexHull2"><a href="AronGraphic.html#convexHull2"><span class="hs-identifier">convexHull2</span></a></a><span> </span><a name="local-6989586621679098374"><a href="#local-6989586621679098374"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679098375"><a href="#local-6989586621679098375"><span class="hs-identifier">pts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098384"><span class="hs-identifier hs-var">convexHull'</span></a><span> </span><a href="#local-6989586621679098374"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679098383"><span class="hs-identifier hs-var">xi</span></a><span> </span><a href="#local-6989586621679098382"><span class="hs-identifier hs-var">topx</span></a><span> </span><a href="#local-6989586621679098381"><span class="hs-identifier hs-var">top</span></a><span> </span><a href="#local-6989586621679098375"><span class="hs-identifier hs-var">pts</span></a><span>
</span><a name="line-1998"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1999"></a><span>        </span><a name="local-6989586621679098376"><a href="#local-6989586621679098376"><span class="hs-identifier">t1</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679098385"><a href="#local-6989586621679098385"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679098386"><a href="#local-6989586621679098386"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679098387"><a href="#local-6989586621679098387"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098385"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2000"></a><span>        </span><a name="local-6989586621679098377"><a href="#local-6989586621679098377"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679098388"><a href="#local-6989586621679098388"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679098389"><a href="#local-6989586621679098389"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679098390"><a href="#local-6989586621679098390"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098389"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2001"></a><span>        </span><a name="local-6989586621679098378"><a href="#local-6989586621679098378"><span class="hs-identifier">t3</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679098391"><a href="#local-6989586621679098391"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679098392"><a href="#local-6989586621679098392"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679098393"><a href="#local-6989586621679098393"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098393"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2002"></a><span>        </span><span class="hs-comment">-- find the vertex that has maximum y value.</span><span>
</span><a name="line-2003"></a><span>        </span><a name="local-6989586621679098379"><a href="#local-6989586621679098379"><span class="hs-identifier">ptsSort</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#qqsort"><span class="hs-identifier hs-var">qqsort</span></a><span> </span><a href="#local-6989586621679098394"><span class="hs-identifier hs-var">cmp</span></a><span> </span><a href="#local-6989586621679098375"><span class="hs-identifier hs-var">pts</span></a><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679098394"><a href="#local-6989586621679098394"><span class="hs-identifier">cmp</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679098395"><a href="#local-6989586621679098395"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679098396"><a href="#local-6989586621679098396"><span class="hs-identifier">y1</span></a></a><span> </span><a name="local-6989586621679098397"><a href="#local-6989586621679098397"><span class="hs-identifier">z1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679098398"><a href="#local-6989586621679098398"><span class="hs-identifier">x2</span></a></a><span> </span><a name="local-6989586621679098399"><a href="#local-6989586621679098399"><span class="hs-identifier">y2</span></a></a><span> </span><a name="local-6989586621679098400"><a href="#local-6989586621679098400"><span class="hs-identifier">z2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098396"><span class="hs-identifier hs-var">y1</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-6989586621679098399"><span class="hs-identifier hs-var">y2</span></a><span>
</span><a name="line-2004"></a><span>
</span><a name="line-2005"></a><span>        </span><span class="hs-comment">-- find the largest angle</span><span>
</span><a name="line-2006"></a><span>        </span><span class="hs-comment">-- angle: p0_p1_p2, vec: (p1, p2) and vec: (p1, p0)</span><span>
</span><a name="line-2007"></a><span>        </span><a name="local-6989586621679098380"><a href="#local-6989586621679098380"><span class="hs-identifier">vexSort</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#mergeSortC"><span class="hs-identifier hs-var">mergeSortC</span></a><span> </span><a href="#local-6989586621679098404"><span class="hs-identifier hs-var">cmp</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679098411"><a href="#local-6989586621679098411"><span class="hs-identifier">p2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#cosVex3"><span class="hs-identifier hs-var">cosVex3</span></a><span> </span><a href="#local-6989586621679098402"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679098401"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679098411"><span class="hs-identifier hs-var">p2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679098401"><span class="hs-identifier hs-var">p1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679098411"><span class="hs-identifier hs-var">p2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098403"><span class="hs-identifier hs-var">cx</span></a><span>  </span><span class="hs-comment">-- p1 to all the rest of pts</span><span>
</span><a name="line-2008"></a><span>                        </span><span class="hs-keyword">where</span><span>
</span><a name="line-2009"></a><span>                            </span><a name="local-6989586621679098401"><a href="#local-6989586621679098401"><span class="hs-identifier">p1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679098379"><span class="hs-identifier hs-var">ptsSort</span></a><span>
</span><a name="line-2010"></a><span>                            </span><a name="local-6989586621679098402"><a href="#local-6989586621679098402"><span class="hs-identifier">p0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098405"><span class="hs-identifier hs-var">addx1</span></a><span> </span><a href="#local-6989586621679098401"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679098405"><a href="#local-6989586621679098405"><span class="hs-identifier">addx1</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679098406"><a href="#local-6989586621679098406"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679098407"><a href="#local-6989586621679098407"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679098408"><a href="#local-6989586621679098408"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098406"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098407"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679098408"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-2011"></a><span>                            </span><a name="local-6989586621679098403"><a href="#local-6989586621679098403"><span class="hs-identifier">cx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">tail</span><span> </span><a href="#local-6989586621679098379"><span class="hs-identifier hs-var">ptsSort</span></a><span>
</span><a name="line-2012"></a><span>                            </span><a name="local-6989586621679098404"><a href="#local-6989586621679098404"><span class="hs-identifier">cmp</span></a></a><span> </span><a name="local-6989586621679098409"><a href="#local-6989586621679098409"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-6989586621679098410"><a href="#local-6989586621679098410"><span class="hs-identifier">c2</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098376"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679098409"><span class="hs-identifier hs-var">c1</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-6989586621679098376"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679098410"><span class="hs-identifier hs-var">c2</span></a><span>
</span><a name="line-2013"></a><span>
</span><a name="line-2014"></a><span>        </span><a name="local-6989586621679098381"><a href="#local-6989586621679098381"><span class="hs-identifier">top</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679098412"><a href="#local-6989586621679098412"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679098413"><a href="#local-6989586621679098413"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679098414"><a href="#local-6989586621679098414"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679098415"><a href="#local-6989586621679098415"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098414"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679098412"><span class="hs-identifier hs-var">t2</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronModule.html#head%27"><span class="hs-identifier hs-var">head'</span></a><span> </span><a href="#local-6989586621679098380"><span class="hs-identifier hs-var">vexSort</span></a><span>
</span><a name="line-2015"></a><span>        </span><a name="local-6989586621679098382"><a href="#local-6989586621679098382"><span class="hs-identifier">topx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098416"><span class="hs-identifier hs-var">addx1</span></a><span> </span><a href="#local-6989586621679098381"><span class="hs-identifier hs-var">top</span></a><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679098416"><a href="#local-6989586621679098416"><span class="hs-identifier">addx1</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a name="local-6989586621679098417"><a href="#local-6989586621679098417"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679098418"><a href="#local-6989586621679098418"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679098419"><a href="#local-6989586621679098419"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098417"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098418"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679098419"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-2016"></a><span>        </span><a name="local-6989586621679098383"><a href="#local-6989586621679098383"><span class="hs-identifier">xi</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098381"><span class="hs-identifier hs-var">top</span></a><span>
</span><a name="line-2017"></a><span>        </span><a name="local-6989586621679098384"><a href="#local-6989586621679098384"><span class="hs-identifier">convexHull'</span></a></a><span> </span><a name="local-6989586621679098420"><a href="#local-6989586621679098420"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679098421"><a href="#local-6989586621679098421"><span class="hs-identifier">xi</span></a></a><span> </span><a name="local-6989586621679098422"><a href="#local-6989586621679098422"><span class="hs-identifier">topx</span></a></a><span> </span><a name="local-6989586621679098423"><a href="#local-6989586621679098423"><span class="hs-identifier">top</span></a></a><span> </span><a name="local-6989586621679098424"><a href="#local-6989586621679098424"><span class="hs-identifier">ptsSort</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098420"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679098421"><span class="hs-identifier hs-var">xi</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621679098428"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098384"><span class="hs-identifier hs-var">convexHull'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098420"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098421"><span class="hs-identifier hs-var">xi</span></a><span> </span><a href="#local-6989586621679098423"><span class="hs-identifier hs-var">top</span></a><span> </span><a href="#local-6989586621679098428"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="#local-6989586621679098424"><span class="hs-identifier hs-var">ptsSort</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679098428"><span class="hs-identifier hs-var">x1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679098423"><span class="hs-identifier hs-var">top</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679098428"><span class="hs-identifier hs-var">x1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679098423"><span class="hs-identifier hs-var">top</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2018"></a><span>                            </span><span class="hs-keyword">where</span><span>
</span><a name="line-2019"></a><span>                                </span><span class="hs-comment">-- use merge sort here for y andthen x</span><span>
</span><a name="line-2020"></a><span>                                </span><span class="hs-comment">-- choose the left most vertex</span><span>
</span><a name="line-2021"></a><span>                                </span><span class="hs-comment">-- find the biggest dot product of vec(top x1) vec(top x2) =&gt; the smallest angle</span><span>
</span><a name="line-2022"></a><span>                                </span><a name="local-6989586621679098425"><a href="#local-6989586621679098425"><span class="hs-identifier">cx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">filter</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679098429"><a href="#local-6989586621679098429"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679098429"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621679098423"><span class="hs-identifier hs-var">top</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098424"><span class="hs-identifier hs-var">ptsSort</span></a><span> </span><span class="hs-comment">-- remove top pt</span><span>
</span><a name="line-2023"></a><span>                                </span><a name="local-6989586621679098426"><a href="#local-6989586621679098426"><span class="hs-identifier">vexSort</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#qqsort"><span class="hs-identifier hs-var">qqsort</span></a><span> </span><a href="#local-6989586621679098427"><span class="hs-identifier hs-var">cmp</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679098430"><a href="#local-6989586621679098430"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#cosVex3"><span class="hs-identifier hs-var">cosVex3</span></a><span> </span><a href="#local-6989586621679098422"><span class="hs-identifier hs-var">topx</span></a><span> </span><a href="#local-6989586621679098423"><span class="hs-identifier hs-var">top</span></a><span> </span><a href="#local-6989586621679098430"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679098423"><span class="hs-identifier hs-var">top</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679098430"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679098425"><span class="hs-identifier hs-var">cx</span></a><span>
</span><a name="line-2024"></a><span>                                </span><a name="local-6989586621679098427"><a href="#local-6989586621679098427"><span class="hs-identifier">cmp</span></a></a><span> </span><a name="local-6989586621679098431"><a href="#local-6989586621679098431"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-6989586621679098432"><a href="#local-6989586621679098432"><span class="hs-identifier">c2</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098376"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679098431"><span class="hs-identifier hs-var">c1</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679098376"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679098432"><span class="hs-identifier hs-var">c2</span></a><span> </span><span class="hs-comment">-- the largest angle for the smallest cos(angle)</span><span>
</span><a name="line-2025"></a><span>                                </span><a name="local-6989586621679098428"><a href="#local-6989586621679098428"><span class="hs-identifier">x1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098378"><span class="hs-identifier hs-var">t3</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679098426"><span class="hs-identifier hs-var">vexSort</span></a><span>
</span><a name="line-2026"></a><span>
</span><a name="line-2027"></a><span>
</span><a name="line-2028"></a><span class="hs-comment">{-| 
    === Connect all pts inside convex hull without crossing segments

    &lt;http://localhost/html/indexConvexHullAlgorithm.html#convexhull_all_segments All_Segments_ConvexHull&gt;

    @
    let vexList = [Vertex3 0.1 0.1 0.1, Vertex3 0.4 0.3 0.6, Vertex3 0.6 0.8 0.2]
    mapM_(\vx -&gt; do 
                drawSegment green vx 
                threadDelay 500
                ) $ convexHullAllSeg vexList
    @
-}</span><span>
</span><a name="line-2041"></a><span class="hs-identifier">convexHullAllSeg</span><span class="hs-glyph">::</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2042"></a><a name="convexHullAllSeg"><a href="AronGraphic.html#convexHullAllSeg"><span class="hs-identifier">convexHullAllSeg</span></a></a><span> </span><a name="local-6989586621679098433"><a href="#local-6989586621679098433"><span class="hs-identifier">cx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098436"><span class="hs-identifier hs-var">segList</span></a><span> </span><a href="#local-6989586621679098434"><span class="hs-identifier hs-var">hullList</span></a><span> </span><a href="#local-6989586621679098435"><span class="hs-identifier hs-var">diffList</span></a><span>
</span><a name="line-2043"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-2044"></a><span>        </span><span class="hs-comment">-- all the pts are on convex hull</span><span>
</span><a name="line-2045"></a><span>        </span><a name="local-6989586621679098434"><a href="#local-6989586621679098434"><span class="hs-identifier">hullList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#convexHull2"><span class="hs-identifier hs-var">convexHull2</span></a><span> </span><a href="#local-6989586621679098437"><span class="hs-identifier hs-var">le</span></a><span> </span><a href="#local-6989586621679098433"><span class="hs-identifier hs-var">cx</span></a><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679098437"><a href="#local-6989586621679098437"><span class="hs-identifier">le</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#len"><span class="hs-identifier hs-var">len</span></a><span> </span><a href="#local-6989586621679098433"><span class="hs-identifier hs-var">cx</span></a><span>
</span><a name="line-2046"></a><span>        </span><span class="hs-comment">-- all the pts are NOT on the convex hull</span><span>
</span><a name="line-2047"></a><span>        </span><a name="local-6989586621679098435"><a href="#local-6989586621679098435"><span class="hs-identifier">diffList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">L.\\</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098433"><span class="hs-identifier hs-var">cx</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621679098434"><span class="hs-identifier hs-var">hullList</span></a><span>
</span><a name="line-2048"></a><span>
</span><a name="line-2049"></a><span>        </span><span class="hs-comment">-- connect all segments inside convex hull</span><span>
</span><a name="line-2050"></a><span>        </span><span class="hs-identifier">segList</span><span class="hs-glyph">::</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2051"></a><span>        </span><a name="local-6989586621679098436"><a href="#local-6989586621679098436"><span class="hs-identifier">segList</span></a></a><span> </span><a name="local-6989586621679098438"><a href="#local-6989586621679098438"><span class="hs-identifier">sl</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098438"><span class="hs-identifier hs-var">sl</span></a><span>
</span><a name="line-2052"></a><span>        </span><span class="hs-identifier">segList</span><span> </span><a name="local-6989586621679098439"><a href="#local-6989586621679098439"><span class="hs-identifier">sl</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679098440"><a href="#local-6989586621679098440"><span class="hs-identifier">p</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679098441"><a href="#local-6989586621679098441"><span class="hs-identifier">cx</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098436"><span class="hs-identifier hs-var">segList</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="AronGraphic.html#nonCrossSegmentNoEndPt"><span class="hs-identifier hs-var">nonCrossSegmentNoEndPt</span></a><span> </span><a href="#local-6989586621679098439"><span class="hs-identifier hs-var">sl</span></a><span> </span><a href="#local-6989586621679098440"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679098439"><span class="hs-identifier hs-var">sl</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098441"><span class="hs-identifier hs-var">cx</span></a><span>
</span><a name="line-2053"></a><span>
</span><a name="line-2054"></a><span class="hs-comment">{-|
    === Check whether a pt is inside a polygon (assume the polygon is convex)
    === This is essentially a Covex Hull problem =&gt; use Convex Hull Algorithm

    TODO: Add test cases, never test it yet
-}</span><span>
</span><a name="line-2060"></a><span class="hs-identifier">ptInsidePolygon</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2061"></a><a name="ptInsidePolygon"><a href="AronGraphic.html#ptInsidePolygon"><span class="hs-identifier">ptInsidePolygon</span></a></a><span> </span><a name="local-6989586621679098442"><a href="#local-6989586621679098442"><span class="hs-identifier">p0</span></a></a><span> </span><a name="local-6989586621679098443"><a href="#local-6989586621679098443"><span class="hs-identifier">cx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#containPt"><span class="hs-identifier hs-var">containPt</span></a><span> </span><a href="#local-6989586621679098442"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679098446"><span class="hs-identifier hs-var">cxx</span></a><span>
</span><a name="line-2062"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-2063"></a><span>        </span><a name="local-6989586621679098444"><a href="#local-6989586621679098444"><span class="hs-identifier">cx'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098443"><span class="hs-identifier hs-var">cx</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679098442"><span class="hs-identifier hs-var">p0</span></a><span class="hs-special">]</span><span>
</span><a name="line-2064"></a><span>        </span><a name="local-6989586621679098445"><a href="#local-6989586621679098445"><span class="hs-identifier">sz</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#len"><span class="hs-identifier hs-var">len</span></a><span> </span><a href="#local-6989586621679098444"><span class="hs-identifier hs-var">cx'</span></a><span>
</span><a name="line-2065"></a><span>        </span><a name="local-6989586621679098446"><a href="#local-6989586621679098446"><span class="hs-identifier">cxx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679098447"><a href="#local-6989586621679098447"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679098447"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#convexHull"><span class="hs-identifier hs-var">convexHull</span></a><span> </span><a href="#local-6989586621679098445"><span class="hs-identifier hs-var">sz</span></a><span> </span><a href="#local-6989586621679098444"><span class="hs-identifier hs-var">cx'</span></a><span>
</span><a name="line-2066"></a><span>
</span><a name="line-2067"></a><span class="hs-comment">{-|
    === Given a \(p_0\): Vertex3 and [Vertex3], check whether the list contain p0
-}</span><span>
</span><a name="line-2070"></a><span class="hs-identifier">containPt</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2071"></a><a name="containPt"><a href="AronGraphic.html#containPt"><span class="hs-identifier">containPt</span></a></a><span> </span><a name="local-6989586621679098448"><a href="#local-6989586621679098448"><span class="hs-identifier">p0</span></a></a><span> </span><a name="local-6989586621679098449"><a href="#local-6989586621679098449"><span class="hs-identifier">cx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">S.member</span><span> </span><a href="#local-6989586621679098448"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="#local-6989586621679098450"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-2072"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-2073"></a><span>        </span><a name="local-6989586621679098450"><a href="#local-6989586621679098450"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">S.fromList</span><span> </span><a href="#local-6989586621679098449"><span class="hs-identifier hs-var">cx</span></a><span>
</span><a name="line-2074"></a><span class="hs-comment">{-|
    === Projection from \(u\) onto \(v\) in Vector3
    &lt;http://localhost/pdf/projectionlatex.pdf projection&gt;
-}</span><span>
</span><a name="line-2078"></a><span class="hs-identifier">projv</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span>
</span><a name="line-2079"></a><a name="projv"><a href="AronGraphic.html#projv"><span class="hs-identifier">projv</span></a></a><span> </span><a name="local-6989586621679098451"><a href="#local-6989586621679098451"><span class="hs-identifier">u</span></a></a><span> </span><a name="local-6989586621679098452"><a href="#local-6989586621679098452"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098456"><span class="hs-identifier hs-var">w'</span></a><span>
</span><a name="line-2080"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2081"></a><span>    </span><a name="local-6989586621679098453"><a href="#local-6989586621679098453"><span class="hs-identifier">u'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#veMat"><span class="hs-identifier hs-var">veMat</span></a><span> </span><a href="#local-6989586621679098451"><span class="hs-identifier hs-var">u</span></a><span>
</span><a name="line-2082"></a><span>    </span><a name="local-6989586621679098454"><a href="#local-6989586621679098454"><span class="hs-identifier">v'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#veMat"><span class="hs-identifier hs-var">veMat</span></a><span> </span><a href="#local-6989586621679098452"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-2083"></a><span>    </span><a name="local-6989586621679098455"><a href="#local-6989586621679098455"><span class="hs-identifier">w</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#projn"><span class="hs-identifier hs-var">projn</span></a><span> </span><a href="#local-6989586621679098453"><span class="hs-identifier hs-var">u'</span></a><span> </span><a href="#local-6989586621679098454"><span class="hs-identifier hs-var">v'</span></a><span>
</span><a name="line-2084"></a><span>    </span><a name="local-6989586621679098456"><a href="#local-6989586621679098456"><span class="hs-identifier">w'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#matVe"><span class="hs-identifier hs-var">matVe</span></a><span> </span><a href="#local-6989586621679098455"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-2085"></a><span>
</span><a name="line-2086"></a><span class="hs-comment">{-|
   === Compute the norm of a vector
   \(v = (x, y, z)\)

   \(|v| = \sqrt{ x^2 + y^2 + z^2} \)
-}</span><span>
</span><a name="line-2092"></a><span class="hs-identifier">nr</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-2093"></a><a name="nr"><a href="AronGraphic.html#nr"><span class="hs-identifier">nr</span></a></a><span> </span><a name="local-6989586621679098457"><a href="#local-6989586621679098457"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sqrt</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="AronGraphic.html#dot3ve"><span class="hs-identifier hs-var">dot3ve</span></a><span> </span><a href="#local-6989586621679098457"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679098457"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-2094"></a><span>
</span><a name="line-2095"></a><span class="hs-comment">{-|
  === Normalize a vector
  e.g \( \|\vec{v}\| = 1 \)
-}</span><span>
</span><a name="line-2099"></a><span class="hs-identifier">uv</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span>
</span><a name="line-2100"></a><a name="uv"><a href="AronGraphic.html#uv"><span class="hs-identifier">uv</span></a></a><span> </span><a name="local-6989586621679098458"><a href="#local-6989586621679098458"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">/</span><a href="#local-6989586621679098459"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098458"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-2101"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-2102"></a><span>        </span><a name="local-6989586621679098459"><a href="#local-6989586621679098459"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#nr"><span class="hs-identifier hs-var">nr</span></a><span> </span><a href="#local-6989586621679098458"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-2103"></a><span class="hs-comment">{-|
    === Rodrigue formula

    \(u\) rotates around \(v\) in angle \(\phi\) in right hand rule

    rejection = \(u - p\)

    gx &lt;http://localhost/pdf/rotate_arbitrary_axis.pdf Rotation&gt;
-}</span><span>
</span><a name="line-2112"></a><a name="rod"><a href="AronGraphic.html#rod"><span class="hs-identifier">rod</span></a></a><span> </span><a name="local-6989586621679098460"><a href="#local-6989586621679098460"><span class="hs-identifier">u</span></a></a><span> </span><a name="local-6989586621679098461"><a href="#local-6989586621679098461"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679098462"><a href="#local-6989586621679098462"><span class="hs-identifier">&#952;</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098467"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-2113"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2114"></a><span>    </span><a name="local-6989586621679098463"><a href="#local-6989586621679098463"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#projv"><span class="hs-identifier hs-var">projv</span></a><span> </span><a href="#local-6989586621679098460"><span class="hs-identifier hs-var">u</span></a><span> </span><a href="#local-6989586621679098461"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-2115"></a><span>    </span><a name="local-6989586621679098464"><a href="#local-6989586621679098464"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098460"><span class="hs-identifier hs-var">u</span></a><span> </span><a href="AronGraphic.html#%2297"><span class="hs-operator hs-var">&#8855;</span></a><span> </span><a href="#local-6989586621679098461"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-comment">-- right hand rule</span><span>
</span><a name="line-2116"></a><span>    </span><a name="local-6989586621679098465"><a href="#local-6989586621679098465"><span class="hs-identifier">re</span></a></a><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098460"><span class="hs-identifier hs-var">u</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679098463"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-2117"></a><span>    </span><a name="local-6989586621679098466"><a href="#local-6989586621679098466"><span class="hs-identifier">u'</span></a></a><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">cos</span><span> </span><a href="#local-6989586621679098462"><span class="hs-identifier hs-var">&#952;</span></a><span class="hs-special">)</span><span> </span><a href="AronGraphic.html#%2A%3A"><span class="hs-operator hs-var">*:</span></a><span> </span><a href="#local-6989586621679098465"><span class="hs-identifier hs-var">re</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">sin</span><span> </span><a href="#local-6989586621679098462"><span class="hs-identifier hs-var">&#952;</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#nr"><span class="hs-identifier hs-var">nr</span></a><span> </span><a href="#local-6989586621679098465"><span class="hs-identifier hs-var">re</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="AronGraphic.html#%2A%3A"><span class="hs-operator hs-var">*:</span></a><span> </span><span class="hs-special">(</span><a href="AronGraphic.html#uv"><span class="hs-identifier hs-var">uv</span></a><span> </span><a href="#local-6989586621679098464"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2118"></a><span>    </span><a name="local-6989586621679098467"><a href="#local-6989586621679098467"><span class="hs-identifier">tv</span></a></a><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098463"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679098466"><span class="hs-identifier hs-var">u'</span></a><span>
</span><a name="line-2119"></a><span>
</span><a name="line-2120"></a><span class="hs-comment">{-|
    === Compute an angle from three points: \(a, b, c \) with dot product
    &gt;let a = Vertex3 1 0 0
    &gt;let b = Vertex3 0 0 0
    &gt;let c = Vertex3 1 0 0
    &gt;cosVex3 a b c
    &gt;0.0

    \( \vec{ba} = a - b \)

    \( \vec{bc} = c - b \)

    \[
        \begin{equation}
        \begin{aligned}
            \vec{ba} \circ \vec{bc} &amp;= | \vec{ba} | | \vec{bc} | \cos{\angle ABC}  \\
            \cos{\angle ABC} &amp;= \frac{ \vec{bc} \circ \vec{bc} }{| \vec{ba} | | \vec{bc}|} \\
        \end{aligned}
        \end{equation}
    \]

-}</span><span>
</span><a name="line-2142"></a><span class="hs-identifier">cosVex3</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span>
</span><a name="line-2143"></a><a name="cosVex3"><a href="AronGraphic.html#cosVex3"><span class="hs-identifier">cosVex3</span></a></a><span> </span><a name="local-6989586621679098468"><a href="#local-6989586621679098468"><span class="hs-identifier">p0</span></a></a><span> </span><a name="local-6989586621679098469"><a href="#local-6989586621679098469"><span class="hs-identifier">p1</span></a></a><span> </span><a name="local-6989586621679098470"><a href="#local-6989586621679098470"><span class="hs-identifier">p2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098473"><span class="hs-identifier hs-var">d</span></a><span class="hs-operator hs-var">/</span><span class="hs-special">(</span><a href="#local-6989586621679098474"><span class="hs-identifier hs-var">n1</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679098475"><span class="hs-identifier hs-var">n2</span></a><span class="hs-special">)</span><span>
</span><a name="line-2144"></a><span>                    </span><span class="hs-keyword">where</span><span>
</span><a name="line-2145"></a><span>                        </span><a name="local-6989586621679098471"><a href="#local-6989586621679098471"><span class="hs-identifier">v10</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098468"><span class="hs-identifier hs-var">p0</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679098469"><span class="hs-identifier hs-var">p1</span></a><span>
</span><a name="line-2146"></a><span>                        </span><a name="local-6989586621679098472"><a href="#local-6989586621679098472"><span class="hs-identifier">v12</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098470"><span class="hs-identifier hs-var">p2</span></a><span> </span><a href="AronGraphic.html#-%3A"><span class="hs-operator hs-var">-:</span></a><span> </span><a href="#local-6989586621679098469"><span class="hs-identifier hs-var">p1</span></a><span>
</span><a name="line-2147"></a><span>                        </span><a name="local-6989586621679098473"><a href="#local-6989586621679098473"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#dot3ve"><span class="hs-identifier hs-var">dot3ve</span></a><span> </span><a href="#local-6989586621679098471"><span class="hs-identifier hs-var">v10</span></a><span> </span><a href="#local-6989586621679098472"><span class="hs-identifier hs-var">v12</span></a><span>
</span><a name="line-2148"></a><span>                        </span><a name="local-6989586621679098474"><a href="#local-6989586621679098474"><span class="hs-identifier">n1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#nr"><span class="hs-identifier hs-var">nr</span></a><span> </span><a href="#local-6989586621679098471"><span class="hs-identifier hs-var">v10</span></a><span>
</span><a name="line-2149"></a><span>                        </span><a name="local-6989586621679098475"><a href="#local-6989586621679098475"><span class="hs-identifier">n2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronGraphic.html#nr"><span class="hs-identifier hs-var">nr</span></a><span> </span><a href="#local-6989586621679098472"><span class="hs-identifier hs-var">v12</span></a><span>
</span><a name="line-2150"></a><span>
</span><a name="line-2151"></a><span class="hs-comment">{-|
    === Find all the segments DO NOT Cross some new segments
    Current algorithm is brute force

    __NOTE__ use __Convex Hull algo__ might be faster

    __NOTE__ EnPts are excluded, please see 'intersectSegNoEndPt'

    * Given a list of segments and a point

    &lt;http://localhost/html/indexConvexHullAlgorithm.html#non_cross_segment non_cross_segment&gt;

    &lt;http://localhost/html/indexConvexHullAlgorithm.html#non_cross_segment_2 non_cross_segment_2&gt;

    Given Segments \( [(B, E), (E, A), (A, D), (D, C)] \) pt: \(F\)

    return =&gt; \( [(A, F), (F, D), (F, C)] \)

    @
    let p0 = Vertex3 0 0 0
        p1 = Vertex3 0.5 0 0
        p2 = Vertex3 0 0.5 0
        q0 = Vertex3 1 1 0
        ls = [(p0, p1), (p0, p2)]
        exp= sort [(p0, q0), (p1, q0), (p2, q0)]
        in exp == (sort $ nonCrossSegmentNoEndPt ls q0)

    let p0 = Vertex3 0 0 0
        p1 = Vertex3 0.5 0 0
        p2 = Vertex3 0 0.5 0
        q0 = Vertex3 1 1 0
        ls = [(p0, p1), (p1, p2)]
        exp= sort [(p1, q0), (p2, q0)]
        in exp == (sort $ nonCrossSegmentNoEndPt ls q0)
    @

    remove all the segments with same vertex from old segments list
    then check all the new segments with the rest of old segments list

-}</span><span>
</span><a name="line-2191"></a><span class="hs-identifier">nonCrossSegmentNoEndPt</span><span class="hs-glyph">::</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-2192"></a><span>                        </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-2193"></a><span>                        </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2194"></a><a name="nonCrossSegmentNoEndPt"><a href="AronGraphic.html#nonCrossSegmentNoEndPt"><span class="hs-identifier">nonCrossSegmentNoEndPt</span></a></a><span> </span><a name="local-6989586621679098476"><a href="#local-6989586621679098476"><span class="hs-identifier">cx</span></a></a><span> </span><a name="local-6989586621679098477"><a href="#local-6989586621679098477"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">S.toList</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679098479"><span class="hs-identifier hs-var">delSeg</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">S.fromList</span><span> </span><a href="#local-6989586621679098483"><span class="hs-identifier hs-var">newSeg</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098478"><span class="hs-identifier hs-var">badSeg</span></a><span>
</span><a name="line-2195"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-2196"></a><span>            </span><span class="hs-comment">-- Cartesian product</span><span>
</span><a name="line-2197"></a><span>            </span><span class="hs-comment">-- checkInter oldSeg newSeg = join $ map(\x -&gt; map(\y -&gt; (intersectSegNoEndPt x y) /= Nothing) oldSeg) newSeg</span><span>
</span><a name="line-2198"></a><span>            </span><a name="local-6989586621679098478"><a href="#local-6989586621679098478"><span class="hs-identifier">badSeg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679098486"><a href="#local-6989586621679098486"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679098486"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">filter</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679098487"><a href="#local-6989586621679098487"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621679098487"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679098481"><span class="hs-identifier hs-var">checkInter</span></a><span> </span><a href="#local-6989586621679098482"><span class="hs-identifier hs-var">oldSeg</span></a><span> </span><a href="#local-6989586621679098483"><span class="hs-identifier hs-var">newSeg</span></a><span>
</span><a name="line-2199"></a><span>
</span><a name="line-2200"></a><span>            </span><span class="hs-identifier">delSeg</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Set</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-2201"></a><span>                    </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-2202"></a><span>                    </span><span class="hs-identifier hs-type">Set</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span>
</span><a name="line-2203"></a><span>            </span><a name="local-6989586621679098479"><a href="#local-6989586621679098479"><span class="hs-identifier">delSeg</span></a></a><span> </span><a name="local-6989586621679098488"><a href="#local-6989586621679098488"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098488"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-2204"></a><span>            </span><span class="hs-identifier">delSeg</span><span> </span><a name="local-6989586621679098489"><a href="#local-6989586621679098489"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679098490"><a href="#local-6989586621679098490"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679098491"><a href="#local-6989586621679098491"><span class="hs-identifier">bx</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098479"><span class="hs-identifier hs-var">delSeg</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098492"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679098489"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679098490"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098491"><span class="hs-identifier hs-var">bx</span></a><span>
</span><a name="line-2205"></a><span>                </span><span class="hs-keyword">where</span><span>
</span><a name="line-2206"></a><span>                    </span><a name="local-6989586621679098492"><a href="#local-6989586621679098492"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679098493"><a href="#local-6989586621679098493"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679098494"><a href="#local-6989586621679098494"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">delete</span><span> </span><a href="#local-6989586621679098494"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679098493"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-2207"></a><span>
</span><a name="line-2208"></a><span>
</span><a name="line-2209"></a><span>            </span><span class="hs-identifier">frm</span><span class="hs-glyph">::</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-2210"></a><span>                 </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-2211"></a><span>                 </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2212"></a><span>            </span><a name="local-6989586621679098480"><a href="#local-6989586621679098480"><span class="hs-identifier">frm</span></a></a><span> </span><a name="local-6989586621679098495"><a href="#local-6989586621679098495"><span class="hs-identifier">cx</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098495"><span class="hs-identifier hs-var">cx</span></a><span>
</span><a name="line-2213"></a><span>            </span><span class="hs-identifier">frm</span><span> </span><a name="local-6989586621679098496"><a href="#local-6989586621679098496"><span class="hs-identifier">cx</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679098497"><a href="#local-6989586621679098497"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679098498"><a href="#local-6989586621679098498"><span class="hs-identifier">bx</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098480"><span class="hs-identifier hs-var">frm</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098499"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679098496"><span class="hs-identifier hs-var">cx</span></a><span> </span><a href="#local-6989586621679098497"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098498"><span class="hs-identifier hs-var">bx</span></a><span>
</span><a name="line-2214"></a><span>                </span><span class="hs-keyword">where</span><span>
</span><a name="line-2215"></a><span>                    </span><a name="local-6989586621679098499"><a href="#local-6989586621679098499"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679098500"><a href="#local-6989586621679098500"><span class="hs-identifier">cx</span></a></a><span> </span><a name="local-6989586621679098501"><a href="#local-6989586621679098501"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">filter</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679098502"><a href="#local-6989586621679098502"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679098502"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621679098501"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098500"><span class="hs-identifier hs-var">cx</span></a><span>
</span><a name="line-2216"></a><span>
</span><a name="line-2217"></a><span>            </span><a name="local-6989586621679098481"><a href="#local-6989586621679098481"><span class="hs-identifier">checkInter</span></a></a><span> </span><a name="local-6989586621679098503"><a href="#local-6989586621679098503"><span class="hs-identifier">oldSeg</span></a></a><span> </span><a name="local-6989586621679098504"><a href="#local-6989586621679098504"><span class="hs-identifier">newSeg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">join</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679098505"><a href="#local-6989586621679098505"><span class="hs-identifier">nx</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679098506"><a href="#local-6989586621679098506"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="AronGraphic.html#intersectSegNoEndPt2"><span class="hs-identifier hs-var">intersectSegNoEndPt2</span></a><span> </span><a href="#local-6989586621679098505"><span class="hs-identifier hs-var">nx</span></a><span> </span><a href="#local-6989586621679098506"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679098505"><span class="hs-identifier hs-var">nx</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098503"><span class="hs-identifier hs-var">oldSeg</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098504"><span class="hs-identifier hs-var">newSeg</span></a><span>
</span><a name="line-2218"></a><span>            </span><span class="hs-comment">-- Did not improve performance </span><span>
</span><a name="line-2219"></a><span class="hs-comment">--            checkInter oldSeg newSeg = join $ map(\nx -&gt; </span><span>
</span><a name="line-2220"></a><span class="hs-comment">--                                map(\y -&gt; ((intersectSegNoEndPt2 nx y) /= Nothing, nx)) (rmAdjacentSeg (fst nx) oldSeg)) newSeg</span><span>
</span><a name="line-2221"></a><span>            </span><a name="local-6989586621679098482"><a href="#local-6989586621679098482"><span class="hs-identifier">oldSeg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098476"><span class="hs-identifier hs-var">cx</span></a><span>         </span><span class="hs-comment">-- [(p0, p1)]</span><span>
</span><a name="line-2222"></a><span>            </span><a name="local-6989586621679098483"><a href="#local-6989586621679098483"><span class="hs-identifier">newSeg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098484"><span class="hs-identifier hs-var">mkSeg</span></a><span> </span><a href="#local-6989586621679098476"><span class="hs-identifier hs-var">cx</span></a><span> </span><a href="#local-6989586621679098477"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-comment">-- [(p0, p), (p1, p)]</span><span>
</span><a name="line-2223"></a><span>            </span><a name="local-6989586621679098484"><a href="#local-6989586621679098484"><span class="hs-identifier">mkSeg</span></a></a><span> </span><a name="local-6989586621679098507"><a href="#local-6989586621679098507"><span class="hs-identifier">cx</span></a></a><span> </span><a name="local-6989586621679098508"><a href="#local-6989586621679098508"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679098509"><a href="#local-6989586621679098509"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098509"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679098508"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679098485"><span class="hs-identifier hs-var">fv</span></a><span> </span><a href="#local-6989586621679098507"><span class="hs-identifier hs-var">cx</span></a><span> </span><span class="hs-comment">-- [(p0, p1)], p =&gt; [(p0, p), (p1, p)]</span><span>
</span><a name="line-2224"></a><span>            </span><a name="local-6989586621679098485"><a href="#local-6989586621679098485"><span class="hs-identifier">fv</span></a></a><span> </span><a name="local-6989586621679098510"><a href="#local-6989586621679098510"><span class="hs-identifier">cx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#unique"><span class="hs-identifier hs-var">unique</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">join</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679098511"><a href="#local-6989586621679098511"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621679098511"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679098511"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098510"><span class="hs-identifier hs-var">cx</span></a><span> </span><span class="hs-comment">-- [(p0, p1), (p0, p2), (p1, p2)] =&gt; [p0, p1, p2]</span><span>
</span><a name="line-2225"></a><span>
</span><a name="line-2226"></a><span class="hs-comment">{-| 
    === Remove all adjacent edges or adjacent segments from a list of segments/edges
-}</span><span>
</span><a name="line-2229"></a><span class="hs-identifier">rmAdjacentSeg</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-2230"></a><span>               </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-2231"></a><span>               </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2232"></a><a name="rmAdjacentSeg"><a href="AronGraphic.html#rmAdjacentSeg"><span class="hs-identifier">rmAdjacentSeg</span></a></a><span> </span><a name="local-6989586621679098512"><a href="#local-6989586621679098512"><span class="hs-identifier">p0</span></a></a><span> </span><a name="local-6989586621679098513"><a href="#local-6989586621679098513"><span class="hs-identifier">cx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">filter</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679098514"><a href="#local-6989586621679098514"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621679098514"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621679098512"><span class="hs-identifier hs-var">p0</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679098514"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621679098512"><span class="hs-identifier hs-var">p0</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098513"><span class="hs-identifier hs-var">cx</span></a><span>
</span><a name="line-2233"></a><span>
</span><a name="line-2234"></a><span>
</span><a name="line-2235"></a><span class="hs-comment">{-| 
    === Affine Combination on three points
    == Draw all the points inside a triangle p0 p1 p2

    The number of steps is \( n = 10 \)

    Extend it to polygon

    &lt;http://localhost/image/affine_triangle.png Affine_Triangle&gt;
-}</span><span>
</span><a name="line-2245"></a><span class="hs-identifier">affineTri</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span>
</span><a name="line-2246"></a><a name="affineTri"><a href="AronGraphic.html#affineTri"><span class="hs-identifier">affineTri</span></a></a><span> </span><a name="local-6989586621679098515"><a href="#local-6989586621679098515"><span class="hs-identifier">p0</span></a></a><span> </span><a name="local-6989586621679098516"><a href="#local-6989586621679098516"><span class="hs-identifier">p1</span></a></a><span> </span><a name="local-6989586621679098517"><a href="#local-6989586621679098517"><span class="hs-identifier">p2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AronModule.html#unique"><span class="hs-identifier hs-var">unique</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">join</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679098526"><a href="#local-6989586621679098526"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679098527"><a href="#local-6989586621679098527"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679098527"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679098526"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679098518"><span class="hs-identifier hs-var">mu</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679098526"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679098527"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098515"><span class="hs-identifier hs-var">p0</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098518"><span class="hs-identifier hs-var">mu</span></a><span> </span><a href="#local-6989586621679098526"><span class="hs-identifier hs-var">h</span></a><span> </span><a href="#local-6989586621679098516"><span class="hs-identifier hs-var">p1</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098518"><span class="hs-identifier hs-var">mu</span></a><span> </span><a href="#local-6989586621679098527"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679098517"><span class="hs-identifier hs-var">p2</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679098515"><span class="hs-identifier hs-var">p0</span></a><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098520"><span class="hs-identifier hs-var">tt</span></a><span> </span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098519"><span class="hs-identifier hs-var">hh</span></a><span>
</span><a name="line-2247"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-2248"></a><span>        </span><a name="local-6989586621679098518"><a href="#local-6989586621679098518"><span class="hs-identifier">mu</span></a></a><span> </span><a name="local-6989586621679098521"><a href="#local-6989586621679098521"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679098522"><a href="#local-6989586621679098522"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679098521"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679098522"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-2249"></a><span>
</span><a name="line-2250"></a><span>        </span><span class="hs-identifier">hh</span><span class="hs-glyph">::</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Float</span><span class="hs-special">]</span><span>
</span><a name="line-2251"></a><span>        </span><a name="local-6989586621679098519"><a href="#local-6989586621679098519"><span class="hs-identifier">hh</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679098525"><a href="#local-6989586621679098525"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679098525"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679098523"><span class="hs-identifier hs-var">del</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><a href="#local-6989586621679098524"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span>
</span><a name="line-2252"></a><span>            </span><span class="hs-keyword">where</span><span>
</span><a name="line-2253"></a><span>                </span><a name="local-6989586621679098523"><a href="#local-6989586621679098523"><span class="hs-identifier">del</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span class="hs-operator hs-var">/</span><a href="#local-6989586621679098524"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">;</span><span>
</span><a name="line-2254"></a><span>                </span><a name="local-6989586621679098524"><a href="#local-6989586621679098524"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">10</span><span class="hs-special">;</span><span>
</span><a name="line-2255"></a><span>        </span><a name="local-6989586621679098520"><a href="#local-6989586621679098520"><span class="hs-identifier">tt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679098519"><span class="hs-identifier hs-var">hh</span></a><span>
</span><a name="line-2256"></a><span>
</span><a name="line-2257"></a><span>
</span><a name="line-2258"></a><span>
</span><a name="line-2259"></a><span class="hs-comment">{-| 
    === Draw all segments from Vertex3 a To Vertex3 b
-}</span><span>
</span><a name="line-2262"></a><span class="hs-identifier">drawSegmentFromTo</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Color3</span><span> </span><span class="hs-identifier hs-type">GLdouble</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2263"></a><a name="drawSegmentFromTo"><a href="AronGraphic.html#drawSegmentFromTo"><span class="hs-identifier">drawSegmentFromTo</span></a></a><span> </span><a name="local-6989586621679098528"><a href="#local-6989586621679098528"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679098529"><a href="#local-6989586621679098529"><span class="hs-identifier">cx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2264"></a><span>                            </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679098530"><a href="#local-6989586621679098530"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679098529"><span class="hs-identifier hs-var">cx</span></a><span>
</span><a name="line-2265"></a><span>                            </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679098531"><a href="#local-6989586621679098531"><span class="hs-identifier">pair</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">join</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zipWith</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679098532"><a href="#local-6989586621679098532"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679098533"><a href="#local-6989586621679098533"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679098532"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679098533"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">init</span><span> </span><a href="#local-6989586621679098529"><span class="hs-identifier hs-var">cx</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tail</span><span> </span><a href="#local-6989586621679098529"><span class="hs-identifier hs-var">cx</span></a><span class="hs-special">)</span><span>
</span><a name="line-2266"></a><span>                            </span><span class="hs-identifier hs-var">mapM_</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679098534"><a href="#local-6989586621679098534"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="AronGraphic.html#drawCircleColor"><span class="hs-identifier hs-var">drawCircleColor</span></a><span> </span><a href="#local-6989586621679098534"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="AronGraphic.html#red"><span class="hs-identifier hs-var">red</span></a><span> </span><span class="hs-number">0.002</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679098531"><span class="hs-identifier hs-var">pair</span></a><span>
</span><a name="line-2267"></a><span>                            </span><a href="AronGraphic.html#drawPrimitive%27"><span class="hs-identifier hs-var">drawPrimitive'</span></a><span> </span><span class="hs-identifier hs-var">Lines</span><span> </span><a href="#local-6989586621679098528"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679098531"><span class="hs-identifier hs-var">pair</span></a><span>
</span><a name="line-2268"></a><span>                            </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679098535"><a href="#local-6989586621679098535"><span class="hs-identifier">one</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679098531"><span class="hs-identifier hs-var">pair</span></a><span>
</span><a name="line-2269"></a><span>                            </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679098536"><a href="#local-6989586621679098536"><span class="hs-identifier">las</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">last</span><span> </span><a href="#local-6989586621679098531"><span class="hs-identifier hs-var">pair</span></a><span>
</span><a name="line-2270"></a><span>                            </span><a href="AronGraphic.html#drawCircleColor"><span class="hs-identifier hs-var">drawCircleColor</span></a><span> </span><a href="#local-6989586621679098535"><span class="hs-identifier hs-var">one</span></a><span> </span><a href="AronGraphic.html#green"><span class="hs-identifier hs-var">green</span></a><span> </span><span class="hs-number">0.005</span><span>
</span><a name="line-2271"></a><span>                            </span><a href="AronGraphic.html#drawCircleColor"><span class="hs-identifier hs-var">drawCircleColor</span></a><span> </span><a href="#local-6989586621679098536"><span class="hs-identifier hs-var">las</span></a><span> </span><a href="AronGraphic.html#blue"><span class="hs-identifier hs-var">blue</span></a><span> </span><span class="hs-number">0.014</span><span>
</span><a name="line-2272"></a><span>
</span><a name="line-2273"></a><span class="hs-comment">{-| 
    === 2d grid on x-y-plane, z=0
    == draw grid

    &gt;mapM_ (\row -&gt; drawSegmentFromTo red row ) grid 
    &gt;mapM_ (\row -&gt; drawSegmentFromTo red row ) $ tran grid 
-}</span><span>
</span><a name="line-2280"></a><span class="hs-identifier">grid</span><span class="hs-glyph">::</span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-2281"></a><a name="grid"><a href="AronGraphic.html#grid"><span class="hs-identifier">grid</span></a></a><span> </span><span class="hs-glyph">=</span><span class="hs-special">[</span><span class="hs-special">[</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679098545"><a href="#local-6989586621679098545"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="AronModule.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="#local-6989586621679098544"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679098543"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><span class="hs-special">(</span><a href="AronModule.html#re"><span class="hs-identifier hs-var">re</span></a><span> </span><a href="#local-6989586621679098545"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="AronModule.html#im"><span class="hs-identifier hs-var">im</span></a><span> </span><a href="#local-6989586621679098545"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679098544"><a href="#local-6989586621679098544"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679098539"><span class="hs-identifier hs-var">aa</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679098543"><a href="#local-6989586621679098543"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679098540"><span class="hs-identifier hs-var">bb</span></a><span class="hs-special">]</span><span>
</span><a name="line-2282"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-2283"></a><span>            </span><a name="local-6989586621679098537"><a href="#local-6989586621679098537"><span class="hs-identifier">n</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">10</span><span>
</span><a name="line-2284"></a><span>            </span><a name="local-6989586621679098538"><a href="#local-6989586621679098538"><span class="hs-identifier">fa</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span class="hs-operator hs-var">/</span><span class="hs-special">(</span><span class="hs-number">1.5</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679098537"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-2285"></a><span>            </span><a name="local-6989586621679098539"><a href="#local-6989586621679098539"><span class="hs-identifier">aa</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679098541"><a href="#local-6989586621679098541"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679098538"><span class="hs-identifier hs-var">fa</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679098541"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">-</span><a href="#local-6989586621679098537"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">..</span><a href="#local-6989586621679098537"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span>
</span><a name="line-2286"></a><span>            </span><a name="local-6989586621679098540"><a href="#local-6989586621679098540"><span class="hs-identifier">bb</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679098542"><a href="#local-6989586621679098542"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679098538"><span class="hs-identifier hs-var">fa</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679098542"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">-</span><a href="#local-6989586621679098537"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">..</span><a href="#local-6989586621679098537"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span>
</span><a name="line-2287"></a><span>
</span><a name="line-2288"></a><span class="hs-identifier">grid2</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-2289"></a><a name="grid2"><a href="AronGraphic.html#grid2"><span class="hs-identifier">grid2</span></a></a><span> </span><a name="local-6989586621679098546"><a href="#local-6989586621679098546"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span class="hs-special">[</span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a href="#local-6989586621679098554"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679098553"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098546"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679098554"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679098553"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679098554"><a href="#local-6989586621679098554"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679098549"><span class="hs-identifier hs-var">aa</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679098553"><a href="#local-6989586621679098553"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679098550"><span class="hs-identifier hs-var">bb</span></a><span class="hs-special">]</span><span>
</span><a name="line-2290"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-2291"></a><span>            </span><a name="local-6989586621679098547"><a href="#local-6989586621679098547"><span class="hs-identifier">n</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">10</span><span>
</span><a name="line-2292"></a><span>            </span><a name="local-6989586621679098548"><a href="#local-6989586621679098548"><span class="hs-identifier">fa</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span class="hs-operator hs-var">/</span><span class="hs-special">(</span><span class="hs-number">1.5</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679098547"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-2293"></a><span>            </span><a name="local-6989586621679098549"><a href="#local-6989586621679098549"><span class="hs-identifier">aa</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679098551"><a href="#local-6989586621679098551"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679098548"><span class="hs-identifier hs-var">fa</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679098551"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">-</span><a href="#local-6989586621679098547"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">..</span><a href="#local-6989586621679098547"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span>
</span><a name="line-2294"></a><span>            </span><a name="local-6989586621679098550"><a href="#local-6989586621679098550"><span class="hs-identifier">bb</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679098552"><a href="#local-6989586621679098552"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679098548"><span class="hs-identifier hs-var">fa</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679098552"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">-</span><a href="#local-6989586621679098547"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">..</span><a href="#local-6989586621679098547"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span>
</span><a name="line-2295"></a><span>
</span><a name="line-2296"></a><span class="hs-comment">{-| 
    === grid 2d with ratio: 

    &gt;r = 1  =&gt; 1/(r*n) =&gt; 1/n
    &gt;r = 2  =&gt; 1/(2*n) 
-}</span><span>
</span><a name="line-2302"></a><span class="hs-identifier">grid2Ratio</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Vertex3</span><span> </span><span class="hs-identifier hs-type">GLfloat</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-2303"></a><a name="grid2Ratio"><a href="AronGraphic.html#grid2Ratio"><span class="hs-identifier">grid2Ratio</span></a></a><span> </span><a name="local-6989586621679098555"><a href="#local-6989586621679098555"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679098556"><a href="#local-6989586621679098556"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span class="hs-special">[</span><span class="hs-special">[</span><span> </span><span class="hs-identifier hs-var">Vertex3</span><span> </span><a href="#local-6989586621679098564"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679098563"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679098555"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679098564"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679098563"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679098564"><a href="#local-6989586621679098564"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679098559"><span class="hs-identifier hs-var">aa</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679098563"><a href="#local-6989586621679098563"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679098560"><span class="hs-identifier hs-var">bb</span></a><span class="hs-special">]</span><span>
</span><a name="line-2304"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-2305"></a><span>            </span><a name="local-6989586621679098557"><a href="#local-6989586621679098557"><span class="hs-identifier">n</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">10</span><span>
</span><a name="line-2306"></a><span>            </span><a name="local-6989586621679098558"><a href="#local-6989586621679098558"><span class="hs-identifier">fa</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span class="hs-operator hs-var">/</span><span class="hs-special">(</span><a href="#local-6989586621679098556"><span class="hs-identifier hs-var">r</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679098557"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-2307"></a><span>            </span><a name="local-6989586621679098559"><a href="#local-6989586621679098559"><span class="hs-identifier">aa</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679098561"><a href="#local-6989586621679098561"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679098558"><span class="hs-identifier hs-var">fa</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679098561"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">-</span><a href="#local-6989586621679098557"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">..</span><a href="#local-6989586621679098557"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span>
</span><a name="line-2308"></a><span>            </span><a name="local-6989586621679098560"><a href="#local-6989586621679098560"><span class="hs-identifier">bb</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679098562"><a href="#local-6989586621679098562"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679098558"><span class="hs-identifier hs-var">fa</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679098562"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">-</span><a href="#local-6989586621679098557"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">..</span><a href="#local-6989586621679098557"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span>
</span><a name="line-2309"></a><span>
</span><a name="line-2310"></a><span>
</span><a name="line-2311"></a><span>
</span><a name="line-2312"></a></pre></body></html>