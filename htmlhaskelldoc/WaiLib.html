<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>WaiLib</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/WaiLib.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption empty">&nbsp;</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr></table><p class="caption">WaiLib</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>The Module contains all the functios for <strong>wai.hs</strong></p><ul><li>Use Aeson to serialize record to Json</li><li>Record: Person</li><li>Insert data to MySqlit-simple file-based database</li><li>Upload file to server.</li><li>Use Redis(memcached) to store snippet and query snippet.</li></ul></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:Block">Block</a> = <a href="#v:Block">Block</a> {<ul class="subs"><li><a href="#v:bblock">bblock</a> :: [Text]</li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:MBlock">MBlock</a> = <a href="#v:MBlock">MBlock</a> {<ul class="subs"><li><a href="#v:mblock">mblock</a> :: [Integer]</li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:GeneMatrix">GeneMatrix</a> = <a href="#v:GeneMatrix">GeneMatrix</a> {<ul class="subs"><li><a href="#v:cmd">cmd</a> :: Text</li><li><a href="#v:ncol">ncol</a> :: Integer</li><li><a href="#v:nrow">nrow</a> :: Integer</li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:ReplyCode">ReplyCode</a> = <a href="#v:ReplyCode">ReplyCode</a> {<ul class="subs"><li><a href="#v:rcmd">rcmd</a> :: Text</li><li><a href="#v:rerror">rerror</a> :: Text</li><li><a href="#v:stdout">stdout</a> :: Text</li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:CompileCode">CompileCode</a> = <a href="#v:CompileCode">CompileCode</a> {<ul class="subs"><li><a href="#v:compiler">compiler</a> :: Text</li><li><a href="#v:option">option</a> :: Text</li><li><a href="#v:code">code</a> :: Text</li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:MatInt">MatInt</a> = <a href="#v:MatInt">MatInt</a> {<ul class="subs"><li><a href="#v:name">name</a> :: Text</li><li><a href="#v:matrix">matrix</a> :: [[Integer]]</li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:Person">Person</a> = <a href="#v:Person">Person</a> {<ul class="subs"><li><a href="#v:personId">personId</a> :: Int64</li><li><a href="#v:personName">personName</a> :: Text</li><li><a href="#v:personAge">personAge</a> :: Text</li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:UserInput">UserInput</a> = <a href="#v:UserInput">UserInput</a> {<ul class="subs"><li><a href="#v:cmdId">cmdId</a> :: Int64</li><li><a href="#v:xcmd">xcmd</a> :: Text</li></ul>}</li><li class="src short"><a href="#v:updir">updir</a> :: String</li><li class="src short"><a href="#v:runSh">runSh</a> :: Text -&gt; IO (ExitCode, Text, Text)</li><li class="src short"><a href="#v:styleChar">styleChar</a> :: String -&gt; String -&gt; Char -&gt; Char -&gt; String -&gt; String</li><li class="src short"><a href="#v:href">href</a> :: String -&gt; String -&gt; String -&gt; String</li><li class="src short"><a href="#v:changeSymbol">changeSymbol</a> :: String -&gt; String</li><li class="src short"><a href="#v:listToByteStr">listToByteStr</a> :: [[String]] -&gt; ByteString</li><li class="src short"><a href="#v:cssStrong">cssStrong</a> :: String -&gt; String</li><li class="src short"><a href="#v:cssHead">cssHead</a> :: [[String]] -&gt; [[String]]</li><li class="src short"><a href="#v:htmlLess">htmlLess</a> :: [[String]] -&gt; [[String]]</li><li class="src short"><a href="#v:htmlGreater">htmlGreater</a> :: [[String]] -&gt; [[String]]</li><li class="src short"><a href="#v:keyWord">keyWord</a> :: [[String]] -&gt; [[String]]</li><li class="src short"><a href="#v:keyWord1">keyWord1</a> :: [[String]] -&gt; [[String]]</li><li class="src short"><a href="#v:keyDash">keyDash</a> :: [[String]] -&gt; [[String]]</li><li class="src short"><a href="#v:keySymbol1">keySymbol1</a> :: [[String]] -&gt; [[String]]</li><li class="src short"><a href="#v:keyName">keyName</a> :: [[String]] -&gt; [[String]]</li><li class="src short"><a href="#v:specialName">specialName</a> :: [[String]] -&gt; [[String]]</li><li class="src short"><a href="#v:javaClassName">javaClassName</a> :: [[String]] -&gt; [[String]]</li><li class="src short"><a href="#v:javaFunClass">javaFunClass</a> :: [[String]] -&gt; [[String]]</li><li class="src short"><a href="#v:javaKeyWords">javaKeyWords</a> :: [[String]] -&gt; [[String]]</li><li class="src short"><a href="#v:javaCmdKeyWords">javaCmdKeyWords</a> :: [[String]] -&gt; [[String]]</li><li class="src short"><a href="#v:mysqlKeyWords">mysqlKeyWords</a> :: [[String]] -&gt; [[String]]</li><li class="src short"><a href="#v:keyURL">keyURL</a> :: [[String]] -&gt; [[String]]</li><li class="src short"><a href="#v:spChar">spChar</a> :: [[String]] -&gt; [[String]]</li><li class="src short"><a href="#v:bracketChar">bracketChar</a> :: [[String]] -&gt; [[String]]</li><li class="src short"><a href="#v:sbChar">sbChar</a> :: [[String]] -&gt; [[String]]</li><li class="src short"><a href="#v:transform">transform</a> :: [[String]] -&gt; [[String]]</li><li class="src short"><a href="#v:hiddenForm">hiddenForm</a> :: Integer -&gt; String -&gt; String</li><li class="src short"><a href="#v:foldListList">foldListList</a> :: ([[String]] -&gt; [[String]]) -&gt; [[String]] -&gt; String</li><li class="src short"><a href="#v:foldListListTxt">foldListListTxt</a> :: [[String]] -&gt; String</li><li class="src short"><a href="#v:preT">preT</a> :: [Char] -&gt; [Char]</li><li class="src short"><a href="#v:divT">divT</a> :: [Char] -&gt; [Char]</li><li class="src short"><a href="#v:divC">divC</a> :: [Char] -&gt; [Char]</li><li class="src short"><a href="#v:tableT">tableT</a> :: [Char] -&gt; [Char]</li><li class="src short"><a href="#v:tableC">tableC</a> :: [Char] -&gt; [Char]</li><li class="src short"><a href="#v:tableAC">tableAC</a> :: [Char] -&gt; [Char] -&gt; [Char]</li><li class="src short"><a href="#v:tdT">tdT</a> :: [Char] -&gt; [Char]</li><li class="src short"><a href="#v:tdC">tdC</a> :: [Char] -&gt; [Char]</li><li class="src short"><a href="#v:tdAC">tdAC</a> :: [Char] -&gt; [Char] -&gt; [Char]</li><li class="src short"><a href="#v:trC">trC</a> :: [Char] -&gt; [Char]</li><li class="src short"><a href="#v:id_">id_</a> :: [Char] -&gt; [Char]</li><li class="src short"><a href="#v:class_">class_</a> :: [Char] -&gt; [Char]</li><li class="src short"><a href="#v:onclick_">onclick_</a> :: [Char] -&gt; [Char]</li><li class="src short"><a href="#v:style_">style_</a> :: Foldable t =&gt; t [Char] -&gt; [Char]</li><li class="src short"><a href="#v:align_">align_</a> :: [Char] -&gt; [Char]</li><li class="src short"><a href="#v:table">table</a> :: [[String]] -&gt; String</li><li class="src short"><a href="#v:pdfname">pdfname</a> :: String</li><li class="src short"><a href="#v:img">img</a> :: String</li><li class="src short"><a href="#v:wapp">wapp</a> :: FilePath</li><li class="src short"><a href="#v:pdfPath">pdfPath</a> :: [Char]</li><li class="src short"><a href="#v:docRoot">docRoot</a> :: [Char]</li><li class="src short"><a href="#v:doc">doc</a> :: FilePath</li><li class="src short"><a href="#v:cmdLog">cmdLog</a> :: FilePath</li><li class="src short"><a href="#v:currCmdFile">currCmdFile</a> :: FilePath</li><li class="src short"><a href="#v:logCurrCmd">logCurrCmd</a> :: [String] -&gt; IO ()</li><li class="src short"><a href="#v:readCurrCmd">readCurrCmd</a> :: IO String</li><li class="src short"><span class="keyword">type</span> <a href="#t:HMap">HMap</a> = HashMap String [[String]]</li><li class="src short"><a href="#v:genePDF">genePDF</a> :: String -&gt; IO ()</li><li class="src short"><a href="#v:app">app</a> :: Connection -&gt; Connection -&gt; IORef <a href="WaiLib.html#t:HMap" title="WaiLib">HMap</a> -&gt; Application</li><li class="src short"><a href="#v:plainIndex">plainIndex</a> :: Response</li><li class="src short"><a href="#v:pdfFile">pdfFile</a> :: Response</li><li class="src short"><a href="#v:insertinfo">insertinfo</a> :: Response</li><li class="src short"><a href="#v:searchUI">searchUI</a> :: Response</li><li class="src short"><a href="#v:notFound">notFound</a> :: Response</li><li class="src short"><a href="#v:notFoundStr">notFoundStr</a> :: ByteString -&gt; Response</li><li class="src short"><a href="#v:snippetPath">snippetPath</a> :: FilePath</li><li class="src short"><a href="#v:insertAll">insertAll</a> :: [(String, [[String]])] -&gt; <a href="WaiLib.html#t:HMap" title="WaiLib">HMap</a> -&gt; <a href="WaiLib.html#t:HMap" title="WaiLib">HMap</a></li><li class="src short"><a href="#v:mapClear">mapClear</a> :: [String] -&gt; <a href="WaiLib.html#t:HMap" title="WaiLib">HMap</a> -&gt; <a href="WaiLib.html#t:HMap" title="WaiLib">HMap</a></li><li class="src short"><a href="#v:snippetMap">snippetMap</a> :: [([String], [String])] -&gt; IORef <a href="WaiLib.html#t:HMap" title="WaiLib">HMap</a> -&gt; IO ()</li><li class="src short"><a href="#v:spanBlock">spanBlock</a> :: <a href="WaiLib.html#t:HMap" title="WaiLib">HMap</a> -&gt; Maybe ByteString -&gt; String</li><li class="src short"><a href="#v:spanBlockX">spanBlockX</a> :: ([[String]] -&gt; [[String]]) -&gt; <a href="WaiLib.html#t:HMap" title="WaiLib">HMap</a> -&gt; Maybe ByteString -&gt; String</li><li class="src short"><a href="#v:spanBlockXX">spanBlockXX</a> :: <a href="WaiLib.html#t:HMap" title="WaiLib">HMap</a> -&gt; Maybe ByteString -&gt; String</li><li class="src short"><a href="#v:-8728-">(&#8728;)</a> :: [a] -&gt; [a] -&gt; [a]</li><li class="src short"><a href="#v:htmlForm">htmlForm</a> :: String -&gt; String</li><li class="src short"><a href="#v:htmlPre">htmlPre</a> :: String -&gt; String</li><li class="src short"><a href="#v:htmlBody">htmlBody</a> :: String -&gt; String</li><li class="src short"><a href="#v:replyHtml">replyHtml</a> :: String -&gt; String -&gt; String</li><li class="src short"><a href="#v:anyRoute">anyRoute</a> :: Connection -&gt; IORef <a href="WaiLib.html#t:HMap" title="WaiLib">HMap</a> -&gt; Request -&gt; Response</li><li class="src short"><a href="#v:uploadPage">uploadPage</a> :: Response</li><li class="src short"><span class="keyword">data</span> <a href="#t:SearchType">SearchType</a><ul class="subs"><li>= <a href="#v:CmdT">CmdT</a></li><li>| <a href="#v:JavaT">JavaT</a></li><li>| <a href="#v:HaskellT">HaskellT</a></li><li>| <a href="#v:SnippetT">SnippetT</a></li></ul></li><li class="src short"><a href="#v:readCmd">readCmd</a> :: FilePath -&gt; <a href="WaiLib.html#t:SearchType" title="WaiLib">SearchType</a> -&gt; IO String</li><li class="src short"><a href="#v:groupCountFilter">groupCountFilter</a> :: [String] -&gt; [String]</li><li class="src short"><a href="#v:optionHtml">optionHtml</a> :: [String] -&gt; String</li><li class="src short"><a href="#v:responseNothing">responseNothing</a> :: String -&gt; Response</li><li class="src short"><a href="#v:responseNothingBS">responseNothingBS</a> :: ByteString -&gt; Response</li><li class="src short"><a href="#v:responseCmd">responseCmd</a> :: Connection -&gt; String -&gt; Response</li><li class="src short"><a href="#v:responseXCmd">responseXCmd</a> :: String -&gt; Response</li><li class="src short"><a href="#v:responseJavaHtml">responseJavaHtml</a> :: String -&gt; Response</li><li class="src short"><a href="#v:responseHaskellHtml">responseHaskellHtml</a> :: String -&gt; Response</li><li class="src short"><a href="#v:queryLibHaskell">queryLibHaskell</a> :: String -&gt; Response</li><li class="src short"><a href="#v:queryLibJava">queryLibJava</a> :: String -&gt; Response</li><li class="src short"><a href="#v:responseSnippet">responseSnippet</a> :: Connection -&gt; String -&gt; IORef <a href="WaiLib.html#t:HMap" title="WaiLib">HMap</a> -&gt; Response</li><li class="src short"><a href="#v:responseSnippetTxt">responseSnippetTxt</a> :: String -&gt; IORef <a href="WaiLib.html#t:HMap" title="WaiLib">HMap</a> -&gt; Response</li><li class="src short"><a href="#v:trimBothLBS">trimBothLBS</a> :: ByteString -&gt; ByteString</li><li class="src short"><a href="#v:geneRectMat">geneRectMat</a> :: Application</li><li class="src short"><a href="#v:receiveCode">receiveCode</a> :: Application</li><li class="src short"><a href="#v:receiveCode2">receiveCode2</a> :: Application</li><li class="src short"><a href="#v:responseEditor">responseEditor</a> :: Response</li><li class="src short"><a href="#v:responseJavascript">responseJavascript</a> :: FilePath -&gt; Response</li><li class="src short"><a href="#v:responseHtml">responseHtml</a> :: FilePath -&gt; Response</li><li class="src short"><a href="#v:updateMap">updateMap</a> :: IORef <a href="WaiLib.html#t:HMap" title="WaiLib">HMap</a> -&gt; Application</li><li class="src short"><a href="#v:replyEditor">replyEditor</a> :: Response</li><li class="src short"><a href="#v:responseHelp">responseHelp</a> :: Response</li><li class="src short"><a href="#v:replyCssButton">replyCssButton</a> :: Response</li><li class="src short"><a href="#v:wordcountReply">wordcountReply</a> :: Response</li><li class="src short"><a href="#v:matrixReply">matrixReply</a> :: Response</li><li class="src short"><a href="#v:replyJS">replyJS</a> :: Response</li><li class="src short"><a href="#v:insertDatabase">insertDatabase</a> :: Connection -&gt; Application</li><li class="src short"><a href="#v:upload">upload</a> :: String -&gt; Application</li><li class="src short"><a href="#v:searchMap">searchMap</a> :: Application</li><li class="src short"><span class="keyword">type</span> <a href="#t:ClientId">ClientId</a> = Int</li><li class="src short"><span class="keyword">type</span> <a href="#t:Client">Client</a> = (<a href="WaiLib.html#t:ClientId" title="WaiLib">ClientId</a>, Connection)</li><li class="src short"><span class="keyword">type</span> <a href="#t:State">State</a> = [<a href="WaiLib.html#t:Client" title="WaiLib">Client</a>]</li><li class="src short"><a href="#v:connectClient">connectClient</a> :: Connection -&gt; MVar <a href="WaiLib.html#t:State" title="WaiLib">State</a> -&gt; IO <a href="WaiLib.html#t:ClientId" title="WaiLib">ClientId</a></li><li class="src short"><a href="#v:withoutClient">withoutClient</a> :: <a href="WaiLib.html#t:ClientId" title="WaiLib">ClientId</a> -&gt; <a href="WaiLib.html#t:State" title="WaiLib">State</a> -&gt; <a href="WaiLib.html#t:State" title="WaiLib">State</a></li><li class="src short"><a href="#v:disconnectClient">disconnectClient</a> :: <a href="WaiLib.html#t:ClientId" title="WaiLib">ClientId</a> -&gt; MVar <a href="WaiLib.html#t:State" title="WaiLib">State</a> -&gt; IO ()</li><li class="src short"><a href="#v:nextId">nextId</a> :: <a href="WaiLib.html#t:State" title="WaiLib">State</a> -&gt; <a href="WaiLib.html#t:ClientId" title="WaiLib">ClientId</a></li><li class="src short"><a href="#v:httpApp">httpApp</a> :: Application</li><li class="src short"><a href="#v:listen">listen</a> :: Connection -&gt; <a href="WaiLib.html#t:ClientId" title="WaiLib">ClientId</a> -&gt; MVar <a href="WaiLib.html#t:State" title="WaiLib">State</a> -&gt; IO ()</li><li class="src short"><a href="#v:broadcast">broadcast</a> :: <a href="WaiLib.html#t:ClientId" title="WaiLib">ClientId</a> -&gt; MVar <a href="WaiLib.html#t:State" title="WaiLib">State</a> -&gt; Text -&gt; IO ()</li><li class="src short"><a href="#v:wsApp">wsApp</a> :: MVar <a href="WaiLib.html#t:State" title="WaiLib">State</a> -&gt; ServerApp</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Block" class="def">Block</a> <a href="src/WaiLib.html#Block" class="link">Source</a> <a href="#t:Block" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Block" class="def">Block</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:bblock" class="def">bblock</a> :: [Text]</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><details id="i:Block" open="open"><summary>Instances</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Block:Show:1"></span> Show <a href="WaiLib.html#t:Block" title="WaiLib">Block</a></span> <a href="src/WaiLib.html#line-98" class="link">Source</a> <a href="#t:Block" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Block:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: Int -&gt; <a href="WaiLib.html#t:Block" title="WaiLib">Block</a> -&gt; ShowS</p><p class="src"><a href="#v:show">show</a> :: <a href="WaiLib.html#t:Block" title="WaiLib">Block</a> -&gt; String</p><p class="src"><a href="#v:showList">showList</a> :: [<a href="WaiLib.html#t:Block" title="WaiLib">Block</a>] -&gt; ShowS</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Block:Generic:2"></span> Generic <a href="WaiLib.html#t:Block" title="WaiLib">Block</a></span> <a href="src/WaiLib.html#line-98" class="link">Source</a> <a href="#t:Block" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Block:Generic:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> Rep <a href="WaiLib.html#t:Block" title="WaiLib">Block</a> :: * -&gt; *</p></div> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:from">from</a> :: <a href="WaiLib.html#t:Block" title="WaiLib">Block</a> -&gt; Rep <a href="WaiLib.html#t:Block" title="WaiLib">Block</a> x</p><p class="src"><a href="#v:to">to</a> :: Rep <a href="WaiLib.html#t:Block" title="WaiLib">Block</a> x -&gt; <a href="WaiLib.html#t:Block" title="WaiLib">Block</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Block:ToJSON:3"></span> ToJSON <a href="WaiLib.html#t:Block" title="WaiLib">Block</a></span> <a href="src/WaiLib.html#line-138" class="link">Source</a> <a href="#t:Block" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Block:ToJSON:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:toJSON">toJSON</a> :: <a href="WaiLib.html#t:Block" title="WaiLib">Block</a> -&gt; Value</p><p class="src"><a href="#v:toEncoding">toEncoding</a> :: <a href="WaiLib.html#t:Block" title="WaiLib">Block</a> -&gt; Encoding</p><p class="src"><a href="#v:toJSONList">toJSONList</a> :: [<a href="WaiLib.html#t:Block" title="WaiLib">Block</a>] -&gt; Value</p><p class="src"><a href="#v:toEncodingList">toEncodingList</a> :: [<a href="WaiLib.html#t:Block" title="WaiLib">Block</a>] -&gt; Encoding</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Block:FromJSON:4"></span> FromJSON <a href="WaiLib.html#t:Block" title="WaiLib">Block</a></span> <a href="src/WaiLib.html#line-137" class="link">Source</a> <a href="#t:Block" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Block:FromJSON:4"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:parseJSON">parseJSON</a> :: Value -&gt; Parser <a href="WaiLib.html#t:Block" title="WaiLib">Block</a></p><p class="src"><a href="#v:parseJSONList">parseJSONList</a> :: Value -&gt; Parser [<a href="WaiLib.html#t:Block" title="WaiLib">Block</a>]</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Block:Rep:5"></span> <span class="keyword">type</span> Rep <a href="WaiLib.html#t:Block" title="WaiLib">Block</a></span> <a href="src/WaiLib.html#line-98" class="link">Source</a> <a href="#t:Block" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Block:Rep:5"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="src"><span class="keyword">type</span> Rep <a href="WaiLib.html#t:Block" title="WaiLib">Block</a> = D1 (MetaData &quot;Block&quot; &quot;WaiLib&quot; &quot;main&quot; False) (C1 (MetaCons &quot;Block&quot; PrefixI True) (S1 (MetaSel (Just &quot;bblock&quot;) NoSourceUnpackedness NoSourceStrictness DecidedLazy) (Rec0 [Text])))</div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:MBlock" class="def">MBlock</a> <a href="src/WaiLib.html#MBlock" class="link">Source</a> <a href="#t:MBlock" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:MBlock" class="def">MBlock</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:mblock" class="def">mblock</a> :: [Integer]</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><details id="i:MBlock" open="open"><summary>Instances</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MBlock:Show:1"></span> Show <a href="WaiLib.html#t:MBlock" title="WaiLib">MBlock</a></span> <a href="src/WaiLib.html#line-99" class="link">Source</a> <a href="#t:MBlock" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MBlock:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: Int -&gt; <a href="WaiLib.html#t:MBlock" title="WaiLib">MBlock</a> -&gt; ShowS</p><p class="src"><a href="#v:show">show</a> :: <a href="WaiLib.html#t:MBlock" title="WaiLib">MBlock</a> -&gt; String</p><p class="src"><a href="#v:showList">showList</a> :: [<a href="WaiLib.html#t:MBlock" title="WaiLib">MBlock</a>] -&gt; ShowS</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MBlock:Generic:2"></span> Generic <a href="WaiLib.html#t:MBlock" title="WaiLib">MBlock</a></span> <a href="src/WaiLib.html#line-99" class="link">Source</a> <a href="#t:MBlock" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MBlock:Generic:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> Rep <a href="WaiLib.html#t:MBlock" title="WaiLib">MBlock</a> :: * -&gt; *</p></div> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:from">from</a> :: <a href="WaiLib.html#t:MBlock" title="WaiLib">MBlock</a> -&gt; Rep <a href="WaiLib.html#t:MBlock" title="WaiLib">MBlock</a> x</p><p class="src"><a href="#v:to">to</a> :: Rep <a href="WaiLib.html#t:MBlock" title="WaiLib">MBlock</a> x -&gt; <a href="WaiLib.html#t:MBlock" title="WaiLib">MBlock</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MBlock:ToJSON:3"></span> ToJSON <a href="WaiLib.html#t:MBlock" title="WaiLib">MBlock</a></span> <a href="src/WaiLib.html#line-146" class="link">Source</a> <a href="#t:MBlock" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MBlock:ToJSON:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:toJSON">toJSON</a> :: <a href="WaiLib.html#t:MBlock" title="WaiLib">MBlock</a> -&gt; Value</p><p class="src"><a href="#v:toEncoding">toEncoding</a> :: <a href="WaiLib.html#t:MBlock" title="WaiLib">MBlock</a> -&gt; Encoding</p><p class="src"><a href="#v:toJSONList">toJSONList</a> :: [<a href="WaiLib.html#t:MBlock" title="WaiLib">MBlock</a>] -&gt; Value</p><p class="src"><a href="#v:toEncodingList">toEncodingList</a> :: [<a href="WaiLib.html#t:MBlock" title="WaiLib">MBlock</a>] -&gt; Encoding</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MBlock:FromJSON:4"></span> FromJSON <a href="WaiLib.html#t:MBlock" title="WaiLib">MBlock</a></span> <a href="src/WaiLib.html#line-145" class="link">Source</a> <a href="#t:MBlock" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MBlock:FromJSON:4"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:parseJSON">parseJSON</a> :: Value -&gt; Parser <a href="WaiLib.html#t:MBlock" title="WaiLib">MBlock</a></p><p class="src"><a href="#v:parseJSONList">parseJSONList</a> :: Value -&gt; Parser [<a href="WaiLib.html#t:MBlock" title="WaiLib">MBlock</a>]</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MBlock:Rep:5"></span> <span class="keyword">type</span> Rep <a href="WaiLib.html#t:MBlock" title="WaiLib">MBlock</a></span> <a href="src/WaiLib.html#line-99" class="link">Source</a> <a href="#t:MBlock" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MBlock:Rep:5"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="src"><span class="keyword">type</span> Rep <a href="WaiLib.html#t:MBlock" title="WaiLib">MBlock</a> = D1 (MetaData &quot;MBlock&quot; &quot;WaiLib&quot; &quot;main&quot; False) (C1 (MetaCons &quot;MBlock&quot; PrefixI True) (S1 (MetaSel (Just &quot;mblock&quot;) NoSourceUnpackedness NoSourceStrictness DecidedLazy) (Rec0 [Integer])))</div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:GeneMatrix" class="def">GeneMatrix</a> <a href="src/WaiLib.html#GeneMatrix" class="link">Source</a> <a href="#t:GeneMatrix" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:GeneMatrix" class="def">GeneMatrix</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:cmd" class="def">cmd</a> :: Text</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:ncol" class="def">ncol</a> :: Integer</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:nrow" class="def">nrow</a> :: Integer</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><details id="i:GeneMatrix" open="open"><summary>Instances</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:GeneMatrix:Show:1"></span> Show <a href="WaiLib.html#t:GeneMatrix" title="WaiLib">GeneMatrix</a></span> <a href="src/WaiLib.html#line-104" class="link">Source</a> <a href="#t:GeneMatrix" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:GeneMatrix:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: Int -&gt; <a href="WaiLib.html#t:GeneMatrix" title="WaiLib">GeneMatrix</a> -&gt; ShowS</p><p class="src"><a href="#v:show">show</a> :: <a href="WaiLib.html#t:GeneMatrix" title="WaiLib">GeneMatrix</a> -&gt; String</p><p class="src"><a href="#v:showList">showList</a> :: [<a href="WaiLib.html#t:GeneMatrix" title="WaiLib">GeneMatrix</a>] -&gt; ShowS</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:GeneMatrix:Generic:2"></span> Generic <a href="WaiLib.html#t:GeneMatrix" title="WaiLib">GeneMatrix</a></span> <a href="src/WaiLib.html#line-104" class="link">Source</a> <a href="#t:GeneMatrix" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:GeneMatrix:Generic:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> Rep <a href="WaiLib.html#t:GeneMatrix" title="WaiLib">GeneMatrix</a> :: * -&gt; *</p></div> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:from">from</a> :: <a href="WaiLib.html#t:GeneMatrix" title="WaiLib">GeneMatrix</a> -&gt; Rep <a href="WaiLib.html#t:GeneMatrix" title="WaiLib">GeneMatrix</a> x</p><p class="src"><a href="#v:to">to</a> :: Rep <a href="WaiLib.html#t:GeneMatrix" title="WaiLib">GeneMatrix</a> x -&gt; <a href="WaiLib.html#t:GeneMatrix" title="WaiLib">GeneMatrix</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:GeneMatrix:ToJSON:3"></span> ToJSON <a href="WaiLib.html#t:GeneMatrix" title="WaiLib">GeneMatrix</a></span> <a href="src/WaiLib.html#line-107" class="link">Source</a> <a href="#t:GeneMatrix" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:GeneMatrix:ToJSON:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:toJSON">toJSON</a> :: <a href="WaiLib.html#t:GeneMatrix" title="WaiLib">GeneMatrix</a> -&gt; Value</p><p class="src"><a href="#v:toEncoding">toEncoding</a> :: <a href="WaiLib.html#t:GeneMatrix" title="WaiLib">GeneMatrix</a> -&gt; Encoding</p><p class="src"><a href="#v:toJSONList">toJSONList</a> :: [<a href="WaiLib.html#t:GeneMatrix" title="WaiLib">GeneMatrix</a>] -&gt; Value</p><p class="src"><a href="#v:toEncodingList">toEncodingList</a> :: [<a href="WaiLib.html#t:GeneMatrix" title="WaiLib">GeneMatrix</a>] -&gt; Encoding</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:GeneMatrix:FromJSON:4"></span> FromJSON <a href="WaiLib.html#t:GeneMatrix" title="WaiLib">GeneMatrix</a></span> <a href="src/WaiLib.html#line-106" class="link">Source</a> <a href="#t:GeneMatrix" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:GeneMatrix:FromJSON:4"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:parseJSON">parseJSON</a> :: Value -&gt; Parser <a href="WaiLib.html#t:GeneMatrix" title="WaiLib">GeneMatrix</a></p><p class="src"><a href="#v:parseJSONList">parseJSONList</a> :: Value -&gt; Parser [<a href="WaiLib.html#t:GeneMatrix" title="WaiLib">GeneMatrix</a>]</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:GeneMatrix:Rep:5"></span> <span class="keyword">type</span> Rep <a href="WaiLib.html#t:GeneMatrix" title="WaiLib">GeneMatrix</a></span> <a href="src/WaiLib.html#line-104" class="link">Source</a> <a href="#t:GeneMatrix" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:GeneMatrix:Rep:5"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="src"><span class="keyword">type</span> Rep <a href="WaiLib.html#t:GeneMatrix" title="WaiLib">GeneMatrix</a> = D1 (MetaData &quot;GeneMatrix&quot; &quot;WaiLib&quot; &quot;main&quot; False) (C1 (MetaCons &quot;GeneMatrix&quot; PrefixI True) (S1 (MetaSel (Just &quot;cmd&quot;) NoSourceUnpackedness NoSourceStrictness DecidedLazy) (Rec0 Text) :*: (S1 (MetaSel (Just &quot;ncol&quot;) NoSourceUnpackedness NoSourceStrictness DecidedLazy) (Rec0 Integer) :*: S1 (MetaSel (Just &quot;nrow&quot;) NoSourceUnpackedness NoSourceStrictness DecidedLazy) (Rec0 Integer))))</div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:ReplyCode" class="def">ReplyCode</a> <a href="src/WaiLib.html#ReplyCode" class="link">Source</a> <a href="#t:ReplyCode" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:ReplyCode" class="def">ReplyCode</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:rcmd" class="def">rcmd</a> :: Text</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:rerror" class="def">rerror</a> :: Text</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:stdout" class="def">stdout</a> :: Text</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><details id="i:ReplyCode" open="open"><summary>Instances</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:ReplyCode:Show:1"></span> Show <a href="WaiLib.html#t:ReplyCode" title="WaiLib">ReplyCode</a></span> <a href="src/WaiLib.html#line-114" class="link">Source</a> <a href="#t:ReplyCode" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:ReplyCode:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: Int -&gt; <a href="WaiLib.html#t:ReplyCode" title="WaiLib">ReplyCode</a> -&gt; ShowS</p><p class="src"><a href="#v:show">show</a> :: <a href="WaiLib.html#t:ReplyCode" title="WaiLib">ReplyCode</a> -&gt; String</p><p class="src"><a href="#v:showList">showList</a> :: [<a href="WaiLib.html#t:ReplyCode" title="WaiLib">ReplyCode</a>] -&gt; ShowS</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:ReplyCode:Generic:2"></span> Generic <a href="WaiLib.html#t:ReplyCode" title="WaiLib">ReplyCode</a></span> <a href="src/WaiLib.html#line-114" class="link">Source</a> <a href="#t:ReplyCode" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:ReplyCode:Generic:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> Rep <a href="WaiLib.html#t:ReplyCode" title="WaiLib">ReplyCode</a> :: * -&gt; *</p></div> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:from">from</a> :: <a href="WaiLib.html#t:ReplyCode" title="WaiLib">ReplyCode</a> -&gt; Rep <a href="WaiLib.html#t:ReplyCode" title="WaiLib">ReplyCode</a> x</p><p class="src"><a href="#v:to">to</a> :: Rep <a href="WaiLib.html#t:ReplyCode" title="WaiLib">ReplyCode</a> x -&gt; <a href="WaiLib.html#t:ReplyCode" title="WaiLib">ReplyCode</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:ReplyCode:ToJSON:3"></span> ToJSON <a href="WaiLib.html#t:ReplyCode" title="WaiLib">ReplyCode</a></span> <a href="src/WaiLib.html#line-117" class="link">Source</a> <a href="#t:ReplyCode" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:ReplyCode:ToJSON:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:toJSON">toJSON</a> :: <a href="WaiLib.html#t:ReplyCode" title="WaiLib">ReplyCode</a> -&gt; Value</p><p class="src"><a href="#v:toEncoding">toEncoding</a> :: <a href="WaiLib.html#t:ReplyCode" title="WaiLib">ReplyCode</a> -&gt; Encoding</p><p class="src"><a href="#v:toJSONList">toJSONList</a> :: [<a href="WaiLib.html#t:ReplyCode" title="WaiLib">ReplyCode</a>] -&gt; Value</p><p class="src"><a href="#v:toEncodingList">toEncodingList</a> :: [<a href="WaiLib.html#t:ReplyCode" title="WaiLib">ReplyCode</a>] -&gt; Encoding</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:ReplyCode:FromJSON:4"></span> FromJSON <a href="WaiLib.html#t:ReplyCode" title="WaiLib">ReplyCode</a></span> <a href="src/WaiLib.html#line-116" class="link">Source</a> <a href="#t:ReplyCode" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:ReplyCode:FromJSON:4"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:parseJSON">parseJSON</a> :: Value -&gt; Parser <a href="WaiLib.html#t:ReplyCode" title="WaiLib">ReplyCode</a></p><p class="src"><a href="#v:parseJSONList">parseJSONList</a> :: Value -&gt; Parser [<a href="WaiLib.html#t:ReplyCode" title="WaiLib">ReplyCode</a>]</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:ReplyCode:Rep:5"></span> <span class="keyword">type</span> Rep <a href="WaiLib.html#t:ReplyCode" title="WaiLib">ReplyCode</a></span> <a href="src/WaiLib.html#line-114" class="link">Source</a> <a href="#t:ReplyCode" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:ReplyCode:Rep:5"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="src"><span class="keyword">type</span> Rep <a href="WaiLib.html#t:ReplyCode" title="WaiLib">ReplyCode</a> = D1 (MetaData &quot;ReplyCode&quot; &quot;WaiLib&quot; &quot;main&quot; False) (C1 (MetaCons &quot;ReplyCode&quot; PrefixI True) (S1 (MetaSel (Just &quot;rcmd&quot;) NoSourceUnpackedness NoSourceStrictness DecidedLazy) (Rec0 Text) :*: (S1 (MetaSel (Just &quot;rerror&quot;) NoSourceUnpackedness NoSourceStrictness DecidedLazy) (Rec0 Text) :*: S1 (MetaSel (Just &quot;stdout&quot;) NoSourceUnpackedness NoSourceStrictness DecidedLazy) (Rec0 Text))))</div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:CompileCode" class="def">CompileCode</a> <a href="src/WaiLib.html#CompileCode" class="link">Source</a> <a href="#t:CompileCode" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:CompileCode" class="def">CompileCode</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:compiler" class="def">compiler</a> :: Text</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:option" class="def">option</a> :: Text</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:code" class="def">code</a> :: Text</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><details id="i:CompileCode" open="open"><summary>Instances</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:CompileCode:Show:1"></span> Show <a href="WaiLib.html#t:CompileCode" title="WaiLib">CompileCode</a></span> <a href="src/WaiLib.html#line-124" class="link">Source</a> <a href="#t:CompileCode" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:CompileCode:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: Int -&gt; <a href="WaiLib.html#t:CompileCode" title="WaiLib">CompileCode</a> -&gt; ShowS</p><p class="src"><a href="#v:show">show</a> :: <a href="WaiLib.html#t:CompileCode" title="WaiLib">CompileCode</a> -&gt; String</p><p class="src"><a href="#v:showList">showList</a> :: [<a href="WaiLib.html#t:CompileCode" title="WaiLib">CompileCode</a>] -&gt; ShowS</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:CompileCode:Generic:2"></span> Generic <a href="WaiLib.html#t:CompileCode" title="WaiLib">CompileCode</a></span> <a href="src/WaiLib.html#line-124" class="link">Source</a> <a href="#t:CompileCode" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:CompileCode:Generic:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> Rep <a href="WaiLib.html#t:CompileCode" title="WaiLib">CompileCode</a> :: * -&gt; *</p></div> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:from">from</a> :: <a href="WaiLib.html#t:CompileCode" title="WaiLib">CompileCode</a> -&gt; Rep <a href="WaiLib.html#t:CompileCode" title="WaiLib">CompileCode</a> x</p><p class="src"><a href="#v:to">to</a> :: Rep <a href="WaiLib.html#t:CompileCode" title="WaiLib">CompileCode</a> x -&gt; <a href="WaiLib.html#t:CompileCode" title="WaiLib">CompileCode</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:CompileCode:ToJSON:3"></span> ToJSON <a href="WaiLib.html#t:CompileCode" title="WaiLib">CompileCode</a></span> <a href="src/WaiLib.html#line-127" class="link">Source</a> <a href="#t:CompileCode" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:CompileCode:ToJSON:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:toJSON">toJSON</a> :: <a href="WaiLib.html#t:CompileCode" title="WaiLib">CompileCode</a> -&gt; Value</p><p class="src"><a href="#v:toEncoding">toEncoding</a> :: <a href="WaiLib.html#t:CompileCode" title="WaiLib">CompileCode</a> -&gt; Encoding</p><p class="src"><a href="#v:toJSONList">toJSONList</a> :: [<a href="WaiLib.html#t:CompileCode" title="WaiLib">CompileCode</a>] -&gt; Value</p><p class="src"><a href="#v:toEncodingList">toEncodingList</a> :: [<a href="WaiLib.html#t:CompileCode" title="WaiLib">CompileCode</a>] -&gt; Encoding</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:CompileCode:FromJSON:4"></span> FromJSON <a href="WaiLib.html#t:CompileCode" title="WaiLib">CompileCode</a></span> <a href="src/WaiLib.html#line-126" class="link">Source</a> <a href="#t:CompileCode" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:CompileCode:FromJSON:4"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:parseJSON">parseJSON</a> :: Value -&gt; Parser <a href="WaiLib.html#t:CompileCode" title="WaiLib">CompileCode</a></p><p class="src"><a href="#v:parseJSONList">parseJSONList</a> :: Value -&gt; Parser [<a href="WaiLib.html#t:CompileCode" title="WaiLib">CompileCode</a>]</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:CompileCode:Rep:5"></span> <span class="keyword">type</span> Rep <a href="WaiLib.html#t:CompileCode" title="WaiLib">CompileCode</a></span> <a href="src/WaiLib.html#line-124" class="link">Source</a> <a href="#t:CompileCode" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:CompileCode:Rep:5"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="src"><span class="keyword">type</span> Rep <a href="WaiLib.html#t:CompileCode" title="WaiLib">CompileCode</a> = D1 (MetaData &quot;CompileCode&quot; &quot;WaiLib&quot; &quot;main&quot; False) (C1 (MetaCons &quot;CompileCode&quot; PrefixI True) (S1 (MetaSel (Just &quot;compiler&quot;) NoSourceUnpackedness NoSourceStrictness DecidedLazy) (Rec0 Text) :*: (S1 (MetaSel (Just &quot;option&quot;) NoSourceUnpackedness NoSourceStrictness DecidedLazy) (Rec0 Text) :*: S1 (MetaSel (Just &quot;code&quot;) NoSourceUnpackedness NoSourceStrictness DecidedLazy) (Rec0 Text))))</div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:MatInt" class="def">MatInt</a> <a href="src/WaiLib.html#MatInt" class="link">Source</a> <a href="#t:MatInt" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:MatInt" class="def">MatInt</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:name" class="def">name</a> :: Text</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:matrix" class="def">matrix</a> :: [[Integer]]</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><details id="i:MatInt" open="open"><summary>Instances</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MatInt:Show:1"></span> Show <a href="WaiLib.html#t:MatInt" title="WaiLib">MatInt</a></span> <a href="src/WaiLib.html#line-132" class="link">Source</a> <a href="#t:MatInt" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MatInt:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: Int -&gt; <a href="WaiLib.html#t:MatInt" title="WaiLib">MatInt</a> -&gt; ShowS</p><p class="src"><a href="#v:show">show</a> :: <a href="WaiLib.html#t:MatInt" title="WaiLib">MatInt</a> -&gt; String</p><p class="src"><a href="#v:showList">showList</a> :: [<a href="WaiLib.html#t:MatInt" title="WaiLib">MatInt</a>] -&gt; ShowS</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MatInt:Generic:2"></span> Generic <a href="WaiLib.html#t:MatInt" title="WaiLib">MatInt</a></span> <a href="src/WaiLib.html#line-132" class="link">Source</a> <a href="#t:MatInt" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MatInt:Generic:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> Rep <a href="WaiLib.html#t:MatInt" title="WaiLib">MatInt</a> :: * -&gt; *</p></div> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:from">from</a> :: <a href="WaiLib.html#t:MatInt" title="WaiLib">MatInt</a> -&gt; Rep <a href="WaiLib.html#t:MatInt" title="WaiLib">MatInt</a> x</p><p class="src"><a href="#v:to">to</a> :: Rep <a href="WaiLib.html#t:MatInt" title="WaiLib">MatInt</a> x -&gt; <a href="WaiLib.html#t:MatInt" title="WaiLib">MatInt</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MatInt:ToJSON:3"></span> ToJSON <a href="WaiLib.html#t:MatInt" title="WaiLib">MatInt</a></span> <a href="src/WaiLib.html#line-134" class="link">Source</a> <a href="#t:MatInt" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MatInt:ToJSON:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:toJSON">toJSON</a> :: <a href="WaiLib.html#t:MatInt" title="WaiLib">MatInt</a> -&gt; Value</p><p class="src"><a href="#v:toEncoding">toEncoding</a> :: <a href="WaiLib.html#t:MatInt" title="WaiLib">MatInt</a> -&gt; Encoding</p><p class="src"><a href="#v:toJSONList">toJSONList</a> :: [<a href="WaiLib.html#t:MatInt" title="WaiLib">MatInt</a>] -&gt; Value</p><p class="src"><a href="#v:toEncodingList">toEncodingList</a> :: [<a href="WaiLib.html#t:MatInt" title="WaiLib">MatInt</a>] -&gt; Encoding</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MatInt:FromJSON:4"></span> FromJSON <a href="WaiLib.html#t:MatInt" title="WaiLib">MatInt</a></span> <a href="src/WaiLib.html#line-133" class="link">Source</a> <a href="#t:MatInt" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MatInt:FromJSON:4"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:parseJSON">parseJSON</a> :: Value -&gt; Parser <a href="WaiLib.html#t:MatInt" title="WaiLib">MatInt</a></p><p class="src"><a href="#v:parseJSONList">parseJSONList</a> :: Value -&gt; Parser [<a href="WaiLib.html#t:MatInt" title="WaiLib">MatInt</a>]</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MatInt:Rep:5"></span> <span class="keyword">type</span> Rep <a href="WaiLib.html#t:MatInt" title="WaiLib">MatInt</a></span> <a href="src/WaiLib.html#line-132" class="link">Source</a> <a href="#t:MatInt" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MatInt:Rep:5"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="src"><span class="keyword">type</span> Rep <a href="WaiLib.html#t:MatInt" title="WaiLib">MatInt</a> = D1 (MetaData &quot;MatInt&quot; &quot;WaiLib&quot; &quot;main&quot; False) (C1 (MetaCons &quot;MatInt&quot; PrefixI True) (S1 (MetaSel (Just &quot;name&quot;) NoSourceUnpackedness NoSourceStrictness DecidedLazy) (Rec0 Text) :*: S1 (MetaSel (Just &quot;matrix&quot;) NoSourceUnpackedness NoSourceStrictness DecidedLazy) (Rec0 [[Integer]])))</div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Person" class="def">Person</a> <a href="src/WaiLib.html#Person" class="link">Source</a> <a href="#t:Person" class="selflink">#</a></p><div class="doc"><p>Person to Json object</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Person" class="def">Person</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:personId" class="def">personId</a> :: Int64</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:personName" class="def">personName</a> :: Text</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:personAge" class="def">personAge</a> :: Text</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><details id="i:Person" open="open"><summary>Instances</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Person:Eq:1"></span> Eq <a href="WaiLib.html#t:Person" title="WaiLib">Person</a></span> <a href="src/WaiLib.html#line-159" class="link">Source</a> <a href="#t:Person" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Person:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="WaiLib.html#t:Person" title="WaiLib">Person</a> -&gt; <a href="WaiLib.html#t:Person" title="WaiLib">Person</a> -&gt; Bool</p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="WaiLib.html#t:Person" title="WaiLib">Person</a> -&gt; <a href="WaiLib.html#t:Person" title="WaiLib">Person</a> -&gt; Bool</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Person:Read:2"></span> Read <a href="WaiLib.html#t:Person" title="WaiLib">Person</a></span> <a href="src/WaiLib.html#line-159" class="link">Source</a> <a href="#t:Person" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Person:Read:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:readsPrec">readsPrec</a> :: Int -&gt; ReadS <a href="WaiLib.html#t:Person" title="WaiLib">Person</a></p><p class="src"><a href="#v:readList">readList</a> :: ReadS [<a href="WaiLib.html#t:Person" title="WaiLib">Person</a>]</p><p class="src"><a href="#v:readPrec">readPrec</a> :: ReadPrec <a href="WaiLib.html#t:Person" title="WaiLib">Person</a></p><p class="src"><a href="#v:readListPrec">readListPrec</a> :: ReadPrec [<a href="WaiLib.html#t:Person" title="WaiLib">Person</a>]</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Person:Show:3"></span> Show <a href="WaiLib.html#t:Person" title="WaiLib">Person</a></span> <a href="src/WaiLib.html#line-159" class="link">Source</a> <a href="#t:Person" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Person:Show:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: Int -&gt; <a href="WaiLib.html#t:Person" title="WaiLib">Person</a> -&gt; ShowS</p><p class="src"><a href="#v:show">show</a> :: <a href="WaiLib.html#t:Person" title="WaiLib">Person</a> -&gt; String</p><p class="src"><a href="#v:showList">showList</a> :: [<a href="WaiLib.html#t:Person" title="WaiLib">Person</a>] -&gt; ShowS</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Person:FromRow:4"></span> FromRow <a href="WaiLib.html#t:Person" title="WaiLib">Person</a></span> <a href="src/WaiLib.html#line-173" class="link">Source</a> <a href="#t:Person" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Person:FromRow:4"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:fromRow">fromRow</a> :: RowParser <a href="WaiLib.html#t:Person" title="WaiLib">Person</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Person:ToRow:5"></span> ToRow <a href="WaiLib.html#t:Person" title="WaiLib">Person</a></span> <a href="src/WaiLib.html#line-180" class="link">Source</a> <a href="#t:Person" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Person:ToRow:5"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:toRow">toRow</a> :: <a href="WaiLib.html#t:Person" title="WaiLib">Person</a> -&gt; [SQLData]</p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:UserInput" class="def">UserInput</a> <a href="src/WaiLib.html#UserInput" class="link">Source</a> <a href="#t:UserInput" class="selflink">#</a></p><div class="doc"><h3>create UserInput table in Sqlite</h3><ul><li>cmdId = pid</li><li>xcmd = input command, e.g. &quot;c ls&quot;</li></ul></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:UserInput" class="def">UserInput</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:cmdId" class="def">cmdId</a> :: Int64</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:xcmd" class="def">xcmd</a> :: Text</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><details id="i:UserInput" open="open"><summary>Instances</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:UserInput:Eq:1"></span> Eq <a href="WaiLib.html#t:UserInput" title="WaiLib">UserInput</a></span> <a href="src/WaiLib.html#line-171" class="link">Source</a> <a href="#t:UserInput" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:UserInput:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="WaiLib.html#t:UserInput" title="WaiLib">UserInput</a> -&gt; <a href="WaiLib.html#t:UserInput" title="WaiLib">UserInput</a> -&gt; Bool</p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="WaiLib.html#t:UserInput" title="WaiLib">UserInput</a> -&gt; <a href="WaiLib.html#t:UserInput" title="WaiLib">UserInput</a> -&gt; Bool</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:UserInput:Read:2"></span> Read <a href="WaiLib.html#t:UserInput" title="WaiLib">UserInput</a></span> <a href="src/WaiLib.html#line-171" class="link">Source</a> <a href="#t:UserInput" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:UserInput:Read:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:readsPrec">readsPrec</a> :: Int -&gt; ReadS <a href="WaiLib.html#t:UserInput" title="WaiLib">UserInput</a></p><p class="src"><a href="#v:readList">readList</a> :: ReadS [<a href="WaiLib.html#t:UserInput" title="WaiLib">UserInput</a>]</p><p class="src"><a href="#v:readPrec">readPrec</a> :: ReadPrec <a href="WaiLib.html#t:UserInput" title="WaiLib">UserInput</a></p><p class="src"><a href="#v:readListPrec">readListPrec</a> :: ReadPrec [<a href="WaiLib.html#t:UserInput" title="WaiLib">UserInput</a>]</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:UserInput:Show:3"></span> Show <a href="WaiLib.html#t:UserInput" title="WaiLib">UserInput</a></span> <a href="src/WaiLib.html#line-171" class="link">Source</a> <a href="#t:UserInput" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:UserInput:Show:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: Int -&gt; <a href="WaiLib.html#t:UserInput" title="WaiLib">UserInput</a> -&gt; ShowS</p><p class="src"><a href="#v:show">show</a> :: <a href="WaiLib.html#t:UserInput" title="WaiLib">UserInput</a> -&gt; String</p><p class="src"><a href="#v:showList">showList</a> :: [<a href="WaiLib.html#t:UserInput" title="WaiLib">UserInput</a>] -&gt; ShowS</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:UserInput:FromRow:4"></span> FromRow <a href="WaiLib.html#t:UserInput" title="WaiLib">UserInput</a></span> <a href="src/WaiLib.html#line-176" class="link">Source</a> <a href="#t:UserInput" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:UserInput:FromRow:4"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:fromRow">fromRow</a> :: RowParser <a href="WaiLib.html#t:UserInput" title="WaiLib">UserInput</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:UserInput:ToRow:5"></span> ToRow <a href="WaiLib.html#t:UserInput" title="WaiLib">UserInput</a></span> <a href="src/WaiLib.html#line-184" class="link">Source</a> <a href="#t:UserInput" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:UserInput:ToRow:5"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="WaiLib.html">WaiLib</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:toRow">toRow</a> :: <a href="WaiLib.html#t:UserInput" title="WaiLib">UserInput</a> -&gt; [SQLData]</p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:updir" class="def">updir</a> :: String <a href="src/WaiLib.html#updir" class="link">Source</a> <a href="#v:updir" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:runSh" class="def">runSh</a> :: Text -&gt; IO (ExitCode, Text, Text) <a href="src/WaiLib.html#runSh" class="link">Source</a> <a href="#v:runSh" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:styleChar" class="def">styleChar</a> :: String -&gt; String -&gt; Char -&gt; Char -&gt; String -&gt; String <a href="src/WaiLib.html#styleChar" class="link">Source</a> <a href="#v:styleChar" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:href" class="def">href</a> :: String -&gt; String -&gt; String -&gt; String <a href="src/WaiLib.html#href" class="link">Source</a> <a href="#v:href" class="selflink">#</a></p><div class="doc"><ul><li>------------------------------------------------------------------------------- 
 | Thu Nov 15 13:18:04 2018 
 | Simple web server for request and response
 | Handle search code snippet
 | -------------------------------------------------------------------------------- 
 run.sh =&gt; ./wai 
 ghc -i<em>$b</em>haskelllib --make wai.hs -o wai 
 [file path] [desc] [image src]</li></ul></div></div><div class="top"><p class="src"><a id="v:changeSymbol" class="def">changeSymbol</a> :: String -&gt; String <a href="src/WaiLib.html#changeSymbol" class="link">Source</a> <a href="#v:changeSymbol" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:listToByteStr" class="def">listToByteStr</a> :: [[String]] -&gt; ByteString <a href="src/WaiLib.html#listToByteStr" class="link">Source</a> <a href="#v:listToByteStr" class="selflink">#</a></p><div class="doc"><p>Convert [[String]] to ByteString</p></div></div><div class="top"><p class="src"><a id="v:cssStrong" class="def">cssStrong</a> :: String -&gt; String <a href="src/WaiLib.html#cssStrong" class="link">Source</a> <a href="#v:cssStrong" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:cssHead" class="def">cssHead</a> :: [[String]] -&gt; [[String]] <a href="src/WaiLib.html#cssHead" class="link">Source</a> <a href="#v:cssHead" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:htmlLess" class="def">htmlLess</a> :: [[String]] -&gt; [[String]] <a href="src/WaiLib.html#htmlLess" class="link">Source</a> <a href="#v:htmlLess" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:htmlGreater" class="def">htmlGreater</a> :: [[String]] -&gt; [[String]] <a href="src/WaiLib.html#htmlGreater" class="link">Source</a> <a href="#v:htmlGreater" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:keyWord" class="def">keyWord</a> :: [[String]] -&gt; [[String]] <a href="src/WaiLib.html#keyWord" class="link">Source</a> <a href="#v:keyWord" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:keyWord1" class="def">keyWord1</a> :: [[String]] -&gt; [[String]] <a href="src/WaiLib.html#keyWord1" class="link">Source</a> <a href="#v:keyWord1" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:keyDash" class="def">keyDash</a> :: [[String]] -&gt; [[String]] <a href="src/WaiLib.html#keyDash" class="link">Source</a> <a href="#v:keyDash" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:keySymbol1" class="def">keySymbol1</a> :: [[String]] -&gt; [[String]] <a href="src/WaiLib.html#keySymbol1" class="link">Source</a> <a href="#v:keySymbol1" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:keyName" class="def">keyName</a> :: [[String]] -&gt; [[String]] <a href="src/WaiLib.html#keyName" class="link">Source</a> <a href="#v:keyName" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:specialName" class="def">specialName</a> :: [[String]] -&gt; [[String]] <a href="src/WaiLib.html#specialName" class="link">Source</a> <a href="#v:specialName" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:javaClassName" class="def">javaClassName</a> :: [[String]] -&gt; [[String]] <a href="src/WaiLib.html#javaClassName" class="link">Source</a> <a href="#v:javaClassName" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:javaFunClass" class="def">javaFunClass</a> :: [[String]] -&gt; [[String]] <a href="src/WaiLib.html#javaFunClass" class="link">Source</a> <a href="#v:javaFunClass" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:javaKeyWords" class="def">javaKeyWords</a> :: [[String]] -&gt; [[String]] <a href="src/WaiLib.html#javaKeyWords" class="link">Source</a> <a href="#v:javaKeyWords" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:javaCmdKeyWords" class="def">javaCmdKeyWords</a> :: [[String]] -&gt; [[String]] <a href="src/WaiLib.html#javaCmdKeyWords" class="link">Source</a> <a href="#v:javaCmdKeyWords" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:mysqlKeyWords" class="def">mysqlKeyWords</a> :: [[String]] -&gt; [[String]] <a href="src/WaiLib.html#mysqlKeyWords" class="link">Source</a> <a href="#v:mysqlKeyWords" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:keyURL" class="def">keyURL</a> :: [[String]] -&gt; [[String]] <a href="src/WaiLib.html#keyURL" class="link">Source</a> <a href="#v:keyURL" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:spChar" class="def">spChar</a> :: [[String]] -&gt; [[String]] <a href="src/WaiLib.html#spChar" class="link">Source</a> <a href="#v:spChar" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:bracketChar" class="def">bracketChar</a> :: [[String]] -&gt; [[String]] <a href="src/WaiLib.html#bracketChar" class="link">Source</a> <a href="#v:bracketChar" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:sbChar" class="def">sbChar</a> :: [[String]] -&gt; [[String]] <a href="src/WaiLib.html#sbChar" class="link">Source</a> <a href="#v:sbChar" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:transform" class="def">transform</a> :: [[String]] -&gt; [[String]] <a href="src/WaiLib.html#transform" class="link">Source</a> <a href="#v:transform" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:hiddenForm" class="def">hiddenForm</a> :: Integer -&gt; String -&gt; String <a href="src/WaiLib.html#hiddenForm" class="link">Source</a> <a href="#v:hiddenForm" class="selflink">#</a></p><div class="doc"><h3>Hide all the data in TextArea</h3><pre>   <a href="form">action=&quot;sendConfirmation.php&quot; name=&quot;confirmationForm&quot; method=&quot;post&quot;</a>
   <a href="textarea">id=&quot;confirmationText&quot; class=&quot;text&quot; cols=&quot;86&quot; rows =&quot;20&quot; name=&quot;confirmationText&quot;</a><a href="/textarea">/textarea</a>

   <a href="input">type=&quot;submit&quot; value=&quot;Email&quot; class=&quot;submitButton&quot;</a>
   <a href="/form">/form</a>

   <a href="textarea">cols=&quot;20&quot; rows=&quot;20&quot; id=&quot;textArea&quot; style=&quot;display:none;font-size:18px;&quot; class=&quot;hide&quot;</a><a href="/textarea">/textarea</a>

   <a href="textarea">autofocus=&quot;true&quot; onfocus=&quot;textAreaAdjust(this);&quot;</a><a href="/textarea">/textarea</a>
   </pre></div></div><div class="top"><p class="src"><a id="v:foldListList" class="def">foldListList</a> :: ([[String]] -&gt; [[String]]) -&gt; [[String]] -&gt; String <a href="src/WaiLib.html#foldListList" class="link">Source</a> <a href="#v:foldListList" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:foldListListTxt" class="def">foldListListTxt</a> :: [[String]] -&gt; String <a href="src/WaiLib.html#foldListListTxt" class="link">Source</a> <a href="#v:foldListListTxt" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:preT" class="def">preT</a> :: [Char] -&gt; [Char] <a href="src/WaiLib.html#preT" class="link">Source</a> <a href="#v:preT" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:divT" class="def">divT</a> :: [Char] -&gt; [Char] <a href="src/WaiLib.html#divT" class="link">Source</a> <a href="#v:divT" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:divC" class="def">divC</a> :: [Char] -&gt; [Char] <a href="src/WaiLib.html#divC" class="link">Source</a> <a href="#v:divC" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:tableT" class="def">tableT</a> :: [Char] -&gt; [Char] <a href="src/WaiLib.html#tableT" class="link">Source</a> <a href="#v:tableT" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:tableC" class="def">tableC</a> :: [Char] -&gt; [Char] <a href="src/WaiLib.html#tableC" class="link">Source</a> <a href="#v:tableC" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:tableAC" class="def">tableAC</a> :: [Char] -&gt; [Char] -&gt; [Char] <a href="src/WaiLib.html#tableAC" class="link">Source</a> <a href="#v:tableAC" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:tdT" class="def">tdT</a> :: [Char] -&gt; [Char] <a href="src/WaiLib.html#tdT" class="link">Source</a> <a href="#v:tdT" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:tdC" class="def">tdC</a> :: [Char] -&gt; [Char] <a href="src/WaiLib.html#tdC" class="link">Source</a> <a href="#v:tdC" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:tdAC" class="def">tdAC</a> :: [Char] -&gt; [Char] -&gt; [Char] <a href="src/WaiLib.html#tdAC" class="link">Source</a> <a href="#v:tdAC" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:trC" class="def">trC</a> :: [Char] -&gt; [Char] <a href="src/WaiLib.html#trC" class="link">Source</a> <a href="#v:trC" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:id_" class="def">id_</a> :: [Char] -&gt; [Char] <a href="src/WaiLib.html#id_" class="link">Source</a> <a href="#v:id_" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:class_" class="def">class_</a> :: [Char] -&gt; [Char] <a href="src/WaiLib.html#class_" class="link">Source</a> <a href="#v:class_" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:onclick_" class="def">onclick_</a> :: [Char] -&gt; [Char] <a href="src/WaiLib.html#onclick_" class="link">Source</a> <a href="#v:onclick_" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:style_" class="def">style_</a> :: Foldable t =&gt; t [Char] -&gt; [Char] <a href="src/WaiLib.html#style_" class="link">Source</a> <a href="#v:style_" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:align_" class="def">align_</a> :: [Char] -&gt; [Char] <a href="src/WaiLib.html#align_" class="link">Source</a> <a href="#v:align_" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:table" class="def">table</a> :: [[String]] -&gt; String <a href="src/WaiLib.html#table" class="link">Source</a> <a href="#v:table" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:pdfname" class="def">pdfname</a> :: String <a href="src/WaiLib.html#pdfname" class="link">Source</a> <a href="#v:pdfname" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:img" class="def">img</a> :: String <a href="src/WaiLib.html#img" class="link">Source</a> <a href="#v:img" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:wapp" class="def">wapp</a> :: FilePath <a href="src/WaiLib.html#wapp" class="link">Source</a> <a href="#v:wapp" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:pdfPath" class="def">pdfPath</a> :: [Char] <a href="src/WaiLib.html#pdfPath" class="link">Source</a> <a href="#v:pdfPath" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:docRoot" class="def">docRoot</a> :: [Char] <a href="src/WaiLib.html#docRoot" class="link">Source</a> <a href="#v:docRoot" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:doc" class="def">doc</a> :: FilePath <a href="src/WaiLib.html#doc" class="link">Source</a> <a href="#v:doc" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:cmdLog" class="def">cmdLog</a> :: FilePath <a href="src/WaiLib.html#cmdLog" class="link">Source</a> <a href="#v:cmdLog" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:currCmdFile" class="def">currCmdFile</a> :: FilePath <a href="src/WaiLib.html#currCmdFile" class="link">Source</a> <a href="#v:currCmdFile" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:logCurrCmd" class="def">logCurrCmd</a> :: [String] -&gt; IO () <a href="src/WaiLib.html#logCurrCmd" class="link">Source</a> <a href="#v:logCurrCmd" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:readCurrCmd" class="def">readCurrCmd</a> :: IO String <a href="src/WaiLib.html#readCurrCmd" class="link">Source</a> <a href="#v:readCurrCmd" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:HMap" class="def">HMap</a> = HashMap String [[String]] <a href="src/WaiLib.html#HMap" class="link">Source</a> <a href="#t:HMap" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:genePDF" class="def">genePDF</a> :: String -&gt; IO () <a href="src/WaiLib.html#genePDF" class="link">Source</a> <a href="#v:genePDF" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:app" class="def">app</a> :: Connection -&gt; Connection -&gt; IORef <a href="WaiLib.html#t:HMap" title="WaiLib">HMap</a> -&gt; Application <a href="src/WaiLib.html#app" class="link">Source</a> <a href="#v:app" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:plainIndex" class="def">plainIndex</a> :: Response <a href="src/WaiLib.html#plainIndex" class="link">Source</a> <a href="#v:plainIndex" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:pdfFile" class="def">pdfFile</a> :: Response <a href="src/WaiLib.html#pdfFile" class="link">Source</a> <a href="#v:pdfFile" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:insertinfo" class="def">insertinfo</a> :: Response <a href="src/WaiLib.html#insertinfo" class="link">Source</a> <a href="#v:insertinfo" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:searchUI" class="def">searchUI</a> :: Response <a href="src/WaiLib.html#searchUI" class="link">Source</a> <a href="#v:searchUI" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:notFound" class="def">notFound</a> :: Response <a href="src/WaiLib.html#notFound" class="link">Source</a> <a href="#v:notFound" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:notFoundStr" class="def">notFoundStr</a> :: ByteString -&gt; Response <a href="src/WaiLib.html#notFoundStr" class="link">Source</a> <a href="#v:notFoundStr" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:snippetPath" class="def">snippetPath</a> :: FilePath <a href="src/WaiLib.html#snippetPath" class="link">Source</a> <a href="#v:snippetPath" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:insertAll" class="def">insertAll</a> :: [(String, [[String]])] -&gt; <a href="WaiLib.html#t:HMap" title="WaiLib">HMap</a> -&gt; <a href="WaiLib.html#t:HMap" title="WaiLib">HMap</a> <a href="src/WaiLib.html#insertAll" class="link">Source</a> <a href="#v:insertAll" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:mapClear" class="def">mapClear</a> :: [String] -&gt; <a href="WaiLib.html#t:HMap" title="WaiLib">HMap</a> -&gt; <a href="WaiLib.html#t:HMap" title="WaiLib">HMap</a> <a href="src/WaiLib.html#mapClear" class="link">Source</a> <a href="#v:mapClear" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:snippetMap" class="def">snippetMap</a> :: [([String], [String])] -&gt; IORef <a href="WaiLib.html#t:HMap" title="WaiLib">HMap</a> -&gt; IO () <a href="src/WaiLib.html#snippetMap" class="link">Source</a> <a href="#v:snippetMap" class="selflink">#</a></p><div class="doc"><h3>read snippet file</h3><p><strong>NOTE</strong> The code can be speed up a bit, change [String] [[String]</p><pre>type HMap = M.HashMap String [[String]] =&gt; type HMap = M.HashMap String (Set [String])</pre></div></div><div class="top"><p class="src"><a id="v:spanBlock" class="def">spanBlock</a> :: <a href="WaiLib.html#t:HMap" title="WaiLib">HMap</a> -&gt; Maybe ByteString -&gt; String <a href="src/WaiLib.html#spanBlock" class="link">Source</a> <a href="#v:spanBlock" class="selflink">#</a></p><div class="doc"><p><a href="http://localhost:8080/snippet?id=keyinput">http://localhost:8080/snippet?id=keyinput</a>
 | Conver ByteString to String or vice versa 
 | span block code: <a href="span">span</a>text<a href="/span">/span</a>
 | 
 | type in search key
 | transform a block of code =&gt; colourful block of code
 | each block of code =&gt; key -&gt; &quot;block of code&quot;
 | return a block of colourful code</p></div></div><div class="top"><p class="src"><a id="v:spanBlockX" class="def">spanBlockX</a> :: ([[String]] -&gt; [[String]]) -&gt; <a href="WaiLib.html#t:HMap" title="WaiLib">HMap</a> -&gt; Maybe ByteString -&gt; String <a href="src/WaiLib.html#spanBlockX" class="link">Source</a> <a href="#v:spanBlockX" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:spanBlockXX" class="def">spanBlockXX</a> :: <a href="WaiLib.html#t:HMap" title="WaiLib">HMap</a> -&gt; Maybe ByteString -&gt; String <a href="src/WaiLib.html#spanBlockXX" class="link">Source</a> <a href="#v:spanBlockXX" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:-8728-" class="def">(&#8728;)</a> :: [a] -&gt; [a] -&gt; [a] <a href="src/WaiLib.html#%2218" class="link">Source</a> <a href="#v:-8728-" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:htmlForm" class="def">htmlForm</a> :: String -&gt; String <a href="src/WaiLib.html#htmlForm" class="link">Source</a> <a href="#v:htmlForm" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:htmlPre" class="def">htmlPre</a> :: String -&gt; String <a href="src/WaiLib.html#htmlPre" class="link">Source</a> <a href="#v:htmlPre" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:htmlBody" class="def">htmlBody</a> :: String -&gt; String <a href="src/WaiLib.html#htmlBody" class="link">Source</a> <a href="#v:htmlBody" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:replyHtml" class="def">replyHtml</a> :: String -&gt; String -&gt; String <a href="src/WaiLib.html#replyHtml" class="link">Source</a> <a href="#v:replyHtml" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:anyRoute" class="def">anyRoute</a> :: Connection -&gt; IORef <a href="WaiLib.html#t:HMap" title="WaiLib">HMap</a> -&gt; Request -&gt; Response <a href="src/WaiLib.html#anyRoute" class="link">Source</a> <a href="#v:anyRoute" class="selflink">#</a></p><div class="doc"><p>snippet?id=queryStr
    S8.unpack: ByteString to String
    type Application = Request -&gt; (Response -&gt; IO ResponseReceived) -&gt; IO ResponseReceived
    anyRoute =&gt; Response</p></div></div><div class="top"><p class="src"><a id="v:uploadPage" class="def">uploadPage</a> :: Response <a href="src/WaiLib.html#uploadPage" class="link">Source</a> <a href="#v:uploadPage" class="selflink">#</a></p><div class="doc"><p><a href="http://localhost:8080/up/">http://localhost:8080/up/</a>
 | NOTE: file =&gt; /upload dir
 | Plz see uploadPage.html 
 | <em>Users</em>cat<em>myfile</em>bitbucket<em>haskell_webapp</em>uploadPage.html
 | responseFile :: H.Status -&gt; H.ResponseHeaders -&gt; FilePath -&gt; Maybe FilePart -&gt; Response</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:SearchType" class="def">SearchType</a> <a href="src/WaiLib.html#SearchType" class="link">Source</a> <a href="#t:SearchType" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:CmdT" class="def">CmdT</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:JavaT" class="def">JavaT</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:HaskellT" class="def">HaskellT</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:SnippetT" class="def">SnippetT</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><a id="v:readCmd" class="def">readCmd</a> :: FilePath -&gt; <a href="WaiLib.html#t:SearchType" title="WaiLib">SearchType</a> -&gt; IO String <a href="src/WaiLib.html#readCmd" class="link">Source</a> <a href="#v:readCmd" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:groupCountFilter" class="def">groupCountFilter</a> :: [String] -&gt; [String] <a href="src/WaiLib.html#groupCountFilter" class="link">Source</a> <a href="#v:groupCountFilter" class="selflink">#</a></p><div class="doc"><h3>Filter some commands out from a list.</h3></div></div><div class="top"><p class="src"><a id="v:optionHtml" class="def">optionHtml</a> :: [String] -&gt; String <a href="src/WaiLib.html#optionHtml" class="link">Source</a> <a href="#v:optionHtml" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:responseNothing" class="def">responseNothing</a> :: String -&gt; Response <a href="src/WaiLib.html#responseNothing" class="link">Source</a> <a href="#v:responseNothing" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:responseNothingBS" class="def">responseNothingBS</a> :: ByteString -&gt; Response <a href="src/WaiLib.html#responseNothingBS" class="link">Source</a> <a href="#v:responseNothingBS" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:responseCmd" class="def">responseCmd</a> :: Connection -&gt; String -&gt; Response <a href="src/WaiLib.html#responseCmd" class="link">Source</a> <a href="#v:responseCmd" class="selflink">#</a></p><div class="doc"><h3>Response output from shell command</h3><ol><li>The maximum number of lines are 200, &quot; | head -200&quot;</li></ol><ol><li>Exit code can not be checked, ExitSuccess</li></ol><p>Wed May  8 23:10:41 2019 
   3 Error can be checked in stderr  
   &gt;(e, so, si) &lt;- A.runSh $ toText (drop 2 ncmd) 
   &gt; if si is NOT empty then there is stderr</p><pre>type streamBody = (Builder -&gt; IO()) -&gt; IO() -&gt; IO()</pre></div></div><div class="top"><p class="src"><a id="v:responseXCmd" class="def">responseXCmd</a> :: String -&gt; Response <a href="src/WaiLib.html#responseXCmd" class="link">Source</a> <a href="#v:responseXCmd" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:responseJavaHtml" class="def">responseJavaHtml</a> :: String -&gt; Response <a href="src/WaiLib.html#responseJavaHtml" class="link">Source</a> <a href="#v:responseJavaHtml" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:responseHaskellHtml" class="def">responseHaskellHtml</a> :: String -&gt; Response <a href="src/WaiLib.html#responseHaskellHtml" class="link">Source</a> <a href="#v:responseHaskellHtml" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:queryLibHaskell" class="def">queryLibHaskell</a> :: String -&gt; Response <a href="src/WaiLib.html#queryLibHaskell" class="link">Source</a> <a href="#v:queryLibHaskell" class="selflink">#</a></p><div class="doc"><h3>query function info from redis without Html</h3><pre>query_redis = &quot;/Users/cat/myfile/symbin/redis_query.hs &quot;</pre><pre>preKey = &quot;AronModule.&quot;  AronModule.hs
preKey = &quot;Aron.&quot;        Aron.java</pre></div></div><div class="top"><p class="src"><a id="v:queryLibJava" class="def">queryLibJava</a> :: String -&gt; Response <a href="src/WaiLib.html#queryLibJava" class="link">Source</a> <a href="#v:queryLibJava" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:responseSnippet" class="def">responseSnippet</a> :: Connection -&gt; String -&gt; IORef <a href="WaiLib.html#t:HMap" title="WaiLib">HMap</a> -&gt; Response <a href="src/WaiLib.html#responseSnippet" class="link">Source</a> <a href="#v:responseSnippet" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:responseSnippetTxt" class="def">responseSnippetTxt</a> :: String -&gt; IORef <a href="WaiLib.html#t:HMap" title="WaiLib">HMap</a> -&gt; Response <a href="src/WaiLib.html#responseSnippetTxt" class="link">Source</a> <a href="#v:responseSnippetTxt" class="selflink">#</a></p><div class="doc"><h3>query snippet from HMap without Html</h3></div></div><div class="top"><p class="src"><a id="v:trimBothLBS" class="def">trimBothLBS</a> :: ByteString -&gt; ByteString <a href="src/WaiLib.html#trimBothLBS" class="link">Source</a> <a href="#v:trimBothLBS" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:geneRectMat" class="def">geneRectMat</a> :: Application <a href="src/WaiLib.html#geneRectMat" class="link">Source</a> <a href="#v:geneRectMat" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:receiveCode" class="def">receiveCode</a> :: Application <a href="src/WaiLib.html#receiveCode" class="link">Source</a> <a href="#v:receiveCode" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:receiveCode2" class="def">receiveCode2</a> :: Application <a href="src/WaiLib.html#receiveCode2" class="link">Source</a> <a href="#v:receiveCode2" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:responseEditor" class="def">responseEditor</a> :: Response <a href="src/WaiLib.html#responseEditor" class="link">Source</a> <a href="#v:responseEditor" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:responseJavascript" class="def">responseJavascript</a> :: FilePath -&gt; Response <a href="src/WaiLib.html#responseJavascript" class="link">Source</a> <a href="#v:responseJavascript" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:responseHtml" class="def">responseHtml</a> :: FilePath -&gt; Response <a href="src/WaiLib.html#responseHtml" class="link">Source</a> <a href="#v:responseHtml" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:updateMap" class="def">updateMap</a> :: IORef <a href="WaiLib.html#t:HMap" title="WaiLib">HMap</a> -&gt; Application <a href="src/WaiLib.html#updateMap" class="link">Source</a> <a href="#v:updateMap" class="selflink">#</a></p><div class="doc"><pre>   <a href="form">action=&quot;/upload&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;</a>
   Upload File: <a href="input">type=&quot;file&quot; name=&quot;file&quot;</a><a href="br">br</a>
   <a href="input">type=&quot;submit&quot; value=&quot;submit&quot;</a>
   <a href="/form">/form</a> 
   </pre><ul><li>Handle file uploads, storing the file in the current directory</li><li>upload :: Application</li></ul></div></div><div class="top"><p class="src"><a id="v:replyEditor" class="def">replyEditor</a> :: Response <a href="src/WaiLib.html#replyEditor" class="link">Source</a> <a href="#v:replyEditor" class="selflink">#</a></p><div class="doc"><p>NOTE: file =&gt; /upload dir
 | Plz see uploadPage.html </p></div></div><div class="top"><p class="src"><a id="v:responseHelp" class="def">responseHelp</a> :: Response <a href="src/WaiLib.html#responseHelp" class="link">Source</a> <a href="#v:responseHelp" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:replyCssButton" class="def">replyCssButton</a> :: Response <a href="src/WaiLib.html#replyCssButton" class="link">Source</a> <a href="#v:replyCssButton" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:wordcountReply" class="def">wordcountReply</a> :: Response <a href="src/WaiLib.html#wordcountReply" class="link">Source</a> <a href="#v:wordcountReply" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:matrixReply" class="def">matrixReply</a> :: Response <a href="src/WaiLib.html#matrixReply" class="link">Source</a> <a href="#v:matrixReply" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:replyJS" class="def">replyJS</a> :: Response <a href="src/WaiLib.html#replyJS" class="link">Source</a> <a href="#v:replyJS" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:insertDatabase" class="def">insertDatabase</a> :: Connection -&gt; Application <a href="src/WaiLib.html#insertDatabase" class="link">Source</a> <a href="#v:insertDatabase" class="selflink">#</a></p><div class="doc"><h3>Insert name and age to MySqlite-simple file-based database.</h3><p><a href="http://localhost:8080/insert/">http://localhost:8080/insert/</a></p><p>File: insert.html
    <a href="form">action=&quot;/insert&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;</a>
      Name <a href="input">type=&quot;text&quot; name=&quot;name&quot;</a><a href="br">br</a>
      Age <a href="input">type=&quot;text&quot; name=&quot;age&quot;</a><a href="br">br</a>
      <a href="input">type=&quot;submit&quot; value=&quot;submit&quot;</a>
    <a href="/form">/form</a> </p><pre>insert data to table: people
&quot;INSERT INTO people (name, age) VALUES (?,?)&quot; </pre></div></div><div class="top"><p class="src"><a id="v:upload" class="def">upload</a> :: String -&gt; Application <a href="src/WaiLib.html#upload" class="link">Source</a> <a href="#v:upload" class="selflink">#</a></p><div class="doc"><ul><li>------------------------------------------------------------------------------- 
 | Wed Dec  5 15:06:00 2018 
   Sat Jun  8 23:42:18 2019 
 | upload with following POST to upload file to server
 | -------------------------------------------------------------------------------- 
 <a href="form">action=&quot;/upload&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;</a>
  Upload File: <a href="input">type=&quot;file&quot; name=&quot;file&quot;</a><a href="br">br</a>
  <a href="input">type=&quot;submit&quot; value=&quot;submit&quot;</a>
 <a href="/form">/form</a> 
 | -------------------------------------------------------------------------------- 
   <a href="http://localhost:8080/up/">http://localhost:8080/up/</a>
 | File is uploaded to =&gt; haskell_web/uploaddir </li></ul></div></div><div class="top"><p class="src"><a id="v:searchMap" class="def">searchMap</a> :: Application <a href="src/WaiLib.html#searchMap" class="link">Source</a> <a href="#v:searchMap" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:ClientId" class="def">ClientId</a> = Int <a href="src/WaiLib.html#ClientId" class="link">Source</a> <a href="#t:ClientId" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Client" class="def">Client</a> = (<a href="WaiLib.html#t:ClientId" title="WaiLib">ClientId</a>, Connection) <a href="src/WaiLib.html#Client" class="link">Source</a> <a href="#t:Client" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:State" class="def">State</a> = [<a href="WaiLib.html#t:Client" title="WaiLib">Client</a>] <a href="src/WaiLib.html#State" class="link">Source</a> <a href="#t:State" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:connectClient" class="def">connectClient</a> :: Connection -&gt; MVar <a href="WaiLib.html#t:State" title="WaiLib">State</a> -&gt; IO <a href="WaiLib.html#t:ClientId" title="WaiLib">ClientId</a> <a href="src/WaiLib.html#connectClient" class="link">Source</a> <a href="#v:connectClient" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:withoutClient" class="def">withoutClient</a> :: <a href="WaiLib.html#t:ClientId" title="WaiLib">ClientId</a> -&gt; <a href="WaiLib.html#t:State" title="WaiLib">State</a> -&gt; <a href="WaiLib.html#t:State" title="WaiLib">State</a> <a href="src/WaiLib.html#withoutClient" class="link">Source</a> <a href="#v:withoutClient" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:disconnectClient" class="def">disconnectClient</a> :: <a href="WaiLib.html#t:ClientId" title="WaiLib">ClientId</a> -&gt; MVar <a href="WaiLib.html#t:State" title="WaiLib">State</a> -&gt; IO () <a href="src/WaiLib.html#disconnectClient" class="link">Source</a> <a href="#v:disconnectClient" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:nextId" class="def">nextId</a> :: <a href="WaiLib.html#t:State" title="WaiLib">State</a> -&gt; <a href="WaiLib.html#t:ClientId" title="WaiLib">ClientId</a> <a href="src/WaiLib.html#nextId" class="link">Source</a> <a href="#v:nextId" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:httpApp" class="def">httpApp</a> :: Application <a href="src/WaiLib.html#httpApp" class="link">Source</a> <a href="#v:httpApp" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:listen" class="def">listen</a> :: Connection -&gt; <a href="WaiLib.html#t:ClientId" title="WaiLib">ClientId</a> -&gt; MVar <a href="WaiLib.html#t:State" title="WaiLib">State</a> -&gt; IO () <a href="src/WaiLib.html#listen" class="link">Source</a> <a href="#v:listen" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:broadcast" class="def">broadcast</a> :: <a href="WaiLib.html#t:ClientId" title="WaiLib">ClientId</a> -&gt; MVar <a href="WaiLib.html#t:State" title="WaiLib">State</a> -&gt; Text -&gt; IO () <a href="src/WaiLib.html#broadcast" class="link">Source</a> <a href="#v:broadcast" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:wsApp" class="def">wsApp</a> :: MVar <a href="WaiLib.html#t:State" title="WaiLib">State</a> -&gt; ServerApp <a href="src/WaiLib.html#wsApp" class="link">Source</a> <a href="#v:wsApp" class="selflink">#</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.20.0</p></div></body></html>